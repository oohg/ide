/*
 * $Id: formedit.prg $
 */
/*
 * OOHG source code:
 * OOHG IDE+ form generator
 *
 * Copyright 2014-2022 Fernando Yurisich <fyurisich@oohg.org> and contributors of
 * the Object Oriented (x)Harbour GUI (aka OOHG) Project, https://oohg.github.io
 *
 * Portions of this project are based upon:
 *    "Harbour Minigui IDE"
 *       Copyright 2002-2014 Ciro Vargas Clemow, <cvc@oohg.org>
 *    "Harbour MiniGUI Extended Edition Library"
 *       Copyright 2005-2020 MiniGUI Team, http://hmgextended.com
 *    "Harbour GUI framework for Win32"
 *       Copyright 2001 Alexander S.Kresin, <alex@kresin.ru>
 *       Copyright 2001 Antonio Linares, <alinares@fivetech.com>
 *    "Harbour MiniGUI"
 *       Copyright 2002-2016 Roberto Lopez, <mail.box.hmg@gmail.com>
 *    "Harbour Project"
 *       Copyright 1999-2022 Contributors, https://harbour.github.io/
 */
/*
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2, or (at your option)
 * any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this software; see the file LICENSE.txt. If not, write to
 * the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
 * Boston, MA 02110-1335, USA (or download from http://www.gnu.org/licenses/).
 *
 * As a special exception, the ooHG Project gives permission for
 * additional uses of the text contained in its release of ooHG.
 *
 * The exception is that, if you link the ooHG libraries with other
 * files to produce an executable, this does not by itself cause the
 * resulting executable to be covered by the GNU General Public License.
 * Your use of that executable is in no way restricted on account of
 * linking the ooHG library code into it.
 *
 * This exception does not however invalidate any other reasons why
 * the executable file might be covered by the GNU General Public License.
 *
 * This exception applies only to the code released by the ooHG
 * Project under the name ooHG. If you copy code from other
 * ooHG Project or Free Software Foundation releases into a copy of
 * ooHG, as the General Public License permits, the exception does
 * not apply to the code that you add in this way. To avoid misleading
 * anyone as to the status of such modified files, you must delete
 * this exception notice from them.
 *
 * If you write modifications of your own for ooHG, it is your choice
 * whether to permit this exception to apply to your modifications.
 * If you do not wish that, delete this exception notice.
 */

#include "oohg.ch"
#include "hbclass.ch"
#include "i_windefs.ch"

#define UpperNIL( cValue )    iif( Upper( AllTrim( cValue ) ) == "NIL", "NIL", cValue )
#define NOTEMPTY( cValue )    ( ! Empty( cValue ) .AND. UpperNIL( cValue ) != "NIL" )
#define NOTZERO( cValue )     ( ! Empty( cValue ) .AND. UpperNIL( cValue ) != "NIL" .AND. UpperNIL( cValue ) != "0" )
#define DOUBLE_QUOTATION_MARK '"'
#define SINGLE_QUOTATION_MARK "'"
#define APP_FULL_NAME         ( "ooHG IDE Plus" + " v." + SubStr( __DATE__, 3, 2 ) + "." + Right( __DATE__, 4 ) )
#define IDE_LAST_CTRL         39
#define HTAB                  Chr( 9 )
#define SM_CXMIN              28
#define SM_CYMIN              29
#define SUPPORTED_DATAS       { ;
                              { "a3State",        .F. }, ;
                              { "aAction",        "" }, ;
                              { "aAction2",       "" }, ;
                              { "aAddress",       "" }, ;
                              { "aAfterColMove",  "" }, ;
                              { "aAfterColSize",  "" }, ;
                              { "aAlignH",        "NIL" }, ;
                              { "aAlignV",        "NIL" }, ;
                              { "aAppend",        .F. }, ;
                              { "aAttached",      .F. }, ;
                              { "aAutoHeight",    .F. }, ;
                              { "aAutoMove",      .F. }, ;
                              { "aAutoPlay",      .F. }, ;
                              { "aAutoSize",      .F. }, ;
                              { "aAutoSkip",      .F. }, ;
                              { "aAutoWidth",     .F. }, ;
                              { "aBackColor",     "NIL" }, ;
                              { "aBackground",    "" }, ;
                              { "aBackgroundClr", "NIL" }, ;
                              { "aBeforeAutoFit", "" }, ;
                              { "aBeforeColMove", "" }, ;
                              { "aBeforeColSize", "" }, ;
                              { "aBorder",        .F. }, ;
                              { "aBoth",          .F. }, ;
                              { "aBottomAlign",   .F. }, ;
                              { "aBoundText",     .F. }, ;
                              { "aBreak",         .F. }, ;
                              { "aBuffer",        "" }, ;
                              { "aButtons",       .F. }, ;
                              { "aButtonWidth",   "" }, ;
                              { "aNavByCell",     .F. }, ;
                              { "aCancel",        .F. }, ;
                              { "aCaption",       "" }, ;
                              { "aCargo",         "" }, ;
                              { "aCellToolTip",   .F. }, ;
                              { "aCenter",        .F. }, ;
                              { "aCenterAlign",   .F. }, ;
                              { "aCheckBoxes",    .F. }, ;
                              { "aChgBefEdit",    .F. }, ;
                              { "aClientEdge",    .F. }, ;
                              { "aCObj",          "" }, ;
                              { "aColCount",      "" }, ;
                              { "aColumnCtrls",   "" }, ;
                              { "aColumnInfo",    "" }, ;
                              { "aColWidth",      "" }, ;
                              { "aControlW",      "" }, ;                  /* Names of the controls in the designed form (real object's names, lowercased) */
                              { "aCtrlsLeft",     .F. }, ;
                              { "aCtrlType",      "" }, ;
                              { "aCue",           "" }, ;
                              { "aCursor",        "" }, ;
                              { "aDate",          .F. }, ;
                              { "aDefault",       .F. }, ;
                              { "aDefaultValues", .F. }, ;
                              { "aDefaultYear",   "" }, ;
                              { "aDelayedLoad",   .F. }, ;
                              { "aDelayMsgs",     .F. }, ;
                              { "aDelete",        .F. }, ;
                              { "aDeleteMsg",     "" }, ;
                              { "aDeleteWhen",    "" }, ;
                              { "aDescend",       .F. }, ;
                              { "aDIBSection",    .F. }, ;
                              { "aDisableAltA",   .F. }, ;
                              { "aDisabled",      .F. }, ;
                              { "aDisplayEdit",   .F. }, ;
                              { "aDrag",          .F. }, ;
                              { "aDragItems",     .F. }, ;
                              { "aDrawBy",        "NIL" }, ;
                              { "aDrop",          .F. }, ;
                              { "aDynBackColor",  "" }, ;
                              { "aDynForeColor",  "" }, ;
                              { "aEdit",          .F. }, ;
                              { "aEditCellValue", .F. }, ;
                              { "aEditFirstVis",  .F. }, ;
                              { "aEditHeight",    "" }, ;
                              { "aEditLikeExcel", .F. }, ;
                              { "aEditKeys",      "" }, ;
                              { "aEditKeysFun",   "" }, ;
                              { "aEditLabels",    .F. }, ;
                              { "aEnableAltA",    .F. }, ;
                              { "aExclude",       "" }, ;
                              { "aExtDblClick",   .F. }, ;
                              { "aField",         "" }, ;
                              { "aFields",        "" }, ;
                              { "aFile",          "" }, ;
                              { "aFileType",      "" }, ;
                              { "aFillRect",      "NIL" }, ;
                              { "aFirstItem",     .F. }, ;
                              { "aFit",           .F. }, ;
                              { "aFitImg",        .F. }, ;
                              { "aFitTxt",        .F. }, ;
                              { "aFixBlocks",     "NIL" }, ;
                              { "aFixedCols",     .F. }, ;
                              { "aFixedCtrls",    "NIL" }, ;
                              { "aFixedWidths",   .F. }, ;
                              { "aFlat",          .F. }, ;
                              { "aFocusedPos",    "" }, ;
                              { "aFocusRect",     "NIL" }, ;
                              { "aFontBold",      .F. }, ;
                              { "aFontColor",     "NIL" }, ;
                              { "aFontItalic",    .F. }, ;
                              { "aFontName",      "" }, ;
                              { "aFontNameFrm",   "" }, ;
                              { "aFontSize",      0 }, ;
                              { "aFontSizeFrm",   "" }, ;
                              { "aFontStrikeout", .F. }, ;
                              { "aFontUnderline", .F. }, ;
                              { "aForceRefresh",  .F. }, ;
                              { "aForceScale",    .F. }, ;
                              { "aFormat",        "" }, ;
                              { "aFullMove",      .F. }, ;
                              { "aFullRowSelect", .F. }, ;
                              { "aGripperText",   "" }, ;
                              { "aHandCursor",    .F. }, ;
                              { "aHBitmap",       "" }, ;
                              { "aHdrBackClrs",   "" }, ;
                              { "aHdrImgAlign",   "" }, ;
                              { "aHdrFontClrs",   "" }, ;
                              { "aHdrImages",     "" }, ;
                              { "aHeaders",       "{ 'one', 'two' }" }, ;
                              { "aHeight",        "" }, ;
                              { "aHelpID",        "" }, ;
                              { "aHorizontal",    .F. }, ;
                              { "aHotTrack",      .F. }, ;
                              { "aHScroll",       .F. }, ;
                              { "aIconLeft",      .F. }, ;
                              { "aImage",         "" }, ;
                              { "aImageAlign",    "NIL" }, ;
                              { "aImageMargin",   "" }, ;
                              { "aImageSize",     .F. }, ;
                              { "aImageSource",   "" }, ;
                              { "aIncrement",     "" }, ;
                              { "aIncremental",   .F. }, ;
                              { "aIndent",        "" }, ;
                              { "aInPlace",       .F. }, ;
                              { "aInputMask",     "" }, ;
                              { "aInsertType",    "" }, ;
                              { "aIntegHeight",   .F. }, ;
                              { "aInternals",     .F. }, ;
                              { "aInvisible",     .F. }, ;
                              { "aItemCount",     "" }, ;
                              { "aItemIDs",       .F. }, ;
                              { "aItemImages",    ""  }, ;
                              { "aItemImgNumber", "" }, ;
                              { "aItems",         "" }, ;
                              { "aItemSize",      "" }, ;
                              { "aItemSource",    "" }, ;
                              { "aJustify",       "" }, ;
                              { "aKeysLkClp",     .F. }, ;
                              { "aLabelLeft",     .F. }, ;
                              { "aLeft",          .F. }, ;
                              { "aLeftJust",      .F. }, ;
                              { "aLimit",         "" }, ;
                              { "aLineSkip",      .F. }, ;
                              { "aListWidth",     "" }, ;
                              { "aLock",          .F. }, ;
                              { "aLowerCase",     .F. }, ;
                              { "aMarquee",       "" }, ;
                              { "aMaxLength",     "" }, ;
                              { "aMinWidth",      "" }, ;
                              { "aMultiCol",      .F. }, ;
                              { "aMultiLine",     .F. }, ;
                              { "aMultiSelect",   .F. }, ;
                              { "aMultiTab",      .F. }, ;
                              { "aName",          "" }, ;                  /* Name of the control in the FMG file, must be unique */
                              { "aNewAtRow",      "" }, ;
                              { "aNo3DColors",    .F. }, ;
                              { "aNoAlt",         .F. }, ;
                              { "aNoAutoSizeMov", .F. }, ;
                              { "aNoAutoSizeWin", .F. }, ;
                              { "aNoBorder",      .F. }, ;
                              { "aNoButtons",     .F. }, ;
                              { "aNoChkDepth",    .F. }, ;
                              { "aNoClickOnChk",  .F. }, ;
                              { "aNoClone",       .F. }, ;
                              { "aNoContext",     .F. }, ;
                              { "aNoDefMsg",      .F. }, ;
                              { "aNodeImages",    "" }, ;
                              { "aNoDelMsg",      .F. }, ;
                              { "aNoDestroy",     .F. }, ;
                              { "aNoDIBSection",  .F. }, ;
                              { "aNoErrorDlg",    .F. }, ;
                              { "aNoFocusRect",   .F. }, ;
                              { "aNoHeaders",     .F. }, ;
                              { "aNoHideSel",     .F. }, ;
                              { "aNoHotLight",    .F. }, ;
                              { "aNoHScroll",     .F. }, ;
                              { "aNoImgList",     .F. }, ;
                              { "aNoLines",       .F. }, ;
                              { "aNoLoadTrans",   .F. }, ;
                              { "aNoMenu",        .F. }, ;
                              { "aNoModalEdit",   .F. }, ;
                              { "aNoneUnsels",    .F. }, ;
                              { "aNoOpen",        .F. }, ;
                              { "aNoPlayBar",     .F. }, ;
                              { "aNoPRedraw",     .F. }, ;
                              { "aNoPrefix",      .F. }, ;
                              { "aNoPrint",       .F. }, ;
                              { "aNoRClickOnChk", .F. }, ;
                              { "aNoRefresh",     .F. }, ;
                              { "aNoResize",      .F. }, ;
                              { "aNoRootButton",  .F. }, ;
                              { "aNoShowAlways",  .F. }, ;
                              { "aNoTabStop",     .F. }, ;
                              { "aNoTicks",       .F. }, ;
                              { "aNoToday",       .F. }, ;
                              { "aNoTodayCircle", .F. }, ;
                              { "aNoVScroll",     .F. }, ;
                              { "aNoWrap",        .F. }, ;
                              { "aNumber",        "" }, ;                   /* End line of control's definition in FMG file */
                              { "aNumeric",       .F. }, ;
                              { "aOnAbortEdit",   "" }, ;
                              { "aOnAppend",      "" }, ;
                              { "aOnBfrEdtCell",  "" }, ;
                              { "aOnBfrInsert",   "" }, ;
                              { "aOnCancel",      "" }, ;
                              { "aOnce",         .F. }, ;
                              { "aOnChange",      "" }, ;
                              { "aOnCheckChg",    "" }, ;
                              { "aOnCollapse",    "" }, ;
                              { "aOnDblClick",    "" }, ;
                              { "aOnDelete",      "" }, ;
                              { "aOnDispChange",  "" }, ;
                              { "aOnDrop",        "" }, ;
                              { "aOnEditCell",    "" }, ;
                              { "aOnEditCellEnd", "" }, ;
                              { "aOnEnter",       "" }, ;
                              { "aOnExpand",      "" }, ;
                              { "aOnGotFocus",    "" }, ;
                              { "aOnHeadClick",   "" }, ;
                              { "aOnHeadDClick",  "" }, ;
                              { "aOnHeadRClick",  "" }, ;
                              { "aOnHScroll",     "" }, ;
                              { "aOnInsert",      "" }, ;
                              { "aOnLabelEdit",   "" }, ;
                              { "aOnListClose",   "" }, ;
                              { "aOnListDisplay", "" }, ;
                              { "aOnLostFocus",   "" }, ;
                              { "aOnMClick",      "" }, ;
                              { "aOnMDClick",     "" }, ;
                              { "aOnMouseLeave",  "" }, ;
                              { "aOnMouseMove",   "" }, ;
                              { "aOnQueryData",   "" }, ;
                              { "aOnRClick",      "" }, ;
                              { "aOnRDClick",     "" }, ;
                              { "aOnRefresh",     "" }, ;
                              { "aOnRowRefresh",  "" }, ;
                              { "aOnScrEndTrack", "" }, ;
                              { "aOnScrLineLU",   "" }, ;
                              { "aOnScrLineRD",   "" }, ;
                              { "aOnScrLT",       "" }, ;
                              { "aOnScrPageLU",   "" }, ;
                              { "aOnScrPageRD",   "" }, ;
                              { "aOnScrRB",       "" }, ;
                              { "aOnScrThumb",    "" }, ;
                              { "aOnScrTrack",    "" }, ;
                              { "aOnSelChange",   "" }, ;
                              { "aOnTextFilled",  "" }, ;
                              { "aOnViewChange",  "" }, ;
                              { "aOnVScroll",     "" }, ;
                              { "aOpaque",        .F. }, ;
                              { "aOptHeight",     "" }, ;
                              { "aOptions",       "" }, ;
                              { "aOwnTT",         .F. }, ;
                              { "aPadding",       "" }, ;
                              { "aPageCargos",    "" }, ;
                              { "aPageNames",     "" }, ;
                              { "aPageObjs",      "" }, ;
                              { "aPageSkip",      .F. }, ;
                              { "aPageSubClass",  "" }, ;
                              { "aPageToolTips",  "" }, ;
                              { "aParent",        "" }, ;
                              { "aPassword",      .F. }, ;
                              { "aPicture",       "" }, ;
                              { "aPlainText",     .F. }, ;
                              { "aPLM",           .F. }, ;
                              { "aProgID",        "" }, ;
                              { "aRaggedRight",   .F. }, ;
                              { "aRange",         "" }, ;
                              { "aReadOnly",      .F. }, ;
                              { "aReadOnlyArray", "" }, ;
                              { "aRecCount",      .F. }, ;
                              { "aRedrawOnAdd",   .F. }, ;
                              { "aRefresh",       "NIL" }, ;
                              { "aReplaceField",  "" }, ;
                              { "aRightAlign",    .F. }, ;
                              { "aRightJust",     .F. }, ;
                              { "aRowCount",      "" }, ;
                              { "aRTL",           .F. }, ;
                              { "aScrollOp",      .F. }, ;
                              { "aSearchLapse",   "" }, ;
                              { "aSelBold",       .F. }, ;
                              { "aSelColor",      "" }, ;
                              { "aShift",         "" }, ;
                              { "aShowAll",       .F. }, ;
                              { "aShowMode",      .F. }, ;
                              { "aShowName",      .F. }, ;
                              { "aShowNone",      .F. }, ;
                              { "aShowPosition",  .F. }, ;
                              { "aSilent",        .F. }, ;
                              { "aSingleBuffer",  .F. }, ;
                              { "aSingleExpand",  .F. }, ;
                              { "aSmooth",        .F. }, ;
                              { "aSolid",         .F. }, ;
                              { "aSort",          .F. }, ;
                              { "aSourceOrder",   "" }, ;
                              { "aSpacing",       "" }, ;
                              { "aSpeed",         1 }, ;                   /* Start line of control's definition in FMG file */
                              { "aStretch",       .F. }, ;
                              { "aSubClass",      "" }, ;
                              { "aSync",          "NIL" }, ;
                              { "aTabPage",       { "", 0 } }, ;           /* Each item is { cTabName, nTabPage } */
                              { "aTabsWidth",     "" }, ;
                              { "aTarget",        "" }, ;
                              { "aTextHeight",    "" }, ;
                              { "aTimeOut",       "" }, ;
                              { "aTitleBackClr",  "NIL" }, ;
                              { "aTitleFontClr",  "NIL" }, ;
                              { "aToolTip",       "" }, ;
                              { "aToolTipAct1",   "" }, ;
                              { "aToolTipAct2",   "" }, ;
                              { "aTop",           .F. }, ;
                              { "aTrailFontClr",  "NIL" }, ;
                              { "aTransparent",   .F. }, ;
                              { "aTxtMrgn",       "" }, ;
                              { "aUpdate",        .F. }, ;
                              { "aUpdateColors",  .F. }, ;
                              { "aUpDown",        .F. }, ;
                              { "aUpperCase",     .F. }, ;
                              { "aUseButtons",    .F. }, ;
                              { "aValid",         "" }, ;
                              { "aValidMess",     "" }, ;
                              { "aValue",         "" }, ;
                              { "aValueIs",       "NIL" }, ;
                              { "aValueSource",   "" }, ;
                              { "aVCenter",       .F. }, ;
                              { "aVersion",       "" }, ;
                              { "aVertical",      .F. }, ;
                              { "aVirtual",       .F. }, ;
                              { "aVScroll",       .F. }, ;
                              { "aWeekNumbers",   .F. }, ;
                              { "aWhen",          "" }, ;
                              { "aWhiteBack",     .F. }, ;
                              { "aWidth",         "" }, ;
                              { "aWidths",        "{ 60, 60 }" }, ;
                              { "aWorkArea",      "Alias()" }, ;
                              { "aWrap",          .F. } }


#define TYPE_FORM               1
#define TYPE_BUTTON             2
#define TYPE_CHECKBOX           3
#define TYPE_LISTBOX            4
#define TYPE_COMBOBOX           5
#define TYPE_CHECKBUTTON        6
#define TYPE_GRID               7
#define TYPE_FRAME              8
#define TYPE_TAB                9
#define TYPE_IMAGE              10
#define TYPE_ANIMATEBOX         11
#define TYPE_DATEPICKER         12
#define TYPE_TEXTBOX            13
#define TYPE_EDITBOX            14
#define TYPE_LABEL              15
#define TYPE_PLAYER             16
#define TYPE_PROGRESSBAR        17
#define TYPE_RADIOGROUP         18
#define TYPE_SLIDER             19
#define TYPE_SPINNER            20
#define TYPE_PICCHECKBUTT       21
#define TYPE_PICBUTT            22
#define TYPE_TIMER              23
#define TYPE_BROWSE             24
#define TYPE_TREE               25
#define TYPE_IPADDRESS          26
#define TYPE_MONTHCALENDAR      27
#define TYPE_HYPERLINK          28
#define TYPE_RICHEDITBOX        29
#define TYPE_TIMEPICKER         30
#define TYPE_XBROWSE            31
#define TYPE_ACTIVEX            32
#define TYPE_CHECKLIST          33
#define TYPE_HOTKEYBOX          34
#define TYPE_PICTURE            35
#define TYPE_PROGRESSMETER      36
#define TYPE_SCROLLBAR          37
#define TYPE_TEXTARRAY          38
#define TYPE_ANIGIF             39

/*--------------------------------------------------------------------------------------------------------------------------------*/
CLASS TFormEditor

   /* Miscelaneous editor's variables */
   DATA aDatas               INIT SUPPORTED_DATAS
   DATA aFDefines            INIT {}
   DATA aFormData            INIT {}
   DATA aFUndefs             INIT {}
   DATA aLine                INIT {}
   DATA aTabs                INIT {}
   DATA cFormFullName        INIT ""
   DATA cFormPathName        INIT ""
   DATA CurrentControl       INIT 1
   DATA Form_List            INIT NIL
   DATA Form_Main            INIT NIL
   DATA FormCtrlOrder        INIT NIL
   DATA lIsFormModified      INIT .F.
   DATA myCMCtrl             INIT NIL
   DATA myDMCtrl             INIT {}
   DATA myIde                INIT NIL
   DATA myMMCtrl             INIT NIL
   DATA myNMCtrl             INIT NIL
   DATA myTbEditor           INIT NIL
   DATA nControlW            INIT 0           /* Number of controls in the form under design */
   DATA nEditorIndex         INIT 0
   DATA nIndexW              INIT 0           /* Index in control's arrays of the control being dragged or sized */
   DATA oCtrlBox             INIT NIL
   DATA oCtrlList            INIT NIL
   DATA oDesignForm          INIT NIL
   DATA oDesignFormMenu      INIT NIL
   DATA oWaitMsg             INIT NIL
   DATA swCursor             INIT 0           /* 1 = control is being dragged   2 = control is being sized   0 = none */

   /*
      Arrays to hold the values of the properties and events of the form's controls.
      Each time a new property or event is added to a control, you must:
      - add a new DATA here (except when you use a existing one).
      - add a new item to SUPPORTED_DATAS array.
      - add logic to handle it at methods p(ControlType), Save, MakeControls, PropertiesClick and EventsClick.
   */

   /* Values of the form's properties */
   DATA cFBackColor          INIT ""
   DATA cFBackImage          INIT ""
   DATA cFCargo              INIT ""
   DATA cFCursor             INIT ""
   DATA cFFontColor          INIT ""
   DATA cFFontName           INIT ""
   DATA cFFontSize           INIT ""
   DATA cFGripperText        INIT ""
   DATA cFHeight             INIT ""
   DATA cFIcon               INIT ""
   DATA cFInterActClose      INIT ""
   DATA cFMaxHeight          INIT ""
   DATA cFMaxWidth           INIT ""
   DATA cFMinHeight          INIT ""
   DATA cFMinWidth           INIT ""
   DATA cFName               INIT ""
   DATA cFNotifyIcon         INIT ""
   DATA cFNotifyToolTip      INIT ""
   DATA cFNumber             INIT 0
   DATA cFObj                INIT ""
   DATA cFOnKeyActions       INIT ""
   DATA cFOnKeyKeys          INIT ""
   DATA cFParent             INIT ""
   DATA cFPosition           INIT { "", "" }
   DATA cFSpeed              INIT 0
   DATA cFSubClass           INIT ""
   DATA cFTitle              INIT ""
   DATA cFVirtualH           INIT ""
   DATA cFVirtualW           INIT ""
   DATA cFWidth              INIT ""
   DATA lFBorder             INIT .F.
   DATA lFBreak              INIT .F.
   DATA lFChild              INIT .F.
   DATA lFClientArea         INIT .F.
   DATA lFFocused            INIT .F.
   DATA lFHelpButton         INIT .F.
   DATA lFInternal           INIT .F.
   DATA lFMDI                INIT .F.
   DATA lFMDIChild           INIT .F.
   DATA lFMDIClient          INIT .F.
   DATA lFMain               INIT .F.
   DATA lFModal              INIT .F.
   DATA lFModalSize          INIT .F.
   DATA lFNoAutoRelease      INIT .F.
   DATA lFNoCaption          INIT .F.
   DATA lFNoDefWinProc       INIT .F.
   DATA lFNoMaximize         INIT .F.
   DATA lFNoMinimize         INIT .F.
   DATA lFNoShow             INIT .F.
   DATA lFNoSize             INIT .F.
   DATA lFNoSysmenu          INIT .F.
   DATA lFRTL                INIT .F.
   DATA lFSplitChild         INIT .F.
   DATA lFStretch            INIT .F.
   DATA lFTopmost            INIT .F.
   DATA nFHeight             INIT 0
   DATA nFMaxHeight          INIT 0
   DATA nFMaxWidth           INIT 0
   DATA nFMinHeight          INIT 0
   DATA nFMinWidth           INIT 0
   DATA nFVirtualH           INIT 0
   DATA nFVirtualW           INIT 0
   DATA nFWidth              INIT 0

   /* Values of the form's events */
   DATA cFDblClickProcedure  INIT ""
   DATA cFMClickProcedure    INIT ""
   DATA cFMDblClickProcedure INIT ""
   DATA cFMoveProcedure      INIT ""
   DATA cFOnGotFocus         INIT ""
   DATA cFOnHScrollbox       INIT ""
   DATA cFOnInit             INIT ""
   DATA cFOnInteractiveClose INIT ""
   DATA cFOnLostFocus        INIT ""
   DATA cFOnMaximize         INIT ""
   DATA cFOnMinimize         INIT ""
   DATA cFOnMouseClick       INIT ""
   DATA cFOnMouseDrag        INIT ""
   DATA cFOnMouseMove        INIT ""
   DATA cFOnNotifyClick      INIT ""
   DATA cFOnPaint            INIT ""
   DATA cFOnRelease          INIT ""
   DATA cFOnScrollDown       INIT ""
   DATA cFOnScrollLeft       INIT ""
   DATA cFOnScrollRight      INIT ""
   DATA cFOnScrollUp         INIT ""
   DATA cFOnSize             INIT ""
   DATA cFOnVScrollbox       INIT ""
   DATA cFRClickProcedure    INIT ""
   DATA cFRDblClickProcedure INIT ""
   DATA cFRestoreProcedure   INIT ""

   /* Values of the form's statusbar properties and events */
   DATA cSAction             INIT ""
   DATA cSAlign              INIT ""
   DATA cSCAction            INIT ""
   DATA cSCAlign             INIT ""
   DATA cSCaption            INIT ""
   DATA cSCargo              INIT ""
   DATA cSCImage             INIT ""
   DATA cSCObj               INIT ""
   DATA cSCStyle             INIT ""
   DATA cSCToolTip           INIT ""
   DATA cSDAction            INIT ""
   DATA cSDAlign             INIT ""
   DATA cSDStyle             INIT ""
   DATA cSDToolTip           INIT ""
   DATA cSFontName           INIT ""
   DATA cSFontNameFrm        INIT ""
   DATA cSFontSizeFrm        INIT ""
   DATA cSIcon               INIT ""
   DATA cSKAction            INIT ""
   DATA cSKAlign             INIT ""
   DATA cSKImage             INIT ""
   DATA cSKStyle             INIT ""
   DATA cSKToolTip           INIT ""
   DATA cSNumber             INIT 0
   DATA cSSpeed              INIT 0
   DATA cSStyle              INIT ""
   DATA cSSubClass           INIT ""
   DATA cSToolTip            INIT ""
   DATA cSWidth              INIT ""
   DATA lSBold               INIT .F.
   DATA lSCAmPm              INIT .F.
   DATA lSDate               INIT .F.
   DATA lSItalic             INIT .F.
   DATA lSKeyboard           INIT .F.
   DATA lSNoAutoAdjust       INIT .F.
   DATA lSStat               INIT .F.
   DATA lSStrikeout          INIT .F.
   DATA lSTime               INIT .F.
   DATA lSTop                INIT .F.
   DATA lSUnderline          INIT .F.
   DATA nSCWidth             INIT 0
   DATA nSDWidth             INIT 0
   DATA nSFontSize           INIT 0
   DATA nSKWidth             INIT 0

   /* Lowercase needed */
   DATA ControlPrefix        INIT { "form_", "button_", "checkbox_", "listbox_", "combobox_", "checkbutton_", "grid_", "frame_", "tab_", "image_", "animatebox_", "datepicker_", "textbox_", "editbox_", "label_", "player_", "progressbar_", "radiogroup_", "slider_", "spinner_", "piccheckbutt_", "picbutt_", "timer_", "browse_", "tree_", "ipaddress_", "monthcalendar_", "hyperlink_", "richeditbox_", "timepicker_", "xbrowse_", "activex_", "checklist_", "hotkeybox_", "picture_", "progressmeter_", "scrollbar_", "textarray_", "anigif_" }
   /* Uppercase needed */
   DATA ControlType          INIT { "FORM",  "BUTTON",  "CHECKBOX",  "LISTBOX",  "COMBOBOX",  "CHECKBUTTON",  "GRID",  "FRAME",  "TAB",  "IMAGE",  "ANIMATEBOX",  "DATEPICKER",  "TEXTBOX",  "EDITBOX",  "LABEL",  "PLAYER",  "PROGRESSBAR",  "RADIOGROUP",  "SLIDER",  "SPINNER",  "PICCHECKBUTT",  "PICBUTT",  "TIMER",  "BROWSE",  "TREE",  "IPADDRESS",  "MONTHCALENDAR",  "HYPERLINK",  "RICHEDITBOX",  "TIMEPICKER",  "XBROWSE",  "ACTIVEX",  "CHECKLIST",  "HOTKEYBOX",  "PICTURE",  "PROGRESSMETER",  "SCROLLBAR",  "TEXTARRAY",  "ANIGIF"  }
   DATA ControlCount         INIT { 0,       0,         0,           0,          0,           0,              0,       0,        0,      0,        0,             0,             0,          0,          0,        0,         0,              0,             0,         0,          0,               0,          0,        0,         0,       0,            0,                0,            0,              0,             0,          0,          0,            0,            0,          0,                0,            0,            0         }

   METHOD AddControl
   METHOD AddCtrlToContainer
   METHOD AddCtrlToTabPage
   METHOD AddTabPage
   METHOD AdjustInspectorCntrls
   METHOD CheckForFrame
   METHOD CheckStringData
   METHOD Clean
   METHOD ColorStrToColorDef
   METHOD ConfirmDelete
   METHOD ControlClick
   METHOD CopyControl
   METHOD CreateControl
   METHOD CreateStatusBar
   METHOD CtrlFontColors
   METHOD CtrlIsOfType
   METHOD Debug
   METHOD DelArray
   METHOD DelCtrlAndChildsArrays
   METHOD DeleteControls
   METHOD DelFirstCtrl
   METHOD DeleteTabPage
   METHOD DrawOutline
   METHOD DrawPoints
   METHOD EditForm           CONSTRUCTOR
   METHOD EditProperties
   METHOD EventsClick
   METHOD Exit
   METHOD FillListOfCtrls
   METHOD FillListOfGroups
   METHOD FirstCtrl
   METHOD FrmEvents
   METHOD FrmFontColors
   METHOD FrmMoved
   METHOD FrmProperties
   METHOD FrmSized
   METHOD GlobalVertGapChg
   METHOD GOtherColors
   METHOD IniArray
   METHOD IsUnique
   METHOD KeyboardMoveSize
   METHOD KeyHandler
   METHOD LoadControls
   METHOD LoadTabpageProperties
   METHOD LookForLastValueUsed
   METHOD MakeControls
   METHOD ManualMoveSize
   METHOD MinimizeForms
   METHOD MouseMoveSize
   METHOD MouseTrack
   METHOD MoveControl
   METHOD New
   METHOD Open
   METHOD OrderControls
   METHOD OrderDown
   METHOD OrderUp
   METHOD OutlineControls
   METHOD pActiveX
   METHOD pAniGIF
   METHOD pAnimateBox
   METHOD pBrowse
   METHOD pButton
   METHOD pCheckBox
   METHOD pCheckButton
   METHOD pCheckList
   METHOD pComboBox
   METHOD pDatePicker
   METHOD pEditBox
   METHOD pForm
   METHOD pFrame
   METHOD pGrid
   METHOD pHotKeyBox
   METHOD pHyperLink
   METHOD pImage
   METHOD pIPAddress
   METHOD pLabel
   METHOD pListBox
   METHOD pMonthcalendar
   METHOD pPicButt
   METHOD pPicCheckButt
   METHOD pPicture
   METHOD pPlayer
   METHOD pProgressBar
   METHOD pProgressMeter
   METHOD pRadioGroup
   METHOD PreProcessDefineWindow
   METHOD pRichedit
   METHOD PrintBrief
   METHOD PropertiesClick
   METHOD pScrollBar
   METHOD pSlider
   METHOD pSpinner
   METHOD pTab
   METHOD pTextArray
   METHOD pTextBox
   METHOD pTimePicker
   METHOD pTimer
   METHOD pTree
   METHOD pXBrowse
   METHOD ReadCargo
   METHOD ReadCtrlCol
   METHOD ReadCtrlName
   METHOD ReadCtrlRow
   METHOD ReadCtrlType
   METHOD ReadFormLogicalData
   METHOD ReadFormPosition
   METHOD ReadFormStringData
   METHOD ReadLogicalData
   METHOD ReadOopData
   METHOD ReadStringData
   METHOD RecreateControl
   METHOD RefreshControlInspector
   METHOD ReorderTabs
   METHOD RestoreForms
   METHOD Save
   METHOD SaveTabpageProperties
   METHOD SetBackColor
   METHOD SetBackColorIDE
   METHOD SetBackColorOOHG
   METHOD SetFontColor
   METHOD SetFontType
   METHOD SetFontTypeIDE
   METHOD SetFontTypeOOHG
   METHOD SizeControl
   METHOD Snap
   METHOD StatPropEvents
   METHOD StrToValueCtrl
   METHOD StrToValueForm
   METHOD SwapArray
   METHOD TabUpdate
   METHOD TranslateConstant
   METHOD ValCellPos
   METHOD ValGlobalPos
   METHOD VerifyBar

   ENDCLASS

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD EditForm( myIde, cFullName, nEditorIndex, lWait ) CLASS TFormEditor

   LOCAL nPos, cName

   CursorWait()

   SET INTERACTIVECLOSE OFF

   ::myIde        := myIde
   ::nEditorIndex := nEditorIndex

   FOR nPos := 1 to Len( ::aDatas )
      __objAddData( Self, ::aDatas[ nPos, 1 ] )
      __objSendMsg( Self, "_" + ::aDatas[ nPos, 1 ], {} )
   NEXT nPos

   DEFINE WINDOW 0 OBJ ::oWaitMsg ;
      AT 10, 10 ;
      WIDTH 150 ;
      HEIGHT 100 ;
      TITLE i18n( "Information" ) ;
      CHILD ;
      NOSHOW ;
      NOSYSMENU ;
      NOCAPTION ;
      BACKCOLOR ::myIde:aSystemColor ;
      ON INIT ::oWaitMsg:Center()

      @ 35, 15 LABEL label_1 ;
         VALUE i18n( "Please wait ..." ) ;
         AUTOSIZE ;
         FONT "Times new Roman" ;
         SIZE 14
   END WINDOW

   DEFINE WINDOW 0 OBJ ::Form_Main ;
      AT ::myIde:aPositions[1, 1], ::myIde:aPositions[1, 2] ;
      WIDTH 684 ;
      HEIGHT 75 ;
      CLIENTAREA ;
      TITLE i18n( "ooHG IDE Plus - Form designer" ) ;
      CHILD ;
      NOSHOW ;
      NOMAXIMIZE ;
      NOSIZE ;
      ICON "IDE_EDIT" ;
      FONT "MS Sans Serif" ;
      SIZE 10 ;
      BACKCOLOR ::myIde:aSystemColor ;
      ON MINIMIZE ::MinimizeForms() ;
      ON MAXIMIZE ::RestoreForms() ;
      ON RESTORE ::RestoreForms()

      @ 0,4 FRAME frame_1 ;
         CAPTION i18n( "Action" ) ;
         WIDTH 106 ;
         HEIGHT 65 ;
         SIZE 9

      @ 17,10 BUTTON exit ;
         PICTURE "IDE_EXIT" ;
         ACTION ::Exit() ;
         WIDTH 30 ;
         HEIGHT 28 ;
         TOOLTIP i18n( "Exit" )

      @ 17,42 BUTTON save ;
         PICTURE "IDE_SAVE" ;
         ACTION ::Save( .F. ) ;
         WIDTH 30 ;
         HEIGHT 28 ;
         TOOLTIP i18n( "Save" )

      @ 17,74 BUTTON save_as ;
         PICTURE "IDE_SAVEAS" ;
         ACTION ::Save( .T. ) ;
         WIDTH 30 ;
         HEIGHT 28 ;
         TOOLTIP i18n( "Save as" )

      @ 0,112 FRAME frame_2 ;
         CAPTION "Form : " + cFullName ;
         WIDTH 330 ;
         HEIGHT 65 ;
         SIZE 9

      @ 17,118 BUTTON form_prop ;
         PICTURE "IDE_FRMPROPS" ;
         ACTION ::FrmProperties() ;
         WIDTH 30 ;
         HEIGHT 28 ;
         TOOLTIP i18n( "Properties" )

      @ 17,150 BUTTON events_prop ;
         PICTURE "IDE_FRMEVENTS" ;
         ACTION ::FrmEvents() ;
         WIDTH 30 ;
         HEIGHT 28 ;
         TOOLTIP i18n( "Events" )

      @ 17,182 BUTTON form_mc ;
         PICTURE "IDE_FRMFONT" ;
         ACTION ::FrmFontColors() ;
         WIDTH 30 ;
         HEIGHT 28 ;
         TOOLTIP i18n( "Fonts and Colors" )

      @ 17,214 BUTTON tbc_fmms ;
         PICTURE "IDE_MMS" ;
         ACTION ::ManualMoveSize( 0 ) ;
         WIDTH 30 ;
         HEIGHT 28 ;
         TOOLTIP i18n( "Manual Move/Size" )

      @ 17,246 BUTTON mmenu1 ;
         PICTURE "IDE_MENUMAIN" ;
         ACTION TMyMenuEditor():Edit( Self, 1 ) ;
         WIDTH 30 ;
         HEIGHT 28 ;
         TOOLTIP i18n( "Main Menu" )

      @ 17,278 BUTTON mmenu2 ;
         PICTURE "IDE_MENUCNTX" ;
         ACTION TMyMenuEditor():Edit( Self, 2 ) ;
         WIDTH 30 ;
         HEIGHT 28 ;
         TOOLTIP i18n( "Context Menu" )

      @ 17,310 BUTTON mmenu3 ;
         PICTURE "IDE_MENUNOTY" ;
         ACTION TMyMenuEditor():Edit( Self, 3 ) ;
         WIDTH 30 ;
         HEIGHT 28 ;
         TOOLTIP i18n( "Notify Menu" )

      @ 17,342 BUTTON toolb ;
         PICTURE "IDE_EDTTOOL" ;
         ACTION ::myTbEditor:Edit() ;
         WIDTH 30 ;
         HEIGHT 28 ;
         TOOLTIP i18n( "Toolbar" )

      @ 17,374 BUTTON form_co ;
         PICTURE "IDE_ORDER" ;
         ACTION ::OrderControls() ;
         WIDTH 30 ;
         HEIGHT 28 ;
         TOOLTIP i18n( "Order" )

      @ 17,406 BUTTON btn_Status ;
         PICTURE "IDE_STATBAR" ;
         ACTION ::StatPropEvents() ;
         WIDTH 30 ;
         HEIGHT 28 ;
         TOOLTIP i18n( "Statusbar Properties" ) ;
         DISABLED

      @ 0,444 FRAME frame_3 ;
         CAPTION "Control : " ;
         WIDTH 236 ;
         HEIGHT 65 ;
         OPAQUE ;
         SIZE 9
      ::Form_Main:frame_3:lProcMsgsOnVisible := .F.

      @ 17,450 BUTTON tbc_prop ;
         PICTURE "IDE_FRMPROPS" ;
         ACTION ::PropertiesClick() ;
         WIDTH 30 ;
         HEIGHT 28 ;
         TOOLTIP i18n( "Properties" )

      @ 17,482 BUTTON tbc_events ;
         PICTURE "IDE_FRMEVENTS" ;
         ACTION ::EventsClick() ;
         WIDTH 30 ;
         HEIGHT 28 ;
         TOOLTIP i18n( "Events" )

      @ 17,514 BUTTON tbc_ifc ;
         PICTURE "IDE_FRMFONT" ;
         ACTION ::CtrlFontColors() ;
         WIDTH 30 ;
         HEIGHT 28 ;
         TOOLTIP i18n( "Font and Colors" )

      @ 17,546 BUTTON tbc_mms ;
         PICTURE "IDE_MMS" ;
         ACTION ::ManualMoveSize( 1 ) ;
         WIDTH 30 ;
         HEIGHT 28 ;
         TOOLTIP i18n( "Manual Move/Size" )

      @ 17,578 BUTTON tbc_im ;
         PICTURE "IDE_MOVECTRL" ;
         ACTION ::MoveControl() ;
         WIDTH 30 ;
         HEIGHT 28 ;
         TOOLTIP i18n( "Interactive Move" )

      @ 17,610 BUTTON tbc_is ;
         PICTURE "IDE_SIZECTRL" ;
         ACTION ::SizeControl() ;
         WIDTH 30 ;
         HEIGHT 28 ;
         TOOLTIP i18n( "Interactive Size" )

      @ 17,642 BUTTON tbc_del ;
         PICTURE "IDE_DELCTRL" ;
         ACTION ::DelFirstCtrl() ;
         WIDTH 30 ;
         HEIGHT 28 ;
         TOOLTIP i18n( "Delete" )

      @ 48,118 LABEL label_1 ;
         WIDTH 120 ;
         HEIGHT 24 ;
         VALUE "" ;
         SIZE 9 ;
         AUTOSIZE

      @ 48,310 LABEL lbl_yx ;
         WIDTH 100 ;
         HEIGHT 24 ;
         VALUE "0000,0000" ;
         SIZE 9

      @ 48,450 LABEL lbl_Position ;
         WIDTH 120 ;
         HEIGHT 24 ;
         VALUE " " + i18n( "r:" ) + "     " + i18n( "c:" ) + "     " + i18n( "w:" ) + "     " + i18n( "h:" ) + "     " ;
         SIZE 9 ;
         AUTOSIZE

   END WINDOW

   DEFINE WINDOW 0 OBJ ::oCtrlBox ;
      AT ::myIde:aPositions[2, 1], ::myIde:aPositions[2, 2] ;
      WIDTH 86 ;
      HEIGHT 406 ;
      CLIENTAREA ;
      TITLE i18n( "Controls" ) ;
      CHILD ;
      NOSHOW ;
      NOSIZE ;
      NOMAXIMIZE ;
      NOAUTORELEASE ;
      NOMINIMIZE ;
      NOSYSMENU ;
      BACKCOLOR ::myIde:aSystemColor

      @ 000, 00 CHECKBUTTON Control_01 ;
         PICTURE "IDE_SELECT" ;
         VALUE .T. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP i18n( "Select Object" ) ;
         ON CHANGE ::ControlClick( 1 )

      @ 000, 29 CHECKBUTTON Control_02 ;
         PICTURE "IDE_BUTTON" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "Button/ButtonMixed" ;
         ON CHANGE ::ControlClick( 2 )

      @ 000, 58 CHECKBUTTON Control_03 ;
         PICTURE "IDE_CHECKBOX" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "CheckBox" ;
         ON CHANGE ::ControlClick( 3 )

      @ 029, 00 CHECKBUTTON Control_04 ;
         PICTURE "IDE_LISTBOX" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "ListBox" ;
         ON CHANGE ::ControlClick( 4 )

      @ 029, 29 CHECKBUTTON Control_05 ;
         PICTURE "IDE_COMBOBOX" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "ComboBox" ;
         ON CHANGE ::ControlClick( 5 )

      @ 029, 58 CHECKBUTTON Control_06 ;
         PICTURE "IDE_CHECKBUTTON" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "CheckButton" ;
         ON CHANGE ::ControlClick( 6 )

      @ 058, 00 CHECKBUTTON Control_07 ;
         PICTURE "IDE_GRID" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "Grid" ;
         ON CHANGE ::ControlClick( 7 )

      @ 058, 29 CHECKBUTTON Control_08 ;
         PICTURE "IDE_FRAME" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "Frame" ;
         ON CHANGE ::ControlClick( 8 )

      @ 058, 58 CHECKBUTTON Control_09 ;
         PICTURE "IDE_TAB" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "Tab" ;
         ON CHANGE ::ControlClick( 9 )

      @ 087, 00 CHECKBUTTON Control_10 ;
         PICTURE "IDE_IMAGE" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "Image" ;
         ON CHANGE ::ControlClick( 10 )

      @ 087, 29 CHECKBUTTON Control_11 ;
         PICTURE "IDE_ANIMATEBOX" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "AnimateBox" ;
         ON CHANGE ::ControlClick( 11 )

      @ 087, 58 CHECKBUTTON Control_12 ;
         PICTURE "IDE_DATEPICKER" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "DatePicker" ;
         ON CHANGE ::ControlClick( 12 )

      @ 116, 00 CHECKBUTTON Control_13 ;
         PICTURE "IDE_TEXTBOX" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "TextBox" ;
         ON CHANGE ::ControlClick( 13 )

      @ 116, 29 CHECKBUTTON Control_14 ;
         PICTURE "IDE_EDITBOX" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "EditBox" ;
         ON CHANGE ::ControlClick( 14 )

      @ 116, 58 CHECKBUTTON Control_15 ;
         PICTURE "IDE_LABEL" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "Label" ;
         ON CHANGE ::ControlClick( 15 )

      @ 145, 00 CHECKBUTTON Control_16 ;
         PICTURE "IDE_PLAYER" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "Player" ;
         ON CHANGE ::ControlClick( 16 )

      @ 145, 29 CHECKBUTTON Control_17 ;
         PICTURE "IDE_PROGRESSBAR" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "ProgressBar" ;
         ON CHANGE ::ControlClick( 17 )

      @ 145, 58 CHECKBUTTON Control_18 ;
         PICTURE "IDE_RADIOGROUP" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "RadioGroup" ;
         ON CHANGE ::ControlClick( 18 )

      @ 174, 00 CHECKBUTTON Control_19 ;
         PICTURE "IDE_SLIDER" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "Slider" ;
         ON CHANGE ::ControlClick( 19 )

      @ 174, 29 CHECKBUTTON Control_20 ;
         PICTURE "IDE_SPINNER" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "Spinner" ;
         ON CHANGE ::ControlClick( 20 )

      @ 174, 58 CHECKBUTTON Control_21 ;
         PICTURE "IDE_IMAGECHECKBUTTON" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "Picture CheckButton" ;
         ON CHANGE ::ControlClick( 21 )

      @ 203, 00 CHECKBUTTON Control_22 ;
         PICTURE "IDE_IMAGEBUTTON" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "Picture Button" ;
         ON CHANGE ::ControlClick( 22 )

      @ 203, 29 CHECKBUTTON Control_23 ;
         PICTURE "IDE_TIMER" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "Timer" ;
         ON CHANGE ::ControlClick( 23 )

      @ 203, 58 CHECKBUTTON Control_24 ;
         PICTURE "IDE_BROWSE" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "Browse" ;
         ON CHANGE ::ControlClick( 24 )

      @ 232, 00 CHECKBUTTON Control_25 ;
         PICTURE "IDE_TREE" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "Tree" ;
         ON CHANGE ::ControlClick( 25 )

      @ 232, 29 CHECKBUTTON Control_26 ;
         PICTURE "IDE_IPAD" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "IPAddress" ;
         ON CHANGE ::ControlClick( 26 )

      @ 232, 58 CHECKBUTTON Control_27 ;
         PICTURE "IDE_MONTHCAL" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "MonthCalendar" ;
         ON CHANGE ::ControlClick( 27 )

      @ 261, 00 CHECKBUTTON Control_28 ;
         PICTURE "IDE_HYPLINK" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "HyperLink" ;
         ON CHANGE ::ControlClick( 28 )

      @ 261, 29 CHECKBUTTON Control_29 ;
         PICTURE "IDE_RICHEDIT" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "RichEditBox" ;
         ON CHANGE ::ControlClick( 29 )

      @ 261, 58 CHECKBUTTON Control_30 ;
         PICTURE "IDE_TIMEP" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "TimePicker" ;
         ON CHANGE ::ControlClick( 30 )

      @ 290, 00 CHECKBUTTON Control_31 ;
         PICTURE "IDE_XBROWSE" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "XBrowse" ;
         ON CHANGE ::ControlClick( 31 )

      @ 290, 29 CHECKBUTTON Control_32 ;
         PICTURE "IDE_ACTIVEX" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "ActiveX" ;
         ON CHANGE ::ControlClick( 32 )

      @ 290, 58 CHECKBUTTON Control_33 ;
         PICTURE "IDE_CHECKLIST" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "CheckList" ;
         ON CHANGE ::ControlClick( 33 )

      @ 319, 00 CHECKBUTTON Control_34 ;
         PICTURE "IDE_HKB" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "HotKeyBox" ;
         ON CHANGE ::ControlClick( 34 )

      @ 319, 29 CHECKBUTTON Control_35 ;
         PICTURE "IDE_PICTURE" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "Picture" ;
         ON CHANGE ::ControlClick( 35 )

      @ 319, 58 CHECKBUTTON Control_36 ;
         PICTURE "IDE_METER" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "ProgressMeter" ;
         ON CHANGE ::ControlClick( 36 )

      @ 348, 00 CHECKBUTTON Control_37 ;
         PICTURE "IDE_SCRLLBR" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "ScrollBar" ;
         ON CHANGE ::ControlClick( 37 )

      @ 348, 29 CHECKBUTTON Control_38 ;
         PICTURE "IDE_ATEXT" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "TextArray" ;
         ON CHANGE ::ControlClick( 38 )

      @ 348, 58 CHECKBUTTON Control_39 ;
         PICTURE "IDE_GIF" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "Animated GIF" ;
         ON CHANGE ::ControlClick( 39 )

      @ 377, 00 CHECKBUTTON Control_Statusbar ;
         PICTURE "IDE_STATBAR" ;
         VALUE .F. ;
         WIDTH 28 ;
         HEIGHT 28 ;
         TOOLTIP "StatusBar On" ;
         ON CHANGE ::VerifyBar()

   END WINDOW

   ::Form_Main:Activate( .T. )
   ::oCtrlBox:Activate( .T. )
   ::oWaitMsg:Activate( .T. )

   ::cFormFullName := cFullName
   nPos := RAt( "\", cFullName )
   ::cFormPathName := Left( ::cFormFullName, nPos )
   cName := SubStr( cFullName, nPos + 1 )
   nPos := RAt( ".", cName )
   IF nPos > 0
      cName := SubStr( cName, 1, nPos - 1 )
   ENDIF
   ::cFName := Lower( cName )
   ::cFormPathName += ::cFName

   ::myTbEditor := TMyToolBarEditor():New( Self )

   IF File( cFullName )
      ::Open( cFullName, lWait )
   ELSE
      ::New( lWait )
   ENDIF

   RETURN Self

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD FirstCtrl() CLASS TFormEditor

   LOCAL aControls, cName, nHandleA

   aControls := ::oCtrlList:Value
   IF Len( aControls ) > 0
      cName := ::oCtrlList:Cell( aControls[1], 6 )
      nHandleA := AScan( ::oDesignForm:aControls, { |o| Lower( o:Name ) == cName } )
   ELSE
      nHandleA := 0
   ENDIF

   /* Index of the first selected control into oDesignForm:aControls array */
   RETURN nHandleA

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD DelFirstCtrl() CLASS TFormEditor

   LOCAL ia 

   IF ( ia := ::FirstCtrl() ) > 0
      RETURN ::DeleteControls( { { ::oDesignForm:aControls[ia]:Name } } )
   ENDIF

   RETURN .F.

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD AdjustInspectorCntrls() CLASS TFormEditor

   LOCAL w, h

   w := ::Form_List:ClientWidth
   IF w < 370
      ::Form_List:ClientWidth := 370
      w := 370
   ENDIF
   h := ::Form_List:ClientHeight
   IF h < 490
      ::Form_List:ClientHeight := 490
      h := 490
   ENDIF
   ::oCtrlList:Width  := w - 20
   ::oCtrlList:Height := h - 90

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD Open( cFMG, lWait ) CLASS TFormEditor

   LOCAL i, j, nLineCount, cFormTxt, cName, cType, cLine, cSkip := "", lAdd, nPos, cConstant, cValue, lNoForm := .T.
   LOCAL lIgnoreRest := .F., aKeys := {}, aActions := {}, cAction

   ::oWaitMsg:label_1:Value := i18n( "Loading form ..." )
   ::oWaitMsg:Show()

   DEFINE WINDOW 0 OBJ ::Form_List ;
      AT ::myIde:aPositions[3, 1], ::myIde:aPositions[3, 2] ;
      WIDTH 370 ;
      HEIGHT 490 ;
      CLIENTAREA ;
      TITLE i18n( "Control Inspector" ) ;
      CHILD ;
      NOSHOW ;
      NOMAXIMIZE ;
      NOMINIMIZE ;
      NOSYSMENU ;
      BACKCOLOR ::myIde:aSystemColor ;
      ON INIT SetHeightForWholeRows( ::oCtrlList, 400 ) ;
      ON SIZE ::AdjustInspectorCntrls()

      @ 10, 10 GRID 0 OBJ ::oCtrlList ;
         WIDTH 350 ;
         HEIGHT 400 ;
         HEADERS { i18n( "Name" ), i18n( "Row" ), i18n( "Col" ), i18n( "Width" ), i18n( "Height" ), i18n( "int-name" ), i18n( "Type" ) } ;
         WIDTHS { 80, 40, 40, 45, 50, 0, 70 } ;
         FONT "Arial" ;
         SIZE 10 ;
         INPLACE EDIT ;
         READONLY { .T., .F., .F., .F., .F., .T., .T. } ;
         JUSTIFY { GRID_JTFY_LEFT, GRID_JTFY_RIGHT, GRID_JTFY_RIGHT, GRID_JTFY_RIGHT, GRID_JTFY_RIGHT, GRID_JTFY_LEFT, GRID_JTFY_LEFT } ;
         ON HEADCLICK { {|| ::oCtrlList:SortColumn( 1, .F. ) }, {|| ::oCtrlList:SortColumn( 2, .F. ) }, {|| ::oCtrlList:SortColumn( 3, .F. ) }, {|| ::oCtrlList:SortColumn( 4, .F. ) }, {|| ::oCtrlList:SortColumn( 5, .F. ) }, NIL, {|| ::oCtrlList:SortColumn( 7, .F. ) } } ;
         FULLMOVE ;
         MULTISELECT ;
         DELETE ;
         DELETEWHEN {|| ::ConfirmDelete() } ;
         ON DELETE {|aParams| ::DeleteControls( aParams[1] ) } ;
         NODELETEMSG ;
         ON EDITCELL ::ValCellPos() ;
         ON CHANGE ::OutlineControls() ;
         ON GOTFOCUS ::oCtrlList:lDeleteAll := ::myIde:lMultiDelete
      ::oCtrlList:ColumnHide( 6 )
      ::oCtrlList:lDeleteAll := ::myIde:lMultiDelete

      DEFINE CONTEXT MENU CONTROL ( ::oCtrlList:Name ) OF ( ::Form_List:Name )
         ITEM i18n( "Properties" )             ACTION { |aParams| ::EditProperties( aParams ) }
         ITEM i18n( "Events" )                 ACTION ::EventsClick()
         ITEM i18n( "Font/Colors" )            ACTION ::CtrlFontColors()
         ITEM i18n( "Manual Move/Size" )       ACTION ::ManualMoveSize( 1 )
         ITEM i18n( "Interactive Move" )       ACTION ::MoveControl()
         ITEM i18n( "Keyboard Move/Size" )     ACTION ::KeyboardMoveSize()
         ITEM i18n( "Interactive Size" )       ACTION ::SizeControl()
         SEPARATOR
         ITEM i18n( "Global Row Align" )       ACTION ::ValGlobalPos( "ROW" )
         ITEM i18n( "Global Col Align" )       ACTION ::ValGlobalPos( "COL" )
         ITEM i18n( "Global Width Change" )    ACTION ::ValGlobalPos( "WID" )
         ITEM i18n( "Global Height Change" )   ACTION ::ValGlobalPos( "HEI" )
         ITEM i18n( "Global Vert Gap Change" ) ACTION ::GlobalVertGapChg()
         ITEM i18n( "Global Hor/Ver Shift" )   ACTION ::ValGlobalPos( "SHI" )
         SEPARATOR
         ITEM i18n( "Copy" )                   ACTION ::CopyControl()
         ITEM i18n( "Delete" )                 ACTION iif( ::ConfirmDelete(), ::DelFirstCtrl(), NIL )
         SEPARATOR
         ITEM i18n( "Print Brief" )            ACTION ::PrintBrief()
         SEPARATOR
         ITEM i18n( "Form's context menu" )    ACTION iif( HB_ISOBJECT( ::myCMCtrl ), ::myCMCtrl:Activate(), MsgInfo( i18n( "Context menu is not defined !!!" ), "OOHG IDE+" ) )
         ITEM i18n( "Form's notify menu" )     ACTION iif( HB_ISOBJECT( ::myNMCtrl ), ::myNMCtrl:Activate(), MsgInfo( i18n( "Notify menu is not defined !!!" ), "OOHG IDE+" ) )
      END MENU

      @ 420, 10 LABEL Lop1 VALUE i18n( "Double click or Enter to modify the position or size of a control." ) FONT "Calibri" SIZE 9 AUTOSIZE HEIGHT 15
      @ 435, 10 LABEL Lop2 VALUE i18n( "Right click to access properties or events, or to do global" )        FONT "Calibri" SIZE 9 AUTOSIZE HEIGHT 15
      @ 450, 10 LABEL Lop3 VALUE i18n( "align/resize of selected controls (use Ctrl+Click to select)." )      FONT "Calibri" SIZE 9 AUTOSIZE HEIGHT 15
      @ 465, 10 LABEL Lop4 VALUE i18n( "Click on the headers to change display order." )                      FONT "Calibri" SIZE 9 AUTOSIZE HEIGHT 15
   END WINDOW

   /* Load form */
   cFormTxt := StrTran( MemoRead( cFMG ), HTAB, " " )
   nLineCount := MLCount( cFormTxt )

   FOR i := 1 TO nLineCount
      /* The leading and trailing spaces are necessary to properly find key words */
      cLine := AllTrim( MemoLine( cFormTxt, 1200, i ) )
      IF Right( cLine, 1 ) == ";" .AND. ! Right( cLine, 2 ) == " ;"
         cLine := Left( cLine, Len( cLine ) - 1 ) + " ;"
      ENDIF
      cLine += " "
      AAdd( ::aLine, " " + cLine )
      cLine := Upper( cLine )

      IF At( "#DEFINE ", cLine ) == 1
         cLine := LTrim( SubStr( ::aLine[i], 10 ) )
         ::aLine[i] := ""
         j := i
         nPos := At( " ", cLine )
         cConstant := Left( cLine, nPos - 1 )
         IF IsAlpha( cConstant ) .OR. Left( cConstant, 1 ) == "_"
            cValue    := AllTrim( SubStr( cLine, nPos + 1 ) )
            DO WHILE i < nLineCount .AND. Right( cValue, 1 ) == ";"
               i ++
               cLine := MemoLine( cFormTxt, 1200, i )
               AAdd( ::aLine, "" )
               cValue += ( CRLF + RTrim( cLine) )
            ENDDO
            IF Right( cValue, 3 ) == ";" + CRLF
               cValue := RTrim( Left( cValue, Len( cValue ) - 3 ) )
            ELSEIF Right( cValue, 1 ) == ";"
               cValue := RTrim( Left( cValue, Len( cValue ) - 1 ) )
            ENDIF
            IF lNoForm
               IF Empty( cValue )
                  MsgStop( i18n( "A malformed directive will be ignored. See line " ) + LTrim( Str( j ) ) + ".", "OOHG IDE+" )
               ELSEIF Upper( cValue ) == "NIL"
                  MsgStop( i18n( "An invalid directive will be ignored. See line " ) + LTrim( Str( j ) ) + ".", "OOHG IDE+" )
               ELSE
                  AAdd( ::aFDefines, { cConstant, cValue } )
               ENDIF
            ELSE
               MsgStop( i18n( "A directive will be ignored because it's not defined before DEFINE WINDOW. See line " ) + LTrim( Str( j ) ) + ".", "OOHG IDE+" )
            ENDIF
         ELSE
            MsgStop( i18n( "An invalid directive will be ignored. See line " ) + LTrim( Str( j ) ) + ".", "OOHG IDE+" )
         ENDIF

      ELSEIF At( "#UNDEF ", cLine ) == 1
         cLine := LTrim( SubStr( ::aLine[i], 9 ) )
         ::aLine[i] := ""
         j := i
         nPos := At( " ", cLine )
         cConstant := Left( cLine, nPos - 1 )
         IF IsAlpha( cConstant ) .OR. Left( cConstant, 1 ) == "_"
            cValue    := AllTrim( SubStr( cLine, nPos + 1 ) )
            DO WHILE i < nLineCount .AND. Right( cValue, 1 ) == ";"
               i ++
               cLine := MemoLine( cFormTxt, 1200, i )
               AAdd( ::aLine, "" )
               cValue += ( CRLF + RTrim( cLine) )
            ENDDO
            IF Right( cValue, 3 ) == ";" + CRLF
               cValue := RTrim( Left( cValue, Len( cValue ) - 3 ) )
            ELSEIF Right( cValue, 1 ) == ";"
               cValue := RTrim( Left( cValue, Len( cValue ) - 1 ) )
            ENDIF
            IF lIgnoreRest
               IF Empty( cValue )
                  AAdd( ::aFUndefs, cConstant )
               ELSE
                  MsgStop( i18n( "A malformed directive will be ignored. See line " ) + LTrim( Str( j ) ) + ".", "OOHG IDE+" )
               ENDIF
            ELSE
               MsgStop( i18n( "A directive will be ignored because it's not defined after END WINDOW. See line " ) + LTrim( Str( j ) ) + ".", "OOHG IDE+" )
            ENDIF
         ELSE
            MsgStop( i18n( "An invalid directive will be ignored. See line " ) + LTrim( Str( j ) ) + ".", "OOHG IDE+" )
         ENDIF

      ELSEIF lIgnoreRest
         /* Ignore controls but continue processing #undefs */

      ELSEIF ! Empty( cSkip )
         IF At( "END " + cSkip + " ", cLine ) == 1
            /* Stop skipping */
            cSkip := ""
         ENDIF

      ELSEIF At( "END WINDOW ", cLine ) == 1
         /* Stop processing controls */
         lIgnoreRest := .T.

      ELSEIF Left( cLine, 13 ) == "*****TEMPLATE"
         /*
            These lines store the last values used in the design form.
            They are used to initialize the form at load time when the
            specified values are not directly usable (variables, fields
            expressions, functions or undefined constants). See pForm()

            *****TEMPLATE ;
            *****   ROW nRow ;
            *****   COL nCol ;
            *****   TITLE cTitle ;
            *****   FONT cFont ;
            *****   SIZE nSize ;
            *****   FONTCOLOR uColor ;
            *****   BACKCOLOR uColor ;
            *****   WIDTH nWidth ;
            *****   HEIGHT nHeight ;
            *****   VIRTUAL WIDTH nVirtualW ;
            *****   VIRTUAL HEIGHT nVirtualH ;
            *****   MAXWIDTH nMaxW ;
            *****   MAXHEIGHT nMaxH ;
            *****   MINWIDTH nMinW ;
            *****   MINHEIGHT nMinH ;
         */
         /* Store starting line */
         ::cFSpeed := i

      ELSEIF At( "DEFINE WINDOW ", cLine ) == 1
         /* Form, after WINDOW should come TEMPLATE, but everything is accepted and ignored */
         cName := "TEMPLATE"
         cType := "FORM"
         IF AScan( ::aControlW, "template" ) > 0
            MsgStop( i18n( "The FMG file contains more than one DEFINE WINDOW (extra ones will be ignored)." ), "OOHG IDE+" )
            /* Add "empty" control to properly set ::aNumber */
            cName := ""
         ENDIF
         lNoForm := .F.
         /* Initialize control's arrays */
         ::IniArray( cName, cType )
         /* Store starting line */
         ::aSpeed[::nControlW] := i
         /* Store ending line of *****@ ... DEFINE TEMPLATE block */
         ::cFNumber := i - 1

      ELSEIF ( At( "@ ", cLine ) == 1 .OR. At( "*****@ ", cLine ) == 1 ) .AND. At( ",", cLine ) > 0
         /* Control */
         cName := ::ReadCtrlName( i )
         cType := ::ReadCtrlType( i )
         IF lNoForm
            MsgStop( i18n( "Control defined before DEFINE WINDOW will be ignored: " + DQM( cName ) + "." ), "OOHG IDE+" )
            cName := ""
         ELSEIF ! Empty( cName ) .and. AScan( ::aControlW, Lower( cName ) ) > 0
            MsgStop( i18n( "Control with duplicated name will be ignored: " + DQM( cName ) + "." ), "OOHG IDE+" )
            cName := ""
         ELSEIF AScan( ::ControlType, cType ) == 0
            MsgStop( i18n( "Control with unsupported type will be ignored:" + DQM( cName ) + ", " + cType + "." ), "OOHG IDE+" )
            cName := ""
         ENDIF
         ::IniArray( cName, cType )
         ::aSpeed[::nControlW] := i
         IF At( "*****@ ", cLine ) == 1 .AND. At( " TAB ", cLine ) # 0
            AAdd( ::aTabs, {Lower( cName ), i, NIL} )
         ENDIF

      ELSEIF At( "DEFINE CONTEXT MENU CONTROL ", cLine ) == 1 .OR. At( "DEFINE CONTEXTMENU CONTROL ", cLine ) == 1 .OR. At( "DEFINE DROPDOWN MENU BUTTON ", cLine ) == 1
         // TODO: Ignore it, direct support is missing, see ::TMyMenuEditor():CreateMenuFromFile( Self, 2 )
         cSkip := "MENU"

      ELSEIF At( "DEFINE CONTEXT MENU ", cLine ) == 1 .OR. At( "DEFINE CONTEXTMENU ", cLine ) == 1 .OR. At( "DEFINE MENU DYNAMIC ", cLine ) == 1
         // TODO: Ignore it, direct support is missing, see ::TMyMenuEditor():CreateMenuFromFile( Self, 2 )/
         cSkip := "MENU"

      ELSEIF At( "DEFINE MAIN MENU ", cLine ) == 1 .OR. At( "DEFINE MAINMENU ", cLine ) == 1
         // TODO: Ignore it, direct support is missing, see ::TMyMenuEditor():CreateMenuFromFile( Self, 1 )
         cSkip := "MENU"

      ELSEIF At( "DEFINE NOTIFY MENU ", cLine ) == 1 .OR. At( "DEFINE NOTIFYMENU ", cLine ) == 1
         // TODO: Ignore it, direct support is missing, see ::TMyMenuEditor():CreateMenuFromFile( Self, 3 )
         cSkip := "MENU"

      ELSEIF At( "DEFINE MENU POPUP ", cLine ) == 1 .OR. At( "DEFINE POPUP ", cLine ) == 1 .OR. At( "POPUP ", cLine ) == 1
         // TODO: Ignore it, direct support is missing, see ::TMyMenuEditor():CreateMenuFromFile( Self, n )
         cSkip := "POPUP"

      ELSEIF At( "DEFINE PAGE ", cLine ) == 1
         /* Ignore it, it's processed by ::AddCtrlToTabPage */
         /* Do not skip, page's controls must be processed */

      ELSEIF At( "DEFINE TAB PAGE ", cLine ) == 1
         ::aLine[i] := " DEFINE PAGE " + SubStr( ::aLine[i], 18 )

      ELSEIF At( "PAGE ", cLine ) == 1
         ::aLine[i] := " DEFINE PAGE " + SubStr( ::aLine[i], 7 )

      ELSEIF At( "DEFINE NODE ", cLine ) == 1
         // TODO: Ignore it, support is missing, do like TIMER
         cSkip := "NODE"

      ELSEIF At( "DEFINE SPLITBOX ", cLine ) == 1
         // TODO: Ignore it, support is missing */
         cSkip := "SPLITBOX"

      ELSEIF At( "DEFINE HOTKEY ", cLine ) == 1
         // TODO: Ignore it, support is missing, do like TIMER
         /* Do not skip, it has no END */

      ELSEIF At( "DEFINE INTERNAL ", cLine ) == 1
         // TODO: Ignore it, support is missing, it uses AT
         cSkip := "INTERNAL"

      ELSEIF At( "DEFINE TOOLBAR ", cLine ) == 1
         cName := ::ReadCtrlName( i )
         cType := "TOOLBAR"
         IF lNoForm
            MsgStop( i18n( "Control defined before DEFINE WINDOW will be ignored: " + DQM( cName ) + "." ), "OOHG IDE+" )
            cName := ""
         ELSEIF ! Empty( cName ) .and. AScan( ::aControlW, Lower( cName ) ) > 0
            MsgStop( i18n( "Control with duplicated name will be ignored: " + DQM( cName ) + "." ), "OOHG IDE+" )
            cName := ""
         ENDIF
         ::IniArray( cName, cType )
         ::aSpeed[::nControlW] := i

      ELSEIF At( "BUTTON ", cLine ) == 1
         ::aLine[i] := " DEFINE TBBUTTON " + SubStr( ::aLine[i], 9 )
         cName := ::ReadCtrlName( i )
         cType := "TBBUTTON"
         IF lNoForm
            MsgStop( i18n( "Control defined before DEFINE WINDOW will be ignored: " + DQM( cName ) + "." ), "OOHG IDE+" )
            cName := ""
         ELSEIF ! Empty( cName ) .and. AScan( ::aControlW, Lower( cName ) ) > 0
            MsgStop( i18n( "Control with duplicated name will be ignored: " + DQM( cName ) + "." ), "OOHG IDE+" )
            cName := ""
         ENDIF
         ::IniArray( cName, cType )
         ::aSpeed[::nControlW] := i

      ELSEIF At( "DEFINE STATUSBAR ", cLine ) == 1
         /* Ignore content, it's processed by ::LoadControls */
         cName := ;
         cType := ;
         cSkip := "STATUSBAR"
         IF lNoForm
            MsgStop( i18n( "Control defined before DEFINE WINDOW will be ignored: STATUSBAR." ), "OOHG IDE+" )
            cName := ""
         ELSEIF AScan( ::aControlW, Lower( cName ) ) > 0
            MsgStop( i18n( "Control with duplicated name will be ignored: STATUSBAR." ), "OOHG IDE+" )
            cName := ""
         ENDIF
         ::IniArray( cName, cType )
         ::aSpeed[::nControlW] := i

      ELSEIF At( "DEFINE TAB ", cLine ) == 1
         IF i <= 1
            lAdd := .T.
         ELSEIF At( " *****@ ", ::aLine[i - 1] ) == 1 .AND. At( " TAB ", ::aLine[i - 1] ) # 0
            cName := ::ReadCtrlName( i - 1 )
            lAdd  := ( Lower( cName ) != ATail( ::aControlW ) )
         ELSE
            lAdd := .T.
         ENDIF
         /* If it's not already defined */
         IF lAdd
            cName := ::ReadCtrlName( i )
            cType := "TAB"
            IF lNoForm
               MsgStop( i18n( "Control defined before DEFINE WINDOW will be ignored: " + DQM( cName ) + "." ), "OOHG IDE+" )
               cName := ""
            ELSEIF ! Empty( cName ) .and. AScan( ::aControlW, Lower( cName ) ) > 0
               MsgStop( i18n( "Control with duplicated name will be ignored: " + DQM( cName ) + "." ), "OOHG IDE+" )
               cName := ""
            ENDIF
            ::IniArray( cName, cType )
            ::aSpeed[::nControlW] := i
            AAdd( ::aTabs, {Lower( cName ), i, NIL} )
         ENDIF

      ELSEIF At( "END TAB ", Upper( cLine ) ) == 1
         FOR j := Len( ::aTabs ) TO 1 STEP -1
            IF ::aTabs[j, 3] == NIL
               ::aTabs[j, 3] := i
               EXIT
            ENDIF
         NEXT j
         IF j < 1
            MsgStop( i18n( "Form has an END TAB without matching DEFINE TAB." ), "OOHG IDE+" )
         ENDIF

      ELSEIF At( "DEFINE TIMER ", cLine ) == 1
         /*
            Check for these lines:
            i-3   *****@ 217, 270 TIMER timer_1 ;
            i-2   *****   ROW 217 ;
            i-1   *****   COL 270
            or for this line:
            i-1   *****@ 217, 270 TIMER timer_1 ;
         */
         lAdd := .T.
         IF i - 3 > 0
            IF At( " *****@ ", ::aLine[i - 3] ) == 1 .AND. At( " TIMER ", ::aLine[i - 3] ) # 0
               cName := ::ReadCtrlName( i - 3 )
               lAdd  := ( Lower( cName ) != ATail( ::aControlW ) )
            ENDIF
         ENDIF
         IF lAdd .AND. ( i - 1 > 0 )
            IF At( " *****@ ", ::aLine[i - 1] ) == 1 .AND. At( " TIMER ", ::aLine[i - 1] ) # 0
               cName := ::ReadCtrlName( i - 1 )
               lAdd  := ( Lower( cName ) != ATail( ::aControlW ) )
            ENDIF
         ENDIF
         IF lAdd
            cName := ::ReadCtrlName( i )
            cType := "TIMER"
            IF lNoForm
               MsgStop( i18n( "Control defined before DEFINE WINDOW will be ignored: " + DQM( cName ) + "." ), "OOHG IDE+" )
               cName := ""
            ELSEIF ! Empty( cName ) .and. AScan( ::aControlW, Lower( cName ) ) > 0
               MsgStop( i18n( "Control with duplicated name will be ignored: " + DQM( cName ) + "." ), "OOHG IDE+" )
               cName := ""
            ENDIF
            ::IniArray( cName, cType )
            ::aSpeed[::nControlW] := i
         ENDIF

      ELSEIF At( "DEFINE TREE ", cLine ) == 1
         IF i <= 1
            lAdd := .T.
         ELSEIF At( " *****@ ", ::aLine[i - 1] ) == 1 .AND. At( " TREE ", ::aLine[i - 1] ) # 0
            cName := ::ReadCtrlName( i - 1 )
            lAdd  := ( Lower( cName ) != ATail( ::aControlW ) )
         ELSE
            lAdd := .T.
         ENDIF
         IF lAdd
            cName := ::ReadCtrlName( i )
            cType := "TREE"
            IF lNoForm
               MsgStop( i18n( "Control defined before DEFINE WINDOW will be ignored: " + DQM( cName ) + "." ), "OOHG IDE+" )
               cName := ""
            ELSEIF ! Empty( cName ) .and. AScan( ::aControlW, Lower( cName ) ) > 0
               MsgStop( i18n( "Control with duplicated name will be ignored: " + DQM( cName ) + "." ), "OOHG IDE+" )
               cName := ""
            ENDIF
            ::IniArray( cName, cType )
            ::aSpeed[::nControlW] := i
         ENDIF

      ELSEIF At( "DEFINE ", cLine ) == 1
         /* Control */
         cName := ::ReadCtrlName( i )
         cType := ::ReadCtrlType( i )
         /* Process if it's a supported type of control */
         IF AScan( ::ControlType, cType ) == 0
            MsgStop( i18n( "Control with unsupported type will be ignored:" + DQM( cName ) + ", " + cType + "." ), "OOHG IDE+" )
            cName := ""
         ELSEIF lNoForm
               MsgStop( i18n( "Control defined before DEFINE WINDOW will be ignored: " + DQM( cName ) + "." ), "OOHG IDE+" )
            cName := ""
         ELSEIF ! Empty( cName ) .and. AScan( ::aControlW, Lower( cName ) ) > 0
            MsgStop( i18n( "Control with duplicated name will be ignored: " + DQM( cName ) + "." ), "OOHG IDE+" )
            cName := ""
         ELSEIF AScan( ::ControlType, cType ) == 0
            MsgStop( i18n( "Control with unsupported type will be ignored:" + DQM( cName ) + ", " + cType + "." ), "OOHG IDE+" )
            cName := ""
         ENDIF
         ::IniArray( cName, cType )
         ::aSpeed[::nControlW] := i

      ELSEIF At( "ON KEY ", cLine ) == 1
         cLine := LTrim( SubStr( ::aLine[i], 9 ) )
         ::aLine[i] := ""
         j := i
         IF ( nPos := At( " ", cLine ) ) > 0
            cName := Left( cLine, nPos - 1 )
            cLine := LTrim( SubStr( cLine, nPos ) )
            IF At( "ACTION ", cLine ) == 1
               cAction := AllTrim( SubStr( cLine, 8 ) )
               IF StrToStr( cName ) == cName .OR. "{" $ cName .OR. "}" $ cName
                  /* The content of cName can't be convert to a string because it contains chars ", ' and [ or
                     it contains chars { or }. Use a #define to circumvent this problem. */
                  MsgStop( i18n( "Malformed ON KEY will be ignored. See line " ) + LTrim( Str( j ) ) + ".", "OOHG IDE+" )
               ELSEIF StrToStr( cAction ) == cAction .OR. "{" $ cAction .OR. "}" $ cAction
                  /* The content of cName can't be convert to a string because it contains chars ", ' and [ or
                     it contains chars { or }. Use a #define to circumvent this problem. */
                  MsgStop( i18n( "Malformed ON KEY will be ignored. See line " ) + LTrim( Str( j ) ) + ".", "OOHG IDE+" )
               ELSE
                  AAdd( aKeys, StrToStr( cName ) )
                  AAdd( aActions, StrToStr( cAction ) )
               ENDIF
            ELSE
               MsgStop( i18n( "Malformed ON KEY will be ignored. See line " ) + LTrim( Str( j ) ) + ".", "OOHG IDE+" )
            ENDIF
         ELSE
            MsgStop( i18n( "Malformed ON KEY will be ignored. See line " ) + LTrim( Str( j ) ) + ".", "OOHG IDE+" )
         ENDIF

      ENDIF
   NEXT i

   /* ON KEY */
   ::cFOnKeyKeys := "{"
   ::cFOnKeyActions := "{"
   IF Len( aKeys ) > 0
      ::cFOnKeyKeys += aKeys[1]
      ::cFOnKeyActions += aActions[1]
      FOR i := 2 TO Len(  aKeys )
         ::cFOnKeyKeys += "," + aKeys[i]
         ::cFOnKeyActions += "," + aActions[i]
      NEXT i
   ENDIF
   ::cFOnKeyKeys += "}"
   ::cFOnKeyActions += "}"

   /* Store ending line for speed access */
   FOR i := 1 TO ( ::nControlW - 1 )
      ::aNumber[i] := ::aSpeed[i + 1] - 1
   NEXT i
   ::aNumber[::nControlW] := nLineCount

   /* Check if each DEFINE TAB has a matching END TAB */
   FOR j := 1 TO Len( ::aTabs )
      IF ::aTabs[j, 3] == NIL
         IF j < Len( ::aTabs )
            ::aTabs[j, 3] := ::aTabs[j + 1, 2]
         ELSE
            ::aTabs[j, 3] := nLineCount
         ENDIF
         MsgStop( i18n( "Form has a DEFINE TAB without matching END TAB." ), "OOHG IDE+" )
      ENDIF
   NEXT j

   /* Delete "empty" controls */
   FOR i := ::nControlW TO 1 STEP -1
      IF Empty( ::aControlW[i] )
         ::DelArray( i )
      ELSEIF ::aControlW[i] == "statusbar"
         ::cSSpeed := ::aSpeed[i]
         ::cSNumber := ::aNumber[i]
         ::DelArray( i )
      ENDIF
   NEXT i

   /* Ensure that DEFINE WINDOW TEMPLATE is the first control */
   i := 1
   DO WHILE i <= ::nControlW
      IF ::aControlW[i] == "template" .AND. ::aCtrlType[i] == "FORM"
         EXIT
      ENDIF
      ::DelArray( i )
   ENDDO
   IF ::nControlW == 0
      MsgStop( i18n( "The FMG file contains no controls." ), "OOHG IDE+" )
      ::IniArray( "TEMPLATE", "FORM" )
   ELSEIF i > 1
      MsgStop( i18n( "DEFINE WINDOW TEMPLATE is not the first control. Please report this error to OOHG developers." ), "OOHG IDE+" )
   ENDIF

   /* Create canvas */
   cName := _OOHG_GetNullName( "0" )

   DEFINE WINDOW ( cName ) OBJ ::oDesignForm ;
      ICON "IDE_VD" ;
      CHILD ;
      NOSHOW ;
      ON MOUSECLICK ::AddControl( .F. ) ;
      ON DBLCLICK ::PropertiesClick() ;
      ON MOUSEDRAG ::MouseMoveSize() ;
      ON GOTFOCUS ::DrawPoints() ;
      ON RESTORE ::DrawPoints() ;
      ON HSCROLLBOX ( EraseWindow( ::oDesignForm:Name ), ::DrawPoints() ) ;
      ON VSCROLLBOX ( EraseWindow( ::oDesignForm:Name ), ::DrawPoints() ) ;
      NOMAXIMIZE ;
      NOMINIMIZE ;
      ON INIT { || ::RefreshControlInspector(), ;
                   iif( ::oCtrlList:ItemCount > 0, ::oCtrlList:Value := { 1 }, NIL ), ;
                   ::oDesignForm:SetFocus(), ;
                   BringWindowToTop( ::oDesignForm:hWnd ), ;
                   ::oDesignForm:OnMouseMove := { || ::MouseTrack() } }

      DEFINE CONTEXT MENU OBJ ::oDesignFormMenu
         ITEM i18n( "Properties" )             ACTION ::PropertiesClick()
         ITEM i18n( "Events" )                 ACTION ::EventsClick()
         ITEM i18n( "Font/Colors" )            ACTION ::CtrlFontColors()
         ITEM i18n( "Manual Move/Size" )       ACTION ::ManualMoveSize( 1 )
         ITEM i18n( "Interactive Move" )       ACTION ::MoveControl()
         ITEM i18n( "Keyboard Move/Size" )     ACTION ::KeyboardMoveSize()
         ITEM i18n( "Interactive Size" )       ACTION ::SizeControl()
         SEPARATOR
         ITEM i18n( "Global Row Align" )       ACTION ::ValGlobalPos( "ROW" )
         ITEM i18n( "Global Col Align" )       ACTION ::ValGlobalPos( "COL" )
         ITEM i18n( "Global Width Change" )    ACTION ::ValGlobalPos( "WID" )
         ITEM i18n( "Global Height Change" )   ACTION ::ValGlobalPos( "HEI" )
         ITEM i18n( "Global Vert Gap Change" ) ACTION ::GlobalVertGapChg()
         ITEM i18n( "Global Hor/Ver Shift" )   ACTION ::ValGlobalPos( "SHI" )
         SEPARATOR
         ITEM i18n( "Copy" )                   ACTION ::CopyControl()
         ITEM i18n( "Delete" )                 ACTION iif( ::ConfirmDelete, ::DelFirstCtrl(), NIL )
         SEPARATOR
         ITEM i18n( "Print Brief" )            ACTION ::PrintBrief()
         SEPARATOR
         ITEM i18n( "Form's context menu" )    ACTION iif( HB_ISOBJECT( ::myCMCtrl ), ::myCMCtrl:Activate(), MsgInfo( i18n( "Context menu is not defined !!!" ), "OOHG IDE+" ) )
         ITEM i18n( "Form's notify menu" )     ACTION iif( HB_ISOBJECT( ::myNMCtrl ), ::myNMCtrl:Activate(), MsgInfo( i18n( "Notify menu is not defined !!!" ), "OOHG IDE+" ) )
         SEPARATOR
         ITEM i18n( "Restore Tools" )          ACTION ::RestoreForms()
      END MENU

      ON KEY ALT+D  ACTION ::Debug()
      ON KEY ALT+C  ACTION ::CopyControl()
      ON KEY DELETE ACTION iif( ::ConfirmDelete(), ::DelFirstCtrl(), NIL )
      ON KEY ESCAPE ACTION ::ControlClick( 1 )
      ON KEY F1     ACTION Help_F1( "FORMEDIT", ::myIde )
   END WINDOW

   ::LoadControls()

   ::oWaitMsg:Hide()
   CursorArrow()

   ::Form_Main:Show()
   ::oCtrlBox:Show()
   ::Form_List:Show()
   ::oDesignForm:Show()
   ::Form_List:Activate( .T. )
   ::oDesignForm:Activate( ! lWait )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
STATIC FUNCTION ClientAreaResize( oForm )

   WITH OBJECT oForm
      :SizePos( NIL, NIL, :Width + :nWidth - :ClientWidth, :Height + :nHeight - :ClientHeight )
   END WITH

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD New( lWait ) CLASS TFormEditor

   LOCAL cName

   ::oWaitMsg:label_1:Value := i18n( "Creating form ..." )
   ::oWaitMsg:Show()

   cName := _OOHG_GetNullName( "0" )

   DEFINE WINDOW ( cName ) OBJ ::oDesignForm ;
      AT ::myIde:aPositions[2, 1], ::myIde:aPositions[2, 2] + 120 ;
      WIDTH 700 ;
      HEIGHT 410 ;
      ICON "IDE_VD" ;
      CHILD ;
      NOSHOW ;
      ON MOUSECLICK ::AddControl( .F. ) ;
      ON DBLCLICK ::PropertiesClick() ;
      ON MOUSEDRAG ::MouseMoveSize() ;
      ON GOTFOCUS ::DrawPoints() ;
      ON RESTORE ::DrawPoints() ;
      ON HSCROLLBOX ( EraseWindow( ::oDesignForm:Name ), ::DrawPoints() ) ;
      ON VSCROLLBOX ( EraseWindow( ::oDesignForm:Name ), ::DrawPoints() ) ;
      FONT ::myIde:cFormDefFontName ;
      SIZE ::myIde:nFormDefFontSize ;
      FONTCOLOR ::myIde:StrToColor( ::myIde:cFormDefFontColor ) ;
      NOMAXIMIZE ;
      NOMINIMIZE ;
      ON INIT { || ::oDesignForm:OnMove := {|| ::FrmMoved() }, ;
                   ::oDesignForm:OnSize := {|| ::FrmSized() }, ;
                   ::oDesignForm:SetFocus(), ;
                   BringWindowToTop( ::oDesignForm:hWnd ), ;
                   ::oDesignForm:OnMouseMove := { || ::MouseTrack() } }

      DEFINE CONTEXT MENU OBJ ::oDesignFormMenu
         ITEM i18n( "Properties" )             ACTION ::PropertiesClick()
         ITEM i18n( "Events" )                 ACTION ::EventsClick()
         ITEM i18n( "Font/Colors" )            ACTION ::CtrlFontColors()
         ITEM i18n( "Manual Move/Size" )       ACTION ::ManualMoveSize( 1 )
         ITEM i18n( "Interactive Move" )       ACTION ::MoveControl()
         ITEM i18n( "Keyboard Move/Size" )     ACTION ::KeyboardMoveSize()
         ITEM i18n( "Interactive Size" )       ACTION ::SizeControl()
         SEPARATOR
         ITEM i18n( "Global Row Align" )       ACTION ::ValGlobalPos( "ROW" )
         ITEM i18n( "Global Col Align" )       ACTION ::ValGlobalPos( "COL" )
         ITEM i18n( "Global Width Change" )    ACTION ::ValGlobalPos( "WID" )
         ITEM i18n( "Global Height Change" )   ACTION ::ValGlobalPos( "HEI" )
         ITEM i18n( "Global Vert Gap Change" ) ACTION ::GlobalVertGapChg()
         ITEM i18n( "Global Hor/Ver Shift" )   ACTION ::ValGlobalPos( "SHI" )
         SEPARATOR
         ITEM i18n( "Copy" )                   ACTION ::CopyControl()
         ITEM i18n( "Delete" )                 ACTION iif( ::ConfirmDelete(), ::DelFirstCtrl(), NIL )
         SEPARATOR
         ITEM i18n( "Print Brief" )            ACTION ::PrintBrief()
         SEPARATOR
         ITEM i18n( "Form's context menu" )    ACTION iif( HB_ISOBJECT( ::myCMCtrl ), ::myCMCtrl:Activate(), MsgInfo( i18n( "Context menu is not defined !!!" ), "OOHG IDE+" ) )
         ITEM i18n( "Form's notify menu" )     ACTION iif( HB_ISOBJECT( ::myNMCtrl ), ::myNMCtrl:Activate(), MsgInfo( i18n( "Notify menu is not defined !!!" ), "OOHG IDE+" ) )
         SEPARATOR
         ITEM i18n( "Restore Tools" )          ACTION ::RestoreForms()
      END MENU

      ON KEY ALT+C  ACTION ::CopyControl()
      ON KEY DELETE ACTION iif( ::ConfirmDelete(), ::DelFirstCtrl(), NIL )
      ON KEY F1     ACTION Help_F1( "FORMEDIT", ::myIde )
      ON KEY ALT+D  ACTION ::Debug()
   END WINDOW

   DEFINE WINDOW 0 OBJ ::Form_List ;
      AT ::myIde:aPositions[3, 1], ::myIde:aPositions[3, 2] ;
      WIDTH 370 ;
      HEIGHT 490 ;
      CLIENTAREA ;
      TITLE i18n( "Control Inspector" ) ;
      CHILD ;
      NOSHOW ;
      NOMAXIMIZE ;
      NOMINIMIZE ;
      NOSYSMENU ;
      BACKCOLOR ::myIde:aSystemColor ;
      ON INIT ( SetHeightForWholeRows( ::oCtrlList, 400 ), ::lIsFormModified := .T. ) ;
      ON SIZE ::AdjustInspectorCntrls()

      @ 10, 10 GRID 0 OBJ ::oCtrlList ;
         WIDTH 350 ;
         HEIGHT 400 ;
         HEADERS { i18n( "Name" ), i18n( "Row" ), i18n( "Col" ), i18n( "Width" ), i18n( "Height" ), i18n( "int-name" ), i18n( "Type" ) } ;
         WIDTHS { 80, 40, 40, 45, 50, 0, 70 } ;
         FONT "Arial" ;
         SIZE 10 ;
         INPLACE EDIT ;
         READONLY { .T., .F., .F., .F., .F., .T., .T. } ;
         JUSTIFY { GRID_JTFY_LEFT, GRID_JTFY_RIGHT, GRID_JTFY_RIGHT, GRID_JTFY_RIGHT, GRID_JTFY_RIGHT, GRID_JTFY_LEFT, GRID_JTFY_LEFT } ;
         ON HEADCLICK { {|| ::oCtrlList:SortColumn( 1, .F. ) }, {|| ::oCtrlList:SortColumn( 2, .F. ) }, {|| ::oCtrlList:SortColumn( 3, .F. ) }, {|| ::oCtrlList:SortColumn( 4, .F. ) }, {|| ::oCtrlList:SortColumn( 5, .F. ) }, NIL, {|| ::oCtrlList:SortColumn( 7, .F. ) } } ;
         FULLMOVE ;
         MULTISELECT ;
         DELETE ;
         DELETEWHEN {|| ::ConfirmDelete() } ;
         ON DELETE {|aParams| ::DeleteControls( aParams[1] ) } ;
         NODELETEMSG ;
         ON EDITCELL ::ValCellPos() ;
         ON CHANGE ::OutlineControls() ;
         ON GOTFOCUS ::oCtrlList:lDeleteAll := ::myIde:lMultiDelete
      ::oCtrlList:ColumnHide( 6 )

      DEFINE CONTEXT MENU CONTROL ( ::oCtrlList:Name ) OF ( ::Form_List:Name )
         ITEM i18n( "Properties" )             ACTION { |aParams| ::EditProperties( aParams ) }
         ITEM i18n( "Events" )                 ACTION ::EventsClick()
         ITEM i18n( "Font/Colors" )            ACTION ::CtrlFontColors()
         ITEM i18n( "Manual Move/Size" )       ACTION ::ManualMoveSize( 1 )
         ITEM i18n( "Interactive Move" )       ACTION ::MoveControl()
         ITEM i18n( "Keyboard Move/Size" )     ACTION ::KeyboardMoveSize()
         ITEM i18n( "Interactive Size" )       ACTION ::SizeControl()
         SEPARATOR
         ITEM i18n( "Global Row Align" )       ACTION ::ValGlobalPos( "ROW" )
         ITEM i18n( "Global Col Align" )       ACTION ::ValGlobalPos( "COL" )
         ITEM i18n( "Global Width Change" )    ACTION ::ValGlobalPos( "WID" )
         ITEM i18n( "Global Height Change" )   ACTION ::ValGlobalPos( "HEI" )
         ITEM i18n( "Global Vert Gap Change" ) ACTION ::GlobalVertGapChg()
         ITEM i18n( "Global Hor/Ver Shift" )   ACTION ::ValGlobalPos( "SHI" )
         SEPARATOR
         ITEM i18n( "Copy" )                   ACTION ::CopyControl()
         ITEM i18n( "Delete" )                 ACTION iif( ::ConfirmDelete(), ::DelFirstCtrl(), NIL )
         SEPARATOR
         ITEM i18n( "Print Brief" )            ACTION ::PrintBrief()
         SEPARATOR
         ITEM i18n( "Form's context menu" )    ACTION iif( HB_ISOBJECT( ::myCMCtrl ), ::myCMCtrl:Activate(), MsgInfo( i18n( "Context menu is not defined !!!" ), "OOHG IDE+" ) )
         ITEM i18n( "Form's notify menu" )     ACTION iif( HB_ISOBJECT( ::myNMCtrl ), ::myNMCtrl:Activate(), MsgInfo( i18n( "Notify menu is not defined !!!" ), "OOHG IDE+" ) )
      END MENU

      @ 420, 10 LABEL lop1 VALUE i18n( "Double click or Enter to modify the position or size of a control." ) FONT "Calibri" SIZE 9 AUTOSIZE HEIGHT 15
      @ 435, 10 LABEL lop2 VALUE i18n( "Right click to access properties or events, or to do global" )        FONT "Calibri" SIZE 9 AUTOSIZE HEIGHT 15
      @ 450, 10 LABEL lop3 VALUE i18n( "align/resize of selected controls (use Ctrl+Click to select)." )      FONT "Calibri" SIZE 9 AUTOSIZE HEIGHT 15
      @ 465, 10 LABEL lop4 VALUE i18n( "Click on the headers to change display order." )                      FONT "Calibri" SIZE 9 AUTOSIZE HEIGHT 15
   END WINDOW

   /* Add first element */
   ::IniArray( "TEMPLATE", "FORM" )

   ::oWaitMsg:Hide()
   CursorArrow()

   ::Form_Main:Show()
   ::oCtrlBox:Show()
   ::Form_List:Show()
   ::oDesignForm:Show()
   ::Form_List:Activate( .T. )
   ::oDesignForm:Activate( ! lWait )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD Exit() CLASS TFormEditor

   LOCAL aPositions[3]

   IF ::lIsFormModified .OR. ::myTbEditor:lChanged
      IF MsgYesNo( i18n( "Save changes?" ), "OOHG IDE+" )
         ::Save( .F. )
      ENDIF
   ENDIF
   ::myTbEditor:Release()
   ::oDesignForm:Release()
   IF ::Form_List:GetWindowState == FORM_NORMAL
      aPositions[3] := { Max( ::Form_List:Row, 0 ), Max( ::Form_List:Col, 0 ) }
   ELSE
      aPositions[3] := { 120, GetDeskTopRealWidth() - 380 }
   ENDIF
   ::Form_List:Release()
   IF ::oCtrlBox:GetWindowState == FORM_NORMAL
      aPositions[2] := { Max( ::oCtrlBox:Row, 0 ), Max( ::oCtrlBox:Col, 0 ) }
   ELSE
      aPositions[2] := { 120, 0 }
   ENDIF
   ::oCtrlBox:Release()
   IF ::Form_Main:GetWindowState == FORM_NORMAL
      aPositions[1] := { Max( ::Form_Main:Row, 0 ), Max( ::Form_Main:Col, 0 ) }
   ELSE
      aPositions[1] := { 0, 0 }
   ENDIF
   ::Form_Main:Release()
   ::myIde:EditorExit( aPositions, ::nEditorIndex )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD MinimizeForms() CLASS TFormEditor

   ::Form_Main:Minimize()
   ::oCtrlBox:Minimize()
   ::Form_List:Minimize()

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD RestoreForms() CLASS TFormEditor

   ::Form_Main:Restore()
   ::oCtrlBox:Restore()
   ::Form_List:Restore()

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD OrderControls() CLASS TFormEditor

   LOCAL cName

   cName := _OOHG_GetNullName( "0" )
   SET INTERACTIVECLOSE ON
   LOAD WINDOW orderf AS ( cName )
   ::FormCtrlOrder := GetFormObject( cName )
   ON KEY ESCAPE OF ( ::FormCtrlOrder:Name ) ACTION ::FormCtrlOrder:Release()
   CENTER WINDOW ( cName )
   ACTIVATE WINDOW ( cName )
   SET INTERACTIVECLOSE OFF
   ::DrawPoints()
   ::RefreshControlInspector()
   ::oDesignForm:SetFocus()

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD FillListOfGroups() CLASS TFormEditor

   LOCAL i

   ::FormCtrlOrder:List_Groups:DeleteAllItems()
   ::FormCtrlOrder:List_Groups:Additem( "Form " )
   FOR i := 2 TO ::nControlW
      IF ::aCtrlType[i] == "TAB"                                            // TODO: Add other containers
         ::FormCtrlOrder:List_Groups:AddItem( ::aControlW[i] )
      ENDIF
   NEXT i
   ::FormCtrlOrder:List_Groups:Value := 1
   ::FillListOfCtrls()

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD FillListOfCtrls() CLASS TFormEditor

   LOCAL cName, CurrentPage, j, aCaptions, i

   CursorWait()
   ::FormCtrlOrder:List_Ctrls:DeleteAllitems()
   IF ::FormCtrlOrder:List_Groups:Value == 1
      /* Form */
      FOR i := 2 TO ::nControlW
         IF Empty( ::aTabPage[i, 1] )
            IF ! ::aControlW[i] $ " statusbar mainmenu contextmenu notifymenu "
               IF ! ::FormCtrlOrder:CheckButton_Filter:Value .OR. ! ( " " + ::aCtrlType[i] + " " ) $ " LABEL FRAME TIMER IMAGE PICTURE ACTIVEX PROGRESSBAR PROGRESSMETER ANIMATEBOX ANIGIF "
                  ::FormCtrlOrder:List_Ctrls:AddItem( ::aName[i] )
               ENDIF
            ENDIF
         ENDIF
      NEXT i
      ::FormCtrlOrder:List_Ctrls:Value := 1
   ELSE
      /* Containers */
      cName := ::FormCtrlOrder:List_Groups:Item( ::FormCtrlOrder:List_Groups:Value )
      j := AScan( ::aControlW, Lower( cName ) )
      IF ::aCtrlType[j] == "TAB"                                                   // TODO: Add other containers
         CurrentPage := 1
         aCaptions := &( ::aCaption[j] )
         ::FormCtrlOrder:List_Ctrls:AddItem( "page " + aCaptions[CurrentPage] )
         FOR i := 2 TO ::nControlW
            IF ::aTabPage[i, 1] == cName
               DO WHILE ::aTabPage[i, 2] > CurrentPage
                 CurrentPage ++
                 ::FormCtrlOrder:List_Ctrls:AddItem( "page " + aCaptions[CurrentPage] )
               ENDDO
               IF ! ::FormCtrlOrder:CheckButton_Filter:Value .OR. ! ( " " + ::aCtrlType[i] + " " ) $ " LABEL FRAME TIMER IMAGE PICTURE ACTIVEX PROGRESSBAR PROGRESSMETER ANIMATEBOX ANIGIF "
                  ::FormCtrlOrder:List_Ctrls:AddItem( "    " + ::aName[i] )
               ENDIF
            ENDIF
         NEXT i
         DO WHILE CurrentPage < Len( aCaptions )
           CurrentPage ++
           ::FormCtrlOrder:List_Ctrls:AddItem( "page " + aCaptions[CurrentPage] )
         ENDDO
         FOR i := 2 TO ::FormCtrlOrder:List_Ctrls:ItemCount()
            IF Left( ::FormCtrlOrder:List_Ctrls:Item( i ), 4 ) # "page"
               EXIT
            ENDIF
         NEXT i
         IF i <= ::FormCtrlOrder:List_Ctrls:ItemCount()
            ::FormCtrlOrder:List_Ctrls:Value := i
         ELSE
            ::FormCtrlOrder:List_Ctrls:Value := 0
         ENDIF
      ENDIF
   ENDIF
   CursorArrow()

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD OrderUp() CLASS TFormEditor

   LOCAL t, iDown, iUp, cCtrl1, cCtrl2, iPos1, iPos2, oTab, oCtrl

   iDown := ::FormCtrlOrder:List_Ctrls:Value
   IF iDown <= 1 .OR. Left( ::FormCtrlOrder:List_Ctrls:Item( iDown ), 4 ) == "page"
      RETURN NIL
   ENDIF
   iUp:= iDown - 1
   IF iUp == 1 .AND. Left( ::FormCtrlOrder:List_Ctrls:Item( iUp ), 4 ) == "page"
      RETURN NIL
   ENDIF
   CursorWait()
   cCtrl1 := AllTrim( ::FormCtrlOrder:List_Ctrls:Item( iDown ) )
   iPos1  := AScan( ::aName, cCtrl1 )
   IF Left( ::FormCtrlOrder:List_Ctrls:Item( iUp ), 4 ) == "page"
      oTab := ::oDesignForm:&( ::aTabPage[iPos1, 1] )
      oCtrl := ::oDesignForm:&( ::aControlW[iPos1] )
      oTab:DeleteControl( oCtrl )
      ::aTabPage[iPos1, 2] --
      oTab:AddControl( oCtrl, ::aTabPage[iPos1, 2], oCtrl:Row, oCtrl:Col )
      oTab:Visible := .F.
      oTab:Visible := .T.
   ELSE
      cCtrl2 := AllTrim( ::FormCtrlOrder:List_Ctrls:Item( iUp ) )
      iPos2  := AScan( ::aName, cCtrl2 )
      ::SwapArray( iPos1, iPos2 )
   ENDIF
   t := ::FormCtrlOrder:List_Ctrls:Item( iDown )
   ::FormCtrlOrder:List_Ctrls:Item( iDown, ::FormCtrlOrder:List_Ctrls:Item( iUp ) )
   ::FormCtrlOrder:List_Ctrls:Item( iUp, t )
   ::FormCtrlOrder:List_Ctrls:Value := iUp
   ::lIsFormModified := .T.
   CursorArrow()

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD OrderDown() CLASS TFormEditor

   LOCAL t, iDown, iUp, cCtrl1, cCtrl2, iPos1, iPos2, oTab, oCtrl

   iUp := ::FormCtrlOrder:List_Ctrls:Value
   IF iUp < 1 .OR. iUp >= ::FormCtrlOrder:List_Ctrls:ItemCount() .OR. Left( ::FormCtrlOrder:List_Ctrls:Item( iUp ), 4) == "page"
      RETURN NIL
   ENDIF
   CursorWait()
   cCtrl1 := AllTrim( ::FormCtrlOrder:List_Ctrls:Item( iUp ) )
   iPos1  := AScan( ::aName, cCtrl1 )
   iDown := iUp + 1
   IF Left( ::FormCtrlOrder:List_Ctrls:Item( iDown ), 4 ) == "page"
      oTab := ::oDesignForm:&( ::aTabPage[iPos1, 1] )
      oCtrl := ::oDesignForm:&( ::aControlW[iPos1] )
      oTab:DeleteControl( oCtrl )
      ::aTabPage[iPos1, 2] ++
      oTab:AddControl( oCtrl, ::aTabPage[iPos1, 2], oCtrl:Row, oCtrl:Col )
      oTab:Visible := .F.
      oTab:Visible := .T.
   ELSE
      cCtrl2 := AllTrim( ::FormCtrlOrder:List_Ctrls:Item( iDown ) )
      iPos2  := AScan( ::aName, cCtrl2 )
      ::SwapArray( iPos1, iPos2 )
   ENDIF
   t := ::FormCtrlOrder:List_Ctrls:Item( iUp )
   ::FormCtrlOrder:List_Ctrls:Item( iUp, ::FormCtrlOrder:List_Ctrls:Item( iDown ) )
   ::FormCtrlOrder:List_Ctrls:Item( iDown, t )
   ::FormCtrlOrder:List_Ctrls:Value := iDown
   ::lIsFormModified := .T.
   CursorArrow()

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD SwapArray( x1, x2 ) CLASS TFormEditor

   LOCAL i, cDataName, uValue

   FOR i := 1 to Len( ::aDatas )
      cDataName := ::aDatas[i, 1]
      uValue := Self:&( cDataName )[x1]
      Self:&( "_" + cDataName )[x1] := Self:&( cDataName )[x2]
      Self:&( "_" + cDataName )[x2] := uValue
   NEXT

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD FrmFontColors() CLASS TFormEditor

   LOCAL cName, si := 0, FormFontColor

   cName := _OOHG_GetNullName( "0" )
   SET INTERACTIVECLOSE ON
   LOAD WINDOW fontclrs AS ( cName )
   FormFontColor := GetFormObject( cName )
   FormFontColor:lbl_Object:Value := DQM( ::cFName + ".fmg" ) + i18n( " - Colors of Form" )
   ACTIVATE WINDOW ( cName )
   SET INTERACTIVECLOSE OFF
   ::oDesignForm:SetFocus()

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD CtrlFontColors() CLASS TFormEditor

   LOCAL ia, si, cName, FormFontColor

   ia := ::FirstCtrl()
   IF ia > 0
      IF ::CtrlIsOfType( ia, " TIMER PLAYER ANIMATEBOX ACTIVEX SCROLLBAR " )
         RETURN NIL
      ENDIF

      si := AScan( ::aControlW, Lower( ::oDesignForm:aControls[ia]:Name ) )
      IF si > 0
         cName := _OOHG_GetNullName( "0" )
         SET INTERACTIVECLOSE ON
         LOAD WINDOW fontclrs AS ( cName )
         FormFontColor := GetFormObject( cName )
         FormFontColor:lbl_Object:Value := "Control: " + ::aName[si]
         /* Enable or disable controls according to object's type */
         IF ( " " + ::aCtrlType[si] + " " ) $ " PROGRESSBAR PROGRESSMETER "
            FormFontColor:StatusBar:Item( 1, "FontColor will be used in FORECOLOR clause." )
         ELSEIF ( " " + ::aCtrlType[si] + " " ) $ " IMAGE PICTURE PICCHECKBUTT PICBUTT SLIDER ANIGIF "
            FormFontColor:btn_FntType:Visible := .F.
            FormFontColor:btn_DefFntType:Visible := .F.
         ELSEIF ::aCtrlType[si] == "MONTHCALENDAR"
            FormFontColor:btn_TtlFntClr:Visible := .T.
            FormFontColor:btn_TtlBkClr:Visible  := .T.
            FormFontColor:btn_TrlFntClr:Visible := .T.
            FormFontColor:btn_BkGrnd:Visible    := .T.
         ELSEIF ( " " + ::aCtrlType[si] + " " ) $ " DATEPICKER TIMEPICKER "
            FormFontColor:btn_BkClr:Visible := .F.
            FormFontColor:btn_DefBkClr:Visible := .F.
         ENDIF
         ACTIVATE WINDOW ( cName )
         SET INTERACTIVECLOSE OFF
         ::oDesignForm:aControls[ia]:SetFocus()
      ENDIF
   ENDIF

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD SetFontColor( si ) CLASS TFormEditor

   LOCAL cCode, uFontColor, aColor, i

   IF si == 0
     uFontColor := ::oDesignForm:Fontcolor
   ELSE
     uFontColor := ::myIde:StrToColor( ::aFontColor[si] )           // TODO: Check, may be a variable or field
   ENDIF
   aColor := GetColor( uFontColor )
   IF aColor[1] == NIL .OR. aColor[2] == NIL .OR. aColor[3] == NIL
      RETURN NIL
   ENDIF
   cCode := ::myIde:ColorToStr( aColor )
   IF si == 0
      ::cFFontcolor := cCode
      ::oDesignForm:FontColor := aColor
      ::oDesignForm:Hide()
      FOR i := 2 to ::nControlW
         ::RecreateControl( ::oDesignForm:&( ::aControlW[i] ):Object(), i )
      NEXT i
      EraseWindow( ::oDesignForm:Name )
      ::oDesignForm:Show()
      ::oCtrlList:SetFocus()
      ::oCtrlList:Value := {}
   ELSE
      ::aFontColor[si] := cCode
      ::oDesignForm:&( ::aControlW[si] ):FontColor := aColor
   ENDIF
   ::lIsFormModified := .T.

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD SetFontType( si ) CLASS TFormEditor

   LOCAL aFont

   IF si == 0
      aFont := GetFont( ::oDesignForm:cFontName, ::oDesignForm:nFontSize, .F. , .F. , ::oDesignForm:FontColor, .F., .F., 0 )
      IF aFont[1] == "" .AND. aFont[2] == 0 .AND. ( ! aFont[3] ) .AND.  ( ! aFont[4] ) .AND. ;
         aFont[5, 1] == NIL .AND. aFont[5, 2] == NIL .AND.  aFont[5, 3] == NIL .AND. ;
         ( ! aFont[6] ) .AND. ( ! aFont[7] ) .AND. aFont[8] == 0
         RETURN NIL
      ENDIF
      IF ! Empty( aFont[1] )
         ::cFFontName := aFont[1]
         ::oDesignForm:cFontName := aFont[1]
      ENDIF
      IF aFont[2] > 0
         ::cFFontSize := LTrim( Str( aFont[2] ) )
         ::oDesignForm:nFontSize := aFont[2]
      ENDIF
      IF aFont[5, 1] <> NIL .AND. aFont[5, 2] <> NIL .AND. aFont[5, 3] <> NIL
         ::cFFontColor := ::myIde:ColorToStr( aFont[5] )
         ::oDesignForm:FontColor := aFont[5]
      ENDIF
   ELSEIF si == -1
      /* Statusbar colors */
      aFont := GetFont( ::cSFontName, ::nSFontSize, ::lSBold, ::lSItalic, { 0, 0, 0 }, ::lSUnderline, ::lSStrikeout, 0 )
      IF aFont[1] == "" .AND. aFont[2] == 0 .AND. ( ! aFont[3] ) .AND.  ( ! aFont[4] ) .AND. ;
         aFont[5, 1] == NIL .AND. aFont[5, 2] == NIL .AND.  aFont[5, 3] == NIL .AND. ;
         ( ! aFont[6] ) .AND. ( ! aFont[7] ) .AND. aFont[8] == 0
         RETURN NIL
      ENDIF
      IF ! Empty( aFont[1] )
         ::cSFontName := aFont[1]
         ::cSFontNameFrm := StrToStr( aFont[1] )
         ::oDesignForm:StatusBar:FontName := aFont[1]
      ENDIF
      IF aFont[2] > 0
         ::nSFontSize := aFont[2]
         ::cSFontSizeFrm := LTrim( Str( aFont[2] ) )
         ::oDesignForm:StatusBar:FontSize := aFont[2]
      ENDIF
      IF ::lSBold <> aFont[3]
         ::lSBold := aFont[3]
         ::oDesignForm:StatusBar:FontBold := aFont[3]
      ENDIF
      IF ::lSItalic <> aFont[4]
         ::lSItalic := aFont[4]
         ::oDesignForm:StatusBar:FontItalic := aFont[4]
      ENDIF
      // TODO: Statusbar color
      IF ::lSUnderline <> aFont[6]
         ::lSUnderline := aFont[6]
         ::oDesignForm:StatusBar:FontUnderline := aFont[6]
      ENDIF
      IF ::lSStrikeout <> aFont[7]
         ::lSStrikeout := aFont[7]
         ::oDesignForm:StatusBar:FontStrikeout := aFont[7]
      ENDIF
   ELSE
      aFont := GetFont( ::aFontName[si], ::aFontSize[si], ::aFontBold[si], ::aFontItalic[si], ::myIde:StrToColor( ::aFontColor[si] ), ::aFontUnderline[si], ::aFontStrikeout[si], 0 )
      IF aFont[1] == "" .AND. aFont[2] == 0 .AND. ( ! aFont[3] ) .AND.  ( ! aFont[4] ) .AND. ;
         aFont[5, 1] == NIL .AND. aFont[5, 2] == NIL .AND.  aFont[5, 3] == NIL .AND. ;
         ( ! aFont[6] ) .AND. ( ! aFont[7] ) .AND. aFont[8] == 0
         RETURN NIL
      ENDIF
      IF ! Empty( aFont[1] )
         ::aFontName[si] := aFont[1]
         ::aFontNameFrm[si] := StrToStr( aFont[1] )
         ::oDesignForm:&( ::aControlW[si] ):FontName := aFont[1]
      ENDIF
      IF aFont[2] > 0
         ::aFontSize[si] := aFont[2]
         ::aFontSizeFrm[si] := LTrim( Str( aFont[2] ) )
         ::oDesignForm:&( ::aControlW[si] ):FontSize := aFont[2]
      ENDIF
      IF ::aFontBold[si] <> aFont[3]
         ::aFontBold[si] := aFont[3]
         ::oDesignForm:&( ::aControlW[si] ):FontBold := aFont[3]
      ENDIF
      IF ::aFontItalic[si] <> aFont[4]
         ::aFontItalic[si] := aFont[4]
         ::oDesignForm:&( ::aControlW[si] ):FontItalic := aFont[4]
      ENDIF
      IF aFont[5,1] <> NIL .AND. aFont[5,2] <> NIL .AND. aFont[5,3] <> NIL
         ::aFontColor[si] := ::myIde:ColorToStr( aFont[5] )
         ::oDesignForm:&( ::aControlW[si] ):FontColor := aFont[5]
      ENDIF
      IF ::aFontUnderline[si] <> aFont[6]
         ::aFontUnderline[si] := aFont[6]
         ::oDesignForm:&( ::aControlW[si] ):FontUnderline := aFont[6]
      ENDIF
      IF ::aFontStrikeout[si] <> aFont[7]
         ::aFontStrikeout[si] := aFont[7]
         ::oDesignForm:&( ::aControlW[si] ):FontStrikeout := aFont[7]
      ENDIF
   ENDIF
   ::lIsFormModified := .T.

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD SetFontTypeIDE( si ) CLASS TFormEditor

   LOCAL ia, oControl, cName

   IF si == 0
      ::cFFontName  := ::myIde:cFormDefFontName
      ::cFFontSize  := LTrim( Str( ::myIde:nFormDefFontSize ) )
      ::cFFontColor := ::myIde:cFormDefFontColor
      ::oDesignForm:cFontName := ::myIde:cFormDefFontName
      ::oDesignForm:nFontSize := ::myIde:nFormDefFontSize
      ::oDesignForm:FontColor := ::myIde:StrToColor( ::myIde:cFormDefFontColor )
   ELSEIF si == -1
      ::cSFontName    := ""
      ::cSFontNameFrm := ""
      ::nSFontSize    := 0
      ::cSFontSizeFrm := "0"
      // TODO: statusbar ide fontcolor
      ::lSBold      := .F.
      ::lSItalic    := .F.
      ::lSUnderline := .F.
      ::lSStrikeout := .F.
      ::oDesignForm:Statusbar:FontName      := ""
      ::oDesignForm:Statusbar:FontSize      := 0
      ::oDesignForm:Statusbar:FontBold      := .F.
      ::oDesignForm:Statusbar:FontItalic    := .F.
      ::oDesignForm:Statusbar:FontUnderline := .F.
      ::oDesignForm:Statusbar:FontStrikeout := .F.
      ::oDesignForm:Statusbar:Release()
      ::CreateStatusBar()
   ELSE
//TODO: aplicar a todos los controles de ::oCtrlList
      cName := ::aControlW[si]
      IF ( ia := AScan( ::oDesignForm:aControls, { |c| Lower( c:Name ) == cName } ) ) == 0
         RETURN NIL
      ENDIF
      oControl := ::oDesignForm:aControls[ia]
      ::aFontName[si]      := ""
      ::aFontNameFrm[si]   := ""
      ::aFontSize[si]      := 0
      ::aFontSizeFrm[si]   := ""
      ::aFontColor[si]     := "NIL"
      ::aFontBold[si]      := .F.
      ::aFontItalic[si]    := .F.
      ::aFontUnderline[si] := .F.
      ::aFontStrikeout[si] := .F.
      oControl := ::RecreateControl( oControl, si )
      ::DrawOutline( oControl )
   ENDIF
   ::lIsFormModified := .T.

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD SetFontTypeOOHG( si ) CLASS TFormEditor

   LOCAL ia, oControl, cName

   IF si == 0
      ::cFFontName  := ""
      ::cFFontSize  := ""
      ::cFFontColor := ""
      ::oDesignForm:cFontName := _OOHG_DefaultFontName
      ::oDesignForm:nFontSize := _OOHG_DefaultFontSize
      ::oDesignForm:FontColor := _OOHG_DefaultFontColor
   ELSEIF si == -1
      ::SetFontTypeIDE( -1 )
      ::cSFontName    := _OOHG_DefaultFontName
      ::cSFontNameFrm := _OOHG_DefaultFontName
      ::nSFontSize    := _OOHG_DefaultFontSize
      ::cSFontSizeFrm := LTrim( Str( _OOHG_DefaultFontSize ) )
      // TODO: statusbar default fontcolor
      ::lSBold      := .F.
      ::lSItalic    := .F.
      ::lSUnderline := .F.
      ::lSStrikeout := .F.
      ::oDesignForm:Statusbar:FontName      := _OOHG_DefaultFontName
      ::oDesignForm:Statusbar:FontSize      := _OOHG_DefaultFontSize
      ::oDesignForm:Statusbar:FontBold      := .F.
      ::oDesignForm:Statusbar:FontItalic    := .F.
      ::oDesignForm:Statusbar:FontUnderline := .F.
      ::oDesignForm:Statusbar:FontStrikeout := .F.
      ::oDesignForm:Statusbar:Release()
      ::CreateStatusBar()
   ELSE
//TODO: aplicar a todos los controles de ::oCtrlList
      cName := ::aControlW[si]
      IF ( ia := AScan( ::oDesignForm:aControls, { |c| Lower( c:Name ) == cName } ) ) == 0
         RETURN NIL
      ENDIF
      oControl := ::oDesignForm:aControls[ia]
      ::aFontName[si]      := _OOHG_DefaultFontName
      ::aFontNameFrm[si]   := _OOHG_DefaultFontName
      ::aFontSize[si]      := _OOHG_DefaultFontSize
      ::aFontSizeFrm[si]   := _OOHG_DefaultFontSize
      ::aFontColor[si]     := _OOHG_DefaultFontColor
      ::aFontBold[si]      := .F.
      ::aFontItalic[si]    := .F.
      ::aFontUnderline[si] := .F.
      ::aFontStrikeout[si] := .F.
      oControl := ::RecreateControl( oControl, si )
      ::DrawOutline( oControl )
   ENDIF
   ::lIsFormModified := .T.

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD SetBackColor( si ) CLASS TFormEditor

   LOCAL cCode, uBackColor, aColor, i

   IF si == 0
     uBackColor := ::oDesignForm:BackColor
   ELSE
     uBackColor := ::myIde:StrToColor( ::aBackColor[si] )           // TODO: Check, may not be a color
   ENDIF
   aColor := GetColor( uBackColor )
   IF aColor[1] == NIL .OR. aColor[2] == NIL .OR. aColor[3] == NIL
      RETURN NIL
   ENDIF
   cCode := ::myIde:ColorToStr( aColor )
   IF si == 0
      ::cFBackColor := cCode
      ::oDesignForm:BackColor := aColor
      ::oDesignForm:Hide()
      FOR i := 2 to ::nControlW
         ::RecreateControl( ::oDesignForm:&( ::aControlW[i] ):Object(), i )
      NEXT i
      EraseWindow( ::oDesignForm:Name )
      ::oDesignForm:Show()
      ::oCtrlList:SetFocus()
      ::oCtrlList:Value := {}
   ELSE
//TODO: aplicar a todos los controles de ::oCtrlList
      ::aBackColor[si] := cCode
      ::oDesignForm:&( ::aControlW[si] ):BackColor := aColor
   ENDIF
   ::lIsFormModified := .T.

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD SetBackColorIDE( si ) CLASS TFormEditor

   LOCAL i

   IF si == 0
      ::cFBackColor := ::myIde:StrToColor( ::myIde:aSystemColor )
      ::oDesignForm:BackColor := ::myIde:aSystemColor
      ::oDesignForm:Hide()
      FOR i := 2 to ::nControlW
         ::RecreateControl( ::oDesignForm:&( ::aControlW[i] ):Object(), i )
      NEXT i
      ::oDesignForm:Show()
   ELSE
//TODO: aplicar a todos los controles de ::oCtrlList
      ::aBackColor[si] := "NIL"
      ::oDesignForm:&( ::aControlW[si] ):BackColor := NIL
   ENDIF
   ::lIsFormModified := .T.
   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD SetBackColorOOHG( si ) CLASS TFormEditor

   LOCAL i

   IF si == 0
      ::cFBackColor := ""
      ::oDesignForm:BackColor := NIL
      ::oDesignForm:Hide()
      FOR i := 2 to ::nControlW
         ::RecreateControl( ::oDesignForm:&( ::aControlW[i] ):Object(), i )
      NEXT i
      ::oDesignForm:Show()
   ELSE
//TODO: aplicar a todos los controles de ::oCtrlList
      ::aBackColor[si] := "NIL"
      ::oDesignForm:&( ::aControlW[si] ):BackColor := NIL
   ENDIF
   ::lIsFormModified := .T.
   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD GOtherColors( si, nColor ) CLASS TFormEditor

   LOCAL cColor, aColor
//TODO: aplicar a todos los controles de ::oCtrlList

   IF ! ::aCtrlType[si] == "MONTHCALENDAR"
      RETURN NIL
   ENDIF

   DO CASE
   CASE nColor == 1
      cColor := ::aTitleFontClr[si]                   // TODO: Check
   CASE nColor == 2
      cColor := ::aTitleBackClr[si]
   CASE nColor == 3
      cColor := ::aTrailFontClr[si]
   CASE nColor == 4
      cColor := ::aBackgroundClr[si]
   OTHERWISE
      RETURN NIL
   ENDCASE

   IF IsValidColorArray( cColor ) .OR. Type( cColor ) == "N"
      aColor := GetColor( &cColor )
   ELSE
      aColor := GetColor()
   ENDIF
   IF aColor[1] == NIL .AND. aColor[2] == NIL .AND. aColor[3] == NIL
      RETURN NIL
   ENDIF
   cColor := ::myIde:ColorToStr( aColor )

   IF ::aCtrlType[si] == "MONTHCALENDAR"
      DO CASE
      CASE nColor == 1
         ::aTitleFontClr[si] := cColor
         ::oDesignForm:&( ::aControlW[si] ):TitleFontColor := &cColor
      CASE nColor == 2
         ::aTitleBackClr[si] := cColor
         ::oDesignForm:&( ::aControlW[si] ):TitleBackColor := &cColor
      CASE nColor == 3
         ::aTrailFontClr[si] := cColor
         ::oDesignForm:&( ::aControlW[si] ):TrailingFontColor := &cColor
      CASE nColor == 4
         ::aBackgroundClr[si] := cColor
         ::oDesignForm:&( ::aControlW[si] ):BackgroundColor := &cColor
      OTHERWISE
         RETURN NIL
      ENDCASE
      ::lIsFormModified := .T.
   ENDIF

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD VerifyBar() CLASS TFormEditor

   IF ::lSStat
      ::oDesignForm:Statusbar:Release()
      ::lSStat := .F.
      ::Form_Main:btn_Status:Enabled := .F.
      ::oCtrlBox:Control_Statusbar:ToolTip := "StatusBar On"
   ELSE
      ::CreateStatusBar()
      ::lSStat := .T.
      ::Form_Main:btn_Status:Enabled := .T.
      ::oCtrlBox:Control_Statusbar:ToolTip := "StatusBar Off"
   ENDIF
   ::lIsFormModified := .T.
   ::oDesignForm:SetFocus()

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD CreateStatusBar() CLASS TFormEditor

   LOCAL aActions, aAligns, aCaptions, aIcons, aStyles, aToolTips, aWidths, cPicture, i, nCant, nWidth

   TMessageBar():Define( "StatusBar", ::oDesignForm:Name, 0, 0, 0, 0, NIL, NIL, ;
         iif( Empty( ::cSFontName ), NIL, ::cSFontName ), iif( ::nSFontSize > 0, ::nSFontSize, NIL ), ;
         NIL, .F., .F., .F., NIL, NIL, ::lSBold, ::lSItalic, ::lSUnderline, ::lSStrikeout, ;
         ::lSTop, ::lSNoAutoAdjust, NIL, NIL, NIL, NIL )

      IF Empty( ::cSCaption )
         ::cSCaption := "{ ' ' }"
      ENDIF
      aCaptions := &( ::cSCaption )
      IF Empty( ::cSWidth )
         ::cSWidth := "{ '' }"
      ENDIF
      aWidths := &( ::cSWidth )
      IF Empty( ::cSAction )
         ::cSAction := "{ '' }"
      ENDIF
      aActions := &( ::cSAction )
      IF Empty( ::cSIcon )
         ::cSIcon := "{ '' }"
      ENDIF
      aIcons := &( ::cSIcon )
      IF Empty( ::cSStyle )
         ::cSStyle := "{ '' }"
      ENDIF
      aStyles := &( ::cSStyle )
      IF Empty( ::cSToolTip )
         ::cSToolTip := "{ '' }"
      ENDIF
      aToolTips := &( ::cSToolTip )
      IF Empty( ::cSAlign )
         ::cSAlign := "{ '' }"
      ENDIF
      aAligns := &( ::cSAlign )

      nCant := Len( aCaptions )
      ASize( aWidths, nCant )
      ASize( aActions, nCant )
      ASize( aIcons, nCant )
      ASize( aStyles, nCant )
      ASize( aToolTips, nCant )
      ASize( aAligns, nCant )

      FOR i := 1 TO nCant
         _SetStatusItem( aCaptions[i], aWidths[i], NIL, aToolTips[i], aIcons[i], aStyles[i], aAligns[i] )
      NEXT i
      IF ::lSKeyboard
         IF ! Empty( cPicture := ::StrToValueCtrl( ::cSKImage, "C", NIL ) )
            IF ! File( cPicture )
               cPicture := "ZZZ_AAAOOHG"
            ENDIF
         ENDIF
         _SetStatusKeybrd( ::nSKWidth, ::StrToValueCtrl( ::cSKToolTip, "C", NIL ), NIL, cPicture, ::cSKStyle, ::cSKAlign )
      ENDIF
      IF ::lSDate
         IF ::nSDWidth > 0
            nWidth := ::nSDWidth
         ELSEIF "yyyy" $ Lower( Set( _SET_DATEFORMAT ) )
            nWidth := 95
         ELSE
            nWidth := 75
         ENDIF
         _SetStatusItem( DToC( Date() ), nWidth, NIL, ::StrToValueCtrl( ::cSDToolTip, "C", NIL ), NIL, ::cSDStyle, ::cSDAlign )
      ENDIF
      IF ::lSTime
         IF ! Empty( cPicture := ::StrToValueCtrl( ::cSCImage, "C", NIL ) )
            IF ! File( cPicture )
               cPicture := "ZZZ_AAAOOHG"
            ENDIF
         ENDIF
         _SetStatusClock( ::nSCWidth, ::StrToValueCtrl( ::cSCToolTip, "C", NIL ), NIL, ::lSCAmPm, cPicture, ::cSCStyle, ::cSCAlign )
      ENDIF
   END STATUSBAR

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD StatPropEvents() CLASS TFormEditor

   LOCAL aData, aLabels, aInitValues, aFormats, aStat1, aStat2, aResults, cTitle, k

   aData       := { { i18n( "**** STATUSBAR clauses" ),  NIL,                                                    NIL  }, ;
                    { "Obj",                             ::cSCObj,                                               1000 }, ;
                    { "Cargo",                           ::cSCargo,                                              1000 }, ;
                    { "NoAutoAdjust",                    ::lSNoAutoAdjust,                                       .F.  }, ;
                    { "SubClass",                        ::cSSubClass,                                           1000 }, ;
                    { "Top",                             ::lSTop,                                                .F.  }, ;
                    { i18n( "**** STATUSITEM clauses" ), NIL,                                                    NIL  }, ;
                    { "Action",                          ::cSAction,                                             1000 }, ;
                    { "Align",                           ::cSAlign,                                              1000 }, ;
                    { "Caption",                         ::cSCaption,                                            1000 }, ;
                    { "Icon",                            ::cSIcon,                                               1000 }, ;
                    { "Style",                           ::cSStyle,                                              1000 }, ;
                    { "ToolTip",                         ::cSToolTip,                                            1000 }, ;
                    { "Width",                           ::cSWidth,                                              1000 }, ;
                    { i18n( "**** DATE clause" ),        NIL,                                                    NIL  }, ;
                    { "Action",                          ::cSDAction,                                            1000 }, ;
                    { "Align",                           AScan( { "CENTER", "LEFT", "RIGHT" }, ::cSDAlign ) + 1, { "NIL", "CENTER", "LEFT", "RIGHT" } }, ;
                    { "Date",                            ::lSDate,                                               .F.  }, ;
                    { "Style",                           AScan( { "FLAT", "RAISED" }, ::cSDStyle ) + 1,          { "NIL", "FLAT", "RAISED" } }, ;
                    { "ToolTip",                         ::cSDToolTip,                                           1000 }, ;
                    { "Width",                           ::nSDWidth,                                             1000 }, ;
                    { i18n( "**** CLOCK clause" ),       NIL,                                                    NIL  }, ;
                    { "Action",                          ::cSCAction,                                            1000 }, ;
                    { "Align",                           AScan( { "CENTER", "LEFT", "RIGHT" }, ::cSCAlign ) + 1, { "NIL", "CENTER", "LEFT", "RIGHT" } }, ;
                    { "AmPm",                            ::lSCAmPm,                                              .F.  }, ;
                    { "Clock",                           ::lSTime,                                               .F.  }, ;
                    { "Icon",                            ::cSCImage,                                             1000 }, ;
                    { "Style",                           AScan( { "FLAT", "RAISED" }, ::cSCStyle ) + 1,          { "NIL", "FLAT", "RAISED" } }, ;
                    { "ToolTip",                         ::cSCToolTip,                                           1000 }, ;
                    { "Width",                           ::nSCWidth,                                             1000 }, ;
                    { i18n( "**** KEYBOARD clause" ),    NIL,                                                    NIL  }, ;
                    { "Action",                          ::cSKAction,                                            1000 }, ;
                    { "Align",                           AScan( { "CENTER", "LEFT", "RIGHT" }, ::cSKAlign ) + 1, { "NIL", "CENTER", "LEFT", "RIGHT" } }, ;
                    { "Icon",                            ::cSKImage,                                             1000 }, ;
                    { "Keyboard",                        ::lSKeyboard,                                           .F.  }, ;
                    { "Style",                           AScan( { "FLAT", "RAISED" }, ::cSKStyle ) + 1,          { "NIL", "FLAT", "RAISED" } }, ;
                    { "ToolTip",                         ::cSKToolTip,                                           1000 }, ;
                    { "Width",                           ::nSKWidth,                                             1000 } }
   cTitle      := DQM( ::cFName + ".fmg" ) + i18n( " - Properties of Form's Statusbar" )
   aLabels     := Array( Len( aData ) )
   aInitValues := Array( Len( aData ) )
   aFormats    := Array( Len( aData ) )
   AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
   aStat1      := { i18n( "Set Font/Colors ." ), {|| ::SetFontType( -1 ) }, i18n( "Change font and colors." ) }
   aStat2      := { i18n( "Use Defaults    ." ), {|| ::SetFontTypeIDE( -1 ) }, i18n( "Use default font and default colors." ) }
   /* get data */
   aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats, "ClientHeightUsed = " + LTrim( Str( Abs( ::oDesignForm:Statusbar:ClientHeightUsed ) ) ), aStat1, aStat2 )
   IF aResults[1] == NIL
      ::ControlClick( 1 )
      RETURN NIL
   ENDIF

   k := 1
   ::cSCargo        := aResults[ ++k ]
   ::cSCObj         := aResults[ ++k ]
   ::lSNoAutoAdjust := aResults[ ++k ]      // TODO: cambiar a ::cS... y ver otros lugares donde se usan las variables
   ::cSSubClass     := aResults[ ++k ]
   ::lSTop          := aResults[ ++k ]
   ++k
   ::cSAction       := aResults[ ++k ]
   ::cSAlign        := aResults[ ++k ]
   ::cSCaption      := aResults[ ++k ]
   ::cSIcon         := aResults[ ++k ]
   ::cSStyle        := aResults[ ++k ]
   ::cSToolTip      := aResults[ ++k ]
   ::cSWidth        := aResults[ ++k ]
   ++k
   ::cSDAction      := aResults[ ++k ]
   ::cSDAlign       := { "NIL", "CENTER", "LEFT", "RIGHT" } [ aResults[ ++k ] ]
   ::lSDate         := aResults[ ++k ]
   ::cSDStyle       := { "NIL", "FLAT", "RAISED" }[ aResults[ ++k ] ]
   ::cSDToolTip     := aResults[ ++k ]
   ::nSDWidth       := aResults[ ++k ]
    ++k
   ::cSCAction      := aResults[ ++k ]
   ::cSCAlign       := { "NIL", "CENTER", "LEFT", "RIGHT" } [ aResults[ ++k ] ]
   ::lSCAmPm        := aResults[ ++k ]
   ::lSTime         := aResults[ ++k ]
   ::cSCImage       := aResults[ ++k ]
   ::cSCStyle       := { "NIL", "FLAT", "RAISED" }[ aResults[ ++k ] ]
   ::cSCToolTip     := aResults[ ++k ]
   ::nSCWidth       := aResults[ ++k ]
    ++k
   ::cSKAction      := aResults[ ++k ]
   ::cSKAlign       := { "NIL", "CENTER", "LEFT", "RIGHT" } [ aResults[ ++k ] ]
   ::cSKImage       := aResults[ ++k ]
   ::lSKeyboard     := aResults[ ++k ]
   ::cSKStyle       := { "NIL", "FLAT", "RAISED" }[ aResults[ ++k ] ]
   ::cSKToolTip     := aResults[ ++k ]
   ::nSKWidth       := aResults[ ++k ]

   ::oDesignForm:Statusbar:Release()
   ::CreateStatusBar()

   ::lIsFormModified := .T.
   ::ControlClick( 1 )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD IsUnique( cName, nExclude ) CLASS TFormEditor

   LOCAL i

   cName := Lower( AllTrim( cName ) )

   FOR i := 1 TO ::nControlW
      IF ::aControlW[i] == cName .AND. i # nExclude   
         RETURN .F.
      ENDIF
   NEXT i

   RETURN .T.

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD IniArray( cControlName, cCtrlType ) CLASS TFormEditor

   LOCAL i, data, value

   FOR i := 1 to Len( ::aDatas )
      data := Self:&( ::aDatas[i, 1] )

      IF HB_ISARRAY( ::aDatas[i, 2] )
         value := AClone( ::aDatas[i, 2] )
      ELSE
         value := ::aDatas[i, 2]
      ENDIF
      AAdd( data, value )
   NEXT

   ::nControlW ++
   ::aName[ ::nControlW ] := cControlName
   ::aCtrlType[ ::nControlW ] := cCtrlType
   IF Left( cControlName, 1 ) == "&"                                     
      i := AScan( ::ControlType, ::aCtrlType[ ::nControlW ] )
      IF i > 0
         /* Assign an unique name */
         ::ControlCount[i] ++
         cControlName := ::ControlPrefix[i] + LTrim( Str( ::ControlCount[i] ) )
         DO WHILE AScan( ::aControlW, cControlName ) > 0
            ::ControlCount[i] ++
            cControlName := ::ControlPrefix[i] + LTrim( Str( ::ControlCount[i] ) )
         ENDDO
         ::aControlW[ ::nControlW ] := Lower( cControlName )
      ENDIF
   ELSE
      ::aControlW[ ::nControlW ] := Lower( cControlName )
   ENDIF

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD DelArray( z ) CLASS TFormEditor

   LOCAL i, data

   FOR i := 1 to Len( ::aDatas )
      data := Self:&( ::aDatas[i, 1] )

      ADel( data, z )
      ASize( data, Len( data ) - 1 )
   NEXT

   ::nControlW --
   IF ::nControlW == 1
      ::nIndexW := 0
   ENDIF

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD MoveControl() CLASS TFormEditor

   LOCAL ia, oControl, iw, nWidth, nHeight, oLabel, nOldRow, nOldCol, nNewRow, nNewCol, cName

//TODO: move outside container
//TODO: mover todos los controles seleccionados juntos
   IF ( ia := ::FirstCtrl() ) > 0
      oControl := ::oDesignForm:aControls[ia]
      iw := AScan( ::aControlW, Lower( oControl:Name ) )
      oControl:Hide()
      EraseWindow( ::oDesignForm:Name )
      ::DrawPoints()
      IF oControl:Type == "RADIOGROUP"
         nWidth  := oControl:GroupWidth
         nHeight := oControl:GroupHeight
      ELSE
         nWidth  := oControl:Width
         nHeight := oControl:Height
      ENDIF
      /* We use a LABEL because;
         InteractiveMoveHandle() function can't move a RADIOGROUP control.
         InteractiveMoveHandle() function moves only the 'display' part of the SPINNER control,
         leaving an artifact until the move is over. */
      @ oControl:ContainerRow, oControl:ContainerCol LABEL 0 ;
         OBJ oLabel ;
         VALUE oControl:Name ;
         PARENT ( ::oDesignForm:Name ) ;
         WIDTH nWidth ;
         HEIGHT nHeight ;
         BORDER ;
         TRANSPARENT
      nOldRow := GetWindowRow( oLabel:hWnd )
      nOldCol := GetWindowCol( oLabel:hWnd )
      /* Execute */
      InteractiveMoveHandle( oLabel:hWnd )
      /* The assignment of ::Row changes ::Col and viceversa, so we need to calculate before assigning */
      nNewRow := oControl:Row + GetWindowRow( oLabel:hWnd ) - nOldRow
      nNewCol := oControl:Col + GetWindowCol( oLabel:hWnd ) - nOldCol
      oControl:Row := nNewRow
      oControl:Col := nNewCol
      oLabel:Release()
      oControl:Show()
      ::Snap( oControl )
      ::lIsFormModified := .T.
      IF ! Empty( ::aTabPage[iw, 1] )
         cName := ::aTabPage[iw, 1]
         ::oDesignForm:&cName:Show()
          IF ::aCtrlType[iw] == "TAB" .AND. ::aTabPage[iw, 2] > 0
             ::oDesignForm:&cName:Value := ::aTabPage[iw, 2]
          ENDIF
      ENDIF
      ::DrawOutline( oControl )
      oControl:SetFocus()
   ENDIF

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD SizeControl() CLASS TFormEditor

   LOCAL ia, oControl, iw, nOldHeight, nWidth, nHeight, oLabel, cName

   IF ( ia := ::FirstCtrl() ) > 0
      IF ::CtrlIsOfType( ia, " MONTHCALENDAR TIMER HOTKEYBOX " )
      //TODO: si alguno de estos est seleccionado dar aviso y no hacer nada
         RETURN NIL
      ENDIF
      oControl   := ::oDesignForm:aControls[ia]
      iw := AScan( ::aControlW, Lower( oControl:Name ) )
      nOldHeight := oControl:Height
      oControl:Hide()
      EraseWindow( ::oDesignForm:Name )
      ::DrawPoints()
      IF oControl:Type == "RADIOGROUP"
         nWidth  := oControl:GroupWidth
         nHeight := oControl:GroupHeight
      ELSE
         nWidth  := oControl:Width
         nHeight := oControl:Height
      ENDIF
      /* Do not use BORDER clause, it imposes a mandatory minimum width and height */
      @ oControl:ContainerRow, oControl:ContainerCol LABEL 0 ;
         OBJ oLabel ;
         VALUE oControl:Name ;
         PARENT ( ::oDesignForm:Name ) ;
         WIDTH nWidth ;
         HEIGHT nHeight ;
         CLIENTEDGE ;
         TRANSPARENT
      /* Execute */
      InteractiveSizeHandle( oLabel:hWnd )
      IF oControl:Type == "RADIOGROUP"
         IF oControl:lHorizontal
            nHeight      := GetWindowHeight( oLabel:hWnd )
            oControl:Height := nHeight
         ELSE
            nWidth       := GetWindowWidth( oLabel:hWnd )
            oControl:Width  := nWidth
         ENDIF
      ELSEIF oControl:Type == "COMBOBOX"
         oControl:Width  := GetWindowWidth ( oLabel:hWnd )
         oControl:Height := nOldHeight
      ELSE
         nWidth       := GetWindowWidth( oLabel:hWnd )
         nHeight      := GetWindowHeight( oLabel:hWnd )
         oControl:Width  := nWidth
         oControl:Height := nHeight
      ENDIF
      oLabel:Release()
      oControl:Show()
      ::lIsFormModified := .T.
      IF ! Empty( ::aTabPage[iw, 1] )
         cName := ::aTabPage[iw, 1]
         ::oDesignForm:&cName:Show()
          IF ::aCtrlType[iw] == "TAB" .AND. ::aTabPage[iw, 2] > 0
             ::oDesignForm:&cName:Value := ::aTabPage[iw, 2]
          ENDIF
      ENDIF
      ::DrawOutline( oControl )
      oControl:SetFocus()
   ENDIF

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD MouseMoveSize() CLASS TFormEditor

   STATIC lBusy := .F.

   //TODO: mover todos los controles seleccionados juntos, avisar que no se permite el size de mltiples controles

   IF lBusy
      RETURN NIL
   ENDIF
   lBusy := .T.
   IF ::swCursor == 1                         /* drag */
      IF ::nIndexW > 0
         IF AScan( ::oDesignForm:aControls, { |c| Lower( c:Name ) == ::aControlW[::nIndexW] } ) == 0
            lBusy := .F.
            RETURN NIL
         ENDIF
         ::MoveControl()
      ENDIF
      ::swCursor := 0
   ELSEIF ::swCursor == 2                     /* size */
      IF ::nIndexW > 0
         IF AScan( ::oDesignForm:aControls, { |c| Lower( c:Name ) == ::aControlW[::nIndexW] } ) == 0
            lBusy := .F.
            RETURN NIL
         ENDIF
         ::SizeControl()
      ENDIF
      ::swCursor := 0
   ENDIF
   lBusy := .F.

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD CopyControl() CLASS TFormEditor

   LOCAL ia, oControl, z, i, cControlName, oNewCtrl := NIL, cTab, oTab, j, data

   //TODO: copiar todos los controles seleccionados

   IF ( ia := ::FirstCtrl() ) > 0
      oControl := ::oDesignForm:aControls[ia]
      z := AScan( ::aControlW, Lower( oControl:Name ) )
      i := AScan( ::ControlType, ::aCtrlType[z] )
      IF i > 0
         /* Assign an unique name */
         ::ControlCount[i] ++
         cControlName := ::ControlPrefix[i] + LTrim( Str( ::ControlCount[i] ) )
         DO WHILE _IsControlDefined( cControlName, ::oDesignForm:Name )
            ::ControlCount[i] ++
            cControlName := ::ControlPrefix[i] + LTrim( Str( ::ControlCount[i] ) )
         ENDDO
         ::nControlW ++
         /* Add an item to control's data arrays */
         FOR j := 1 to Len( ::aDatas )
            data := Self:&( ::aDatas[j, 1] )

            AAdd( data, data[z] )
         NEXT
         ::aControlW[ ::nControlW ] := Lower( cControlName )
         ::aName[ ::nControlW ] := cControlName
         /* Create the control */
         oNewCtrl     := ::CreateControl( i, ::nControlW, oControl:Width, oControl:Height, NIL )
         oNewCtrl:Row := oControl:Row + 10
         oNewCtrl:Col := oControl:Col + 10
         /* Assign to TAB if needed */
         IF ! Empty( ::aTabPage[::nControlW, 1] ) .AND. ::aTabPage[::nControlW, 2] > 0
            IF ( i := AScan( ::aControlW, { |c| c == ::aTabPage[::nControlW, 1] } ) ) > 0
               cTab := ::aControlW[i]
               IF ( i := AScan( ::oDesignForm:aControls, { |c| Lower( c:Name ) == cTab } ) ) > 0
                  oTab := ::oDesignForm:aControls[i]
                  oTab:AddControl( cControlName, ::aTabPage[::nControlW, 2], oNewCtrl:Row, oNewCtrl:Col )
                  ::ReorderTabs()
               ELSE
                  ::aTabPage[::nControlW, 1] := ""
                  ::aTabPage[::nControlW, 2] := 0
               ENDIF
            ELSE
               ::aTabPage[::nControlW, 1] := ""
               ::aTabPage[::nControlW, 2] := 0
            ENDIF
         ENDIF
         ::DrawOutline( oNewCtrl )
         ::lIsFormModified := .T.
      ENDIF
   ENDIF

   RETURN oNewCtrl

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD ReorderTabs CLASS TFormEditor

   LOCAL k, k1

   /* Order controls in TAB by TAB name */
   FOR k := 2 TO ::nControlW
      FOR k1 := k + 1 TO ::nControlW
         IF ! Empty( ::aTabPage[k, 1] ) .AND. ! Empty( ::aTabPage[k1, 1] )
            IF ::aTabPage[k, 1] > ::aTabPage[k1, 1]
               ::SwapArray( k, k1 )
            ENDIF
         ENDIF
      NEXT k1
   NEXT k
   /* Order controls in each TAB by page */
   FOR k := ::nControlW TO 2 STEP -1
      FOR k1 := k - 1 TO 2 STEP -1
         IF ! Empty( ::aTabPage[k, 1] ) .AND. ! Empty( ::aTabPage[k1, 1] )
            IF ::aTabPage[k, 1] == ::aTabPage[k1, 1]
               IF ::aTabPage[k, 2] < ::aTabPage[k1, 2]
                  ::SwapArray( k, k1 )
                  EXIT
               ENDIF
            ENDIF
         ENDIF
      NEXT k1
   NEXT k

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD CheckForFrame() CLASS TFormEditor

   LOCAL i, oControl, SupMin := 99999999, oCtrl := NIL, w_OOHG_MouseRow, w_OOHG_MouseCol

   w_OOHG_MouseRow := _OOHG_MouseRow
   w_OOHG_MouseCol := _OOHG_MouseCol

   FOR i := 1 TO Len( ::oDesignForm:aControls )
      oControl := ::oDesignForm:aControls[i]
      IF oControl:Row == oControl:ContainerRow .AND. oControl:Col == oControl:ContainerCol
         IF w_OOHG_MouseRow >= oControl:Row .AND. w_OOHG_MouseRow <= oControl:Row + oControl:Height .AND. ;
            w_OOHG_MouseCol >= oControl:Col .AND. w_OOHG_MouseCol <= oControl:Col + oControl:Width .AND. ;
            oControl:Type $ " FRAME DATEPICKER TAB " .AND. IsWindowVisible( oControl:hWnd )
            IF SupMin > oControl:Height * oControl:Width
               SupMin := oControl:Height * oControl:Width
               oCtrl  := oControl
            ENDIF
         ENDIF
      ELSE
         IF w_OOHG_MouseRow >= oControl:ContainerRow .AND. w_OOHG_MouseRow <= oControl:ContainerRow + oControl:Height .AND. ;
            w_OOHG_MouseCol >= oControl:ContainerCol .AND. w_OOHG_MouseCol <= oControl:ContainerCol+ oControl:Width .AND. ;
            oControl:Type $ " FRAME DATEPICKER TAB " .AND. IsWindowVisible( oControl:hWnd )
            IF SupMin > oControl:Height * oControl:Width
               SupMin := oControl:Height * oControl:Width
               oCtrl  := oControl
            ENDIF
         ENDIF
      ENDIF
   NEXT i

   RETURN oCtrl

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD AddControl( lOpenContextMenu ) CLASS TFormEditor

   LOCAL oFrame, cName, oNewCtrl := NIL
   LOCAL nWidth := NIL, nHeight := NIL

   IF ::CurrentControl == TYPE_FORM
      /* From ::oDesignForm */
      IF ( oFrame := ::CheckForFrame() ) # NIL
         oFrame:SetFocus()
         ::DrawOutline( oFrame )
         IF lOpenContextMenu
            ::oDesignFormMenu:Activate()
         ENDIF
      ENDIF
      RETURN NIL
   ELSEIF ::CurrentControl >= 2 .AND. ::CurrentControl <= IDE_LAST_CTRL
      ::ControlCount[::CurrentControl] ++
      cName := ::ControlPrefix[::CurrentControl] + LTrim( Str( ::ControlCount[::CurrentControl] ) )
      DO WHILE _IsControlDefined( cName, ::oDesignForm:Name )
         ::ControlCount[::CurrentControl] ++
         cName := ::ControlPrefix[::CurrentControl] + LTrim( Str( ::ControlCount[::CurrentControl] ) )
      ENDDO
      ::IniArray( cName, ::ControlType[::CurrentControl] )

      DO CASE
      CASE ::CurrentControl == TYPE_BUTTON
         ::aCaption[::nControlW]   := cName
         ::aAction[::nControlW]    := "MsgInfo( 'Button Pressed!' )"

      CASE ::CurrentControl == TYPE_CHECKBOX
         ::aValue[::nControlW]  := "NIL"

      CASE ::CurrentControl == TYPE_LISTBOX

      CASE ::CurrentControl == TYPE_COMBOBOX

      CASE ::CurrentControl == TYPE_CHECKBUTTON

      CASE ::CurrentControl == TYPE_GRID

      CASE ::CurrentControl == TYPE_FRAME

      CASE ::CurrentControl == TYPE_TAB
         ::aCaption[::nControlW]      := { 'Page 1', 'Page 2' }
         ::aImage[::nControlW]        := { '', '' }
         ::aPageCargos[::nControlW]   := { 'NIL', 'NIL' }
         ::aPageNames[::nControlW]    := { '', '' }
         ::aPageObjs[::nControlW]     := { '', '' }
         ::aPageSubClass[::nControlW] := { '', '' }
         ::aPageToolTips[::nControlW] := { '', '' }
         nWidth                       := 240
         nHeight                      := 200

      CASE ::CurrentControl == TYPE_IMAGE

      CASE ::CurrentControl == TYPE_ANIMATEBOX
         nWidth  := 100
         nHeight := 100

      CASE ::CurrentControl == TYPE_DATEPICKER

      CASE ::CurrentControl == TYPE_TEXTBOX
         ::aFocusedPos[::nControlW] := "-2"

      CASE ::CurrentControl == TYPE_EDITBOX
         nWidth  := 120
         nHeight := 240
         ::aFocusedPos[::nControlW] := "-4"

      CASE ::CurrentControl == TYPE_LABEL
         ::aVCenter[::nControlW] := .F.

      CASE ::CurrentControl == TYPE_PLAYER
         nWidth  := 100
         nHeight := 100

      CASE ::CurrentControl == TYPE_PROGRESSBAR
         nWidth  := NIL
         nHeight := NIL

      CASE ::CurrentControl == TYPE_RADIOGROUP

      CASE ::CurrentControl == TYPE_SLIDER

      CASE ::CurrentControl == TYPE_SPINNER

      CASE ::CurrentControl == TYPE_PICCHECKBUTT
         ::aPicture[::nControlW] := "IDE_FRMPROPS"
         nWidth                  := 30
         nHeight                 := 30

      CASE ::CurrentControl == TYPE_PICBUTT
         ::aAction[::nControlW]  := "MsgInfo( 'Picbutton Pressed!' )"
         nWidth                  := 30
         nHeight                 := 30
         ::aPicture[::nControlW] := "IDE_FRMPROPS"

      CASE ::CurrentControl == TYPE_TIMER
         nWidth  := 100
         nHeight := 20

      CASE ::CurrentControl == TYPE_BROWSE

      CASE ::CurrentControl == TYPE_TREE

      CASE ::CurrentControl == TYPE_IPADDRESS
         nWidth  := 100
         nHeight := 24

      CASE ::CurrentControl == TYPE_MONTHCALENDAR

      CASE ::CurrentControl == TYPE_HYPERLINK
         ::aAddress[::nControlW] := "https://oohg.github.io/"

      CASE ::CurrentControl == TYPE_RICHEDITBOX
         nWidth  := 120
         nHeight := 240
         ::aFocusedPos[::nControlW] := "-4"
         ::aMaxLength[::nControlW]  := "0"

      CASE ::CurrentControl == TYPE_TIMEPICKER

      CASE ::CurrentControl == TYPE_XBROWSE

      CASE ::CurrentControl == TYPE_ACTIVEX
         nWidth  := 100
         nHeight := 100

      CASE ::CurrentControl == TYPE_CHECKLIST

      CASE ::CurrentControl == TYPE_HOTKEYBOX
         nWidth  := 120
         nHeight := 40

      CASE ::CurrentControl == TYPE_PICTURE

      CASE ::CurrentControl == TYPE_PROGRESSMETER

      CASE ::CurrentControl == TYPE_SCROLLBAR
         nHeight := 100

      CASE ::CurrentControl == TYPE_TEXTARRAY
         nWidth  := 100
         nHeight := 100

      CASE ::CurrentControl == TYPE_ANIGIF
         nWidth  := 100
         nHeight := 100

      ENDCASE

      oNewCtrl := ::CreateControl( ::CurrentControl, ::nControlW, nWidth, nHeight, NIL )

      IF ::CurrentControl == TYPE_TEXTBOX
         /* TEXT */
         IF ::myIde:nTextBoxHeight > 0
            oNewCtrl:Height := ::myIde:nTextBoxHeight
         ENDIF
      ELSEIF ::CurrentControl == TYPE_LABEL
         /* LABEL */
         IF ::myIde:nLabelHeight > 0
            oNewCtrl:Height := ::myIde:nLabelHeight
         ENDIF
      ENDIF

      ::AddCtrlToContainer( oNewCtrl, 2, "", 0, 0, 0 )

      ::RefreshControlInspector()                       // TODO: solo agregar y los 2 que siguen
      ::oCtrlList:SetFocus()
      ::oCtrlList:Value := { ::oCtrlList:ItemCount }
      oNewCtrl:SetFocus()                               // TODO: quitar y hacerlo en ::oCtrlList:OnChange
      ::DrawOutline( oNewCtrl )                         // TODO: que solo dibuje el contorno
      ::lIsFormModified := .T.
   ENDIF

   RETURN oNewCtrl

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD AddCtrlToContainer( oNewCtrl, i, cContainerName, nContainerPage, nContainerRow, nContainerCol ) CLASS TFormEditor

   LOCAL j, oTab

   DO WHILE i < ::nControlW

      IF ::aCtrlType[i] == "TAB" .AND. ::aTabPage[i, 1] == Lower( cContainerName ) .AND. ::aTabPage[i, 2] == nContainerPage
         IF ( j := AScan( ::oDesignForm:aControls, { |c| Lower( c:Name ) == ::aControlW[i] } ) ) > 0
            oTab := ::oDesignForm:aControls[j]
            IF ( oNewCtrl:Row > oTab:Row + nContainerRow ) .AND. ( oNewCtrl:Row < oTab:Row + oTab:Height + nContainerRow ) .AND. ;
               ( oNewCtrl:Col > oTab:Col + nContainerCol ) .AND. ( oNewCtrl:Col < oTab:Col + oTab:Width + nContainerCol )
               /* See if the selected page contains a TAB */
               IF ::AddCtrlToContainer( oNewCtrl, i + 1, oTab:Name, oTab:Value, oTab:Row + nContainerRow, oTab:Col + nContainerCol )
                  RETURN .T.
               ENDIF
               /* Add the control to the selected page */
               oTab:AddControl( oNewCtrl:Name, oTab:Value, oNewCtrl:Row - oTab:Row - nContainerRow, oNewCtrl:Col - oTab:Col - nContainerCol )
               ::aTabPage[::nControlW, 1] := Lower( oTab:Name )
               ::aTabPage[::nControlW, 2] := oTab:Value
               ::ReorderTabs()
               RETURN .T.
            ENDIF
         ENDIF
      ENDIF
      i ++
   ENDDO

   RETURN .F.

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD CreateControl( nControlType, i, nWidth, nHeight, aCtrls ) CLASS TFormEditor

   LOCAL aCaptions, aHeaders, aImages, aItems, aWidths, cFormat, cName, cPicture, j, lRed, nCnt, nMax, nMin, oCtrl, oPage, uRO

   cName := ::aControlW[i]
   oCtrl := NIL
   IF ( lRed := ::oDesignForm:SetRedraw() )
      ::oDesignForm:SetRedraw( .F. )
   ENDIF

/*
   TODO: Behaviour:
      Click changes the value of ::oCtrlList and draws the control's outline.
      Ctrl+Click adds the control to ::oCtrlList value and draws the control's outline.
      RClick shows the context menu of the design form.
      DblClick changes the value of ::oCtrlList, draws the control's outline and shows the context menu (=Click+RClick).
      If a control do not supports any of the above replace it with a label.
*/

   DO CASE
   CASE nControlType == TYPE_ACTIVEX
      oCtrl := TLabel():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, ;
                  ::StrToValueCtrl( ::aProgID[i], "C", cName ), nWidth, nHeight, ;
                  NIL, NIL, .F., .F., .F., ;
                  .F., .F., .F., WHITE, NIL, NIL, NIL, NIL, .F., .F., NIL, .F., .F., NIL )
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

//TODO: OnClick = cambiar ::oCtrlList:Value al clickeado + drawoutline
//TODO: DblClick = OnClick + PropestiesClick()
//TODO: Ctrl+OnClick = agregar a ::oCtrlList:value + drawoutline del nuevo

   CASE nControlType == TYPE_ANIGIF
      oCtrl := TLabel():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, ;
                  ::StrToValueCtrl( ::aFile[i], "C", cName ), nWidth, nHeight, ;
                  NIL, NIL, .F., ::aBorder[i], ::aClientEdge[i], ;
                  .F.,.F., .F., NIL, NIL, NIL, ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), ;
                  NIL, .F., .F., .F., .F., .F., .F., .F., ::aRTL[i], .F., .F., NIL, .F., .F., NIL )
      IF ::aWhiteBack[i]
         oCtrl:BackColor  := WHITE
      ELSE
         oCtrl:BackColor  := ::myIde:StrToColor( ::aBackColor[i] )
      ENDIF
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_ANIMATEBOX
      oCtrl := TLabel():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, ;
                  ::StrToValueCtrl( ::aFile[i], "C", cName ), nWidth, nHeight, ;
                  NIL, NIL, .F., .F., .F., ;
                  .F., .F., .F., WHITE, NIL, NIL, ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), NIL, .F., ;
                  .F., .F., .F., .F., .F., ::aCenter[i], ::aRTL[i], .F., .F., NIL, .F., .F. )
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_BROWSE
      aHeaders := ::StrToValueCtrl( ::aHeaders[i], "A", { "Head1", "Head2" }, 1, 0, "C" )
      FOR j := 1 TO Len( aHeaders )
         IF Empty( aHeaders[j] )
            aHeaders[j] := "Head" + LTrim( Str( j ) )
         ENDIF
      NEXT j
      aWidths  := ::StrToValueCtrl( ::aWidths[i], "A", { 60, 60 }, Len( aHeaders ), 0, "N" )
      FOR j := 1 TO Len( aHeaders )
         IF aWidths[j] <= 0
            aWidths[j] := 60
         ENDIF
      NEXT j
      aItems := { Array( Len( aHeaders ) ) }
      aItems[1, 1] := cName
      oCtrl := TGrid():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, nWidth, nHeight, aHeaders, aWidths, ;
                  aItems, 1, NIL, NIL, NIL, ;
                  NIL, NIL, NIL, NIL, NIL, ::aNoLines[i], NIL, NIL, .F., NIL, ::aFontBold[i], ::aFontItalic[i], ;
                  ::aFontUnderline[i], ::aFontStrikeout[i], .F., NIL, NIL, .F., NIL, NIL, NIL, NIL, NIL, ::aRTL[i], .F., NIL, ;
                  .T., NIL, NIL, NIL, NIL, .F., .F., .F., ! ::aNoHeaders[i], NIL, NIL, NIL, .F., NIL,  NIL, ::aCheckBoxes[i], ;
                  NIL, .T., .T., ::aPLM[i], .T., NIL, NIL, .T., NIL, NIL, NIL, NIL, NIL, .F., .F., .F., NIL, NIL, NIL, .F., .F., ;
                  NIL, .F., .T., NIL, .F., .F., .F., .F., .F., .F., .F., .F., NIL, NIL, NIL, .T., NIL, NIL, .F., .F., .F., .F. )
      IF ! Empty( ::aFontName[i] )
         oCtrl:FontName := ::aFontName[i]
      ENDIF
      IF ::aFontSize[i] > 0
         oCtrl:FontSize := ::aFontSize[i]
      ENDIF
      oCtrl:FontColor  := ::myIde:StrToColor( ::aFontColor[i] )
      oCtrl:BackColor  := ::myIde:StrToColor( ::aBackColor[i] )
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }
      oCtrl:aHeadClick  := Array( Len( aHeaders ) )
      AFill( oCtrl:aHeadClick, { || ::DrawOutline( oCtrl ) } )
      oCtrl:bHeadRClick  := { || ::oDesignFormMenu:Activate() }
      oCtrl:OnRClick    := { || ::oDesignFormMenu:Activate() }

//TODO: hacer igual en GRID y XBROWSE

   CASE nControlType == TYPE_BUTTON
      oCtrl := TButton():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, ;
                  ::StrToValueCtrl( ::aCaption[i], "C", cName ), NIL, nWidth, nHeight, NIL, NIL, ;
                  ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), NIL, NIL, ::aFlat[i], .F., NIL, .F., ::aFontBold[i], ;
                  ::aFontItalic[i], ::aFontUnderline[i], ::aFontStrikeout[i], ::aRTL[i], ::aNoPrefix[i], .F., NIL, NIL, ;
                  iif( Empty( cPicture := ::StrToValueCtrl( ::aPicture[i], "C", NIL ) ), NIL, iif( File( cPicture ), cPicture, "ZZZ_AAAOOHG" ) ), ;
                  ::aNoLoadTrans[i], ::aStretch[i], .F., ::StrToValueCtrl( ::aImageAlign[i], "C", NIL ), ::aMultiLine[i], ;
                  iif( ::aDrawBy[i] == "OOHGDRAW", .T., iif( ::aDrawBy[i] == "WINDRAW", .F., NIL ) ), ;
                  ::StrToValueCtrl( ::aImageMargin[i], "A", NIL, 4, 0, "N" ), NIL, ::aNo3DColors[i], ::aForceScale[i], ;
                  ! ::aDIBSection[i], NIL, ::aNoHotLight[i], ::aSolid[i], NIL, ;
                  { ::StrToValueCtrl( ::aAlignH[i], "C", NIL ), ::StrToValueCtrl( ::aAlignV[i], "C", NIL ) }, ;
                  ::aNoPrint[i], ::StrToValueCtrl( ::aTxtMrgn[i], "A", NIL, 4, 0, "N" ), ::aFitTxt[i], ::aFitImg[i], ;
                  ::aImageSize[i], ::aTransparent[i], ::aNoFocusRect[i], ::aNoImgList[i], .F., ;
                  ::aHandCursor[i], .F. )
      IF ! Empty( ::aFontName[i] )
         oCtrl:FontName := ::aFontName[i]
      ENDIF
      IF ::aFontSize[i] > 0
         oCtrl:FontSize := ::aFontSize[i]
      ENDIF
      oCtrl:BackColor  := ::myIde:StrToColor( ::aBackColor[i] )
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_CHECKBOX
      oCtrl := TCheckBox():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, ;
                  ::StrToValueCtrl( ::aCaption[i], "C", cName ), ::StrToValueCtrl( ::aValue[i], "L", NIL ), ;
                  NIL, NIL, ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), NIL, nWidth, nHeight, NIL, NIL, ;
                  NIL, .F., .F., ::aFontBold[i], ::aFontItalic[i], ::aFontUnderline[i], ::aFontStrikeout[i], ;
                  NIL, NIL, NIL, ::aTransparent[i], ::aAutoSize[i], ::aRTL[i], .F., ::a3State[i], ::aLeftJust[i], ;
                  iif( ::aDrawBy[i] == "OOHGDRAW", .T., iif( ::aDrawBy[i] == "WINDRAW", .F., NIL ) ), NIL, ::aNoFocusRect[i] )
      IF ! Empty( ::aFontName[i] )
         oCtrl:FontName := ::aFontName[i]
      ENDIF
      IF ::aFontSize[i] > 0
         oCtrl:FontSize := ::aFontSize[i]
      ENDIF
      oCtrl:FontColor  := ::myIde:StrToColor( ::aFontColor[i] )
      oCtrl:BackColor  := ::myIde:StrToColor( ::aBackColor[i] )
      oCtrl:OnChange   := { || ::DrawOutline( oCtrl ) }   // OnClick codeblock is ignored
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_CHECKBUTTON
      oCtrl := TButtonCheck():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, ;
                  ::StrToValueCtrl( ::aCaption[i], "C", cName ), ::StrToValueCtrl( ::aValue[i], "L", NIL ), NIL, NIL, ;
                  ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), NIL, nWidth, nHeight, NIL, NIL, NIL, .F., .F., ::aFontBold[i], ;
                  ::aFontItalic[i], ::aFontUnderline[i], ::aFontStrikeout[i], NIL, ::aRTL[i], ;
                  iif( Empty( cPicture := ::StrToValueCtrl( ::aPicture[i], "C", NIL ) ), NIL, iif( File( cPicture ), cPicture, "ZZZ_AAAOOHG" ) ), ;
                  NIL, NIL, ::aNoLoadTrans[i], ::aStretch[i], ::aNo3DColors[i], ::aForceScale[i], ! ::aDIBSection[i], NIL, .F., ;
                  iif( ::aDrawBy[i] == "OOHGDRAW", .T., iif( ::aDrawBy[i] == "WINDRAW", .F., NIL ) ), ;
                  ::StrToValueCtrl( ::aImageMargin[i], "A", NIL, 4, 0, "N" ), NIL, ::StrToValueCtrl( ::aImageAlign[i], "C", NIL ), ;
                  ::aMultiLine[i], ::aFlat[i], ::aNoHotLight[i], ::aSolid[i], NIL, ;
                  { ::StrToValueCtrl( ::aAlignH[i], "C", NIL ), ::StrToValueCtrl( ::aAlignV[i], "C", NIL ) }, ;
                  ::aNoPrint[i], ::StrToValueCtrl( ::aTxtMrgn[i], "A", NIL, 4, 0, "N" ), ::aFitTxt[i], ::aFitImg[i], ;
                  ::aImageSize[i], ::aTransparent[i], ::aNoFocusRect[i], ::aNoImgList[i], .F., ::aHandCursor[i] )
      IF ! Empty( ::aFontName[i] )
         oCtrl:FontName := ::aFontName[i]
      ENDIF
      IF ::aFontSize[i] > 0
         oCtrl:FontSize := ::aFontSize[i]
      ENDIF
      oCtrl:FontColor  := ::myIde:StrToColor( ::aFontColor[i] )
      oCtrl:BackColor  := ::myIde:StrToColor( ::aBackColor[i] )
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_CHECKLIST
      IF NOTEMPTY( ::aImage[i] )
         IF Empty( aImages := ::StrToValueCtrl( ::aImage[i], "A", NIL, 1, 0, "C" ) )
            aImages := { "ZZZ_AAAOOHG" }
         ELSE
           FOR j := 1 to Len( aImages )
              IF ! File( aImages[j] )
                 aImages[j] := "ZZZ_AAAOOHG"
              ENDIF
           NEXT j
         ENDIF
      ELSE
         aImages := NIL
      ENDIF
      IF NOTEMPTY( ::aItems[i] )
         IF NOTEMPTY( ::aImage[i] )
            aItems := { { cName, 0 }, { "item2", 0 } }
         ELSE
            aItems := { cName, "item2" }
         ENDIF
         aItems := ::StrToValueCtrl( ::aItems[i], "A", aItems, 1, 0, "C" )
         FOR j := 1 to Len( aItems )
            IF Empty( aItems[j] )
               aItems[j] := cName
            ENDIF
         NEXT j
      ELSE
         aItems := { cName, "item2" }
      ENDIF
      oCtrl := TCheckList():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, nWidth, nHeight, ;
                  aItems, NIL, NIL, NIL, ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), NIL, NIL, NIL, aImages, ;
                  ::StrToValueCtrl( ::aJustify[i], "C", NIL ), .F., NIL, ::aFontBold[i], ::aFontItalic[i], ;
                  ::aFontUnderline[i], ::aFontStrikeout[i], NIL, NIL, ::aRTL[i], .F., .F., .F., ::aSort[i], ;
                  ::aDescend[i], ::myIde:StrToColor( ::aSelColor[i] ), .T., NIL )
      IF ! Empty( ::aFontName[i] )
         oCtrl:FontName := ::aFontName[i]
      ENDIF
      IF ::aFontSize[i] > 0
         oCtrl:FontSize := ::aFontSize[i]
      ENDIF
      oCtrl:FontColor  := ::myIde:StrToColor( ::aFontColor[i] )
      oCtrl:BackColor  := ::myIde:StrToColor( ::aBackColor[i] )
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_COMBOBOX
      IF NOTEMPTY( ::aImage[i] )
         IF Empty( aImages := ::StrToValueCtrl( ::aImage[i], "A", NIL, 1, 0, "C" ) )
            aImages := { "ZZZ_AAAOOHG" }
         ELSE
           FOR j := 1 to Len( aImages )
              IF ! File( aImages[j] )
                 aImages[j] := "ZZZ_AAAOOHG"
              ENDIF
           NEXT j
         ENDIF
      ELSE
         aImages := NIL
      ENDIF
      IF NOTEMPTY( ::aItems[i] )
         aItems := ::StrToValueCtrl( ::aItems[i], "A", { cName, "item2" }, 1, 0, "C" )
      ELSE
         aItems := { cName, "item2" }
      ENDIF
      oCtrl := myTCombo():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, nWidth, aItems, NIL, NIL, NIL, ;
                  ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), NIL, nHeight, NIL,  NIL, NIL, NIL, .F., .F., ::aSort[i], ;
                  ::aFontBold[i], ::aFontItalic[i], ::aFontUnderline[i], ::aFontStrikeout[i], NIL, NIL, .F., NIL, .F., ;
                  ::StrToValueCtrl( ::aGripperText[i], "C", NIL ),  aImages, ::aRTL[i], ;
                  ::StrToValueCtrl( ::aTextHeight[i], "N", NIL), .F., ::aFirstItem[i], ::aFit[i], NIL, NIL, ;
                  ::StrToValueCtrl( ::aListWidth[i], "N", NIL ), NIL, NIL, NIL, NIL, .F., ::aIncremental[i], ::aIntegHeight[i], ;
                  .F., NIL, NIL, NIL, ::StrToValueCtrl( ::aMaxLength[i], "N", NIL ), ;
                  ::StrToValueCtrl( ::aEditHeight[i], "N", NIL ), ::StrToValueCtrl( ::aOptHeight[i], "N", NIL ), .F., .F., .F., ;
                  NIL, NIL, .F. )
      IF ! Empty( ::aFontName[i] )
         oCtrl:FontName := ::aFontName[i]
      ENDIF
      IF ::aFontSize[i] > 0
         oCtrl:FontSize := ::aFontSize[i]
      ENDIF
      oCtrl:FontColor         := ::myIde:StrToColor( ::aFontColor[i] )
      oCtrl:BackColor         := ::myIde:StrToColor( ::aBackColor[i] )
      oCtrl:OnListDisplay     := { || ::DrawOutline( oCtrl ) }     /* includes OnClick */
      oCtrl:OnDblClick        := { || ::PropertiesClick() }

//TODO: probar si es necesario o no
      oCtrl:oListBox:OnRClick := { || ::oDesignFormMenu:Activate() }

   CASE nControlType == TYPE_DATEPICKER
      oCtrl := TDatePick():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, nWidth, nHeight, ;
                  ::StrToValueCtrl( ::aValue[i], "D", NIL ), NIL, NIL, ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), NIL, NIL, ;
                  NIL, ::aShowNone[i], ::aUpDown[i], ::aRightAlign[i], NIL, .F., .F., ::aFontBold[i], ::aFontItalic[i], ;
                  ::aFontUnderline[i], ::aFontStrikeout[i], NIL, NIL, ::aRTL[i], .F., ::aNoBorder[i], NIL, NIL, ;
                  ::StrToValueCtrl( ::aFormat[i], "C", NIL ), NIL )
      IF ! Empty( ::aFontName[i] )
         oCtrl:FontName := ::aFontName[i]
      ENDIF
      IF ::aFontSize[i] > 0
         oCtrl:FontSize := ::aFontSize[i]
      ENDIF
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }
      /* The control ignores double clicks. Use right click instead. */

   CASE nControlType == TYPE_EDITBOX
      oCtrl := TEdit():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, nWidth, nHeight, ;
                  ::StrToValueCtrl( ::aValue[i], "C", cName ), NIL, NIL, ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), ;
                  ::StrToValueCtrl( ::aMaxLength[i], "N", NIL ), NIL, NIL, NIL, ::aReadOnly[i], .F., NIL, .F., .F., ;
                  ::aFontBold[i], ::aFontItalic[i], ::aFontUnderline[i], ::aFontStrikeout[i], NIL, NIL, NIL, ::aNoVScroll[i], ;
                  ::aNoHScroll[i], ::aRTL[i], ::aNoBorder[i], ::StrToValueCtrl( ::aFocusedPos[i], "N", NIL ), NIL, NIL, ;
                  .F., ::StrToValueCtrl( ::aInsertType[i], "N", NIL ) )
      IF ! Empty( ::aFontName[i] )
         oCtrl:FontName := ::aFontName[i]
      ENDIF
      IF ::aFontSize[i] > 0
         oCtrl:FontSize := ::aFontSize[i]
      ENDIF
      oCtrl:FontColor  := ::myIde:StrToColor( ::aFontColor[i] )
      oCtrl:BackColor  := ::myIde:StrToColor( ::aBackColor[i] )
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_FRAME
      oCtrl := TFrame():Define( cName, ::oDesignForm:Name, _OOHG_MouseRow, _OOHG_MouseCol, nWidth, nHeight, ;
                  ::StrToValueCtrl( ::aCaption[i], "C", cName ), NIL, NIL, ::aOpaque[i], ::aFontBold[i], ::aFontItalic[i], ;
                  ::aFontUnderline[i], ::aFontStrikeout[i], NIL, NIL, ::aTransparent[i], ::aRTL[i], .F., .F., NIL, NIL )
      IF ! Empty( ::aFontName[i] )
         oCtrl:FontName := ::aFontName[i]
      ENDIF
      IF ::aFontSize[i] > 0
         oCtrl:FontSize := ::aFontSize[i]
      ENDIF
      oCtrl:FontColor := ::myIde:StrToColor( ::aFontColor[i] )
      oCtrl:BackColor := ::myIde:StrToColor( ::aBackColor[i] )

//TODO: ver como hacer para move y size

   CASE nControlType == TYPE_GRID
      aHeaders := ::StrToValueCtrl( ::aHeaders[i], "A", { "Head1", "Head2" }, 1, 0, "C" )
      FOR j := 1 TO Len( aHeaders )
         IF Empty( aHeaders[j] )
            aHeaders[j] := "Head" + LTrim( Str( j ) )
         ENDIF
      NEXT j
      aWidths  := ::StrToValueCtrl( ::aWidths[i], "A", { 60, 60 }, Len( aHeaders ), 0, "N" )
      FOR j := 1 TO Len( aHeaders )
         IF aWidths[j] <= 0
            aWidths[j] := 60
         ENDIF
      NEXT j
      aItems := { Array( Len( aHeaders ) ) }
      aItems[1, 1] := cName
      oCtrl := TGrid():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, nWidth, nHeight, aHeaders, aWidths, ;
                  aItems, 1, NIL, NIL, i18n( "Right click on items or headers to change properties and events or to move/size." ), ;
                  NIL, NIL, NIL, NIL, NIL, ::aNoLines[i], NIL, NIL, .F., NIL, ::aFontBold[i], ::aFontItalic[i], ;
                  ::aFontUnderline[i], ::aFontStrikeout[i], .F., NIL, NIL, .F., NIL, NIL, NIL, NIL, NIL, ::aRTL[i], .F., NIL, ;
                  .T., NIL, NIL, NIL, NIL, .F., .F., .F., ! ::aNoHeaders[i], NIL, NIL, NIL, .F., NIL,  NIL, ::aCheckBoxes[i], ;
                  NIL, .T., .T., ::aPLM[i], .T., NIL, NIL, .T., NIL, NIL, NIL, NIL, NIL, .F., .F., .F., NIL, NIL, NIL, .F., .F., ;
                  NIL, .F., .T., NIL, .F., .F., .F., .F., .F., .F., .F., .F., NIL, NIL, NIL, .T., NIL, NIL, .F., .F., .F., .F. )
      IF ! Empty( ::aFontName[i] )
         oCtrl:FontName := ::aFontName[i]
      ENDIF
      IF ::aFontSize[i] > 0
         oCtrl:FontSize := ::aFontSize[i]
      ENDIF
      oCtrl:FontColor   := ::myIde:StrToColor( ::aFontColor[i] )
      oCtrl:BackColor   := ::myIde:StrToColor( ::aBackColor[i] )
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }
      oCtrl:aHeadClick  := Array( Len( aHeaders ) )
      AFill( oCtrl:aHeadClick, { || ::DrawOutline( oCtrl ) } )
      oCtrl:bHeadRClick  := { || ::oDesignFormMenu:Activate() }
      oCtrl:OnRClick    := { || ::oDesignFormMenu:Activate() }

   CASE nControlType == TYPE_HOTKEYBOX
      oCtrl := TLabel():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, cName, nWidth, nHeight, NIL, NIL, ;
                  ::aFontBold[i], .F., .F., ;
                  .F., .F., .F., WHITE, NIL, NIL, ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), NIL, .F., ::aFontItalic[i], ;
                  ::aFontUnderline[i], ::aFontStrikeout[i], .F., .F., .F., ::aRTL[i], .F., .F., NIL, .F. )
      IF ! Empty( ::aFontName[i] )
         oCtrl:FontName := ::aFontName[i]
      ENDIF
      IF ::aFontSize[i] > 0
         oCtrl:FontSize := ::aFontSize[i]
      ENDIF
      oCtrl:FontColor  := ::myIde:StrToColor( ::aFontColor[i] )
      oCtrl:BackColor  := ::myIde:StrToColor( ::aBackColor[i] )
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_HYPERLINK
      oCtrl := THyperLink():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, ;
                  ::StrToValueCtrl( ::aValue[i], "C", cName ), ::StrToValueCtrl( ::aAddress[i], "C", "https://oohg.github.io/" ), ;
                  nWidth, nHeight, NIL, NIL, ::aFontBold[i], ::aBorder[i], ::aClientEdge[i], ::aHScroll[i], ::aVScroll[i], ;
                  ::aTransparent[i], NIL, NIL, ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), NIL, .F., ::aFontItalic[i], ;
                  ::aAutoSize[i], ::aHandCursor[i], ::aRTL[i] )
      IF ! Empty( ::aFontName[i] )
         oCtrl:FontName := ::aFontName[i]
      ENDIF
      IF ::aFontSize[i] > 0
         oCtrl:FontSize := ::aFontSize[i]
      ENDIF
      oCtrl:FontColor  := ::myIde:StrToColor( ::aFontColor[i] )
      oCtrl:BackColor  := ::myIde:StrToColor( ::aBackColor[i] )
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_IMAGE
      cPicture := ::StrToValueCtrl( ::aPicture[i], "C", NIL )
      IF Empty( cPicture ).OR. ! File( cPicture )
         cPicture := "ZZZ_AAAOOHG"
      ENDIF
      oCtrl := TImage():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, cPicture, nWidth, nHeight, NIL, ;
                  NIL, .F., ::aStretch[i], ::aWhiteBack[i], ::aRTL[i], NIL, NIL, NIL, ! ::aNoResize[i], ::aImageSize[i], ;
                  ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), ::aBorder[i], ::aClientEdge[i], ::aNoLoadTrans[i], ;
                  ::aNo3DColors[i], ::aNoDIBSection[i], ::aTransparent[i], NIL, .F., NIL, NIL, NIL, NIL, NIL, NIL, ;
                  ::aNoChkDepth[i],.F. )
      oCtrl:BackColor  := ::myIde:StrToColor( ::aBackColor[i] )
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_IPADDRESS
      oCtrl := TLabel():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, ;
                  ::StrToValueCtrl( ::aValue[i], "C", cName ), nWidth, nHeight, NIL, NIL, ::aFontBold[i], .F., .F., ;
                  .F., .F., .F., WHITE, NIL, NIL, ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), NIL, .F., ::aFontItalic[i], ;
                  ::aFontUnderline[i], ::aFontStrikeout[i], .F., .F., .F., ::aRTL[i], .F., .F., NIL, .F. )
      IF ! Empty( ::aFontName[i] )
         oCtrl:FontName := ::aFontName[i]
      ENDIF
      IF ::aFontSize[i] > 0
         oCtrl:FontSize := ::aFontSize[i]
      ENDIF
      oCtrl:FontColor  := ::myIde:StrToColor( ::aFontColor[i] )
      oCtrl:BackColor  := ::myIde:StrToColor( ::aBackColor[i] )
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_LABEL
      oCtrl := TLabel():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, ;
                  ::StrToValueCtrl( ::aValue[i], "C", cName ), nWidth, nHeight, NIL, NIL, ::aFontBold[i], ;
                  ::aBorder[i], ::aClientEdge[i], ;
                  ::aHScroll[i], ::aVScroll[i], ::aTransparent[i], NIL, NIL, NIL, ;
                  ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), NIL, .F., ::aFontItalic[i], ::aFontUnderline[i], ;
                  ::aFontStrikeout[i], ::aAutoSize[i], ::aRightAlign[i], ::aCenterAlign[i], ::aRTL[i], ::aNoWrap[i], ;
                  ::aNoPrefix[i], ::StrToValueCtrl( ::aInputMask[i], "C", NIL ), .F., ::aVCenter[i], NIL, ;
                  NIL, NIL, NIL, ::aAutoWidth[i], ::aAutoHeight[i] )
      IF ! Empty( ::aFontName[i] )
         oCtrl:FontName := ::aFontName[i]
      ENDIF
      IF ::aFontSize[i] > 0
         oCtrl:FontSize := ::aFontSize[i]
      ENDIF
      oCtrl:FontColor  := ::myIde:StrToColor( ::aFontColor[i] )
      oCtrl:BackColor  := ::myIde:StrToColor( ::aBackColor[i] )
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_LISTBOX
      IF NOTEMPTY( ::aImage[i] )
         IF Empty( aImages := ::StrToValueCtrl( ::aImage[i], "A", NIL, 1, 0, "C" ) )
            aImages := { "ZZZ_AAAOOHG" }
         ELSE
           FOR j := 1 to Len( aImages )
              IF ! File( aImages[j] )
                 aImages[j] := "ZZZ_AAAOOHG"
              ENDIF
           NEXT j
         ENDIF
      ELSE
         aImages := NIL
      ENDIF
      IF NOTEMPTY( ::aItems[i] )
         IF NOTEMPTY( ::aImage[i] )
            aItems := { { cName, 0 }, { "item2", 0 } }
         ELSE
            aItems := { cName, "item2" }
         ENDIF
         aItems := ::StrToValueCtrl( ::aItems[i], "A", aItems, 1, 0, "C" )
         FOR j := 1 to Len( aItems )
            IF Empty( aItems[j] )
               aItems[j] := cName
            ENDIF
         NEXT j
      ELSE
         aItems := { cName, "item2" }
      ENDIF
      IF ::aMultiSelect[i]
         oCtrl := TListMulti():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, nWidth, nHeight, aItems, NIL, ;
                     NIL, NIL, ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), NIL, NIL, NIL, NIL, .F., NIL, .F., .F., .F., ;
                     ::aFontBold[i], ::aFontItalic[i], ::aFontUnderline[i], ::aFontStrikeout[i], NIL, NIL, ::aRTL[i], .F., NIL, ;
                     aImages, ::StrToValueCtrl( ::aTextHeight[i], "N", NIL), ::aFit[i], ::aNoVScroll[i], ::aMultiCol[i], ;
                     ::StrToValueCtrl( ::aColWidth[i], "N", NIL), ::aMultiTab[i], .F., .F. )
      ELSE
         oCtrl := TList():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, nWidth, nHeight, aItems, NIL, ;
                     NIL, NIL, ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), NIL, NIL, NIL, NIL, .F., NIL, .F., .F., .F., ;
                     ::aFontBold[i], ::aFontItalic[i], ::aFontUnderline[i], ::aFontStrikeout[i], NIL, NIL, ::aRTL[i], .F., NIL, ;
                     aImages, ::StrToValueCtrl( ::aTextHeight[i], "N", NIL), ::aFit[i], ::aNoVScroll[i], ::aMultiCol[i], ;
                     ::StrToValueCtrl( ::aColWidth[i], "N", NIL), ::aMultiTab[i], .F., .F. )
      ENDIF
      IF ! Empty( ::aFontName[i] )
         oCtrl:FontName := ::aFontName[i]
      ENDIF
      IF ::aFontSize[i] > 0
         oCtrl:FontSize := ::aFontSize[i]
      ENDIF
      oCtrl:FontColor  := ::myIde:StrToColor( ::aFontColor[i] )
      oCtrl:BackColor  := ::myIde:StrToColor( ::aBackColor[i] )
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_MONTHCALENDAR
      IF ::aMultiSelect[i]
         oCtrl := TMonthCalMulti():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, nWidth, nHeight, ;
                     ::StrToValueCtrl( ::aValue[i], "D", Date() ), NIL, NIL, ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), ;
                     ::aNoToday[i], ::aNoTodayCircle[i], ::aWeekNumbers[i], NIL, NIL, .F., .F., ::aFontBold[i], ::aFontItalic[i], ;
                     ::aFontUnderline[i], ::aFontStrikeout[i], ::aRTL[i], .F., NIL, NIL, NIL, NIL, NIL, NIL, NIL, NIL, NIL )
      ELSE
         oCtrl := TMonthCal():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, nWidth, nHeight, ;
                     ::StrToValueCtrl( ::aValue[i], "D", Date() ), NIL, NIL, ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), ;
                     ::aNoToday[i], ::aNoTodayCircle[i], ::aWeekNumbers[i], NIL, NIL, .F., .F., ::aFontBold[i], ::aFontItalic[i], ;
                     ::aFontUnderline[i], ::aFontStrikeout[i], ::aRTL[i], .F., NIL, NIL, NIL, NIL, NIL, NIL, NIL, NIL, NIL )
      ENDIF
      IF ! Empty( ::aFontName[i] )
         oCtrl:FontName := ::aFontName[i]
      ENDIF
      IF ::aFontSize[i] > 0
         oCtrl:FontSize := ::aFontSize[i]
      ENDIF
      oCtrl:FontColor         := ::myIde:StrToColor( ::aFontColor[i] )
      oCtrl:BackColor         := ::myIde:StrToColor( ::aBackColor[i] )
      oCtrl:TitleFontColor    := ::myIde:StrToColor( ::aTitleFontClr[i] )
      oCtrl:TitleBackColor    := ::myIde:StrToColor( ::aTitleBackClr[i] )
      oCtrl:TrailingFontColor := ::myIde:StrToColor( ::aTrailFontClr[i] )
      oCtrl:OnClick           := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick        := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_PICBUTT
      cPicture := ::StrToValueCtrl( ::aPicture[i], "C", NIL )
      IF Empty( cPicture ).OR. ! File( cPicture )
         cPicture := "ZZZ_AAAOOHG"
      ENDIF
      oCtrl := TButton(): Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, NIL, NIL, ;
                                  nWidth, nHeight, NIL, NIL, ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), NIL, NIL, ;
                                  ::aFlat[i], .F., NIL, NIL, NIL, ;
                                  NIL, NIL, NIL, NIL, NIL, ;
                                  NIL, NIL, NIL, cPicture, ::aNoLoadTrans[i], ;
                                  ::aStretch[i], .F., ::StrToValueCtrl( ::aImageAlign[i], "C", NIL ), .F., ;
                                  iif( ::aDrawBy[i] == "OOHGDRAW", .T., iif( ::aDrawBy[i] == "WINDRAW", .F., NIL ) ), ;
                                  ::StrToValueCtrl( ::aImageMargin[i], "A", NIL, 4, 0, "N" ), NIL, ::aNo3DColors[i], ::aForceScale[i], ;
                                  ! ::aDIBSection[i], NIL, ::aNoHotLight[i], ::aSolid[i], NIL, ;
                                  NIL, NIL, NIL, NIL, ::aFitImg[i], ;
                                  ::aImageSize[i], ::aTransparent[i], ::aNoFocusRect[i], ::aNoImgList[i], .F., ;
                                  ::aHandCursor[i], .F. )
      IF ! Empty( ::aFontName[i] )
         oCtrl:FontName := ::aFontName[i]
      ENDIF
      IF ::aFontSize[i] > 0
         oCtrl:FontSize := ::aFontSize[i]
      ENDIF
      oCtrl:BackColor  := ::myIde:StrToColor( ::aBackColor[i] )
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_PICCHECKBUTT
      cPicture := ::StrToValueCtrl( ::aPicture[i], "C", NIL )
      IF Empty( cPicture ).OR. ! File( cPicture )
         cPicture := "ZZZ_AAAOOHG"
      ENDIF
      oCtrl := TButtonCheck():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, NIL, ;
                  ::StrToValueCtrl( ::aValue[i], "L", NIL ), NIL, NIL, ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), NIL, nWidth, ;
                  nHeight, NIL, NIL, NIL, .F., .F., .F., .F., .F., .F., NIL, .F., cPicture, NIL, NIL, ::aNoLoadTrans[i], ;
                  ::aStretch[i], ::aNo3DColors[i], ::aForceScale[i], ! ::aDIBSection[i], NIL, .F., ;
                  iif( ::aDrawBy[i] == "OOHGDRAW", .T., iif( ::aDrawBy[i] == "WINDRAW", .F., NIL ) ), ;
                  ::StrToValueCtrl( ::aImageMargin[i], "A", NIL, 4, 0, "N" ), NIL, ::StrToValueCtrl( ::aImageAlign[i], "C", NIL ), ;
                  .F., ::aFlat[i], ::aNoHotLight[i], ::aSolid[i], NIL, NIL, NIL, NIL, NIL, ::aFitImg[i], ::aImageSize[i], ;
                  ::aTransparent[i], ::aNoFocusRect[i], ::aNoImgList[i], .F., ::aHandCursor[i] )
      oCtrl:BackColor  := ::myIde:StrToColor( ::aBackColor[i] )
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_PICTURE
      cPicture := ::StrToValueCtrl( ::aPicture[i], "C", NIL )
      IF Empty( cPicture ).OR. ! File( cPicture )
         cPicture := "ZZZ_AAAOOHG"
      ENDIF
      oCtrl := TPicture():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, cPicture, nWidth, nHeight, NIL, ;
                  NIL, ::aStretch[i], ::aForceScale[i], ::aImageSize[i], ::aBorder[i], ::aClientEdge[i], NIL, NIL, ;
                  ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), NIL, ::aRTL[i], .F., ::aNoLoadTrans[i], ::aNo3DColors[i], ;
                  ::aNoDIBSection[i], ::aTransparent[i], NIL, .F. )
      oCtrl:BackColor  := ::myIde:StrToColor( ::aBackColor[i] )
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_PLAYER
       oCtrl := TLabel():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, cName, ;
                  nWidth, nHeight, NIL, NIL, .F., .F., .F., ;
                  .F., .F., .F., WHITE, NIL, NIL, NIL, NIL, .F., .F., .F., .F., .F., .F., .F., ;
                  ::aRTL[i], .F., .F., NIL, .F. )
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_PROGRESSBAR
      IF ( j := At( ",", ::aRange[i] ) ) > 0
         nMin := Val( SubStr( ::aRange[i], 1, j - 1 ) )
         nMax := Val( SubStr( ::aRange[i], j + 1 ) )
         IF nMin >= nMax
            /* Avoid RTE, use defaults */
            nMin := NIL
            nMax := NIL
         ENDIF
      ELSE
         nMin := NIL
         nMax := NIL
      ENDIF
      oCtrl := myTProgressBar():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, nWidth, nHeight, ;
                  nMin, nMax, ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), ::aVertical[i], ::aSmooth[i], NIL, .F., ;
                  NIL, NIL, NIL, ::aRTL[i], ::StrToValueCtrl( ::aMarquee[i], "N", NIL, 0 ) )
      oCtrl:FontColor  := ::myIde:StrToColor( ::aFontColor[i] )
      oCtrl:BackColor  := ::myIde:StrToColor( ::aBackColor[i] )
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_PROGRESSMETER
      IF ( j := At( ",", ::aRange[i] ) ) > 0
         nMin := Val( SubStr( ::aRange[i], 1, j - 1 ) )
         nMax := Val( SubStr( ::aRange[i], j + 1 ) )
         IF nMin >= nMax
            /* Avoid RTE, use defaults */
            nMin := NIL
            nMax := NIL
         ENDIF
      ELSE
         nMin := NIL
         nMax := NIL
      ENDIF
      oCtrl := TProgressMeter():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, nWidth, nHeight, nMin, ;
                  nMax, NIL, ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), NIL, NIL, ::aFontBold[i], ::aFontItalic[i], ;
                  ::aFontUnderline[i], ::aFontStrikeout[i], NIL, NIL, NIL, NIL, .F., ::aRTL[i], ::aClientEdge[i], .F. )
      IF ! Empty( ::aFontName[i] )
         oCtrl:FontName := ::aFontName[i]
      ENDIF
      IF ::aFontSize[i] > 0
         oCtrl:FontSize := ::aFontSize[i]
      ENDIF
      oCtrl:FontColor  := ::myIde:StrToColor( ::aFontColor[i] )
      oCtrl:BackColor  := ::myIde:StrToColor( ::aBackColor[i] )
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_RADIOGROUP
      IF NOTEMPTY( ::aOptions[i] )
         aItems := ::StrToValueCtrl( ::aOptions[i], "A", { cName, "item2" }, 1, 0, "C" )
         FOR j := 1 to Len( aItems )
            IF Empty( aItems[j] )
               aItems[j] := cName
            ENDIF
         NEXT j
      ELSE
         aItems := { cName, "item2" }
      ENDIF
      IF Empty( uRO := ::StrToValueCtrl( ::aReadOnlyArray[i], "A", NIL, 1, 0, "L" ) )
         uRO := ::StrToValueCtrl( ::aReadOnlyArray[i], "L", NIL )
      ENDIF
      oCtrl := myTRadioGroup():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, aItems, ;
                  ::StrToValueCtrl( ::aValue[i], "N", NIL ), NIL, NIL, ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), NIL, ;
                  ::StrToValueCtrl( ::aWidth[i], "N", NIL ), ::StrToValueCtrl( ::aSpacing[i], "N", NIL ), NIL, .F., .F., ;
                  ::aFontBold[i], ::aFontItalic[i], ::aFontUnderline[i], ::aFontStrikeout[i], NIL, NIL, ::aTransparent[i], ;
                  ::aAutoSize[i], ::aHorizontal[i], .F., ::aRTL[i], ::StrToValueCtrl( ::aHeight[i], "N", NIL ), ;
                  iif( ::aDrawBy[i] == "OOHGDRAW", .T., iif( ::aDrawBy[i] == "WINDRAW", .F., NIL ) ), ;
                  NIL, ::aLeftJust[i], uRO, ::aNoFocusRect[i], ::StrToValueCtrl( ::aLimit[i], "N", NIL ), ;
                  ::StrToValueCtrl( ::aShift[i], "N", NIL ) )
      IF ! Empty( ::aFontName[i] )
         oCtrl:FontName := ::aFontName[i]
      ENDIF
      IF ::aFontSize[i] > 0
         oCtrl:FontSize := ::aFontSize[i]
      ENDIF
      oCtrl:FontColor  := ::myIde:StrToColor( ::aFontColor[i] )
      oCtrl:BackColor  := ::myIde:StrToColor( ::aBackColor[i] )
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_RICHEDITBOX
      oCtrl := TEditRich():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, nWidth, nHeight, ;
                  ::StrToValueCtrl( ::aValue[i], "N", cName ), NIL, NIL, ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), ;
                  ::StrToValueCtrl( ::aMaxLength[i], "N", NIL ), NIL, NIL, NIL, .T., .F., NIL, .F., .F., ;
                  ::aFontBold[i], ::aFontItalic[i], ::aFontUnderline[i], ::aFontStrikeout[i], NIL, NIL, ::aRTL[i], .F., NIL, NIL, ;
                  ::aNoHideSel[i], ::StrToValueCtrl( ::aFocusedPos[i], "N", NIL ), ::aNoVScroll[i], ::aNoHScroll[i], NIL, ;
                  iif( ::aPlainText[i], 1, ::StrToValueCtrl( ::aFileType[i], "N", NIL ) ), NIL, NIL, NIL, NIL )
      IF ! Empty( ::aFontName[i] )
         oCtrl:FontName := ::aFontName[i]
      ENDIF
      IF ::aFontSize[i] > 0
         oCtrl:FontSize := ::aFontSize[i]
      ENDIF
      oCtrl:FontColor  := ::myIde:StrToColor( ::aFontColor[i] )
      oCtrl:BackColor  := ::myIde:StrToColor( ::aBackColor[i] )
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_SCROLLBAR
      oCtrl := TScrollBar():Define( cName, ::oDesignForm:Name, ;
                  _OOHG_MouseCol, _OOHG_MouseRow, nWidth, nHeight, NIL, NIL, NIL, NIL, NIL, NIL, NIL, NIL, ;
                  NIL, NIL, NIL, NIL, NIL, .F., ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), ::aRTL[i], ;
                  iif( ::aHorizontal[i], 0, iif( ::aVertical[i], 1, NIL ) ), .F., NIL, .F., NIL, NIL, .F. )
      oCtrl:ContextMenu := ::oDesignFormMenu
      oCtrl:OnLineUp    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnLineDown  := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnPageUp    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnPageDown  := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnTop       := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnBottom    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnThumb     := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnTrack     := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnEndTrack  := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick  := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_SLIDER
      IF ( j := At( ",", ::aRange[i] ) ) > 0
         nMin := Val( SubStr( ::aRange[i], 1, j - 1 ) )
         nMax := Val( SubStr( ::aRange[i], j + 1 ) )
         IF nMin >= nMax
            nMin := NIL
            nMax := NIL
         ENDIF
      ELSE
         nMin := NIL
         nMax := NIL
      ENDIF
      oCtrl := TSlider():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, nWidth, nHeight, nMin, nMax, ;
                  NIL, ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), NIL, ::aVertical[i], ::aNoTicks[i], ;
                  ::aBoth[i], ::aTop[i], ::aLeft[i], NIL, .F., ;
                  .F., NIL, ::aRTL[i], .F. )
      oCtrl:BackColor  := ::myIde:StrToColor( ::aBackColor[i] )
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_SPINNER
      IF ( j := At( ",", ::aRange[i] ) ) > 0
         nMin := Val( SubStr( ::aRange[i], 1, j - 1 ) )
         nMax := Val( SubStr( ::aRange[i], j + 1 ) )
         IF nMin >= nMax
            nMin := NIL
            nMax := NIL
         ENDIF
      ELSE
         nMin := NIL
         nMax := NIL
      ENDIF
      oCtrl := TSpinner():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, nWidth, NIL, NIL, NIL, nMin, nMax, ;
                  ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), NIL, NIL, NIL, nHeight, NIL, .F., .F., ::aFontBold[i], ;
                  ::aFontItalic[i], ::aFontUnderline[i], ::aFontStrikeout[i], ::aWrap[i], ::aReadOnly[i], ;
                  ::StrToValueCtrl( ::aIncrement[i], "N", NIL ), NIL, NIL, ::aRTL[i], ::aNoBorder[i], .F., ::aBoundText[i] )
      IF ! Empty( ::aFontName[i] )
         oCtrl:FontName := ::aFontName[i]
      ENDIF
      IF ::aFontSize[i] > 0
         oCtrl:FontSize := ::aFontSize[i]
      ENDIF
      oCtrl:FontColor   := ::myIde:StrToColor( ::aFontColor[i] )
      oCtrl:BackColor   := ::myIde:StrToColor( ::aBackColor[i] )
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick  := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_TAB
      oCtrl := TTab():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, nWidth, nHeight, {}, {}, ;
                  NIL, NIL, NIL, i18n( "Right click on header area to change properties and events or to move/size." ), NIL, ;
                  ::aButtons[i], ::aFlat[i], ::aHotTrack[i], ::aVertical[i], .F., NIL, ::aFontBold[i], ::aFontItalic[i], ;
                  ::aFontUnderline[i], ::aFontStrikeout[i], {}, ::aRTL[i], ::aInternals[i], .F., .F., ::aMultiLine[i], .F., ;
                  ::aRightAlign[i], ::aBottomAlign[i], NIL, ::aRaggedRight[i], ::aFixedWidths[i], NIL, NIL, NIL, NIL, NIL, ;
                  NIL, NIL, ::aIconLeft[i], ::aLabelLeft[i], ::aRightJust[i], ::aScrollOp[i], NIL, NIL )
         /* Add pages and controls */
         aCaptions := AClone( ::aCaption[i] )
         nCnt      := Len( aCaptions )
         aImages   := AClone( ::aImage[i] )
         FOR j := 1 TO nCnt
            IF Type( aCaptions[j] ) == "C"
               aCaptions[j] := &( aCaptions[j] )
            ELSE
               aCaptions[j] := "Page " + LTrim( Str( j ) )
            ENDIF
            IF Type( aImages[j] ) == "C"
               IF ! Empty( aImages[j] ) .AND. ! File( aImages[j] )
                  aImages[j] := "ZZZ_AAAOOHG"
               ENDIF
            ELSEIF Empty( aImages[j] )
               aImages[j] := ""
            ELSE
               aImages[j] := "ZZZ_AAAOOHG"
            ENDIF
            /* DEFINE PAGE */
            oPage := _BeginTabPage( aCaptions[j], aImages[j] )
            END PAGE
            IF aCtrls # NIL
               aEval( aCtrls[j], { |c| oPage:AddControl( c, c:Row, c:Col ) } )
            ENDIF
         NEXT j
      END TAB
      IF ! Empty( ::aFontName[i] )
         oCtrl:FontName := ::aFontName[i]
      ENDIF
      IF ::aFontSize[i] > 0
         oCtrl:FontSize := ::aFontSize[i]
      ENDIF
      oCtrl:FontColor := ::myIde:StrToColor( ::aFontColor[i] )
      /* This works for the tabs area only because the control does not respond to clicks on the display area */
      oCtrl:OnClick   := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnRClick  := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_TEXTARRAY
      oCtrl := TLabel():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, cName, nWidth, nHeight, NIL, NIL, ;
                  ::aFontBold[i], ::aBorder[i], ::aClientEdge[i], ;
                  .F.,.F., .F., WHITE, NIL, NIL, ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), NIL, .F., ::aFontItalic[i], ;
                  ::aFontUnderline[i], ::aFontStrikeout[i], .F., .F., .F., ::aRTL[i], .F., .F., NIL, .F. )
      IF ! Empty( ::aFontName[i] )
         oCtrl:FontName := ::aFontName[i]
      ENDIF
      IF ::aFontSize[i] > 0
         oCtrl:FontSize := ::aFontSize[i]
      ENDIF
      IF ( j := ::myIde:StrToColor( ::aBackColor[i] ) ) == NIL
         j := GetSysColor( COLOR_3DFACE )
      ENDIF
      oCtrl:BackColor  := j
      oCtrl:FontColor  := ::myIde:StrToColor( ::aFontColor[i] )
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_TEXTBOX
      IF NOTEMPTY( ::aImage[i] )
         IF Empty( aImages := ::StrToValueCtrl( ::aImage[i], "A", NIL, 1, 0, "C" ) )
            aImages := { "ZZZ_AAAOOHG", "ZZZ_AAAOOHG" }
         ELSE
           FOR j := 1 to Len( aImages )
              IF ! File( aImages[j] )
                 aImages[j] := "ZZZ_AAAOOHG"
              ENDIF
           NEXT j
         ENDIF
      ELSE
         aImages := NIL
      ENDIF

      cFormat := ::StrToValueCtrl( ::aFormat[i], "C", NIL )
      IF ! IsFormatValid( cFormat )
         cFormat := ""
      ENDIF

      oCtrl := DefineTextBox( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, nWidth, nHeight, NIL, NIL, ;
                  NIL, ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), ::StrToValueCtrl( ::aMaxLength[i], "N", NIL ), ;
                  ::aUpperCase[i], ::aLowerCase[i], ::aPassword[i], NIL, NIL, NIL, NIL, ::aRightAlign[i], NIL, ;
                  ::aReadOnly[i], ::aFontBold[i], ::aFontItalic[i], ::aFontUnderline[i], ::aFontStrikeout[i], NIL, ;
                  NIL, NIL, .F., .F., ::aRTL[i], ::aAutoSkip[i], ::aNoBorder[i], ::StrToValueCtrl( ::aFocusedPos[i], "N", NIL ), ;
                  .F., NIL, ::aDate[i], ::aNumeric[i], ::StrToValueCtrl( ::aInputMask[i], "C", NIL ), ;
                  cFormat, NIL, NIL, aImages, ;
                  ::StrToValueCtrl( ::aButtonWidth[i], "N", NIL ), NIL, NIL, ::aCenterAlign[i], ;
                  ::aDefaultYear[i], NIL, ::StrToValueCtrl( ::aInsertType[i], "N", NIL ), ::aCtrlsLeft[i], .F., NIL, NIL )
      IF ! Empty( ::aFontName[i] )
         oCtrl:FontName := ::aFontName[i]
      ENDIF
      IF ::aFontSize[i] > 0
         oCtrl:FontSize := ::aFontSize[i]
      ENDIF
      oCtrl:FontColor   := ::myIde:StrToColor( ::aFontColor[i] )
      oCtrl:BackColor   := ::myIde:StrToColor( ::aBackColor[i] )
      oCtrl:OnClick     := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick  := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_TIMEPICKER
      oCtrl := TTimePick():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, nWidth, nHeight, NIL, NIL, ;
                  NIL, ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), NIL, NIL, NIL, ::aShowNone[i], .T., .F., NIL, .F., .F., ;
                  ::aFontBold[i], ::aFontItalic[i], ::aFontUnderline[i], ::aFontStrikeout[i], NIL, NIL, ::aRTL[i], .F., ;
                  ::aNoBorder[i], ::aFormat[i] )
      IF ! Empty( ::aFontName[i] )
         oCtrl:FontName := ::aFontName[i]
      ENDIF
      IF ::aFontSize[i] > 0
         oCtrl:FontSize := ::aFontSize[i]
      ENDIF
      oCtrl:FontColor  := ::myIde:StrToColor( ::aFontColor[i] )
      oCtrl:BackColor  := ::myIde:StrToColor( ::aBackColor[i] )
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_TIMER
      oCtrl := TLabel():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, cName, nWidth, nHeight, ;
                  NIL, NIL, .F., .F., .F., ;
                  .F., .F., .F., WHITE, NIL, NIL, ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), NIL, .F., ;
                  .F., .F., .F., .F., .F., .F., .F., .F., .F., NIL, .F., .F. )
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_TREE
      oCtrl := TTree():Define( cName, ::oDesignForm:Name, _OOHG_MouseRow, _OOHG_MouseCol, nWidth, nHeight, NIL, ;
                  ::StrToValueCtrl( ::aToolTip[i], "C", NIL ), NIL, NIL, NIL, NIL, NIL, .F., NIL, NIL, NIL, NIL, ;
                  ::aNoRootButton[i], ::aFontBold[i], ::aFontItalic[i],  ::aFontUnderline[i], ::aFontStrikeout[i], ;
                  .F., ::aRTL[i], NIL, .F., .F., .F., NIL, NIL, ::aFullRowSelect[i], ::aCheckBoxes[i], ::aEditLabels[i], ;
                  ::aNoHScroll[i], ::aNoVScroll[i], ::aHotTrack[i], ::aNoLines[i], ::aNoButtons[i], .F., ::aSingleExpand[i], ;
                  ::aNoBorder[i], ::myIde:StrToColor( ::aSelColor[i] ),NIL, NIL, NIL, ::StrToValueCtrl( ::aIndent[i], "N", NIL ), ;
                  ::aSelBold[i], .F., NIL, NIL, NIL )
         NODE "Tree"
         END NODE
         NODE "Nodes"
         END NODE
      END TREE
      IF ! Empty( ::aFontName[i] )
         oCtrl:FontName := ::aFontName[i]
      ENDIF
      IF ::aFontSize[i] > 0
         oCtrl:FontSize := ::aFontSize[i]
      ENDIF
      oCtrl:FontColor  := ::myIde:StrToColor( ::aFontColor[i] )
      oCtrl:BackColor  := ::myIde:StrToColor( ::aBackColor[i] )
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }

   CASE nControlType == TYPE_XBROWSE
      aHeaders := ::StrToValueCtrl( ::aHeaders[i], "A", { "Head1", "Head2" }, 1, 0, "C" )
      FOR j := 1 TO Len( aHeaders )
         IF Empty( aHeaders[j] )
            aHeaders[j] := "Head" + LTrim( Str( j ) )
         ENDIF
      NEXT j
      aWidths  := ::StrToValueCtrl( ::aWidths[i], "A", { 60, 60 }, Len( aHeaders ), 0, "N" )
      FOR j := 1 TO Len( aHeaders )
         IF aWidths[j] <= 0
            aWidths[j] := 60
         ENDIF
      NEXT j
      aItems := { Array( Len( aHeaders ) ) }
      aItems[1, 1] := cName
      oCtrl := TGrid():Define( cName, ::oDesignForm:Name, _OOHG_MouseCol, _OOHG_MouseRow, nWidth, nHeight, aHeaders, aWidths, ;
                  aItems, 1, NIL, NIL, i18n( "Right click on items or headers to change properties and events or to move/size." ), ;
                  NIL, NIL, NIL, NIL, NIL, ::aNoLines[i], NIL, NIL, .F., NIL, ::aFontBold[i], ::aFontItalic[i], ;
                  ::aFontUnderline[i], ::aFontStrikeout[i], .F., NIL, NIL, .F., NIL, NIL, NIL, NIL, NIL, ::aRTL[i], .F., NIL, ;
                  .T., NIL, NIL, NIL, NIL, .F., .F., .F., ! ::aNoHeaders[i], NIL, NIL, NIL, .F., NIL,  NIL, ::aCheckBoxes[i], ;
                  NIL, .T., .T., ::aPLM[i], .T., NIL, NIL, .T., NIL, NIL, NIL, NIL, NIL, .F., .F., .F., NIL, NIL, NIL, .F., .F., ;
                  NIL, .F., .T., NIL, .F., .F., .F., .F., .F., .F., .F., .F., NIL, NIL, NIL, .T., NIL, NIL, .F., .F., .F., .F. )
      IF ! Empty( ::aFontName[i] )
         oCtrl:FontName := ::aFontName[i]
      ENDIF
      IF ::aFontSize[i] > 0
         oCtrl:FontSize := ::aFontSize[i]
      ENDIF
      oCtrl:FontColor  := ::myIde:StrToColor( ::aFontColor[i] )
      oCtrl:BackColor  := ::myIde:StrToColor( ::aBackColor[i] )
      oCtrl:OnClick    := { || ::DrawOutline( oCtrl ) }
      oCtrl:OnDblClick := { || ::DrawOutline( oCtrl ), ::PropertiesClick() }
      oCtrl:aHeadClick  := Array( Len( aHeaders ) )
      AFill( oCtrl:aHeadClick, { || ::DrawOutline( oCtrl ) } )
      oCtrl:bHeadRClick  := { || ::oDesignFormMenu:Activate() }
      oCtrl:OnRClick    := { || ::oDesignFormMenu:Activate() }

   ENDCASE

   IF lRed
      ::oDesignForm:SetRedraw( .T. )
   ENDIF

   RETURN oCtrl

/*--------------------------------------------------------------------------------------------------------------------------------*/
STATIC FUNCTION IsFormatValid( cFormat )

   LOCAL lResult, nPos

   IF Empty( cFormat )
      lResult := .T.
   ELSEIF Left( cFormat, 1 ) == "@"
      lResult := .F.
   ELSEIF " " $ cFormat
      lResult := .F.
   ELSE
      cFormat := Upper( cFormat )

      DO WHILE "S" $ cFormat
         nPos := At( "S", cFormat )
         cFormat := Left( cFormat, nPos - 1 ) + SubStr( cFormat, nPos + 1 )
         DO WHILE Len( cFormat ) >= nPos .AND. SubStr( cFormat, nPos, 1 ) $ "0123456789"
            cFormat := Left( cFormat, nPos - 1 ) + SubStr( cFormat, nPos + 1 )
         ENDDO
      ENDDO

      IF "A" $ cFormat
         cFormat := StrTran( cFormat, "A", "" )
      ENDIF

      IF "2" $ cFormat
         cFormat := StrTran( cFormat, "2", "" )
      ENDIF

      IF "4" $ cFormat
         cFormat := StrTran( cFormat, "4", "" )
      ENDIF

      IF "C" $ cFormat
         cFormat := StrTran( cFormat, "C", "" )
      ENDIF

      IF "D" $ cFormat
         cFormat := StrTran( cFormat, "D", "" )
      ENDIF

      IF "E" $ cFormat
         cFormat := StrTran( cFormat, "E", "" )
      ENDIF

      IF "K" $ cFormat
         cFormat := StrTran( cFormat, "K", "" )
      ENDIF

      IF "R" $ cFormat
         cFormat := StrTran( cFormat, "R", "" )
      ENDIF

      IF "X" $ cFormat
         cFormat := StrTran( cFormat, "X", "" )
      ENDIF

      IF "Z" $ cFormat
         cFormat := StrTran( cFormat, "Z", "" )
      ENDIF

      IF "(" $ cFormat
         cFormat := StrTran( cFormat, "(", "" )
      ENDIF

      IF ")" $ cFormat
         cFormat := StrTran( cFormat, ")", "" )
      ENDIF

      IF "!" $ cFormat
         cFormat := StrTran( cFormat, "!", "" )
      ENDIF

      lResult := Empty( cFormat )
   ENDIF

   RETURN lResult

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD DrawOutline( oControl, lNoRefresh, lNoErase ) CLASS TFormEditor

   LOCAL i, y, x, y1, x1, cTab, bAux, w, h

   STATIC lBusy := .F.
   IF lBusy
      RETURN NIL
   ENDIF
   lBusy := .T.

// TODO: tiene que redibujar el outline de todos los seleccionados cuando se hizo move

   IF ( i := AScan( ::aControlW, Lower( oControl:Name ) ) ) > 0
      /* Ensure that the container's page is selected */
      DO WHILE ! Empty( ::aTabPage[i, 1] ) .AND. ::aTabPage[i, 2] > 0
         cTab := ::aTabPage[i, 1]
         bAux := ::oDesignForm:&cTab:OnChange
         ::oDesignForm:&cTab:OnChange := NIL
         ::oDesignForm:&cTab:Value := ::aTabPage[i, 2]
         ::oDesignForm:&cTab:OnChange := bAux
         /* If it's inside another TAB then loop */
         IF ( i := AScan( ::aControlW, Lower( ::oDesignForm:&cTab:Name ) ) ) <= 0
            EXIT
         ENDIF
      ENDDO

      IF lNoErase == NIL .OR. ! lNoErase
         EraseWindow( ::oDesignForm:Name )
         ::DrawPoints()
      ENDIF

      y := oControl:ContainerRow
      x := oControl:ContainerCol
      IF oControl:Type == "RADIOGROUP"
         h := oControl:GroupHeight
         w := oControl:GroupWidth
      ELSE
         h := oControl:Height
         w := oControl:Width
      ENDIF
      y1 := oControl:ContainerRow + h
      x1 := oControl:ContainerCol + w

      DRAW RECTANGLE IN WINDOW ( ::oDesignForm:Name ) ;
         AT oControl:ContainerRow - 10, oControl:ContainerCol - 10 ;
         TO oControl:ContainerRow, oControl:ContainerCol ;
         PENCOLOR { 255, 0, 0 } ;
         FILLCOLOR { 255, 0, 0 }

      DRAW RECTANGLE IN WINDOW ( ::oDesignForm:Name ) ;
         AT y1 + 1, x1 + 1 ;
         TO y1 + 6, x1 + 6 ;
         PENCOLOR { 255, 0, 0 } ;
         FILLCOLOR { 255, 0, 0 }

      DRAW LINE IN WINDOW ( ::oDesignForm:Name ) ;
         AT y - 1, x - 1 ;
         TO y - 1 + h + 1, x - 1 ;
         PENCOLOR { 255, 0, 0 }

      DRAW LINE IN WINDOW ( ::oDesignForm:Name ) ;
         AT y - 1, x - 1 ;
         TO y - 1, x - 1 + w + 1 ;
         PENCOLOR { 255, 0, 0 }

      DRAW LINE IN WINDOW ( ::oDesignForm:Name ) ;
         AT y - 1 + h + 1, x - 1 ;
         TO y1, x1 + 1 ;
         PENCOLOR { 255, 0, 0 }

      DRAW LINE IN WINDOW ( ::oDesignForm:Name ) ;
         AT y - 1, x - 1 + w + 1 ;
         TO y1 + 1, x1 ;
         PENCOLOR { 255, 0, 0 }

// TODO: solo tiene que dibujar, no refresh, no erase, debe ser llamado desde el on change del control inspector y no al revs
      ::Form_Main:frame_3:Caption := "Control: " + oControl:Name
      ::Form_Main:lbl_Position:Value := " " + i18n( "r:" ) + AllTrim( Str( oControl:Row, 4 ) ) + ;
                                        " " + i18n( "c:" ) + AllTrim( Str( oControl:Col, 4 ) ) + ;
                                        " " + i18n( "w:" ) + AllTrim( Str( w, 4 ) ) + ;
                                        " " + i18n( "h:" ) + AllTrim( Str( h, 4 ) ) + " "

      IF lNoRefresh == NIL .OR. ! lNoRefresh
         ::RefreshControlInspector( oControl:Name )
      ENDIF
   ELSE
      IF lNoErase == NIL .OR. ! lNoErase
         EraseWindow( ::oDesignForm:Name )
         ::DrawPoints()
      ENDIF

      ::nIndexW := 0
      ::Form_Main:frame_3:Caption := "Control: "
      ::Form_Main:lbl_Position:Value:= " " + i18n( "r:" ) + "     " + i18n( "c:" ) + "     " + i18n( "w:" ) + "     " + i18n( "h:" ) + "     "

      IF lNoRefresh == NIL .OR. ! lNoRefresh
         ::RefreshControlInspector()
      ENDIF
      ::oCtrlList:Value := {}
   ENDIF

   lBusy := .F.

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD EditProperties( aParams ) CLASS TFormEditor

   LOCAL ia

   IF HB_ISARRAY( aParams ) .AND. Len( aParams ) > 0 .AND. aParams[1] > 0
      IF ( ia := AScan( ::oDesignForm:aControls, { |c| Lower( c:Name ) == ::oCtrlList:Cell( aParams[1], 6 ) } ) ) > 0
         ::DrawOutline( ::oDesignForm:aControls[ia] )
         ::PropertiesClick()
      ENDIF
   ELSE
      IF ( ia := ::FirstCtrl() ) > 0
         ::DrawOutline( ::oDesignForm:aControls[ia] )
         ::PropertiesClick()
      ENDIF
   ENDIF

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD ManualMoveSize( nOption ) CLASS TFormEditor

   LOCAL aFormats, aInitValues, aLabels, aResults, cMsg, cTitle, ia, lChanged, nCol, nHeight, nRow, nWidth, oControl

   lChanged := .F.
   IF nOption == 1
      IF ::nControlW == 1
         RETURN NIL
      ENDIF
      IF ( ia := ::FirstCtrl() ) > 0
         oControl    := ::oDesignForm:aControls[ia]
         nRow        := oControl:Row
         nCol        := oControl:Col
         nWidth      := oControl:Width
         nHeight     := oControl:Height
         cTitle      := DQM( ::cFName + ".fmg" ) + i18n( " - Manual Move/Size of Control " ) + Lower( oControl:Name )
         aLabels     := { i18n( "Row" ), i18n( "Col" ), i18n( "Width" ), i18n( "Height" ) }
         aInitValues := { nRow, nCol, nWidth, nHeight }
         aFormats    := { "9999", "9999", "9999", "9999" }
         aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
         IF aResults[1] == NIL
            oControl:SetFocus()
            RETURN NIL
         ENDIF
         IF aResults[1] >= 0
            lChanged := .T.
            oControl:Row := aResults[1]
         ENDIF
         IF aResults[2] >= 0
            lChanged := .T.
            oControl:Col := aResults[2]
         ENDIF
         IF ! ::CtrlIsOfType( ia, " MONTHCALENDAR TIMER " )
            IF aResults[3] >= 0
               lChanged := .T.
               oControl:Width  := aResults[3]
            ENDIF
            IF aResults[4] >= 0
               lChanged := .T.
               oControl:Height := aResults[4]
            ENDIF
         ENDIF
         IF lChanged
            ::Snap( oControl )
            ::DrawOutline( oControl )
            ::lIsFormModified := .T.
         ENDIF
      ENDIF
   ELSE
      nRow := ::oDesignForm:Row
      nCol := ::oDesignForm:Col
      IF ::lFClientArea
         nWidth  := ::oDesignForm:ClientWidth
         nHeight := ::oDesignForm:ClientHeight
      ELSE
         nWidth  := ::oDesignForm:Width
         nHeight := ::oDesignForm:Height
      ENDIF
      cTitle      := DQM( ::cFName + ".fmg" ) + i18n( " - Manual Move/Size of Form" )
      aLabels     := { i18n( "Row" ), i18n( "Col" ), i18n( "Width" ), i18n( "Height" ) }
      aInitValues := { nRow, nCol, nWidth, nHeight }
      aFormats    := { "9999", "9999", "9999", "9999" }
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         ::oDesignForm:SetFocus()
         RETURN NIL
      ENDIF
      IF aResults[1] >= 0
         ::oDesignForm:Row := aResults[1]
         IF Type( ::cFPosition[1] ) == "N"
            ::cFPosition[1] := LTrim( Str( aResults[1] ) )
            lChanged := .T.
         ELSE
            IF MsgYesNo( i18n( "Form's ROW is set to: " ) + ::cFPosition[1] + CRLF + i18n( "Select [Yes] to overwrite." ), "OOHG IDE+" )
               ::cFPosition[1] := LTrim( Str( aResults[1] ) )
               lChanged := .T.
            ENDIF
         ENDIF
      ENDIF
      IF aResults[2] >= 0
         ::oDesignForm:Col := aResults[2]
         IF Type( ::cFPosition[2] ) == "N"
            ::cFPosition[2] := LTrim( Str( aResults[2] ) )
            lChanged := .T.
         ELSE
            IF MsgYesNo( i18n( "Form's COL is set to: " ) + ::cFPosition[2] + CRLF + i18n( "Select [Yes] to overwrite." ), "OOHG IDE+" )
               ::cFPosition[2] := LTrim( Str( aResults[2] ) )
               lChanged := .T.
            ENDIF
         ENDIF
      ENDIF
      IF aResults[3] >= 0
         IF ::lFClientArea
            ::oDesignForm:ClientWidth := aResults[3]
            cMsg := i18n( "Form's CLIENTWIDTH is set to: " )
         ELSE
            ::oDesignForm:Width := aResults[3]
            cMsg := i18n( "Form's WIDTH is set to: " )
         ENDIF
         IF Type( ::cFWidth ) == "N"
            ::cFWidth := LTrim( Str( aResults[3] ) )
            lChanged := .T.
         ELSE
            IF MsgYesNo( cMsg + ::cFWidth + CRLF + i18n( "Select [Yes] to overwrite." ), "OOHG IDE+" )
               ::cFWidth := LTrim( Str( aResults[3] ) )
               lChanged := .T.
            ENDIF
         ENDIF
      ENDIF
      IF aResults[4] >= 0
         IF ::lFClientArea
            ::oDesignForm:ClientHeight := aResults[4]
            cMsg := i18n( "Form's CLIENTHEIGHT is set to: " )
         ELSE
            ::oDesignForm:Height := aResults[4]
            cMsg := i18n( "Form's HEIGHT is set to: " )
         ENDIF
         IF Type( ::cFHeight ) == "N"
            ::cFHeight := LTrim( Str( aResults[4] ) )
            lChanged := .T.
         ELSE
            IF MsgYesNo( cMsg + ::cFHeight + CRLF + i18n( "Select [Yes] to overwrite." ), "OOHG IDE+" )
               ::cFHeight := LTrim( Str( aResults[4] ) )
               lChanged := .T.
            ENDIF
         ENDIF
      ENDIF
      IF lChanged
         ::lIsFormModified := .T.
      ENDIF
      ::oDesignForm:SetFocus()
   ENDIF

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD FrmMoved CLASS TFormEditor

   IF ::myIde:lSavePosOnDrag
      ::lIsFormModified := .T.
      ::cFPosition[1] := LTrim( Str( ::oDesignForm:Row ) )
      ::cFPosition[2] := LTrim( Str( ::oDesignForm:Col ) )
   ENDIF

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD FrmSized CLASS TFormEditor

   IF ::myIde:lSaveSizeOnRed
      ::lIsFormModified := .T.
      IF ::lFClientArea
         ::cFWidth := LTrim( Str( ::oDesignForm:ClientWidth ) )
      ELSE
         ::cFWidth := LTrim( Str( ::oDesignForm:Width ) )
      ENDIF
      IF ::lFClientArea
         ::cFHeight := LTrim( Str( ::oDesignForm:ClientHeight ) )
      ELSE
         ::cFHeight := LTrim( Str( ::oDesignForm:Height ) )
      ENDIF
   ENDIF

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD KeyboardMoveSize() CLASS TFormEditor

   IF ::FirstCtrl() == 0
      MsgStop( i18n( "No control is selected." ), "OOHG IDE+" )
      RETURN NIL
   ENDIF
   IF ::nControlW == 1
      RETURN NIL
   ENDIF

   ON KEY LEFT   OF ( ::oDesignForm:Name ) ACTION ::KeyHandler( "L" )
   ON KEY RIGHT  OF ( ::oDesignForm:Name ) ACTION ::KeyHandler( "R" )
   ON KEY UP     OF ( ::oDesignForm:Name ) ACTION ::KeyHandler( "U" )
   ON KEY DOWN   OF ( ::oDesignForm:Name ) ACTION ::KeyHandler( "D" )
   ON KEY ESCAPE OF ( ::oDesignForm:Name ) ACTION ::KeyHandler( "E" )

   IF ::myIde:lCtrlSizes
      ON KEY CTRL+LEFT  OF ( ::oDesignForm:Name ) ACTION ::KeyHandler( "W-" )
      ON KEY CTRL+RIGHT OF ( ::oDesignForm:Name ) ACTION ::KeyHandler( "W+" )
      ON KEY CTRL+UP    OF ( ::oDesignForm:Name ) ACTION ::KeyHandler( "H-" )
      ON KEY CTRL+DOWN  OF ( ::oDesignForm:Name ) ACTION ::KeyHandler( "H+" )

      ON KEY ALT+LEFT  OF ( ::oDesignForm:Name ) ACTION ::KeyHandler( "LJ" )
      ON KEY ALT+RIGHT OF ( ::oDesignForm:Name ) ACTION ::KeyHandler( "RJ" )
      ON KEY ALT+UP    OF ( ::oDesignForm:Name ) ACTION ::KeyHandler( "UJ" )
      ON KEY ALT+DOWN  OF ( ::oDesignForm:Name ) ACTION ::KeyHandler( "DJ" )
   ELSE
      ON KEY ALT+LEFT  OF ( ::oDesignForm:Name ) ACTION ::KeyHandler( "W-" )
      ON KEY ALT+RIGHT OF ( ::oDesignForm:Name ) ACTION ::KeyHandler( "W+" )
      ON KEY ALT+UP    OF ( ::oDesignForm:Name ) ACTION ::KeyHandler( "H-" )
      ON KEY ALT+DOWN  OF ( ::oDesignForm:Name ) ACTION ::KeyHandler( "H+" )

      ON KEY CTRL+LEFT  OF ( ::oDesignForm:Name ) ACTION ::KeyHandler( "LJ" )
      ON KEY CTRL+RIGHT OF ( ::oDesignForm:Name ) ACTION ::KeyHandler( "RJ" )
      ON KEY CTRL+UP    OF ( ::oDesignForm:Name ) ACTION ::KeyHandler( "UJ" )
      ON KEY CTRL+DOWN  OF ( ::oDesignForm:Name ) ACTION ::KeyHandler( "DJ" )
   ENDIF

   IF _IsControlDefined( "Statusbar", ::oDesignForm:Name )
      ::oDesignForm:Statusbar:Release()
   ENDIF
   DEFINE STATUSBAR OF ( ::oDesignForm:Name )
      STATUSITEM ""
   END STATUSBAR
   ::KeyHandler( "" )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD KeyHandler( cPar ) CLASS TFormEditor

   LOCAL ia, nR, nC, oControl

   IF ( ia := ::FirstCtrl() ) > 0
      oControl := ::oDesignForm:aControls[ia]
      nR       := oControl:Row + GetWindowRow( ::oDesignForm:hWnd ) + GetTitleHeight() + ( GetBorderHeight() * 2 ) + 18
      nC       := oControl:Col + GetWindowCol( ::oDesignForm:hWnd ) + GetBorderWidth() + ( oControl:Width / 2 )
      SetCursorPos( nC, nR )

      IF cPar == "E"
         RELEASE KEY LEFT   OF ( ::oDesignForm:Name )
         RELEASE KEY RIGHT  OF ( ::oDesignForm:Name )
         RELEASE KEY UP     OF ( ::oDesignForm:Name )
         RELEASE KEY DOWN   OF ( ::oDesignForm:Name )
         RELEASE KEY ESCAPE OF ( ::oDesignForm:Name )
         ::oDesignForm:StatusBar:Release()
         IF ::lSStat
            ::CreateStatusBar()
         ENDIF
         ::Snap( oControl )
      ELSE
         DO CASE
         CASE cPar == "L"
            oControl:Col := oControl:Col - ::myIde:nPxMove
            ::lIsFormModified := .T.
         CASE cPar == "R"
            oControl:Col := oControl:Col + ::myIde:nPxMove
            ::lIsFormModified := .T.
         CASE cPar == "U"
            oControl:Row := oControl:Row - ::myIde:nPxMove
            ::lIsFormModified := .T.
         CASE cPar == "D"
            oControl:Row := oControl:Row + ::myIde:nPxMove
            ::lIsFormModified := .T.
         CASE cPar == "LJ"
            oControl:Col := oControl:Col - ::myIde:nPxJump
            ::lIsFormModified := .T.
         CASE cPar == "RJ"
            oControl:Col := oControl:Col + ::myIde:nPxJump
            ::lIsFormModified := .T.
         CASE cPar == "UJ"
            oControl:Row := oControl:Row - ::myIde:nPxJump
            ::lIsFormModified := .T.
         CASE cPar == "DJ"
            oControl:Row := oControl:Row + ::myIde:nPxJump
            ::lIsFormModified := .T.
         CASE cPar == "W-"
            oControl:Width := oControl:Width - ::myIde:nPxSize
            ::lIsFormModified := .T.
         CASE cPar == "W+"
            oControl:Width := oControl:Width + ::myIde:nPxSize
            ::lIsFormModified := .T.
         CASE cPar == "H-"
            oControl:Height := oControl:Height - ::myIde:nPxSize
            ::lIsFormModified := .T.
         CASE cPar == "H+"
            oControl:Height := oControl:Height + ::myIde:nPxSize
            ::lIsFormModified := .T.
         ENDCASE
         IF _IsControlDefined( "Statusbar", ::oDesignForm:Name )
            ::oDesignForm:StatusBar:Item( 1, i18n( " Row = " ) + LTrim( Str( oControl:Row ) ) + ;
                                             i18n( "  Col = " ) + LTrim( Str( oControl:Col ) ) + ;
                                             i18n( "  Width = " ) + LTrim( Str( oControl:Width ) ) + ;
                                             i18n( "  Height = " ) + LTrim( Str( oControl:Height ) ) + ;
                                             i18n( "  Use Arrow Keys to Move and [Esc] To Exit Keyboard Move/Size" ) )
         ENDIF
      ENDIF
      ::DrawOutline( oControl )
      ::oDesignForm:SetFocus()
   ENDIF

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD GlobalVertGapChg() CLASS TFormEditor

   LOCAL aControls, aFormats, aInitValues, aItemsSel, aLabels, aResults, cName, cTitle, i, nCol, nHeight, nLen, nRow, oCtrl, oPage
   LOCAL oTab

   aItemsSel := ::oCtrlList:Value
   nLen := Len( aItemsSel )
   IF nLen > 1
      CursorWait()

      aControls := {}
      FOR i := 1 TO nLen
         cName := ::oCtrlList:Cell( aItemsSel[i], 6 )
         oCtrl := ::oDesignForm:&cName:Object()
         AAdd( aControls, { oCtrl, oCtrl:Row } )
      NEXT
      aSort( aControls, NIL, NIL, { |x, y| x[2] < y[2] } )
      oCtrl := aControls[1, 1]
      nRow  := oCtrl:Row
      nCol  := oCtrl:Col

      cTitle      := i18n( "Global Vertical Gap Change" )
      aLabels     := { i18n( "New Gap Value" ), i18n( "New Col Value" ) }
      aInitValues := { ::myIde:nStdVertGap, nCol }
      aFormats    := { "9999", "9999" }
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )

      IF aResults[1] # NIL
         ::oDesignForm:SetRedraw( .F. )
         ::oCtrlList:SetRedraw( .F. )

         FOR i := 1 TO nLen
            oCtrl     := aControls[i, 1]
            nHeight   := oCtrl:Height
            oCtrl:Row := nRow
            IF aResults[2] # 0
               oCtrl:Col := aResults[2]
            ENDIF

            IF oCtrl:Row # oCtrl:ContainerRow .OR. oCtrl:Col # oCtrl:ContainerCol
               oPage      := oCtrl:Container
               oTab       := oPage:Container
               oTab:Value := oPage:Position
            ENDIF
            ::DrawOutline( oCtrl, .T. )

            nRow := nRow + aResults[1] + nHeight
         NEXT

         ::oCtrlList:SetRedraw( .T. )
         ::oCtrlList:Redraw()
         ::oDesignForm:SetRedraw( .T. )
         ::oDesignForm:Redraw()
         ::lIsFormModified := .T.
      ENDIF

      CursorArrow()
   ENDIF

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD ValCellPos() CLASS TFormEditor

   LOCAL wValue, cName, oCtrl, oPage, oTab

   wValue := This.CellRowIndex
   cName  := ::oCtrlList:Cell( wValue, 6 )
   oCtrl  := ::oDesignForm:&cName:Object()

   DO CASE
   CASE This.CellColIndex == 2
      oCtrl:Row := Val( ::oCtrlList:Cell( wValue, 2 ) )
   CASE This.CellColIndex == 3
      oCtrl:Col := Val( ::oCtrlList:Cell( wValue, 3 ) )
   CASE This.CellColIndex == 4
      oCtrl:Width := Val( ::oCtrlList:Cell( wValue, 4 ) )
   CASE This.CellColIndex == 5
      oCtrl:Height := Val( ::oCtrlList:Cell( wValue, 5 ) )
   ENDCASE

   IF oCtrl:Row # oCtrl:ContainerRow .OR. oCtrl:Col # oCtrl:ContainerCol
      oPage      := oCtrl:Container
      oTab       := oPage:Container
      oTab:Value := oPage:Position
   ENDIF
   ::DrawOutline( oCtrl, .T. )
   ::lIsFormModified := .T.

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD ValGlobalPos( cCual ) CLASS TFormEditor

   LOCAL aFormats, aInitValues, aItemsSel, aLabels, aResults, cName, cTitle, i, ia, nFila, nLen, oCtrl, oPage, oTab

   aItemsSel := ::oCtrlList:Value
   nLen := Len( aItemsSel )

   IF nLen > 0
      DO CASE
      CASE cCual == "ROW"
         cTitle      := DQM( ::cFName + ".fmg" ) + i18n( " - Global Row Change" )
         aLabels     := { i18n( "New Row Value" ) }
         aInitValues := { Val( ::oCtrlList:Cell( aItemsSel[1], 2 ) ) }
         aFormats    := { "9999" }
         aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      CASE cCual == "COL"
         cTitle      := DQM( ::cFName + ".fmg" ) + i18n( " - Global Col Change" )
         aLabels     := { i18n( "New Col Value" ) }
         aInitValues := { Val( ::oCtrlList:Cell( aItemsSel[1], 3 ) ) }
         aFormats    := { "9999" }
         aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      CASE cCual == "WID"
         cTitle      := DQM( ::cFName + ".fmg" ) + i18n( " - Global Width Change" )
         aLabels     := { i18n( "New Width Value" ) }
         aInitValues := { Val( ::oCtrlList:Cell( aItemsSel[1], 4 ) ) }
         aFormats    := { "9999" }
         aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      CASE cCual == "HEI"
         cTitle      := DQM( ::cFName + ".fmg" ) + i18n( " - Global Height Change" )
         aLabels     := { i18n( "New Height Value" ) }
         aInitValues := { Val( ::oCtrlList:Cell( aItemsSel[1], 5 ) ) }
         aFormats    := { "9999" }
         aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      CASE cCual == "SHI"
         cTitle      := DQM( ::cFName + ".fmg" ) + i18n( " - Global Shift" )
         aLabels     := { i18n( "Horizontal Value" ), i18n( "Vertical Value " ) }
         aInitValues := { 0, 0 }
         aFormats    := { "9999", "9999" }
         aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      ENDCASE

      IF aResults[1] == NIL
         RETURN NIL
      ENDIF

      CursorWait()

      ::oDesignForm:SetRedraw( .F. )
      ::oCtrlList:SetRedraw( .F. )

      FOR i := 1 TO nLen
         nFila := aItemsSel[i]
         cName := ::oCtrlList:Cell( nFila, 6 )
         oCtrl := ::oDesignForm:&cName:Object()

         DO CASE
         CASE cCual == "ROW"
              oCtrl:Row    := aResults[1]
         CASE cCual == "COL"
              oCtrl:Col    := aResults[1]
         CASE cCual == "WID"
              oCtrl:Width  := aResults[1]
         CASE cCual == "HEI"
              oCtrl:Height := aResults[1]
         CASE cCual == "SHI"
              oCtrl:Col    := oCtrl:Col + aResults[1]
              oCtrl:Row    := oCtrl:Row + aResults[2]
         ENDCASE
      NEXT

      EraseWindow( ::oDesignForm:Name )
      FOR i := 1 TO nLen
         IF ( ia := AScan( ::oDesignForm:aControls, { |c| Lower( c:Name ) == ::oCtrlList:Cell( aItemsSel[i], 6 ) } ) ) > 0
            oCtrl := ::oDesignForm:aControls[ia]
            IF oCtrl:Row # oCtrl:ContainerRow .OR. oCtrl:Col # oCtrl:ContainerCol
               oPage      := oCtrl:Container
               oTab       := oPage:Container
               oTab:Value := oPage:Position
            ENDIF
            ::DrawOutline( oCtrl, .T., .F. )
         ENDIF
      NEXT i
      ::DrawPoints()
      ::RefreshControlInspector()

      ::oCtrlList:SetRedraw( .T. )
      ::oCtrlList:Redraw()
      ::oDesignForm:SetRedraw( .T. )
      ::oDesignForm:Redraw()
      ::lIsFormModified := .T.

      CursorArrow()
   ENDIF

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD PrintBrief() CLASS TFormEditor

   LOCAL aFormats, aInitValues, aItems, aLabels, aOptions, aOptionsN, aResults, cName, cObj, ContLin, cRealName, cTitle, cType, i
   LOCAL lDynamicOnly, nCantItems, nCol, nHeight, nIndice, nPage, nRow, nWidth, oCtrl, oPrint, uValue

   // TODO: improve report

   aItems := {}
   aOptions := { i18n( "Tab Order" ), i18n( "Name" ), i18n( "Type" ), i18n( "Row" ), i18n( "Col" ) }
   aOptionsN := { 0, 1, 7, 2, 3 }

   cTitle      := DQM( ::cFName + ".fmg" ) + i18n( " - Print Brief" )
   aLabels     := { i18n( "Filter Dynamic Controls" ), i18n( "Print Events" ), i18n( "Sort By" ), i18n( "Draw Grid" ) }
   aInitValues := { .T., .T., 1, .F. }
   aFormats    := { NIL, NIL, aOptions, NIL }
   aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
   IF aResults[1] == NIL
      RETURN NIL
   ENDIF

   CursorWait()

   DEFAULT aResults[3] TO 1
   lDynamicOnly := aResults[1]

   nCantItems := ::oCtrlList:ItemCount
   FOR i := 1 TO nCantItems
      AAdd( aItems, { ::oCtrlList:Cell( i, 1 ), ::oCtrlList:Cell( i, 2 ), ::oCtrlList:Cell( i, 3), ::oCtrlList:Cell( i, 4), ::oCtrlList:Cell( i, 5), ::oCtrlList:Cell( i, 6 ), ::oCtrlList:Cell( i, 7 ) } )
   NEXT
   nIndice := aOptionsN[aResults[3]]
   IF nIndice > 0
      IF nIndice # 2
         aSort( aItems, NIL, NIL, { |x, y| x[nIndice] < y[nIndice] } )
      ELSE
         aSort( aItems, NIL, NIL, { |x, y| x[2] + x[3] < y[2] + y[3] } )
      ENDIF
   ENDIF

   oPrint := TPrint( "HBPRINTER" )
   oPrint:Init()
   oPrint:SelPrinter( .T., .T., .T. )
   IF oPrint:lPrError
      oPrint:Release()
      CursorArrow()
      MsgStop( i18n( "Error detected while printing." ), "OOHG IDE+" )
      RETURN NIL
   ENDIF
   oPrint:Begindoc()
   oPrint:SetFont( NIL, NIL, NIL, .T. )
   oPrint:SetPreviewSize( 2 )
   oPrint:BeginPage()
   oPrint:SetCPL( 120 )

   ContLin := 1
   nPage   := 1
   oPrint:PrintData( ContLin, 0, "BRIEF OF " + iif( lDynamicOnly, "DYNAMIC", "ALL" ) + " CONTROLS IN FORM: " + ::oDesignForm:Title + " OBJ: " + ::cFObj )
   oPrint:PrintData( ContLin, 143, "SORTED BY " + Upper( aOptions[aResults[3]] ) )
   ContLin ++
   oPrint:PrintData( ContLin, 0, "FILE: " + ::cFormFullName )
   oPrint:PrintData( ContLin, 143, Dtoc( Date() ) + " " + Time() )
   ContLin ++
   oPrint:PrintData( ContLin, 0, Replicate( "-", 162 ) )
   ContLin ++
   oPrint:PrintData( Contlin, 0, "NAME                    TYPE        ROW    COL   WIDTH HEIGHT  VALUE                 OBJ                  NUM  DATE  RONLY  UPPER  RALIGN  MAXLEN  IMASK           " )
   /*
   oPrint:Printdata( Contlin, 0, "0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012" )
   ContLin ++
   oPrint:Printdata( Contlin, 0, "0         1         2         3         4         5         6         7         8         9         0         1         2         3         4         5         6  " )
   ContLin ++
   */
   ContLin ++
   oPrint:PrintData( ContLin, 0, Replicate( "-", 162 ) )
   IF aResults[4]
      ContLin ++
   ENDIF
   FOR i := 1 TO nCantItems
      cRealName := aItems[i, 1]
      cName     := aItems[i, 6]
      cType     := aItems[i, 7]
      oCtrl     := ::oDesignForm:&cName:Object()
      nRow      := oCtrl:Row
      nCol      := oCtrl:Col
      nWidth    := oCtrl:Width
      nHeight   := oCtrl:Height
      uValue    := oCtrl:Value
      nIndice   := AScan( ::aControlW, cName )
      cObj      := ::aCObj[nIndice]

      IF Upper( cType ) $ "LABEL FRAME TIMER IMAGE PICTURE ACTIVEX PROGRESSBAR PROGRESSMETER ANIMATEBOX ANIGIF" .AND. lDynamicOnly
      ELSE
         IF ! aResults[4]
            ContLin ++
         ENDIF
         oPrint:PrintData( ContLin, 000, Left( cRealName, 23 ) )
         oPrint:PrintData( ContLin, 024, Left( cType, 11 ) )
         oPrint:PrintData( ContLin, 036, StrZero( nRow, 3 ) )
         oPrint:PrintData( ContLin, 043, StrZero( nCol, 3 ) )
         oPrint:PrintData( ContLin, 050, StrZero( nWidth, 3 ) )
         oPrint:PrintData( ContLin, 056, StrZero( nHeight, 3 ) )
         oPrint:PrintData( ContLin, 063, Left( CStr( uValue ), 20 ) )
         oPrint:PrintData( ContLin, 085, Left( CStr( cObj ), 20 ) )
         oPrint:PrintData( ContLin, 108, iif( ::aNumeric[nIndice], "Y", "N" ) )
         oPrint:PrintData( ContLin, 113, iif( ::aDate[nIndice], "Y", "N" ) )
         oPrint:PrintData( ContLin, 120, iif( ::aReadOnly[nIndice], "Y", "N" ) )
         oPrint:PrintData( ContLin, 127, iif( ::aUpperCase[nIndice], "Y", "N" ) )
         oPrint:PrintData( ContLin, 134, iif( ::aRightAlign[nIndice], "Y", "N" ) )
         oPrint:PrintData( ContLin, 142, Transform( ::aMaxLength[nIndice], "999" ) )
         oPrint:PrintData( ContLin, 148, AllTrim( ::aResultsMask[nIndice] ) )
         IF ! Empty( ::aField[nIndice] )
            oPrint:PrintData( ++ ContLin, 005, "FIELD      : " + AllTrim( ::aField[nIndice] ) )
         ENDIF
         IF ! Empty( ::aValid[nIndice] )
            oPrint:PrintData( ++ ContLin, 005, "VALID      : " + AllTrim( ::aValid[nIndice] ) )
         ENDIF
         IF ! Empty( ::aWhen[nIndice] )
            oPrint:PrintData( ++ Contlin, 005, "WHEN       : " + AllTrim( ::aWhen[nIndice] ) )
         ENDIF
         IF ContLin > 40
            ContLin ++
            oPrint:PrintData( ++ ContLin, 0, "Page... " + Ltrim( Str( nPage, 3 ) ) )
            oPrint:PrintData( ++ ContLin, 0,  Replicate( "-", 162 ) )
            oPrint:EndPage()
            oPrint:BeginPage()
            ContLin := 1
            nPage ++
         ENDIF
         IF aResults[2]
            IF ! Empty( ::aAction[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ACTION        : " + AllTrim( CStr( ::aAction[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aAction2[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ACTION2       : " + AllTrim( CStr( ::aAction2[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnAbortEdit[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONABORTEDIT   : " + AllTrim( CStr( ::aOnAbortEdit[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnAppend[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONAPPEND      : " + AllTrim( CStr( ::aOnAppend[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnCancel[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONCANCEL      : " + AllTrim( CStr( ::aOnCancel[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnChange[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONCHANGE      : " + AllTrim( CStr( ::aOnChange[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnCheckChg[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONCHECKCHANGE : " + AllTrim( CStr( ::aOnCheckChg[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnDblClick[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONDBLCLICK    : " + AllTrim( CStr( ::aOnDblClick[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnDelete[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONDELETE      : " + AllTrim( CStr( ::aOnDelete[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnDispChange[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONDISP.CHANGE : " + AllTrim( CStr( ::aOnDispChange[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnDrop[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONDROP        : " + AllTrim( CStr( ::aOnDrop[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnEditCell[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONEDITCELL    : " + AllTrim( CStr( ::aOnEditCell[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnEditCellEnd[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONEDITCELLEND : " + AllTrim( CStr( ::aOnEditCellEnd[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnEnter[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONENTER       : " + AllTrim( CStr( ::aOnEnter[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnGotFocus[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONGOTFOCUS    : " + AllTrim( CStr( ::aOnGotFocus[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnHeadClick[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONHEADCLICK   : " + AllTrim( CStr( ::aOnHeadClick[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnHeadDClick[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONHEADDBLCLICK: " + AllTrim( CStr( ::aOnHeadDClick[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnHeadRClick[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONHEADRCLICK  : " + AllTrim( CStr( ::aOnHeadRClick[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnHScroll[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONHSCROLL     : " + AllTrim( CStr( ::aOnHScroll[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnBfrInsert[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONBEFOREINSERT: " + AllTrim( CStr( ::aOnBfrInsert[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnInsert[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONINSERT      : " + AllTrim( CStr( ::aOnInsert[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnLabelEdit[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONLABELEDIT   : " + AllTrim( CStr( ::aOnLabelEdit[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnListClose[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONLISTCLOSE   : " + AllTrim( CStr( ::aOnListClose[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnListDisplay[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONLISTDISPLAY : " + AllTrim( CStr( ::aOnListDisplay[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnLostFocus[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONLOSTFOCUS   : " + AllTrim( CStr( ::aOnLostFocus[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnMouseMove[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONMOUSEMOVE   : " + AllTrim( CStr( ::aOnMouseMove[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnQueryData[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONQUERYDATA   : " + AllTrim( CStr( ::aOnQueryData[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnRClick[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONRCLICK      : " + AllTrim( CStr( ::aOnRClick[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnMClick[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONMCLICK      : " + AllTrim( CStr( ::aOnMClick[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnRDClick[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONRDBLCLICK   : " + AllTrim( CStr( ::aOnRDClick[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnMDClick[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONMDBLCLICK   : " + AllTrim( CStr( ::aOnMDClick[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnRefresh[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONREFRESH     : " + AllTrim( CStr( ::aOnRefresh[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnRowRefresh[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONROWREFRESH  : " + AllTrim( CStr( ::aOnRowRefresh[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnScrEndTrack[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONENDTRACK    : " + AllTrim( CStr( ::aOnScrEndTrack[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnScrLineLU[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONLINEUP      : " + AllTrim( CStr( ::aOnScrLineLU[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnScrLineRD[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONLINEDOWN    : " + AllTrim( CStr( ::aOnScrLineRD[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnScrLT[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONTOP         : " + AllTrim( CStr( ::aOnScrLT[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnScrPageLU[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONPAGEUP      : " + AllTrim( CStr( ::aOnScrPageLU[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnScrPageRD[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONPAGEDOWN    : " + AllTrim( CStr( ::aOnScrPageRD[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnScrRB[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONBOTTOM      : " + AllTrim( CStr( ::aOnScrRB[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnScrThumb[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONTHUMB       : " + AllTrim( CStr( ::aOnScrThumb[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnScrTrack[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONTRACK       : " + AllTrim( CStr( ::aOnScrTrack[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnSelChange[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONSELCHANGE   : " + AllTrim( CStr( ::aOnSelChange[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnTextFilled[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONTEXTFILLED  : " + AllTrim( CStr( ::aOnTextFilled[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnViewChange[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONVIEWCHANGE  : " + AllTrim( CStr( ::aOnViewChange[nIndice] ) ) )
            ENDIF
            IF ! Empty( ::aOnVScroll[nIndice] )
               oPrint:PrintData( ++ ContLin, 005, "ONVSCROLL     : " + AllTrim( CStr( ::aOnVScroll[nIndice] ) ) )
            ENDIF
         ENDIF
         IF aResults[4]
            oPrint:PrintLine( ++ Contlin, 0, ContLin, 162 )
         ENDIF
      ENDIF
   NEXT

   ContLin ++
   oPrint:PrintData( ++ ContLin, 0, "Page... " + LTrim( Str( nPage, 3 ) ) )
   oPrint:PrintData( ++ ContLin, 0, Replicate( "-", 162 ) )
   oPrint:PrintData( ++ ContLin, 0, "End print" )
   oPrint:EndPage()
   oPrint:EndDoc()

   CursorArrow()

   RETURN NIL

//--------------------------------------------------------------//
STATIC FUNCTION CStr( xExp )

   LOCAL cType := ValType( xExp )

   SWITCH cType

      CASE 'C'
         RETURN xExp

      CASE 'D'
         RETURN dToS( xExp )

      CASE 'T'
         RETURN tToS( xExp )

      CASE 'L'
         RETURN iif( xExp, '.T.', '.F.' )

      CASE 'N'
         RETURN Str( xExp )

      CASE 'A'
         RETURN "{ Array of " +  LTrim( Str( Len( xExp ) ) ) + " Items }"

      CASE 'B'
         RETURN '{|| Block }'

      CASE 'O'
         RETURN "{ " + xExp:ClassName() + " Object }"

      CASE 'P'
         RETURN NumToHex( xExp )

      CASE 'H'
         RETURN "{ Hash of " +  LTrim( Str( Len( xExp ) ) ) + " Items }"

      CASE 'U'
         RETURN 'NIL'

   #ifdef __XHARBOUR__
      DEFAULT
   #else
      OTHERWISE
   #endif
         RETURN "Type: " + cType

   ENDSWITCH

RETURN ""

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD OutlineControls() CLASS TFormEditor

   LOCAL aVal, nLen, i, ia

   EraseWindow( ::oDesignForm:Name )
   aVal := ::oCtrlList:Value
   IF ( nLen := Len( aVal ) ) > 0
      FOR i := 1 TO nLen
         IF ( ia := AScan( ::oDesignForm:aControls, { |c| Lower( c:Name ) == ::oCtrlList:Cell( aVal[i], 6 ) } ) ) > 0
// TODO: remove            ::oDesignForm:aControls[ia]:SetFocus()
            ::DrawOutline( ::oDesignForm:aControls[ia], .T., .T. )
         ENDIF
      NEXT i
   ENDIF
   ::DrawPoints()

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD LoadControls() CLASS TFormEditor

   LOCAL i, lItem, cType, cLine, nWidth, cAction, cIcon, lFlat, lRaised, lAmPm
   LOCAL cToolTip, lCenter, lLeft, lRight, cCaption, nProcess

   ::oDesignForm:SetRedraw( .F. )

   /* Load statusbar data */
   FOR i := 1 TO Len( ::aLine )
      IF At( " DEFINE STATUSBAR ", Upper( ::aLine[i] ) ) == 1
         ::lSStat := .T.
         ::Form_Main:btn_Status:Enabled := .T.
         ::oCtrlBox:Control_Statusbar:ToolTip := i18n( "StatusBar Off" )

         ::cSCargo        := ::ReadCargo( i, "LASTFORM.STATUSBAR.CARGO" )
         ::cSCObj         := ::ReadStringData( i, "OBJ", "" )
         ::lSTop          := ( ::ReadLogicalData( i, "TOP", "F" ) == "T" )
         ::lSNoAutoAdjust := ( ::ReadLogicalData( i, "NOAUTOADJUST", "F" ) == "T" )
         ::cSSubClass     := ::ReadStringData( i, "SUBCLASS", "" )
         ::cSFontNameFrm  := ::ReadStringData( i, "FONT", "" )
         ::cSFontName     := ::StrToValueForm( ::cSFontNameFrm, "C", "" )
         ::cSFontSizeFrm  := ::ReadStringData( i, "SIZE", "" )
         ::nSFontSize     := ::StrToValueCtrl( ::cSFontSizeFrm, "N", 0, 1, 9999 )
         ::lSBold         := ( ::ReadLogicalData( i, "BOLD", "F" ) == "T" )
         ::lSItalic       := ( ::ReadLogicalData( i, "ITALIC", "F" ) == "T" )
         ::lSUnderline    := ( ::ReadLogicalData( i, "UNDERLINE", "F" ) == "T" )
         ::lSStrikeout    := ( ::ReadLogicalData( i, "STRIKEOUT", "F" ) == "T" )
         lItem            := .F.
         ::cSCaption      := "{ "
         ::cSWidth        := "{ "
         ::cSAction       := "{ "
         ::cSIcon         := "{ "
         ::cSStyle        := "{ "
         ::cSToolTip      := "{ "
         ::cSAlign        := "{ "
         ::lSKeyboard     := .F.
         ::nSKWidth       := 0
         ::cSKAction      := ""
         ::cSKToolTip     := ""
         ::cSKImage       := ""
         ::cSKStyle       := ""
         ::cSKAlign       := ""
         ::lSDate         := .F.
         ::nSDWidth       := 0
         ::cSDAction      := ""
         ::cSDToolTip     := ""
         ::cSDStyle       := ""
         ::cSDAlign       := ""
         ::lSTime         := .F.
         ::nSCWidth       := 0
         ::cSCAction      := ""
         ::cSCToolTip     := ""
         ::lSCAmPm        := .F.
         ::cSCImage       := ""
         ::cSCStyle       := ""
         ::cSCAlign       := ""

         i ++
         DO WHILE i <= Len( ::aLine )
            cLine := Upper( ::aLine[i] )
            IF At( " END STATUSBAR ", cLine ) == 1
               EXIT
            ENDIF

            IF At( " STATUSITEM ", cLine ) == 1
               lItem := .T.
               nProcess := 1
               cCaption := RTrim( SubStr( ::aLine[i], 13 ) )
            ELSEIF At( " KEYBOARD ", cLine ) == 1 .AND. ! ::lSKeyboard
               ::lSKeyboard := .T.
               nProcess := 2
               cCaption := RTrim( SubStr( ::aLine[i], 11 ) )
            ELSEIF At( " DATE ", cLine ) == 1 .AND. ! ::lSDate
               ::lSDate := .T.
               nProcess := 3
               cCaption := RTrim( SubStr( ::aLine[i], 7 ) )
            ELSEIF At( " CLOCK ", cLine ) == 1 .AND. ! ::lSTime
               ::lSTime := .T.
               nProcess := 4
               cCaption := RTrim( SubStr( ::aLine[i], 8 ) )
            ELSE
               nProcess := 0
            ENDIF

            IF nProcess > 0
               nWidth   := 0
               cAction  := ""
               cIcon    := ""
               lFlat    := .F.
               lRaised  := .F.
               cToolTip := ""
               lCenter  := .F.
               lLeft    := .F.
               lRight   := .F.
               lAmPm    := .F.

               IF Right( cCaption, 1 ) == ";"
                  cCaption := AllTrim( SubStr( cCaption, 1, Len( cCaption ) - 1 ) )

                  i ++
                  DO WHILE i <= Len( ::aLine )
                     cLine := Upper( ::aLine[i] )
                     IF At( " END STATUSBAR ", cLine ) == 1 .OR. At( " STATUSITEM ", cLine ) == 1 .OR. At( " KEYBOARD ", cLine ) == 1 .OR. At( " DATE ", cLine ) == 1 .OR. At( " CLOCK ", cLine ) == 1
                        EXIT
                     ELSEIF At( " WIDTH ", cLine ) == 1
                        nWidth := RTrim( SubStr( ::aLine[i], 8 ) )
                        i ++
                        IF Right( nWidth, 1 ) == ";"
                           nWidth := Val( AllTrim( SubStr( nWidth, 1, Len( nWidth ) - 1 ) ) )
                        ELSE
                           nWidth := Val( AllTrim( nWidth ) )
                           EXIT
                        ENDIF
                     ELSEIF At( " ACTION ", cLine ) == 1
                        cAction := RTrim( SubStr( ::aLine[i], 9 ) )
                        i ++
                        IF Right( cAction, 1 ) == ";"
                           cAction := AllTrim( SubStr( cAction, 1, Len( cAction ) - 1 ) )
                        ELSE
                           cAction := AllTrim( cAction )
                           EXIT
                        ENDIF
                     ELSEIF At( " ICON ", cLine ) == 1
                        cIcon := RTrim( SubStr( ::aLine[i], 7 ) )
                        i ++
                        IF Right( cIcon, 1 ) == ";"
                           cIcon := AllTrim( SubStr( cIcon, 1, Len( cIcon ) - 1 ) )
                        ELSE
                           cIcon := AllTrim( cIcon )
                           EXIT
                        ENDIF
                     ELSEIF At( " AMPM ", cLine ) == 1
                        lAmPm := RTrim( SubStr( ::aLine[i], 7 ) )
                        i ++
                        IF Right( lAmPm, 1 ) == ";"
                           lAmPm := AllTrim( SubStr( lAmPm, 1, Len( lAmPm ) - 1 ) )
                           IF Empty( lAmPm )
                              lAmPm := .T.
                           ELSE
                              lAmPm := .T.
                              EXIT
                           ENDIF
                        ELSE
                           lAmPm := .T.
                           EXIT
                        ENDIF
                     ELSEIF At( " FLAT ", cLine ) == 1
                        lFlat := RTrim( SubStr( ::aLine[i], 7 ) )
                        i ++
                        IF Right( lFlat, 1 ) == ";"
                           lFlat := AllTrim( SubStr( lFlat, 1, Len( lFlat ) - 1 ) )
                           IF Empty( lFlat )
                              lFlat := .T.
                           ELSE
                              lFlat := .T.
                              EXIT
                           ENDIF
                        ELSE
                           lFlat := .T.
                           EXIT
                        ENDIF
                     ELSEIF At( " RAISED ", cLine ) == 1
                        lRaised := RTrim( SubStr( ::aLine[i], 9 ) )
                        i ++
                        IF Right( lRaised, 1 ) == ";"
                           lRaised := AllTrim( SubStr( lRaised, 1, Len( lRaised ) - 1 ) )
                           IF Empty( lRaised )
                              lRaised := .T.
                           ELSE
                              lRaised := .T.
                              EXIT
                           ENDIF
                        ELSE
                           lRaised := .T.
                           EXIT
                        ENDIF
                     ELSEIF At( " TOOLTIP ", cLine ) == 1
                        cToolTip := RTrim( SubStr( ::aLine[i], 10 ) )
                        i ++
                        IF Right( cToolTip, 1 ) == ";"
                           cToolTip := AllTrim( SubStr( cToolTip, 1, Len( cToolTip ) - 1 ) )
                        ELSE
                           cToolTip := AllTrim( cToolTip )
                           EXIT
                        ENDIF
                     ELSEIF At( " CENTER ", cLine ) == 1
                        lCenter := RTrim( SubStr( ::aLine[i], 9 ) )
                        i ++
                        IF Right( lCenter, 1 ) == ";"
                           lCenter := AllTrim( SubStr( lCenter, 1, Len( lCenter ) - 1 ) )
                           IF Empty( lCenter )
                              lCenter := .T.
                           ELSE
                              lCenter := .T.
                              EXIT
                           ENDIF
                        ELSE
                           lCenter := .T.
                           EXIT
                        ENDIF
                     ELSEIF At( " LEFT ", cLine ) == 1
                        lLeft := RTrim( SubStr( ::aLine[i], 7 ) )
                        i ++
                        IF Right( lLeft, 1 ) == ";"
                           lLeft := AllTrim( SubStr( lLeft, 1, Len( lLeft ) - 1 ) )
                           IF Empty( lLeft )
                              lLeft := .T.
                           ELSE
                              lLeft := .T.
                              EXIT
                           ENDIF
                        ELSE
                           lLeft := .T.
                           EXIT
                        ENDIF
                     ELSEIF At( " RIGHT ", cLine ) == 1
                        lRight := RTrim( SubStr( ::aLine[i], 8 ) )
                        i ++
                        IF Right( lRight, 1 ) == ";"
                           lRight := AllTrim( SubStr( lRight, 1, Len( lRight ) - 1 ) )
                           IF Empty( lRight )
                              lRight := .T.
                           ELSE
                              lRight := .T.
                              EXIT
                           ENDIF
                        ELSE
                           lRight := .T.
                           EXIT
                        ENDIF
                     ELSE
                        i ++
                        EXIT
                     ENDIF
                  ENDDO
               ELSE
                  cCaption := AllTrim( cCaption )
                  i ++
               ENDIF

               IF nProcess == 1          /* STATUSITEM */
                  ::cSCaption += iif( Empty( cCaption ), SQM( " " ), cCaption ) + ", "
                  ::cSWidth   += iif( nWidth > 0, LTrim( Str( nWidth ) ), "0" ) + ", "
                  ::cSAction  += iif( Empty( cAction ), SQM( "" ), StrToStr( cAction ) ) + ", "
                  ::cSIcon    += iif( Empty( cIcon ), SQM( "" ), cIcon ) + ", "
                  ::cSStyle   += iif( lFlat, SQM( "FLAT" ), iif( lRaised, SQM( "RAISED" ), SQM( "" ) ) ) + ", "
                  ::cSToolTip += iif( Empty( cToolTip ), SQM( "" ), cToolTip ) + ", "
                  ::cSAlign   += iif( lLeft, SQM( "LEFT" ), iif( lRight, SQM( "RIGHT" ), iif( lCenter, SQM( "CENTER" ), SQM( "" ) ) ) ) + ", "
               ELSEIF nProcess == 2      /* KEYBOARD */
                  ::nSKWidth   := nWidth
                  ::cSKAction  := cAction
                  ::cSKToolTip := cToolTip
                  ::cSKImage   := cIcon
                  ::cSKStyle   := iif( lFlat, "FLAT", iif( lRaised, "RAISED", "" ) )
                  ::cSKAlign   := iif( lLeft, "LEFT", iif( lRight, "RIGHT", iif( lCenter, "CENTER", "" ) ) )
               ELSEIF nProcess == 3      /* DATE */
                  ::nSDWidth   := nWidth
                  ::cSDAction  := cAction
                  ::cSDToolTip := cToolTip
                  ::cSDStyle   := iif( lFlat, "FLAT", iif( lRaised, "RAISED", "" ) )
                  ::cSDAlign   := iif( lLeft, "LEFT", iif( lRight, "RIGHT", iif( lCenter, "CENTER", "" ) ) )
               ELSE                      /* CLOCK */
                  ::nSCWidth   := nWidth
                  ::cSCAction  := cAction
                  ::cSCToolTip := cToolTip
                  ::lSCAmPm    := lAmPm
                  ::cSCImage   := cIcon
                  ::cSCStyle   := iif( lFlat, "FLAT", iif( lRaised, "RAISED", "" ) )
                  ::cSCAlign   := iif( lLeft, "LEFT", iif( lRight, "RIGHT", iif( lCenter, "CENTER", "" ) ) )
               ENDIF
            ELSE
               i ++
            ENDIF
         ENDDO

         IF ! lItem
            ::cSCaption += "' ' }"
            ::cSWidth   += "'' }"
            ::cSAction  += "'' }"
            ::cSIcon    += "'' }"
            ::cSStyle   += "'' }"
            ::cSToolTip += "'' }"
            ::cSAlign   += "'' }"
         ELSE
            ::cSCaption := SubStr( ::cSCaption, 1, Len( ::cSCaption ) - 2 ) + " }"
            ::cSWidth   := SubStr( ::cSWidth, 1, Len( ::cSWidth ) - 2 ) + " }"
            ::cSAction  := SubStr( ::cSAction, 1, Len( ::cSAction ) - 2 ) + " }"
            ::cSIcon    := SubStr( ::cSIcon, 1, Len( ::cSIcon ) - 2 ) + " }"
            ::cSStyle   := SubStr( ::cSStyle, 1, Len( ::cSStyle ) - 2 ) + " }"
            ::cSToolTip := SubStr( ::cSToolTip, 1, Len( ::cSToolTip ) - 2 ) + " }"
            ::cSAlign   := SubStr( ::cSAlign, 1, Len( ::cSAlign ) - 2 ) + " }"
         ENDIF

         EXIT
      ENDIF
   NEXT i

   /* Controls */
   FOR i := 1 TO ::nControlW
      cType := ::aCtrlType[i]
      IF cType == "CHECKBUTTON"
         IF ::CheckStringData( i, "CAPTION" )
            cType := "CHECKBUTTON"
         ELSE
            cType := "PICCHECKBUTT"
         ENDIF
      ELSEIF cType == "BUTTON"
         IF ::CheckStringData( i, "CAPTION" )
            cType := "BUTTON"
         ELSE
            cType := "PICBUTT"
         ENDIF
      ENDIF
      /*
         For each new control you must add a CASE for calling the method that
         loads the control's properties and events from the FMG file.
      */
      DO CASE
      CASE cType == "STATUSBAR"
         /* Do nothing */
      CASE cType == "TOOLBAR"
         /* Do nothing */
      CASE cType == "TBBUTTON"
         /* Do nothing */
      CASE cType == ::ControlType[ TYPE_FORM ]
         ::pForm()
      CASE cType == ::ControlType[ TYPE_ANIGIF ]
         ::pAniGIF( i )
      CASE cType == ::ControlType[ TYPE_ANIMATEBOX ]
         ::pAnimateBox( i )
      CASE cType == ::ControlType[ TYPE_BROWSE ]
         ::pBrowse( i )
      CASE cType == ::ControlType[ TYPE_BUTTON ]
         ::pButton( i )
      CASE cType == ::ControlType[ TYPE_CHECKBOX ]
         ::pCheckBox( i )
      CASE cType == ::ControlType[ TYPE_LISTBOX ]
         ::pListBox( i )
      CASE cType == ::ControlType[ TYPE_COMBOBOX ]
         ::pComboBox( i )
      CASE cType == ::ControlType[ TYPE_CHECKBUTTON ]
         ::pCheckButton( i )
      CASE cType == ::ControlType[ TYPE_PICCHECKBUTT ]
         ::pPicCheckButt( i )
      CASE cType == ::ControlType[ TYPE_PICBUTT ]
         ::pPicButt( i )
      CASE cType == ::ControlType[ TYPE_IMAGE ]
         ::pImage( i )
      CASE cType == ::ControlType[ TYPE_DATEPICKER ]
         ::pDatePicker( i )
      CASE cType == ::ControlType[ TYPE_GRID ]
         ::pGrid( i )
      CASE cType == ::ControlType[ TYPE_FRAME ]
         ::pFrame( i )
      CASE cType == ::ControlType[ TYPE_TEXTBOX ]
         ::pTextBox( i )
      CASE cType == ::ControlType[ TYPE_EDITBOX ]
         ::pEditBox( i )
      CASE cType == ::ControlType[ TYPE_RADIOGROUP ]
         ::pRadioGroup( i )
      CASE cType == ::ControlType[ TYPE_PROGRESSBAR ]
         ::pProgressBar( i )
      CASE cType == ::ControlType[ TYPE_SLIDER ]
         ::pSlider( i )
      CASE cType == ::ControlType[ TYPE_SPINNER ]
         ::pSpinner( i )
      CASE cType == ::ControlType[ TYPE_PLAYER ]
         ::pPlayer( i )
      CASE cType == ::ControlType[ TYPE_LABEL ]
         ::pLabel( i )
      CASE cType == ::ControlType[ TYPE_TIMER ]
         ::pTimer( i )
      CASE cType == ::ControlType[ TYPE_IPADDRESS ]
         ::pIPAddress( i )
      CASE cType == ::ControlType[ TYPE_MONTHCALENDAR ]
         ::pMonthcalendar( i )
      CASE cType == ::ControlType[ TYPE_HYPERLINK ]
         ::pHyperLink( i )
      CASE cType == ::ControlType[ TYPE_TREE ]
         ::pTree( i )
      CASE cType == ::ControlType[ TYPE_RICHEDITBOX ]
         ::pRichedit( i )
      CASE cType == ::ControlType[ TYPE_TAB ]
         ::pTab( i )
      CASE cType == ::ControlType[ TYPE_TIMEPICKER ]
         ::pTimePicker( i )
      CASE cType == ::ControlType[ TYPE_XBROWSE ]
         ::pXBrowse( i )
      CASE cType == ::ControlType[ TYPE_ACTIVEX ]
         ::pActiveX( i )
      CASE cType == ::ControlType[ TYPE_CHECKLIST ]
         ::pCheckList( i )
      CASE cType == ::ControlType[ TYPE_HOTKEYBOX ]
         ::pHotKeyBox( i )
      CASE cType == ::ControlType[ TYPE_PICTURE ]
         ::pPicture( i )
      CASE cType == ::ControlType[ TYPE_PROGRESSMETER ]
         ::pProgressMeter( i )
      CASE cType == ::ControlType[ TYPE_SCROLLBAR ]
         ::pScrollBar( i )
      CASE cType == ::ControlType[ TYPE_TEXTARRAY ]
         ::pTextArray( i )
      OTHERWISE
         ::pLabel( i )
      ENDCASE
   NEXT i

   /* Toolbars */
   ::myTbEditor:LoadToolBars()

   /* Main menu */
   TMyMenuEditor():CreateMenuFromFile( Self, 1 )

   /* Context menu */
   TMyMenuEditor():CreateMenuFromFile( Self, 2 )

   /* Notify menu */
   TMyMenuEditor():CreateMenuFromFile( Self, 3 )

   /* Show statusbar */
   IF ::lSStat
      ::CreateStatusBar()
   ENDIF

   IF ::nControlW == 1
      ::nIndexW := 0
   ENDIF

   ::oDesignForm:SetRedraw( .T. )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD ControlClick( wpar ) CLASS TFormEditor

   LOCAL cControl, i
   STATIC lIdle := .T.

   IF lIdle
      lIdle := .F.
      FOR i := 1 TO IDE_LAST_CTRL
         cControl := "Control_" + StrZero( i, 2, 0 )
         ::oCtrlBox:&cControl:Value := .F.
      NEXT i
      ::CurrentControl := wpar
      cControl := "Control_" + StrZero( wpar, 2, 0 )
      ::oCtrlBox:&cControl:Value := .T.
      IF wpar > 1 .AND. wpar <= IDE_LAST_CTRL
         EraseWindow( ::oDesignForm:Name )
         ::DrawPoints()
         ::oCtrlList:Value := {}
      ENDIF
      lIdle := .T.
   ENDIF

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD ReadCtrlName( i, cCtrlType ) CLASS TFormEditor

   LOCAL nStart, j, cCtrlName

   IF ( nStart := At( " DEFINE ", ::aLine[i] ) ) # 0
      /* Alternate syntax: DEFINE cCtrlType cCtrlName */
      nStart += 8
      cCtrlType := AllTrim( SubStr( ::aLine[i], nStart ) )
   ELSE
      /* Standard syntax: @ nRow, nCol cCtrlType cCtrlName */
      nStart := At( ",", ::aLine[i] ) + 1
      cCtrlType := AllTrim( SubStr( ::aLine[i], nStart ) )
      IF ( j := At( " ", cCtrlType ) ) # 0
         cCtrlType := LTrim( Substr( cCtrlType, j + 1 ) )
      ENDIF
   ENDIF
   IF Right( cCtrlType, 1 ) == ";"
      cCtrlType := RTrim( SubStr( cCtrlType, 1, Len( cCtrlType ) - 1 ) )
   ENDIF
   IF ( j := At( " ", cCtrlType ) ) # 0
      cCtrlName := LTrim( Substr( cCtrlType, j + 1 ) )
      cCtrlType := Upper( Left( cCtrlType, j - 1 ) )
      IF ( j := At( " ", cCtrlName ) ) # 0
         cCtrlName := Left( cCtrlName, j - 1 )
      ENDIF
   ELSE
      cCtrlName := ""
      cCtrlType := Upper( cCtrlType )
   ENDIF
   /* Validate name */
   IF Empty( cCtrlName )
      MsgStop( i18n( "Control will be ignored because it has no name. See line " ) + Ltrim( Str( i ) ) + ".", "OOHG IDE+" )
   ELSE
      nStart := Asc( Upper( Left( cCtrlName, 1 ) ) )
      IF ( nStart < 65 .AND. nStart # 38 ) .OR. ( nStart > 90 .AND. nStart # 95 )
         MsgStop( i18n( "Control will be ignored because it has an invalid name: " ) + DQM( cCtrlName ) + ".", "OOHG IDE+" )
         cCtrlName := ""
      ELSE
         FOR j := 2 TO Len( cCtrlName )
            nStart := Asc( Upper( SubStr( cCtrlName, j, 1 ) ) )
            IF ! ( nStart == 95 .OR. ( nStart >= 65 .AND. nStart <= 90 ) .OR. ( nStart >= 48 .AND. nStart <= 57 ) )
               MsgStop( i18n( "Control will be ignored because it has an invalid name: " ) + DQM( cCtrlName ) + ".", "OOHG IDE+" )
               cCtrlName := ""
               EXIT
            ENDIF
         NEXT j
      ENDIF
   ENDIF

   RETURN cCtrlName

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD ReadCtrlType( i ) CLASS TFormEditor

   LOCAL nStart, cCtrlType, j

   IF ( nStart := At( " DEFINE ", ::aLine[i] ) ) # 0
      /* Alternate syntax: DEFINE cCtrlType cCtrlName */
      nStart += 8
      cCtrlType := AllTrim( SubStr( ::aLine[i], nStart ) )
   ELSE
      /* Standard syntax: @ nRow, nCol cCtrlType cCtrlName */
      nStart := At( ",", ::aLine[i] ) + 1
      cCtrlType := AllTrim( SubStr( ::aLine[i], nStart ) )
      IF ( j := At( " ", cCtrlType ) ) # 0
         cCtrlType := LTrim( Substr( cCtrlType, j + 1 ) )
      ENDIF
   ENDIF
   IF Right( cCtrlType, 1 ) == ";"
      cCtrlType := RTrim( SubStr( cCtrlType, 1, Len( cCtrlType ) - 1 ) )
   ENDIF
   IF ( j := At( " ", cCtrlType ) ) # 0
      cCtrlType := Left( cCtrlType, j - 1 )
   ENDIF

   RETURN Upper( cCtrlType )

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD ReadOopData( i, cProp, cDefault ) CLASS TFormEditor

   LOCAL j, nFrom, nTo, nPos, cSearch, cAux, cValue

   nFrom   := iif( i > 0, ::aSpeed[i], ::cSSpeed ) + 1
   nTo     := iif( i > 0, ::aNumber[i], ::cSNumber )
   cSearch := " " + Upper( ::cFName ) + "." + Upper( ::aName[i] ) + "." + Upper( cProp )
   FOR j := nFrom TO nTo
      IF At( cSearch, Upper( ::aLine[j] ) ) == 1
         cAux := LTrim( SubStr( ::aLine[j], Len( cSearch ) + 1 ) )
         IF Left( cAux, 1 ) == "="
            nPos := 2
         ELSEIF Left( cAux, 2 ) == ":="
            nPos := 3
         ELSE
            nPos := 1
         ENDIF
         IF nPos > 1
            cValue := AllTrim( SubStr( cAux, nPos ) )
            IF Empty( cValue )
               RETURN cDefault
            ELSEIF Upper( cValue ) == "NIL"
               RETURN "NIL"
            ELSE
               RETURN cValue
            ENDIF
         ENDIF
      ENDIF
   NEXT j

   RETURN cDefault

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD ReadCargo( i, cWhat ) CLASS TFormEditor

   LOCAL j, nFrom, nTo, nPos, cSearch, cAux, cValue

   nFrom   := ::aSpeed[i]
   nTo     := ::aNumber[i]
   cSearch := " " + cWhat
   FOR j := nFrom TO nTo
      IF At( cSearch, Upper( ::aLine[j] ) ) == 1
         cAux := LTrim( SubStr( ::aLine[j], Len( cSearch ) + 1 ) )
         IF Left( cAux, 1 ) == "="
            nPos := 2
         ELSEIF Left( cAux, 2 ) == ":="
            nPos := 3
         ELSE
            nPos := 1
         ENDIF
         IF nPos > 1
            cValue := AllTrim( SubStr( cAux, nPos ) )
            IF Empty( cValue )
               RETURN ""
            ELSEIF Upper( cValue ) == "NIL"
               RETURN ""
            ELSE
               RETURN cValue
            ENDIF
         ENDIF
      ENDIF
   NEXT j

   RETURN ""

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD ReadStringData( i, cProp, cDefault, nLine, nCount ) CLASS TFormEditor

   LOCAL j, nFrom, nTo, nPos, cLine

   DEFAULT nLine TO 0
   nFrom := iif( nLine > 0, nLine, iif( i > 0, ::aSpeed[i], ::cSSpeed ) ) + 1

   DEFAULT nCount TO 0
   nTo := iif( nCount > 0, nFrom + nCount, iif( i > 0, ::aNumber[i], ::cSNumber ) )

   FOR j := nFrom TO nTo
      IF Empty( ::aLine[j] )
         nLine := 0
         RETURN cDefault
      ENDIF
      IF ( nPos := At( " " + Upper( cProp ) + " ", Upper( ::aLine[j] ) ) ) > 0 .AND. Empty( Left( ::aLine[j], nPos ) )
         cLine := RTrim( SubStr( ::aLine[j], nPos + Len( cProp ) + 2 ) )
         IF Right( cLine, 1 ) == ";"
            cLine := RTrim( SubStr( cLine, 1, Len( cLine ) - 1 ) )
         ENDIF
         cLine := LTrim( cLine )
         IF Len( cLine ) == 0
            nLine := 0
            RETURN cDefault
         ELSEIF Upper( cLine ) == "NIL"
            nLine := 0
            RETURN cDefault
         ELSE
            nLine := j
            RETURN cLine
         ENDIF
      ENDIF
   NEXT j
   nLine := 0

   RETURN cDefault

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD CheckStringData( i, cProp ) CLASS TFormEditor

   LOCAL j, nFrom, nTo, nPos

   nFrom := iif( i > 0, ::aSpeed[i], ::cSSpeed ) + 1
   nTo   := iif( i > 0, ::aNumber[i], ::cSNumber )
   FOR j := nFrom TO nTo
      IF Empty( ::aLine[j] )
         RETURN .F.
      ELSEIF ( nPos := At( " " + Upper( cProp ) + " ", Upper( ::aLine[j] ) ) ) > 0 .AND. Empty( Left( ::aLine[j], nPos ) )
         RETURN .T.
      ENDIF
   NEXT j

   RETURN .F.

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD ReadLogicalData( i, cProp, cDefault ) CLASS TFormEditor

   LOCAL j, nFrom, nTo, nPos, cValue

   IF ! cDefault $ "TFN"
      cDefault := "F"
   ENDIF

   nFrom := iif( i > 0, ::aSpeed[i], ::cSSpeed ) + 1
   nTo   := iif( i > 0, ::aNumber[i], ::cSNumber )
   FOR j := nFrom TO nTo
      IF Empty( ::aLine[j] )
         RETURN cDefault
      ENDIF
      IF ( ( nPos := At( " " + Upper( cProp ) + " ", Upper( ::aLine[j] ) ) ) > 0 .AND. Empty( Left( ::aLine[j], nPos ) ) ) .OR. ;
         ( ( nPos := At( " " + Upper( cProp ), Upper( ::aLine[j] ) ) ) > 0 .AND. nPos + Len( cProp ) == Len( ::aLine[j] ) )
         /* cProp must be the first word of the line */
         IF Empty( Left( ::aLine[j], nPos ) )
            cValue := SubStr( ::aLine[j], nPos + Len( cProp ) + 2 )
            cValue := RTrim( cValue)
            IF Right( cValue, 1 ) == ";"
               cValue := SubStr( cValue, 1, Len( cValue ) - 1 )
            ENDIF
            cValue := AllTrim( cValue )
            IF Empty( cValue )
               /* keyword without attribute, eg TRANSPARENT */
               RETURN "T"
            ELSEIF Upper( cValue ) == ".T."
               /* keyword with valid attribute, eg TRANSPARENT .T. */
               RETURN "T"
            ELSEIF Upper( cValue ) == ".F."
               /* keyword with valid attribute, eg TRANSPARENT .F. */
               RETURN "F"
            ELSE
               /* keyword with invalid attribute, eg TRANSPARENT some_string */
               EXIT
            ENDIF
         ENDIF
      ENDIF
   NEXT j

   RETURN cDefault

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD ReadFormStringData( cProp, cDefault ) CLASS TFormEditor

   LOCAL nLen, i, c2, c1, cRet

   cRet := cDefault
   IF ( i := At( " ", cProp ) ) > 0
      c1 := SubStr( cProp, 1, i - 1 )
      c2 := SubStr( cProp, i + 1 )
      nLen := Len( ::aFormData ) - 2
      FOR i := 2 TO nLen
         IF Upper( ::aFormData[i] ) == c1 .AND. ::aFormData[i - 1] == ";"
            IF Upper( ::aFormData[i + 1] ) == c2
               cRet := ::aFormData[i + 2]
               EXIT
            ENDIF
         ENDIF
      NEXT i
   ELSE
      nLen := Len( ::aFormData ) - 1
      FOR i := 1 TO nLen
         IF Upper( ::aFormData[i] ) == cProp
            cRet := ::aFormData[i + 1]
            EXIT
         ENDIF
      NEXT i
   ENDIF
   IF UpperNIL( ::Clean( cRet ) ) == "NIL"
      cRet := cDefault
   ENDIF

   RETURN cRet

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD ReadFormPosition() CLASS TFormEditor

   LOCAL nLen, i, cAux, j, cRow := "", cCol := ""

   nLen := Len( ::aFormData ) - 1
   FOR i := 1 TO nLen
      IF Upper( ::aFormData[i] ) == "AT"
         cAux := ::aFormData[i + 1]
         IF ( j := At( ",", cAux ) ) > 0
            cRow := AllTrim( SubStr( cAux, 1, j - 1 ) )
            cCol := AllTrim( SubStr( cAux, j + 1 ) )
         ELSE
            cRow := cAux
         ENDIF
         EXIT
      ENDIF
   NEXT i
   IF Empty( cRow ) .AND. Empty( cCol )
      ::ReadFormStringData( "ROW", "100" )
      ::ReadFormStringData( "COL", "100" )
   ENDIF
   IF Empty( cRow )
      cRow := "100"
   ENDIF
   IF Empty( cCol )
      cCol := "100"
   ENDIF

   RETURN { cRow, cCol }

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD ReadFormLogicalData( cProp ) CLASS TFormEditor

   LOCAL i

   FOR EACH i IN ::aFormData
      IF Upper( i ) == cProp
         RETURN .T.
      ENDIF
   NEXT i

   RETURN .F.

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD ReadCtrlRow( i ) CLASS TFormEditor

   LOCAL j, nFrom, nTo, cLine, nPos, cRow := "0"

   nFrom := ::aSpeed[i]
   nTo   := ::aNumber[i]
   /* Process @ lines */
   cLine := ::aLine[nFrom]
   IF Left( cLine, 8 ) == " *****@ "
      /* TAB, TIMER or TREE */
      cLine := " " + SubStr( cLine, 7 )
   ENDIF
   IF Left( cLine, 3 ) == " @ "
      cLine := LTrim( SubStr( cLine, 3 ) )
      IF ( nPos := At( ",", cLine ) ) > 0
         cRow := LTrim( Str( Val( RTrim( SubStr( cLine, 1, nPos - 1 ) ) ) ) )
      ELSE
         cLine := RTrim( cLine )
         IF ( nPos := At( " ", cLine ) ) > 0
            cRow := LTrim( Str( Val( SubStr( cLine, 1, nPos - 1 ) ) ) )
         ELSE
            IF Right( cLine, 1 ) == ";"
               cLine := RTrim( SubStr( cLine, 1, Len( cLine ) - 1 ) )
            ENDIF
            cRow := LTrim( Str( Val( cLine ) ) )
         ENDIF
      ENDIF
   ELSE
      /* Process AT clause, must be the first word of the line */
      FOR j := nFrom TO nTo
         cLine := ::aLine[j]
         IF At( " AT ", Upper( cLine) ) == 1
            IF ( nPos := At( ",", cLine ) ) > 0
               cRow := LTrim( Str( Val( AllTrim( SubStr( cLine, 5, nPos - 1 ) ) ) ) )
            ELSE
               cLine := AllTrim( SubStr( cLine, 5 ) )
               IF ( nPos := At( " ", cLine ) ) > 0
                  cRow := LTrim( Str( Val( SubStr( cLine, 1, nPos - 1 ) ) ) )
               ELSE
                  IF Right( cLine, 1 ) == ";"
                     cLine := RTrim( SubStr( cLine, 1, Len( cLine ) - 1 ) )
                  ENDIF
                  cRow := LTrim( Str( Val( cLine ) ) )
               ENDIF
            ENDIF
            EXIT
         ENDIF
      NEXT j
      /* Process ROW clause */
      cRow := ::ReadStringData( i, "ROW", cRow )
   ENDIF
   /* Clean return value */
   cRow := LTrim( Str( Val( cRow ) ) )

   RETURN cRow

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD ReadCtrlCol( i ) CLASS TFormEditor

   LOCAL j, nFrom, nTo, cLine, nPos, cCol := "0"

   nFrom := ::aSpeed[i]
   nTo   := ::aNumber[i]
   /* Process @ lines */
   cLine := ::aLine[nFrom]
   IF Left( cLine, 8 ) == " *****@ "
      /* TAB, TIMER or TREE */
      cLine := " " + SubStr( cLine, 7 )
   ENDIF
   IF Left( cLine, 3 ) == " @ "
      IF ( nPos := At( ",", cLine ) ) > 0
         cLine := AllTrim( SubStr( cLine, nPos + 1 ) )
         IF Right( cLine, 1 ) == ";"
            cLine := RTrim( SubStr( cLine, 1, Len( cLine ) - 1 ) )
         ENDIF
         IF ( nPos := At( " ", cLine ) ) > 0
            cCol := Left( cLine, nPos - 1 )
         ELSE
            cCol := cLine
         ENDIF
      ENDIF
   ELSE
      /* Process AT clause, must be the first word of the line */
      FOR j := nFrom TO nTo
         cLine := ::aLine[j]
         IF At( " AT ", Upper( cLine) ) == 1
            cLine := RTrim( SubStr( cLine, 5 ) )
            IF Right( cLine, 1 ) == ";"
               cLine := SubStr( cLine, 1, Len( cLine ) - 1 )
            ENDIF
            cLine := AllTrim( cLine )
            IF ( nPos := At( ",", cLine ) ) > 0
               cLine := LTrim( SubStr( cLine, nPos + 1 ) )
               IF ( nPos := At( " ", cLine ) ) > 0
                  cCol := Left( cLine, nPos - 1 )
               ELSE
                  cCol := cLine
               ENDIF
            ENDIF
            EXIT
         ENDIF
      NEXT j
      /* Process COL clause */
      cCol := ::ReadStringData( i, "COL", cCol )
   ENDIF
   /* Clean return value */
   cCol := LTrim( Str( Val( cCol ) ) )

   RETURN cCol

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD Clean( cData, uDefault ) CLASS TFormEditor

   LOCAL cIni, cFin

   DEFAULT uDefault TO cData

   cIni := Left( cData, 1 )
   cFin := Right( cData, 1 )
   IF cIni == SINGLE_QUOTATION_MARK .OR. cIni == DOUBLE_QUOTATION_MARK
      IF cIni == cFin
         RETURN SubStr( cData, 2, Len( cData ) - 2 )
      ENDIF
   ELSEIF cIni == "[" .AND. cFin == "]"
      RETURN SubStr( cData, 2, Len( cData ) - 2 )
   ENDIF

   RETURN uDefault

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD DrawPoints() CLASS TFormEditor

   LOCAL hDC, nHeight, nWidth, i, j, nTop := 0, oTBCtrl

   nHeight := ::oDesignForm:ClientHeight
   nWidth  := ::oDesignForm:ClientWidth

   IF _IsControlDefined( "StatusBar", ::oDesignForm:Name )
      nHeight -= ::oDesignForm:Statusbar:ClientHeightUsed
   ENDIF

   FOR i := 1 to ::myTbEditor:Count
      oTBCtrl := ::myTbEditor:aToolBars[i]:oTBCtrl
      IF HB_ISOBJECT( oTBCtrl )
         IF oTBCtrl:lTop
            nTop += Round( oTBCtrl:ClientHeightUsed(), -1 )
         ELSE
            nHeight -= Round( oTBCtrl:ClientHeightUsed(), -1 )
         ENDIF
      ENDIF
   NEXT i

   hDC := GetDC( ::oDesignForm:hWnd )

   FOR i := 0 TO nWidth STEP 10
      FOR j := nTop TO nHeight STEP 10
         SetPixel( hDC, i, j, RGB( 0, 0, 0 ) )
      NEXT
   NEXT

   ReleaseDC( ::oDesignForm:hWnd, hDC )

   DRAW LINE IN WINDOW ( ::oDesignForm:Name ) AT 480, 001 TO 480, nWidth  PENCOLOR { 255, 0, 0 } PENWIDTH 1
   DRAW LINE IN WINDOW ( ::oDesignForm:Name ) AT 600, 001 TO 600, nWidth  PENCOLOR { 255, 0, 0 } PENWIDTH 1
   DRAW LINE IN WINDOW ( ::oDesignForm:Name ) AT 001, 640 TO nHeight, 640 PENCOLOR { 255, 0, 0 } PENWIDTH 1
   DRAW LINE IN WINDOW ( ::oDesignForm:Name ) AT 001, 800 TO nHeight, 800 PENCOLOR { 255, 0, 0 } PENWIDTH 1
   /* TODO:
       4:3  aspect ratio resolutions: 640480, 800600, 960720, 1024768, 1280960, 14001050, 14401080 , 16001200, 18561392, 19201440, and 20481536.
      16:10 aspect ratio resolutions: 640400, 1280800, 1440900, 16801050, 19201200 and 25601600.
      16:9  aspect ratio resolutions: 512288, 1024576, 1152648, 1280720, 1366768, 1600900, 19201080, 25601440 and 38402160.
   */

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD PreProcessDefineWindow() CLASS TFormEditor

   LOCAL zi, zf, i, cData := "", j, k, c, lOnIsOk
   LOCAL aTokens0 := { "MAIN", "CHILD", "MODAL", "NOSHOW", "TOPMOST", "NOMINIMIZE", "NOMAXIMIZE", "NOSIZE", "NOSYSMENU", "NOCAPTION", "NOAUTORELEASE", "HELPBUTTON", "FOCUSED", "BREAK", "SPLITCHILD", "RTL", "CLIENTAREA", "MODALSIZE", "MDI", "MDICHILD", "MDICLIENT", "INTERNAL", "NODWP" }
   LOCAL aTokens1 := { "AT", "TITLE", "WIDTH", "HEIGHT", "OBJ", "PARENT", "ICON", "GRIPPERTEXT", "SUBCLASS", "CURSOR", "BACKCOLOR", "BACKIMAGE", "FONT", "FONTCOLOR", "MAXHEIGHT", "MAXWIDTH", "MINHEIGHT", "MINWIDTH", "NOTIFYICON", "NOTIFYTOOLTIP", "SIZE", "STRETCH", "INTERACTIVECLOSE" }
   LOCAL aTokens2 := { "DBLCLICK", "GOTFOCUS", "HSCROLLBOX", "INIT", "INTERACTIVECLOSE", "LOSTFOCUS", "MAXIMIZE", "MCLICK", "MDBLCLICK", "MINIMIZE", "MOUSECLICK", "MOUSEDRAG", "MOUSEMOVE", "MOVE", "NOTIFYCLICK", "PAINT", "RCLICK", "RDBLCLICK", "RELEASE", "RESTORE", "SCROLLDOWN", "SCROLLLEFT", "SCROLLRIGHT", "SCROLLUP", "SIZE", "VSCROLLBOX" }

   /* Concatenate lines */
   zi := ::aSpeed[1]
   zf := ::aNumber[1]
   FOR i := zi TO zf
      IF Empty( ::aLine[i] )
         EXIT
      ENDIF
      cData += ::aLine[i]
   NEXT i
   cData := RTrim( cData )
   /* Convert to tokens */
   ::aFormData := hb_ATokens( cData, " ", .T., .F. )
   /* Add ; at the end to make parsing easier */
   IF ATail( ::aFormData ) # ";"
      AAdd( ::aFormData, ";" )
   ENDIF
   /* This routine locates the window's clauses and concatenates all the
      subsequent tokens until the next clause or a semicolon is found */
   i := 1
   DO WHILE i < Len( ::aFormData )
      DO CASE
      CASE ::aFormData[i] == "VIRTUAL"
         /* VIRTUAL WIDTH <vWidth> ; */
         /* VIRTUAL HEIGHT <vHeight> ; */
         i ++
         IF ::aFormData[i] == "WIDTH" .OR. ::aFormData[i] == "HEIGHT"
            i ++
            j := i
            c := " "
            DO WHILE ::aFormData[j] # ";" .AND. ;
                     ! ::aFormData[j] == "ON" .AND. ;
                     ! ::aFormData[j] == "VIRTUAL" .AND. ;
                     ! AScan( aTokens0, ::aFormData[j] ) > 0 .AND. ;
                     ! AScan( aTokens1, ::aFormData[j] ) > 0
               c += ( " " + ::aFormData[j] )
               j ++
            ENDDO
            c := LTrim( c )
            IF ! Empty( c )
               ::aFormData[i] := c
               i ++
            ENDIF
         ELSE
            j := i
            DO WHILE ::aFormData[j] # ";" .AND. ;
                     ! ::aFormData[j] == "ON" .AND. ;
                     ! ::aFormData[j] == "VIRTUAL" .AND. ;
                     ! AScan( aTokens0, ::aFormData[j] ) > 0 .AND. ;
                     ! AScan( aTokens1, ::aFormData[j] ) > 0
               j ++
            ENDDO
         ENDIF
         FOR k := j - 1 TO i STEP -1
            ADel( ::aFormData, k )
            ASize( ::aFormData, Len( ::aFormData ) - 1 )
         NEXT
         IF ::aFormData[i] # ";"
            ASize( ::aFormData, Len( ::aFormData ) + 1 )
            AIns( ::aFormData, i )
            ::aFormData[i] := ";"
         ENDIF
         i ++
      CASE AScan( aTokens0, ::aFormData[i] ) > 0
         /* Logical properties */
         i ++
         j := i
         DO WHILE ::aFormData[j] # ";" .AND. ;
                  ! ::aFormData[j] == "ON" .AND. ;
                  ! ::aFormData[j] == "VIRTUAL" .AND. ;
                  ! AScan( aTokens0, ::aFormData[j] ) > 0 .AND. ;
                  ! AScan( aTokens1, ::aFormData[j] ) > 0
            j ++
         ENDDO
         FOR k := j - 1 TO i STEP -1
            ADel( ::aFormData, k )
            ASize( ::aFormData, Len( ::aFormData ) - 1 )
         NEXT
         IF ::aFormData[i] # ";"
            ASize( ::aFormData, Len( ::aFormData ) + 1 )
            AIns( ::aFormData, i )
            ::aFormData[i] := ";"
         ENDIF
         i ++
      CASE AScan( aTokens1, ::aFormData[i] ) > 0
         /* Properties with 1 parameter */
         lOnIsOk := ( ::aFormData[i] == "INTERACTIVECLOSE" )
         i ++
         j := i
         c := " "
         DO WHILE ::aFormData[j] # ";" .AND. ;
                  ( lOnIsOk .OR. ! ::aFormData[j] == "ON" ) .AND. ;
                  ! ::aFormData[j] == "VIRTUAL" .AND. ;
                  ! AScan( aTokens0, ::aFormData[j] ) > 0 .AND. ;
                  ! AScan( aTokens1, ::aFormData[j] ) > 0
            c += ( " " + ::aFormData[j] )
            j ++
         ENDDO
         c := LTrim( c )
         IF ! Empty( c )
            ::aFormData[i] := c
            i ++
         ENDIF
         FOR k := j - 1 TO i STEP -1
            ADel( ::aFormData, k )
            ASize( ::aFormData, Len( ::aFormData ) - 1 )
         NEXT
         IF ::aFormData[i] # ";"
            ASize( ::aFormData, Len( ::aFormData ) + 1 )
            AIns( ::aFormData, i )
            ::aFormData[i] := ";"
         ENDIF
         i ++
      CASE ::aFormData[i] == "ON"
         /* Events */
         i ++
         IF AScan( aTokens2, ::aFormData[i] ) > 0
            i ++
            j := i
            c := " "
            DO WHILE ::aFormData[j] # ";" .AND. ;
                     ! ::aFormData[j] == "ON" .AND. ;
                     ! ::aFormData[j] == "VIRTUAL" .AND. ;
                     ! ::aFormData[j] == "AT" .AND. ;
                     ! AScan( aTokens0, ::aFormData[j] ) > 0 .AND. ;
                     ! AScan( aTokens1, ::aFormData[j] ) > 0
               c += ( " " + ::aFormData[j] )
               j ++
            ENDDO
            c := LTrim( c )
            IF ! Empty( c )
               ::aFormData[i] := c
               i ++
            ENDIF
         ELSE
            j := i
            DO WHILE ::aFormData[j] # ";" .AND. ;
                     ! ::aFormData[j] == "ON" .AND. ;
                     ! ::aFormData[j] == "VIRTUAL" .AND. ;
                     ! ::aFormData[j] == "AT" .AND. ;
                     ! AScan( aTokens0, ::aFormData[j] ) > 0 .AND. ;
                     ! AScan( aTokens1, ::aFormData[j] ) > 0
               j ++
            ENDDO
         ENDIF
         FOR k := j - 1 TO i STEP -1
            ADel( ::aFormData, k )
            ASize( ::aFormData, Len( ::aFormData ) - 1 )
         NEXT
         IF ::aFormData[i] # ";"
            ASize( ::aFormData, Len( ::aFormData ) + 1 )
            AIns( ::aFormData, i )
            ::aFormData[i] := ";"
         ENDIF
         i ++
      OTHERWISE
         ADel( ::aFormData, i )
         ASize( ::aFormData, Len( ::aFormData ) - 1 )
      ENDCASE
   ENDDO

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pForm() CLASS TFormEditor

   LOCAL nFColForShow, cFFontForShow, nFHeight, nFMaxHeight, nFMaxWidth, nFMinHeight, nFMinWidth, nFRowForShow, nFSizeForShow
   LOCAL cFTitleForShow, nFVirtualH, nFVirtualW, nFWidth, uFBkClrForShow, uFColorForShow

   ::PreProcessDefineWindow()

   /* Load window's properties */
   ::cFPosition           := ::ReadFormPosition()
   ::cFTitle              := ::ReadFormStringData( "TITLE", "" )
   ::cFObj                := ::ReadFormStringData( "OBJ", "" )
   ::cFCargo              := ::ReadCargo( 1, "LASTFORM.CARGO" )
   ::cFIcon               := ::ReadFormStringData( "ICON", "" )
   ::cFGripperText        := ::ReadFormStringData( "GRIPPERTEXT", "" )
   ::cFInterActClose      := ::ReadFormStringData( "INTERACTIVECLOSE", "" )
   ::cFBackColor          := ::ReadFormStringData( "BACKCOLOR", "" )
   ::cFCursor             := ::ReadFormStringData( "CURSOR", "" )
   ::cFFontName           := ::ReadFormStringData( "FONT", "" )             /* Do not force a font when the form has none, use OOHG default */
   ::cFFontName           := ::ReadOopData( 1, "FONTNAME", ::cFFontName )
   ::cFFontColor          := ::ReadFormStringData( "FONTCOLOR", "" )
   ::cFFontColor          := ::ReadOopData( 1, "FONTCOLOR", ::cFFontColor )
   ::cFNotifyIcon         := ::ReadFormStringData( "NOTIFYICON", "" )
   ::cFNotifyToolTip      := ::ReadFormStringData( "NOTIFYTOOLTIP", "" )
   ::cFBackImage          := ::ReadFormStringData( "BACKIMAGE", "" )
   ::cFParent             := ::ReadFormStringData( "PARENT", "" )
   ::cFSubClass           := ::ReadFormStringData( "SUBCLASS", "" )
   ::cFWidth              := ::ReadFormStringData( "WIDTH", "640" )
   ::cFHeight             := ::ReadFormStringData( "HEIGHT", "480" )
   ::cFVirtualW           := ::ReadFormStringData( "VIRTUAL WIDTH", "" )               /* Must be declared after WIDTH */
   ::cFVirtualH           := ::ReadFormStringData( "VIRTUAL HEIGHT", "" )              /* Must be declared after HEIGHT */
   ::cFFontSize           := ::ReadFormStringData( "SIZE", "" )
   ::cFFontSize           := ::ReadOopData( 1, "FONTSIZE", ::cFFontSize )
   ::cFMinWidth           := ::ReadFormStringData( "MINWIDTH", "" )
   ::cFMaxWidth           := ::ReadFormStringData( "MAXWIDTH", "" )
   ::cFMinHeight          := ::ReadFormStringData( "MINHEIGHT", "" )
   ::cFMaxHeight          := ::ReadFormStringData( "MAXHEIGHT", "" )
   ::cFDblClickProcedure  := ::ReadFormStringData( "ON DBLCLICK", "" )
   ::cFDblClickProcedure  := ::ReadFormStringData( "ONDBLCLICK", ::cFDblClickProcedure )
   ::cFMClickProcedure    := ::ReadFormStringData( "ON MCLICK", "" )
   ::cFMClickProcedure    := ::ReadFormStringData( "ONMCLICK", ::cFMClickProcedure )
   ::cFMDblClickProcedure := ::ReadFormStringData( "ON MDBLCLICK", "" )
   ::cFMDblClickProcedure := ::ReadFormStringData( "ONMDBLCLICK", ::cFMDblClickProcedure )
   ::cFMoveProcedure      := ::ReadFormStringData( "ON MOVE", "" )
   ::cFMoveProcedure      := ::ReadFormStringData( "ONMOVE", ::cFMoveProcedure )
   ::cFOnGotFocus         := ::ReadFormStringData( "ON GOTFOCUS", "" )
   ::cFOnGotFocus         := ::ReadFormStringData( "ONGOTFOCUS", ::cFOnGotFocus )
   ::cFOnHScrollbox       := ::ReadFormStringData( "ON HSCROLLBOX", "" )
   ::cFOnHScrollbox       := ::ReadFormStringData( "ONHSCROLLBOX", ::cFOnHScrollbox )
   ::cFOnInit             := ::ReadFormStringData( "ON INIT", "" )
   ::cFOnInit             := ::ReadFormStringData( "ONINIT", ::cFOnInit )
   ::cFOnInteractiveClose := ::ReadFormStringData( "ON INTERACTIVECLOSE", "" )
   ::cFOnInteractiveClose := ::ReadFormStringData( "ONINTERACTIVECLOSE", ::cFOnInteractiveClose )
   ::cFOnLostFocus        := ::ReadFormStringData( "ON LOSTFOCUS", "" )
   ::cFOnLostFocus        := ::ReadFormStringData( "ONLOSTFOCUS", ::cFOnLostFocus )
   ::cFOnMaximize         := ::ReadFormStringData( "ON MAXIMIZE", "" )
   ::cFOnMaximize         := ::ReadFormStringData( "ONMAXIMIZE", ::cFOnMaximize )
   ::cFOnMinimize         := ::ReadFormStringData( "ON MINIMIZE", "" )
   ::cFOnMinimize         := ::ReadFormStringData( "ONMINIMIZE", ::cFOnMinimize )
   ::cFOnMouseClick       := ::ReadFormStringData( "ON MOUSECLICK", "" )
   ::cFOnMouseClick       := ::ReadFormStringData( "ONMOUSECLICK", ::cFOnMouseClick )
   ::cFOnMouseDrag        := ::ReadFormStringData( "ON MOUSEDRAG", "" )
   ::cFOnMouseDrag        := ::ReadFormStringData( "ONMOUSEDRAG", ::cFOnMouseDrag )
   ::cFOnMouseMove        := ::ReadFormStringData( "ON MOUSEMOVE", "" )
   ::cFOnMouseMove        := ::ReadFormStringData( "ONMOUSEMOVE", ::cFOnMouseMove )
   ::cFOnNotifyClick      := ::ReadFormStringData( "ON NOTIFYCLICK", "" )
   ::cFOnNotifyClick      := ::ReadFormStringData( "ONNOTIFYCLICK", ::cFOnNotifyClick )
   ::cFOnPaint            := ::ReadFormStringData( "ON PAINT", "" )
   ::cFOnPaint            := ::ReadFormStringData( "ONPAINT", ::cFOnPaint )
   ::cFOnRelease          := ::ReadFormStringData( "ON RELEASE", "" )
   ::cFOnRelease          := ::ReadFormStringData( "ONRELEASE", ::cFOnRelease )
   ::cFOnScrollDown       := ::ReadFormStringData( "ON SCROLLDOWN", "" )
   ::cFOnScrollDown       := ::ReadFormStringData( "ONSCROLLDOWN", ::cFOnScrollDown )
   ::cFOnScrollLeft       := ::ReadFormStringData( "ON SCROLLLEFT", "" )
   ::cFOnScrollLeft       := ::ReadFormStringData( "ONSCROLLLEFT", ::cFOnScrollLeft )
   ::cFOnScrollRight      := ::ReadFormStringData( "ON SCROLLRIGHT", "" )
   ::cFOnScrollRight      := ::ReadFormStringData( "ONSCROLLRIGHT", ::cFOnScrollRight )
   ::cFOnScrollUp         := ::ReadFormStringData( "ON SCROLLUP", "" )
   ::cFOnScrollUp         := ::ReadFormStringData( "ONSCROLLUP", ::cFOnScrollUp )
   ::cFOnSize             := ::ReadFormStringData( "ON SIZE", "" )
   ::cFOnSize             := ::ReadFormStringData( "ONSIZE", ::cFOnSize )
   ::cFOnVScrollbox       := ::ReadFormStringData( "ON VSCROLLBOX", "" )
   ::cFOnVScrollbox       := ::ReadFormStringData( "ONVSCROLLBOX", ::cFOnVScrollbox )
   ::cFRClickProcedure    := ::ReadFormStringData( "ON RCLICK", "" )
   ::cFRClickProcedure    := ::ReadFormStringData( "ONRCLICK", ::cFRClickProcedure )
   ::cFRDblClickProcedure := ::ReadFormStringData( "ON RDBLCLICK", "" )
   ::cFRDblClickProcedure := ::ReadFormStringData( "ONRDBLCLICK", ::cFRDblClickProcedure )
   ::cFRestoreProcedure   := ::ReadFormStringData( "ON RESTORE", "" )
   ::cFRestoreProcedure   := ::ReadFormStringData( "ONRESTORE", ::cFRestoreProcedure )
   ::lFBorder             := ::ReadFormLogicalData( "BORDER" )
   ::lFBreak              := ::ReadFormLogicalData( "BREAK" )
   ::lFChild              := ::ReadFormLogicalData( "CHILD" )
   ::lFClientArea         := ::ReadFormLogicalData( "CLIENTAREA" )
   ::lFFocused            := ::ReadFormLogicalData( "FOCUSED" )
   ::lFHelpButton         := ::ReadFormLogicalData( "HELPBUTTON" )
   ::lFInternal           := ::ReadFormLogicalData( "INTERNAL" )
   ::lFMDI                := ::ReadFormLogicalData( "MDI" )
   ::lFMDIChild           := ::ReadFormLogicalData( "MDICHILD" )
   ::lFMDIClient          := ::ReadFormLogicalData( "MDICLIENT" )
   ::lFMain               := ::ReadFormLogicalData( "MAIN" )
   ::lFModal              := ::ReadFormLogicalData( "MODAL" )
   ::lFModalSize          := ::ReadFormLogicalData( "MODALSIZE" )
   ::lFNoAutoRelease      := ::ReadFormLogicalData( "NOAUTORELEASE" )
   ::lFNoCaption          := ::ReadFormLogicalData( "NOCAPTION" )
   ::lFNoDefWinProc       := ::ReadFormLogicalData( "NODWP" )
   ::lFNoMaximize         := ::ReadFormLogicalData( "NOMAXIMIZE" )
   ::lFNoMinimize         := ::ReadFormLogicalData( "NOMINIMIZE" )
   ::lFNoShow             := ::ReadFormLogicalData( "NOSHOW" )
   ::lFNoSize             := ::ReadFormLogicalData( "NOSIZE" )
   ::lFNoSysMenu          := ::ReadFormLogicalData( "NOSYSMENU" )
   ::lFRTL                := ::ReadFormLogicalData( "RTL" )
   ::lFSplitchild         := ::ReadFormLogicalData( "SPLITCHILD" )
   ::lFStretch            := ::ReadFormLogicalData( "STRETCH" )
   ::lFTopmost            := ::ReadFormLogicalData( "TOPMOST" )

   /* Derive values that can be used in the design form */
   nFRowForShow   := ::StrToValueForm( "ROW", ::cFPosition[1], "N", 120, 0, GetDesktopRealHeight() - ::myIDE:nRowBorder )
   nFColForShow   := ::StrToValueForm( "COL", ::cFPosition[2], "N", 120, 0, GetDesktopRealWidth() - ::myIDE:nColBorder )
   cFTitleForShow := ::StrToValueForm( "TITLE", ::cFTitle, "C", "Form's title" )
   cFFontForShow  := iif( ! NOTEMPTY( ::cFFontName ), _OOHG_DefaultFontName, ::StrToValueForm( "FONT", ::cFFontName, "C", ::myIde:cFormDefFontName ) )
   uFColorForShow := iif( ! NOTEMPTY( ::cFFontColor ), _OOHG_DefaultFontColor, ::StrToValueForm( "FONTCOLOR", ::cFFontColor, "X", ::myIde:cFormDefFontColor ) )
   uFBkClrForShow := iif( ! NOTEMPTY( ::cFBackColor ), NIL, ::StrToValueForm( "BACKCOLOR", ::cFBackColor, "X", ::myIde:aSystemColor ) )
   nFSizeForShow  := iif( ! NOTEMPTY( ::cFFontSize ), _OOHG_DefaultFontSize, ::StrToValueForm( "SIZE", ::cFFontSize, "N", ::myIde:nFormDefFontSize, 0, 0 ) )
   nFWidth        := ::StrToValueForm( "WIDTH", ::cFWidth, "N", 700, GetSystemMetrics( SM_CXMIN ), 0 )
   nFHeight       := ::StrToValueForm( "HEIGHT", ::cFHeight, "N", 480, GetSystemMetrics( SM_CYMIN ), 0 )
   nFVirtualW     := ::StrToValueForm( "VIRTUAL WIDTH", ::cFVirtualW, "N", 0, 0, 0 )
   nFVirtualH     := ::StrToValueForm( "VIRTUAL HEIGHT", ::cFVirtualH, "N", 0, 0, 0 )
   nFMaxWidth     := ::StrToValueForm( "MAXWIDTH", ::cFMaxWidth, "N", 0, 0, 0 )
   nFMaxHeight    := ::StrToValueForm( "MAXHEIGHT", ::cFMaxHeight, "N", 0, 0, 0 )
   nFMinWidth     := ::StrToValueForm( "MINWIDTH", ::cFMinWidth, "N", 0, GetSystemMetrics( SM_CXMIN ), 0 )
   nFMinHeight    := ::StrToValueForm( "MINHEIGHT", ::cFMinHeight, "N", 0, GetSystemMetrics( SM_CYMIN ), 0 )

   /* Apply derived values to design form */
   ::oDesignForm:Hide()
   ::oDesignForm:Row           := nFRowForShow
   ::oDesignForm:Col           := nFColForShow
   ::oDesignForm:Title         := cFTitleForShow
   ::oDesignForm:cFontName     := cFFontForShow
   ::oDesignForm:nFontSize     := nFSizeForShow
   ::oDesignForm:FontColor     := uFColorForShow
   ::oDesignForm:BackColor     := uFBkClrForShow
   ::oDesignForm:nWidth        := nFWidth
   ::oDesignForm:Width         := nFWidth
   ::oDesignForm:nHeight       := nFHeight
   ::oDesignForm:Height        := nFHeight
   ::oDesignForm:VirtualWidth  := nFVirtualW
   ::oDesignForm:VirtualHeight := nFVirtualH
   ::oDesignForm:MaxWidth      := nFMaxWidth
   ::oDesignForm:MaxHeight     := nFMaxHeight
   ::oDesignForm:MinWidth      := nFMinWidth
   ::oDesignForm:MinHeight     := nFMinHeight
   ::oDesignForm:OnMove        := {|| ::FrmMoved() }
   ::oDesignForm:OnSize        := {|| ::FrmSized() }
   IF ::lFClientArea
      ClientAreaResize( ::oDesignForm )
   ENDIF
   ::oDesignForm:Show()

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD StrToValueCtrl( cData, cType, uDefault, nMin, nMax, cItemType ) CLASS TFormEditor

   LOCAL uRet, i

   IF cType == "C"
      /* Return value must be a string or NIL */
      IF Empty( cData )
         uRet := uDefault
      ELSEIF Type( cData ) == "C"
         uRet := &( cData )
      ELSE
         /* Assume it's a constant an try to find a #define */
         IF ( uRet := ::TranslateConstant( cData, "C" ) ) == NIL
            /* Return default value */
            uRet := uDefault
         ENDIF
      ENDIF
   ELSEIF cType == "L"
      /* Return value must be a logical or NIL */
      IF Type( cData ) == "L"
         uRet := &( cData )
      ELSE
         /* Assume it's a constant an try to find a #define */
         IF ( uRet := ::TranslateConstant( cData, "L" ) ) == NIL
            /* Return default value */
            uRet := uDefault
         ENDIF
      ENDIF
   ELSEIF cType == "N"
      /* Return value must be a number or NIL */
      IF Type( cData ) == "N"
         uRet := &( cData )
      ELSE
         /* Assume it's a constant an try to find a #define */
         IF ( uRet := ::TranslateConstant( cData, "N" ) ) == NIL
            /* Return default value */
            uRet := uDefault
         ENDIF
      ENDIF
      IF HB_ISNUMERIC( uRet )
         IF HB_ISNUMERIC( nMin ) .AND. uRet < nMin
            uRet := uDefault
         ENDIF
         IF HB_ISNUMERIC( nMax ) .AND. uRet > nMax
            uRet := uDefault
         ENDIF
      ENDIF
   ELSEIF cType == "D"
      /* Return value must be a date or NIL */
      IF Type( cData ) == "D"
         uRet := &( cData )
      ELSE
         /* Assume it's a constant an try to find a #define */
         IF ( uRet := ::TranslateConstant( cData, "D" ) ) == NIL
            /* Return default value */
            uRet := uDefault
         ENDIF
      ENDIF
      IF HB_ISDATE( uRet )
         IF HB_ISDATE( nMin ) .AND. uRet < nMin
            uRet := uDefault
         ENDIF
         IF HB_ISDATE( nMax ) .AND. uRet > nMax
            uRet := uDefault
         ENDIF
      ENDIF
   ELSEIF cType == "A"
      IF "A" == Type( cData )
         uRet := &( cData )
         IF nMax > 0 .AND. Len( cData ) > nMax
            ASize( uRet, nMax )
         ENDIF
         IF nMin > 0
            IF nMax == nMin
               IF Len( uRet ) # nMin
                  ASize( uRet, nMax )
               ENDIF
            ELSEIF Len( uRet ) < nMin
               ASize( uRet, nMin )
            ENDIF
         ENDIF
         FOR i := 1 TO Len( uRet )
            IF ValType( uRet[ i ] ) # cItemType
               IF cItemType == "C"
                  uRet[ i ] := ""
               ELSEIF cItemType == "N"
                  uRet[ i ] := 0
               ELSEIF cItemType == "L"
                  uRet[ i ] := .F.
               ENDIF
            ENDIF
         NEXT i
      ELSE
         /* Assume it's a constant an try to find a #define */
         IF ( uRet := ::TranslateConstant( cData, "A", nMin, nMax, cItemType ) ) == NIL
            /* Return default value */
            uRet := uDefault
         ENDIF
      ENDIF
   ELSEIF cType == "X"
      /* Return value must be a color or NIL */
      uRet := ::myIde:StrToColor( cData )
      IF uRet == NIL
         /* Assume it's a constant an try to find a #define */
         IF ( uRet := ::TranslateConstant( cData, "X" ) ) == NIL
            /* Return default value */
            uRet := uDefault
         ENDIF
      ENDIF
   ELSE
      /* Should never happen */
      uRet := NIL
   ENDIF

   RETURN uRet

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD StrToValueForm( cKey, cData, cType, uDefault, nMin, nMax ) CLASS TFormEditor

   LOCAL uRet

   IF cType == "C"
      /* Return value must be a string */
      IF Empty( cData )
         uRet := ""
      ELSEIF Type( cData ) == "C"
         uRet := &( cData )
      ELSE
         /* Assume it's a constant an try to find a #define */
         IF ( uRet := ::TranslateConstant( cData, "C" ) ) == NIL
            /* Look for last value used */
            IF ( uRet := ::LookForLastValueUsed( cKey, "C" ) ) == NIL
               /* Return default value */
               uRet := uDefault
            ENDIF
         ENDIF
      ENDIF
   ELSEIF cType == "N"
      /* Return value must be a number */
      IF Type( cData ) == "N"
         uRet := &( cData )
      ELSE
         /* Assume it's a constant an try to find a #define */
         IF ( uRet := ::TranslateConstant( cData, "N" ) ) == NIL
            /* Look for last value used */
            IF ( uRet := ::LookForLastValueUsed( cKey, "N" ) ) == NIL
               /* Return default value */
               uRet := uDefault
            ENDIF
         ENDIF
      ENDIF
      IF uRet < nMin
         uRet := uDefault
      ELSEIF nMax > 0 .AND. uRet > nMax
         uRet := uDefault
      ENDIF
   ELSEIF cType == "X"
      /* Return value must be a color */
      uRet := ::myIde:StrToColor( cData )
      IF uRet == NIL
         /* Assume it's a constant an try to find a #define */
         IF ( uRet := ::TranslateConstant( cData, "X" ) ) == NIL
            /* Look for last value used */
            IF ( uRet := ::LookForLastValueUsed( cKey, "X" ) ) == NIL
               /* Return default value */
               uRet := uDefault
            ENDIF
         ENDIF
      ENDIF
   ELSE
      /* Should never happen */
      uRet := NIL
   ENDIF

   RETURN uRet

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD TranslateConstant( cConstant, cType, nMin, nMax, cItemType ) CLASS TFormEditor

   LOCAL i, j, uRet

   FOR i := 1 TO Len( ::aFDefines )
      IF ::aFDefines[i, 1] == cConstant
         IF cType == "X"
            RETURN ::myIde:StrToColor( ::aFDefines[i, 2] )
         ELSEIF cType $ "CNDL"
            IF Type( ::aFDefines[i, 2] ) == cType
               RETURN &( ::aFDefines[i, 2] )
            ENDIF
         ELSEIF cType == "A"
            IF Type( ::aFDefines[i, 2] ) == "A"
               uRet := &( ::aFDefines[i, 2] )
               IF nMax > 0 .AND. Len( uRet ) > nMax
                  ASize( uRet, nMax )
               ENDIF
               IF nMin > 0
                  IF nMax == nMin
                     IF Len( uRet ) # nMin
                        ASize( uRet, nMax )
                     ENDIF
                  ELSEIF Len( uRet ) < nMin
                     ASize( uRet, nMin )
                  ENDIF
               ENDIF
               FOR j := 1 TO Len( uRet )
                  IF ValType( uRet[ j ] ) # cItemType
                     IF cItemType == "C"
                        uRet[ j ] := ""
                     ELSEIF cItemType == "N"
                        uRet[ j ] := 0
                     ELSEIF cItemType == "L"
                        uRet[ j ] := .F.
                     ENDIF
                  ENDIF
               NEXT j
               RETURN uRet
            ENDIF
         ENDIF
      ENDIF
   NEXT i

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD LookForLastValueUsed( cKey, cType ) CLASS TFormEditor

   LOCAL j, nPos, cLine

/*
   *****TEMPLATE ;
   *****   ROW nRow ;
   *****   COL nCol ;
   *****   TITLE cTitle ;
   *****   FONT cFont ;
   *****   SIZE nSize ;
   *****   FONTCOLOR uColor ;
   *****   BACKCOLOR uColor ;
   *****   WIDTH nWidth ;
   *****   HEIGHT nHeight ;
   *****   VIRTUAL WIDTH nVirtualW ;
   *****   VIRTUAL HEIGHT nVirtualH ;
   *****   MAXWIDTH nMaxW ;
   *****   MAXHEIGHT nMaxH ;
   *****   MINWIDTH nMinW ;
   *****   MINHEIGHT nMinH ;
*/
   IF cKey # "NIL"
      FOR j := ::cFSpeed + 1 TO ::cFNumber
         nPos := Len( cKey ) + 10
         IF Left( ::aLine[j], nPos ) == ( " *****   " + cKey + " " )
            cLine := RTrim( SubStr( ::aLine[j], nPos + 1 ) )
            IF Right( cLine, 1 ) == ";"
               cLine := RTrim( SubStr( cLine, 1, Len( cLine ) - 1 ) )
            ENDIF
            cLine := LTrim( cLine )
            IF cType == "X"
               RETURN ::myIde:StrToColor( cLine )
            ELSEIF cType $ "CN"
               IF Type( cLine ) == cType
                  RETURN &( cLine )
               ENDIF
            ENDIF
            EXIT
         ENDIF
      NEXT j
   ENDIF

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD ColorStrToColorDef( cColor ) CLASS TFormEditor

   LOCAL uRet, aColor, nPos

   IF Type( cColor ) == "A"
      aColor := &( cColor )
      IF Len( aColor ) == 3 .AND. HB_ISNUMERIC( aColor[1] ) .AND. HB_ISNUMERIC( aColor[2] ) .AND. HB_ISNUMERIC( aColor[3] )
         /* #define take precedence over #xtranslate, #define is case-sensitive and #xtranslate isn't */
         IF ( nPos := AScan( ::myIde:aClrDefs, {|cd| cd[2, 1] == aColor[1] .AND. cd[2, 2] == aColor[2] .AND. cd[2, 3] == aColor[3] } ) )  > 0
            uRet := ::myIde:aClrDefs[nPos, 1]
         ELSEIF ( nPos := AScan( ::myIde:aClrXtrs, {|cx| cx[2, 1] == aColor[1] .AND. cx[2, 2] == aColor[2] .AND. cx[2, 3] == aColor[3] } ) )  > 0
            uRet := ::myIde:aClrXtrs[nPos, 1]
         ELSE
            uRet := cColor
         ENDIF
      ELSE
         uRet := cColor
      ENDIF
   ELSE
      uRet := cColor
   ENDIF

   RETURN uRet

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pActiveX( i ) CLASS TFormEditor

   LOCAL cCargo, cObj, cParent, cProgID, cSubClass, cVal, lEnabled, lNoTabStop, lVisible, nCol, nHeight, nRow, nWidth, oCtrl

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", "100" ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", "100" ) )
   cProgID             := ::ReadStringData( i, "PROGID", "" )
   lNoTabStop          := ( ( cVal := ::ReadLogicalData( i, "TABSTOP", "N" ) ) == "F" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "NOTABSTOP", "N" ) == "T" ) )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_ACTIVEX ]
   ::aCObj[i]          := cObj
   ::aProgID[i]        := cProgID
   ::aNoTabStop[i]     := lNoTabStop
   ::aDisabled[i]      := ! lEnabled
   ::aInvisible[i]     := ! lVisible
   ::aSubClass[i]      := cSubClass
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pAniGIF( i ) CLASS TFormEditor

   LOCAL aBackColor, cAction, cCargo, cFile, cHelpId, cObj, cParent, cSubClass, cToolTip, cVal, lBorder, lClientEdge, lEnabled, lRTL
   LOCAL lVisible, lWhiteBack, nCol, nHeight, nRow, nWidth, oCtrl

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( TImage():nWidth ) ) ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( TImage():nHeight ) ) ) )
   cAction             := ::ReadStringData( i, "ACTION", "" )
   cAction             := ::ReadStringData( i, "ON CLICK", cAction )
   cAction             := ::ReadStringData( i, "ONCLICK", cAction )
   cHelpId             := ::ReadStringData( i, "HELPID", "" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   lWhiteBack          := ( ::ReadLogicalData( i, "WHITEBACKGROUND", "F" ) == "T" )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   cFile               := ::ReadStringData(i, "FILE", "" )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   lBorder             := ( ::ReadLogicalData( i, "BORDER", "F" ) == "T" )
   lClientEdge         := ( ::ReadLogicalData( i, "CLIENTEDGE", "F") == "T" )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_ANIGIF ]
   ::aCObj[i]          := cObj
   ::aAction[i]        := cAction
   ::aFile[i]          := cFile
   ::aToolTip[i]       := cToolTip
   ::aBorder[i]        := lBorder
   ::aClientEdge[i]    := lClientEdge
   ::aInvisible[i]     := ! lVisible
   ::aDisabled[i]      := ! lEnabled
   ::aHelpID[i]        := cHelpid
   ::aBackColor[i]     := aBackColor
   ::aRTL[i]           := lRTL
   ::aWhiteBack[i]     := lWhiteBack
   ::aSubClass[i]      := cSubClass
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pAnimatebox( i ) CLASS TFormEditor

   LOCAL cCargo, cFile, cHelpid, cObj, cParent, cSubClass, cToolTip, cVal, lAutoplay, lCenter, lEnabled, lNoTabStop, lRTL, lTrans
   LOCAL lVisible, nCol, nHeight, nRow, nWidth, oCtrl

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", "100" ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", "100" ) )
   cFile               := ::ReadStringData( i, "FILE", "" )
   lAutoplay           := ( ::ReadLogicalData( i, "AUTOPLAY", "F") == "T" )
   lCenter             := ( ::ReadLogicalData( i, "CENTER", "F" ) == "T" )
   lTrans              := ( ::ReadLogicalData( i, "TRANSPARENT", "F" ) == "T" )
   cHelpid             := ::ReadStringData( i, "HELPID", "" )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lNoTabStop          := ( ( cVal := ::ReadLogicalData( i, "TABSTOP", "N" ) ) == "F" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "NOTABSTOP", "N" ) == "T" ) )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_ANIMATEBOX ]
   ::aCObj[i]          := cObj
   ::aFile[i]          := cFile
   ::aAutoPlay[i]      := lAutoplay
   ::aCenter[i]        := lCenter
   ::aTransparent[i]   := lTrans
   ::aHelpID[i]        := cHelpId
   ::aSubClass[i]      := cSubClass
   ::aInvisible[i]     := ! lVisible
   ::aNoTabStop[i]     := lNoTabStop
   ::aDisabled[i]      := ! lEnabled
   ::aRTL[i]           := lRTL
   ::aToolTip[i]       := cToolTip
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pBrowse( i ) CLASS TFormEditor

   LOCAL aBackColor, aFontColor, aSelColor, cAction, cAfterColMove, cAfterColSize, cBeforeAutoFit, cBeforeColMove, cBeforeColSize
   LOCAL cCargo, cColControls, cColumnInfo, cDefVal, cDeleteMsg, cDeleteWhen, cDynBackColor, cDynamicBlocks, cDynamicCtrls
   LOCAL cDynForecolor, cEditCell, cEditKeys, cEditKeysFun, cFields, cFixedBlocks, cFixedCtrls, cFocusRect, cFontName, cForceRefresh
   LOCAL cHdrImgAlign, cHdrImgs, cHdrBackClrs, cHdrFontClrs, cHdrs, cHelpId, cImage, cInputMask, cJustify, cNewAtRow, cNoFocusRect
   LOCAL cNoRefresh, cObj, cOnAbortEdit, cOnAppend, cOnBfrEdtCell, cOnChange, cOnCheckChg, cOnDblClick, cOnDelete, cOnEditCell
   LOCAL cOnEditEnd, cOnEnter, cOnGotFocus, cOnHeadClick, cOnHeadDClick, cOnHeadRClick, cOnLostFocus, cOnRClick, cOnRowRefresh
   LOCAL cParent, cReadOnly, cReplaceField, cSubClass, cSync, cTimeOut, cToolTip, cUnSync, cVal, cValid, cValidMess, cValue, cWhen
   LOCAL cWidths, cWorkArea, lAppend, lBold, lBreak, lButtons, lByCell, lCBE, lCellTT, lCheckBoxes, lDelete, lDescending
   LOCAL lDisableAltA, lEdit, lEditFV, lEnableAltA, lEnabled, lExtDblClick, lFixedCols, lFixedWidths, lFullMove, lInPlace, lItalic
   LOCAL lKeysLkClp, lLikeExcel, lLock, lNoDefaultMsg, lNoDeleteMsg, lNoHeaders, lNoHScroll, lNoLines, lNoModalEdit, lNoneUnsels
   LOCAL lNoShow, lNoTabStop, lNoVScroll, lPLM, lRTL, lRecCount, lSilent, lSingleBuffer, lStrikeout, lUnderline, lUpdateAll
   LOCAL lUpdateColors, lVisible, nCol, nFontSize, nHeight, nRow, nWidth, oCtrl, uFontName, uFontSize

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( TOBrowse():nWidth ) ) ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( TOBrowse():nHeight ) ) ) )
   cHdrs               := ::ReadStringData( i, "HEADERS", "{ '', '' } ")
   cWidths             := ::ReadStringData( i, "WIDTHS", "{ 100, 60 }")
   cWorkArea           := ::ReadStringData( i, "WORKAREA", "ALIAS()" )
   cFields             := ::ReadStringData( i, "FIELDS", "{ 'field1', 'field2' }" )
   cInputMask          := ::ReadStringData( i, "INPUTMASK", "")
   cValue              := ::ReadStringData( i, "VALUE", "" )
   uFontName           := ::ReadStringData( i, "FONT", "" )
   uFontName           := ::ReadStringData( i, "FONTNAME", uFontName )
   uFontName           := ::ReadOopData( i, "FONTNAME", uFontName )
   cFontName           := ::StrToValueCtrl( uFontName, "C", "" )
   uFontSize           := ::ReadStringData( i, "SIZE", "" )
   uFontSize           := ::ReadStringData( i, "FONTSIZE", uFontSize )
   uFontSize           := ::ReadOopData( i, "FONTSIZE", uFontSize )
   nFontSize           := ::StrToValueCtrl( uFontSize, "N", 0, 1, 9999 )
   lBold               := ( ::ReadLogicalData( i, "BOLD", "F" ) == "T" )
   lBold               := ( ::ReadLogicalData( i, "FONTBOLD", iif( lBold, "T", "F" ) ) == "T" )
   lBold               := ( Upper( ::ReadOopData( i, "FONTBOLD", iif( lBold, ".T.", ".F." ) ) ) == ".T." )
   lItalic             := ( ::ReadLogicalData( i, "ITALIC", "F" ) == "T" )
   lItalic             := ( ::ReadLogicalData( i, "FONTITALIC", iif( lItalic, "T", "F" ) ) == "T" )
   lItalic             := ( Upper( ::ReadOopData( i, "FONTITALIC", iif( lItalic, ".T.", ".F." ) ) ) == ".T." )
   lUnderline          := ( ::ReadLogicalData( i, "UNDERLINE", "F" ) == "T" )
   lUnderline          := ( ::ReadLogicalData( i, "FONTUNDERLINE", iif( lUnderline, "T", "F" ) ) == "T" )
   lUnderline          := ( Upper( ::ReadOopData( i, "FONTUNDERLINE", iif( lUnderline, ".T.", ".F." ) ) ) == ".T." )
   lStrikeout          := ( ::ReadLogicalData( i, "STRIKEOUT", "F" ) == "T" )
   lStrikeout          := ( ::ReadLogicalData( i, "FONTSTRIKEOUT", iif( lStrikeout, "T", "F" ) ) == "T" )
   lStrikeout          := ( Upper( ::ReadOopData( i, "FONTSTRIKEOUT", iif( lStrikeout, ".T.", ".F." ) ) ) == ".T." )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   cDynBackColor       := ::ReadStringData( i, "DYNAMICBACKCOLOR", "" )
   cDynForecolor       := ::ReadStringData( i, "DYNAMICFORECOLOR", "" )
   aFontColor          := ::ReadStringData( i, "FONTCOLOR", "NIL" )
   aFontColor          := UpperNIL( ::ReadOopData( i, "FONTCOLOR", aFontColor ) )
   cOnGotFocus         := ::ReadStringData( i, "ON GOTFOCUS", "" )
   cOnGotFocus         := ::ReadStringData( i, "ONGOTFOCUS", cOnGotFocus )
   cOnChange           := ::ReadStringData( i, "ON CHANGE", "" )
   cOnChange           := ::ReadStringData( i, "ONCHANGE", cOnChange )
   cOnLostFocus        := ::ReadStringData( i, "ON LOSTFOCUS", "" )
   cOnLostFocus        := ::ReadStringData( i, "ONLOSTFOCUS", cOnLostFocus )
   cOnDblClick         := ::ReadStringData( i, "ON DBLCLICK", "" )
   cOnDblClick         := ::ReadStringData( i, "ONDBLCLICK", cOnDblClick )
   cAction             := ::ReadStringData( i, "ACTION", "" )
   cAction             := ::ReadStringData( i, "ON CLICK",cAction )
   cAction             := ::ReadStringData( i, "ONCLICK", cAction )
   lEdit               := ( ::ReadLogicalData( i, "EDIT", "F" ) == "T" )
   lEdit               := ( ::ReadLogicalData( i, "ALLOWEDIT", iif( lEdit, "T", "F" ) ) == "T" )
   lInPlace            := ( ::ReadLogicalData( i, "INPLACE", "F" ) == "T" )
   lAppend             := ( ::ReadLogicalData( i, "APPEND", "F" ) == "T" )
   cOnHeadClick        := ::ReadStringData( i, "ON HEADCLICK", "" )
   cOnHeadClick        := ::ReadStringData( i, "ONHEADCLICK", cOnHeadClick )
   cWhen               := ::ReadStringData( i, "WHEN", "" )
   cWhen               := ::ReadStringData( i, "COLUMNWHEN", cWhen )
   cValid              := ::ReadStringData( i, "VALID", "" )
   cValid              := ::ReadStringData( i, "COLUMNVALID", cValid )
   cValidMess          := ::ReadStringData( i, "VALIDMESSAGES", "" )
   cReadOnly           := ::ReadStringData( i, "READONLY", "")
   lLock               := ( ::ReadLogicalData( i, "LOCK", "F" ) == "T" )
   lDelete             := ( ::ReadLogicalData( i, "DELETE", "F" ) == "T" )
   lNoLines            := ( ::ReadLogicalData( i, "NOLINES", "F" ) == "T" )
   cImage              := ::ReadStringData( i, "IMAGE", "" )
   cJustify            := ::ReadStringData( i, "JUSTIFY", "" )
   lNoVScroll          := ( ::ReadLogicalData( i, "NOVSCROLL", "F" ) == "T" )
   lNoVScroll          := ( ::ReadLogicalData( i, "NOVSCROLLBAR", iif( lNoVScroll, "T", "F" ) ) == "T" )
   cHelpId             := ::ReadStringData( i, "HELPID", "" )
   lBreak              := ( ::ReadLogicalData( i, "BREAK", "F" ) == "T" )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   cOnAppend           := ::ReadStringData( i, "ON APPEND", "" )
   cOnAppend           := ::ReadStringData( i, "ONAPPEND", cOnAppend )
   cOnEditCell         := ::ReadStringData( i, "ON EDITCELL", "" )
   cOnEditCell         := ::ReadStringData( i, "ONEDITCELL", cOnEditCell )
   cColControls        := ::ReadStringData( i, "COLUMNCONTROLS", "" )
   cReplaceField       := ::ReadStringData( i, "REPLACEFIELD", "" )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   lRecCount           := ( ::ReadLogicalData( i, "RECCOUNT", "F" ) == "T" )
   cColumnInfo         := ::ReadStringData( i, "COLUMNINFO", "" )
   lNoHeaders          := ( ( cVal := ::ReadLogicalData( i, "NOHEADERS", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "SHOWHEADERS", "N" ) == "F" ) )
   cOnEnter            := ::ReadStringData( i, "ON ENTER", "" )
   cOnEnter            := ::ReadStringData( i, "ONENTER", cOnEnter )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   lNoTabStop          := ( ( cVal := ::ReadLogicalData( i, "TABSTOP", "N" ) ) == "F" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "NOTABSTOP", "N" ) == "T" ) )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lDescending         := ( ::ReadLogicalData( i, "DESCENDING", "F" ) == "T" )
   cDeleteWhen         := ::ReadStringData( i, "DELETEWHEN", "" )
   cDeleteMsg          := ::ReadStringData( i, "DELETEMSG", "" )
   cOnDelete           := ::ReadStringData( i, "ON DELETE", "" )
   cOnDelete           := ::ReadStringData( i, "ONDELETE", cOnDelete )
   cHdrBackClrs        := ::ReadStringData( i, "HEADERBACKCOLORS", "" )
   cHdrFontClrs        := ::ReadStringData( i, "HEADERCOLORS", "" )
   cHdrFontClrs        := ::ReadStringData( i, "HEADERFONTCOLORS", cHdrFontClrs )
   cHdrImgs            := ::ReadStringData( i, "HEADERIMAGES", "" )
   cHdrImgs            := ::ReadStringData( i, "HEADERIMAGE", cHdrImgs )
   cHdrImgAlign        := ::ReadStringData( i, "IMAGESALIGN", "" )
   cHdrImgAlign        := ::ReadStringData( i, "HEADERIMAGESALIGN", cHdrImgAlign )
   lFullMove           := ( ::ReadLogicalData( i, "FULLMOVE", "F" ) == "T" )
   aSelColor           := UpperNIL( ::ReadStringData( i, "SELECTEDCOLORS", "" ) )
   cEditKeys           := ::ReadStringData( i, "EDITKEYS", "" )
   cEditKeysFun        := ::ReadStringData( i, "EDITKEYSFUN", "" )
   cForceRefresh       := ::ReadLogicalData( i, "FORCEREFRESH", "N" )
   cNoRefresh          := ::ReadLogicalData( i, "NOREFRESH", "N" )
   lSingleBuffer       := ( ::ReadLogicalData( i, "SINGLEBUFFER", "F" ) == "T" )
   cFocusRect          := ::ReadLogicalData( i, "FOCUSRECT", "F" )
   cNoFocusRect        := ::ReadLogicalData( i, "NOFOCUSRECT", "F" )
   lPLM                := ( ::ReadLogicalData( i, "PAINTLEFTMARGIN", "F" ) == "T" )
   cSync               := ::ReadLogicalData( i, "SYNCHRONIZED", "N" )
   cUnSync             := ::ReadLogicalData( i, "UNSYNCHRONIZED", "N" )
   lFixedCols          := ( ::ReadLogicalData( i, "FIXEDCOLS", "F" ) == "T" )
   lNoDefaultMsg       := ( ::ReadLogicalData( i, "NODEFAULTMSG", "F" ) == "T" )
   lNoDeleteMsg        := ( ::ReadLogicalData( i, "NODELETEMSG", "F" ) == "T" )
   lUpdateAll          := ( ::ReadLogicalData( i, "UPDATEALL", "F" ) == "T" )
   cOnAbortEdit        := ::ReadStringData( i, "ON ABORTEDIT", "" )
   cOnAbortEdit        := ::ReadStringData( i, "ONABORTEDIT", cOnAbortEdit )
   lFixedWidths        := ( ::ReadLogicalData( i, "FIXEDWIDTHS", "F" ) == "T" )
   cFixedBlocks        := ::ReadLogicalData( i, "FIXEDBLOCKS", "N" )
   cDynamicBlocks      := ::ReadLogicalData( i, "DYNAMICBLOCKS", "N" )
   cBeforeColMove      := ::ReadStringData( i, "BEFORECOLMOVE", "" )
   cAfterColMove       := ::ReadStringData( i, "AFTERCOLMOVE", "" )
   cBeforeColSize      := ::ReadStringData( i, "BEFORECOLSIZE", "" )
   cAfterColSize       := ::ReadStringData( i, "AFTERCOLSIZE", "" )
   cBeforeAutoFit      := ::ReadStringData( i, "BEFOREAUTOFIT", "" )
   lLikeExcel          := ( ::ReadLogicalData( i, "EDITLIKEEXCEL", "F" ) == "T" )
   lButtons            := ( ::ReadLogicalData( i, "USEBUTTONS", "F" ) == "T" )
   lUpdateColors       := ( ::ReadLogicalData( i, "UPDATECOLORS", "F" ) == "T" )
   cFixedCtrls         := ::ReadLogicalData( i, "FIXEDCONTROLS", "N" )
   cDynamicCtrls       := ::ReadLogicalData( i, "DYNAMICCONTROLS", "N" )
   cOnHeadDClick       := ::ReadStringData( i, "ON HEADDBLCLICK", "" )
   cOnHeadDClick       := ::ReadStringData( i, "ONHEADBLCLICK", cOnHeadDClick )
   cOnHeadRClick       := ::ReadStringData( i, "ON HEADRCLICK", "" )
   cOnHeadRClick       := ::ReadStringData( i, "ONHEADRCLICK", cOnHeadRClick )
   lNoModalEdit        := ( ::ReadLogicalData( i, "NOMODALEDIT", "F" ) == "T" )
   lByCell             := ( ::ReadLogicalData( i, "NAVIGATEBYCELL", "F" ) == "T" )
   lExtDblClick        := ( ::ReadLogicalData( i, "EXTDBLCLICK", "F" ) == "T" )
   lSilent             := ( ::ReadLogicalData( i, "SILENT", "F" ) == "T" )
   lEnableAltA         := ( ::ReadLogicalData( i, "ENABLEALTA", "F" ) == "T" )
   lDisableAltA        := ( ::ReadLogicalData( i, "DISABLEALTA", "F" ) == "T" )
   lNoShow             := ( ::ReadLogicalData( i, "NOSHOWALWAYS", "F" ) == "T" )
   lNoneUnsels         := ( ::ReadLogicalData( i, "NONEUNSELS", "F" ) == "T" )
   lCBE                := ( ::ReadLogicalData( i, "CHANGEBEFOREEDIT", "F" ) == "T" )
   cOnRClick           := ::ReadStringData( i, "ON RCLICK", "" )
   cOnRClick           := ::ReadStringData( i, "ONRCLICK", cOnRClick )
   lCheckBoxes         := ( ::ReadLogicalData( i, "CHECKBOXES", "F" ) == "T" )
   cOnCheckChg         := ::ReadStringData( i, "ON CHECKCHANGE", "" )
   cOnCheckChg         := ::ReadStringData( i, "ONCHECKCHANGE", cOnCheckChg )
   cOnRowRefresh       := ::ReadStringData( i, "ON ROWREFRESH", "" )
   cOnRowRefresh       := ::ReadStringData( i, "ONROWREFRESH", cOnRowRefresh )
   cDefVal             := ::ReadStringData( i, "DEFAULTVALUES", "")
   cOnEditEnd          := ::ReadStringData( i, "ON EDITCELLEND", "" )
   cOnEditEnd          := ::ReadStringData( i, "ONEDITCELLEND", cOnEditEnd )
   lEditFV             := ( ::ReadLogicalData( i, "EDITFIRSTVISIBLE", "F" ) == "T" )
   cOnBfrEdtCell       := ::ReadStringData( i, "ON BEFOREEDITCELL", "" )
   cOnBfrEdtCell       := ::ReadStringData( i, "ONBEFOREEDITCELL", cOnBfrEdtCell )
   cEditCell           := ::ReadStringData( i, "EDITCELLVALUE", "" )
   lKeysLkClp          := ( ::ReadLogicalData( i, "KEYSLIKECLIPPER", "F" ) == "T" )
   lCellTT             := ( ::ReadLogicalData( i, "CELLTOOLTIP", "F" ) == "T" )
   lNoHScroll          := ( ::ReadLogicalData( i, "NOHSCROLL", "F" ) == "T" )
   lNoHScroll          := ( ::ReadLogicalData( i, "NOHSCROLLBAR", iif( lNoHScroll, "T", "F" ) ) == "T" )
   cTimeOut            := ::ReadStringData( i, "TIMEOUT", "" )
   cNewAtRow           := ::ReadStringData( i, "NEWATROW", "" )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_BROWSE ]
   ::aCObj[i]          := cObj
   ::aHeaders[i]       := cHdrs
   ::aWidths[i]        := cWidths
   ::aWorkArea[i]      := cWorkArea
   ::aFields[i]        := cFields
   ::aInputMask[i]     := cInputMask
   ::aValue[i]         := cValue
   ::aFontName[i]      := cFontName
   ::aFontNameFrm[i]   := uFontName
   ::aFontSize[i]      := nFontSize
   ::aFontSizeFrm[i]   := uFontSize
   ::aFontBold[i]      := lBold
   ::aFontItalic[i]    := lItalic
   ::aFontUnderline[i] := lUnderline
   ::aFontStrikeout[i] := lStrikeout
   ::aToolTip[i]       := cToolTip
   ::aBackColor[i]     := aBackColor
   ::aDynBackColor[i]  := cDynBackColor
   ::aDynForeColor[i]  := cDynForecolor
   ::aFontColor[i]     := aFontColor
   ::aOnGotFocus[i]    := cOnGotFocus
   ::aOnChange[i]      := cOnChange
   ::aOnLostFocus[i]   := cOnLostFocus
   ::aOnDblClick[i]    := cOnDblClick
   ::aAction[i]        := cAction
   ::aEdit[i]          := lEdit
   ::aInPlace[i]       := lInPlace
   ::aAppend[i]        := lAppend
   ::aOnHeadClick[i]   := cOnHeadClick
   ::aOnHeadDClick[i]  := cOnHeadDClick
   ::aWhen[i]          := cWhen
   ::aValid[i]         := cValid
   ::aValidMess[i]     := cValidMess
   ::aReadOnlyArray[i] := cReadOnly
   ::aLock[i]          := lLock
   ::aDelete[i]        := lDelete
   ::aNoLines[i]       := lNoLines
   ::aImage[i]         := cImage
   ::aJustify[i]       := cJustify
   ::aNoVScroll[i]     := lNoVScroll
   ::aHelpID[i]        := cHelpId
   ::aBreak[i]         := lBreak
   ::aRTL[i]           := lRTL
   ::aOnAppend[i]      := cOnAppend
   ::aOnEditCell[i]    := cOnEditCell
   ::aColumnCtrls[i]   := cColControls
   ::aReplaceField[i]  := cReplaceField
   ::aSubClass[i]      := cSubClass
   ::aRecCount[i]      := lRecCount
   ::aColumnInfo[i]    := cColumnInfo
   ::aNoHeaders[i]     := lNoHeaders
   ::aOnEnter[i]       := cOnEnter
   ::aDisabled[i]      := ! lEnabled
   ::aNoTabStop[i]     := lNoTabStop
   ::aInvisible[i]     := ! lVisible
   ::aDescend[i]       := lDescending
   ::aDeleteWhen[i]    := cDeleteWhen
   ::aDeleteMsg[i]     := cDeleteMsg
   ::aOnDelete[i]      := cOnDelete
   ::aHdrBackClrs[i]   := cHdrBackClrs
   ::aHdrFontClrs[i]   := cHdrFontClrs
   ::aHdrImages[i]     := cHdrImgs
   ::aHdrImgAlign[i]   := cHdrImgAlign
   ::aFullMove[i]      := lFullMove
   ::aSelColor[i]      := aSelColor
   ::aEditKeys[i]      := cEditKeys
   ::aEditKeysFun[i]   := cEditKeysFun
   ::aRefresh[i]       := iif( cForceRefresh == cNoRefresh, "NIL", iif( cForceRefresh == "T" .OR. cNoRefresh == "F", "REFRESH_FORCE", "REFRESH_NO" ) )
   ::aSingleBuffer[i]  := lSingleBuffer
   ::aFocusRect[i]     := iif( cFocusRect == cNoFocusRect, "NIL", iif( cFocusRect == "T" .OR. cNoFocusRect == "F", ".T.", ".F." ) )
   ::aPLM[i]           := lPLM
   ::aSync[i]          := iif( cUnSync == cSync, "NIL", iif( cSync == "T" .OR. cUnSync == "F", ".T.", ".F." ) )
   ::aFixedCols[i]     := lFixedCols
   ::aNoDefMsg[i]      := lNoDefaultMsg
   ::aNoDelMsg[i]      := lNoDeleteMsg
   ::aUpdate[i]        := lUpdateAll
   ::aOnAbortEdit[i]   := cOnAbortEdit
   ::aFixedWidths[i]   := lFixedWidths
   ::aFixBlocks[i]     := iif( cDynamicBlocks == cFixedBlocks, "NIL", iif( cFixedBlocks == "T" .OR. cDynamicBlocks == "F", ".T.", ".F." ) )
   ::aBeforeColMove[i] := cBeforeColMove
   ::aAfterColMove[i]  := cAfterColMove
   ::aBeforeColSize[i] := cBeforeColSize
   ::aAfterColSize[i]  := cAfterColSize
   ::aBeforeAutoFit[i] := cBeforeAutoFit
   ::aEditLikeExcel[i] := lLikeExcel
   ::aUseButtons[i]    := lButtons
   ::aUpdateColors[i]  := lUpdateColors
   ::aFixedCtrls[i]    := iif( cDynamicCtrls == cFixedCtrls, "NIL", iif( cFixedCtrls == "T" .OR. cDynamicCtrls == "F", ".T.", ".F." ) )
   ::aOnHeadRClick[i]  := cOnHeadRClick
   ::aNoModalEdit[i]   := lNoModalEdit
   ::aNavByCell[i]     := lByCell
   ::aExtDblClick[i]   := lExtDblClick
   ::aSilent[i]        := lSilent
   ::aDisableAltA[i]   := lDisableAltA .AND. ! lEnableAltA
   ::aNoShowAlways[i]  := lNoShow
   ::aNoneUnsels[i]    := lNoneUnsels
   ::aChgBefEdit[i]    := lCBE
   ::aOnRClick[i]      := cOnRClick
   ::aCheckBoxes[i]    := lCheckBoxes
   ::aOnCheckChg[i]    := cOnCheckChg
   ::aOnRowRefresh[i]  := cOnRowRefresh
   ::aDefaultValues[i] := cDefVal
   ::aOnEditCellEnd[i] := cOnEditEnd
   ::aEditFirstVis[i]  := lEditFV
   ::aOnBfrEdtCell[i]  := cOnBfrEdtCell
   ::aEditCellValue[i] := cEditCell
   ::aKeysLkClp[i]     := lKeysLkClp
   ::aCellToolTip[i]   := lCellTT
   ::aNoHScroll[i]     := lNoHScroll
   ::aTimeOut[i]       := cTimeOut
   ::aNewAtRow[i]      := cNewAtRow
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pButton( i ) CLASS TFormEditor

   LOCAL aBackColor, aFontColor, cAction, cAlign, cBuffer, cCaption, cCargo, cFocusRect, cFontName, cHBitmap, cHelpId, cImgMargin
   LOCAL cNoFocusRect, cObj, cOnGotFocus, cOnLostFocus, cOnMouseMove, cOOHGDraw, cParent, cPicture, cSubClass, cToolTip, cTxtAlignH
   LOCAL cTxtAlignV, cVal, cWinDraw, lBold, lBottom, lCancel, lCenter, lDefault, lDIBSection, lEnabled, lFitImg, lFitTxt, lFlat
   LOCAL lForceScale, lHandCursor, lHCenter, lHLeft, lHRight, lImgSize, lItalic, lLeft, lMultiLine, lNo3DColors, lNoDestroy
   LOCAL lNoHotLight, lNoImgList, lNoLoadTrans, lNoPrefix, lNoPrint, lNoTabStop, lRight, lRTL, lSolid, lStretch, lStrikeout, lTop
   LOCAL lTransp, lUnderline, lVisible, lVBottom, lVCenter, lVTop, nCol, nFontSize, nHeight, nRow, cTxtMrgn, nWidth, oCtrl
   LOCAL uFontName, uFontSize

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( TButton():nWidth ) ) ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( TButton():nHeight ) ) ) )
   cAction             := ::ReadStringData( i, "ACTION", "MsgInfo( 'Button pressed!' )" )
   cAction             := ::ReadStringData( i, "ON CLICK",cAction )
   cAction             := ::ReadStringData( i, "ONCLICK", cAction )
   uFontName           := ::ReadStringData( i, "FONT", "" )
   uFontName           := ::ReadStringData( i, "FONTNAME", uFontName )
   uFontName           := ::ReadOopData( i, "FONTNAME", uFontName )
   cFontName           := ::StrToValueCtrl( uFontName, "C", "" )
   uFontSize           := ::ReadStringData( i, "SIZE", "" )
   uFontSize           := ::ReadStringData( i, "FONTSIZE", uFontSize )
   uFontSize           := ::ReadOopData( i, "FONTSIZE", uFontSize )
   nFontSize           := ::StrToValueCtrl( uFontSize, "N", 0, 1, 9999 )
   lBold               := ( ::ReadLogicalData( i, "BOLD", "F" ) == "T" )
   lBold               := ( ::ReadLogicalData( i, "FONTBOLD", iif( lBold, "T", "F" ) ) == "T" )
   lBold               := ( Upper( ::ReadOopData( i, "FONTBOLD", iif( lBold, ".T.", ".F." ) ) ) == ".T." )
   lItalic             := ( ::ReadLogicalData( i, "ITALIC", "F" ) == "T" )
   lItalic             := ( ::ReadLogicalData( i, "FONTITALIC", iif( lItalic, "T", "F" ) ) == "T" )
   lItalic             := ( Upper( ::ReadOopData( i, "FONTITALIC", iif( lItalic, ".T.", ".F." ) ) ) == ".T." )
   lUnderline          := ( ::ReadLogicalData( i, "UNDERLINE", "F" ) == "T" )
   lUnderline          := ( ::ReadLogicalData( i, "FONTUNDERLINE", iif( lUnderline, "T", "F" ) ) == "T" )
   lUnderline          := ( Upper( ::ReadOopData( i, "FONTUNDERLINE", iif( lUnderline, ".T.", ".F." ) ) ) == ".T." )
   lStrikeout          := ( ::ReadLogicalData( i, "STRIKEOUT", "F" ) == "T" )
   lStrikeout          := ( ::ReadLogicalData( i, "FONTSTRIKEOUT", iif( lStrikeout, "T", "F" ) ) == "T" )
   lStrikeout          := ( Upper( ::ReadOopData( i, "FONTSTRIKEOUT", iif( lStrikeout, ".T.", ".F." ) ) ) == ".T." )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   lFlat               := ( ::ReadLogicalData( i, "FLAT", "F" ) == "T" )
   cOnGotFocus         := ::ReadStringData( i, "ON GOTFOCUS", "" )
   cOnGotFocus         := ::ReadStringData( i, "ONGOTFOCUS", cOnGotFocus )
   cOnLostFocus        := ::ReadStringData( i, "ON LOSTFOCUS", "" )
   cOnLostFocus        := ::ReadStringData( i, "ONLOSTFOCUS", cOnLostFocus )
   cOnMouseMove        := ::ReadStringData( i, "ON MOUSEMOVE", "" )
   cOnMouseMove        := ::ReadStringData( i, "ONMOUSEMOVE", cOnMouseMove )
   cOnMouseMove        := ::ReadStringData( i, "ON MOUSEHOVER", cOnMouseMove )
   cOnMouseMove        := ::ReadStringData( i, "ONMOUSEHOVER", cOnMouseMove )
   lNoTabStop          := ( ( cVal := ::ReadLogicalData( i, "TABSTOP", "N" ) ) == "F" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "NOTABSTOP", "N" ) == "T" ) )
   cHelpId             := ::ReadStringData( i, "HELPID", "" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   lNoPrefix           := ( ::ReadLogicalData( i, "NOPREFIX", "F" ) == "T" )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   cCaption            := ::ReadStringData( i, "CAPTION", i )
   cPicture            := ::ReadStringData( i, "PICTURE", "" )
   cPicture            := ::ReadStringData( i, "ICON", cPicture )
   cBuffer             := ::ReadStringData( i, "BUFFER", "" )
   cHBitmap            := ::ReadStringData( i, "HBITMAP", "" )
   lNoLoadTrans        := ( ::ReadLogicalData( i, "NOLOADTRANSPARENT", "F" ) == "T" )
   lStretch            := ( ::ReadLogicalData( i, "STRETCH", "F" ) == "T" )
   lCancel             := ( ::ReadLogicalData( i, "CANCEL", "F" ) == "T" )
   cAlign              := ::ReadStringData( i, "PICTALIGNMENT", "" )
   cAlign              := ::ReadStringData( i, "IMAGEALIGN", cAlign )
   lTop                := ( cAlign == "TOP" )
   lTop                := lTop .OR. ( ::ReadLogicalData( i, "TOP", "F" ) == "T" )
   lBottom             := ( cAlign == "BOTTOM" )
   lBottom             := lBottom .OR. ( ::ReadLogicalData( i, "BOTTOM", "F" ) == "T" )
   lLeft               := ( cAlign == "LEFT" )
   lLeft               := lLeft .OR. ( ::ReadLogicalData( i, "LEFT", "F" ) == "T" )
   lRight              := ( cAlign == "RIGHT" )
   lRight              := lRight .OR. ( ::ReadLogicalData( i, "RIGHT", "F" ) == "T" )
   lCenter             := ( cAlign == "CENTER" )
   lCenter             := lCenter .OR. ( ::ReadLogicalData( i, "CENTER", "F" ) == "T" )
   lMultiLine          := ( ::ReadLogicalData( i, "MULTILINE", "F" ) == "T" )
   cOOHGDraw           := ::ReadLogicalData( i, "THEMED", "N" )
   cOOHGDraw           := ::ReadLogicalData( i, "OOHGDRAW", cOOHGDraw )
   cWinDraw            := ::ReadLogicalData( i, "NOTHEME", "N" )
   cWinDraw            := ::ReadLogicalData( i, "WINDRAW", cWinDraw )
   cImgMargin          := ::ReadStringData( i, "IMAGEMARGIN", "" )
   lFitImg             := ( ::ReadLogicalData( i, "FITIMG", "F" ) == "T" )
   lNo3DColors         := ( ::ReadLogicalData( i, "NO3DCOLORS", "F" ) == "T" )
   lForceScale         := ::ReadLogicalData( i, "FORCESCALE", "F" )
   lForceScale         := ::ReadLogicalData( i, "AUTOFIT", lForceScale )
   lForceScale         := ( ::ReadLogicalData( i, "ADJUST", lForceScale ) == "T" )
   lDIBSection         := ( ::ReadLogicalData( i, "DIBSECTION", "F" ) == "T" )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   lSolid              := ( ::ReadLogicalData( i, "SOLID", "F" ) == "T" )
   lNoHotLight         := ( ::ReadLogicalData( i, "NOHOTLIGHT", "F" ) == "T" )
   aFontColor          := ::ReadStringData( i, "FONTCOLOR", "NIL" )
   aFontColor          := UpperNIL( ::ReadOopData( i, "FONTCOLOR", aFontColor ) )
   cTxtAlignH          := ::ReadStringData( i, "TEXTALIGNH", "" )
   lHLeft              := ( cTxtAlignH == "LEFT" )
   lHRight             := ( cTxtAlignH == "RIGHT" )
   lHCenter            := ( cTxtAlignH == "CENTER" )
   cTxtAlignV          := ::ReadStringData( i, "TEXTALIGNV", "" )
   lVTop               := ( cTxtAlignV == "TOP" )
   lVBottom            := ( cTxtAlignV == "BOTTOM" )
   lVCenter            := ( cTxtAlignV == "VCENTER" )
   lNoPrint            := ( ::ReadLogicalData( i, "NOPRINTOVER", "F" ) == "T" )
   cTxtMrgn            := ::ReadStringData( i, "TEXTMARGIN", "" )
   lFitTxt             := ( ::ReadLogicalData( i, "FITTXT", "F" ) == "T" )
   lImgSize            := ( ::ReadLogicalData( i, "IMAGESIZE", "F" ) == "T" )
   lTransp             := ( ::ReadLogicalData( i, "TRANSPARENT", "F" ) == "T" )
   cFocusRect          := ::ReadLogicalData( i, "FOCUSRECT", "F" )
   cNoFocusRect        := ::ReadLogicalData( i, "NOFOCUSRECT", "F" )
   lNoImgList          := ( ::ReadLogicalData( i, "NOIMAGELIST", "F" ) == "T" )
   lNoDestroy          := ( ::ReadLogicalData( i, "NODESTROY", "F" ) == "T" )
   lHandCursor         := ( ::ReadLogicalData( i, "HANDCURSOR", "F" ) == "T" )
   lDefault            := ( ::ReadLogicalData( i, "DEFAULT", "F" ) == "T" )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_BUTTON ]
   ::aCObj[i]          := cObj
   ::aAction[i]        := cAction
   ::aFontName[i]      := cFontName
   ::aFontNameFrm[i]   := uFontName
   ::aFontSize[i]      := nFontSize
   ::aFontSizeFrm[i]   := uFontSize
   ::aFontBold[i]      := lBold
   ::aFontItalic[i]    := lItalic
   ::aFontUnderline[i] := lUnderline
   ::aFontStrikeout[i] := lStrikeout
   ::aToolTip[i]       := cToolTip
   ::aFlat[i]          := lFlat
   ::aOnGotFocus[i]    := cOnGotFocus
   ::aOnLostFocus[i]   := cOnLostFocus
   ::aOnMouseMove[i]   := cOnMouseMove
   ::aNoTabStop[i]     := lNoTabStop
   ::aHelpID[i]        := cHelpId
   ::aInvisible[i]     := ! lVisible
   ::aRTL[i]           := lRTL
   ::aNoPrefix[i]      := lNoPrefix
   ::aSubClass[i]      := cSubClass
   ::aDisabled[i]      := ! lEnabled
   ::aCaption[i]       := cCaption
   ::aPicture[i]       := cPicture
   ::aBuffer[i]        := cBuffer
   ::aHBitmap[i]       := cHBitmap
   ::aNoLoadTrans[i]   := lNoLoadTrans
   ::aStretch[i]       := lStretch
   ::aCancel[i]        := lCancel
   ::aImageAlign[i]    := iif( lTop, "TOP", iif( lBottom, "BOTTOM", iif( lLeft, "LEFT", iif( lRight, "RIGHT", iif( lCenter, "CENTER", "NIL" ) ) ) ) )
   ::aMultiLine[i]     := lMultiLine
   ::aDrawBy[i]        := iif( cOOHGDraw == cWinDraw, "NIL", iif( cOOHGDraw == "T" .OR. cWinDraw == "F", "OOHGDRAW", "WINDRAW" ) )
   ::aImageMargin[i]   := cImgMargin
   ::aFitImg[i]        := lFitImg
   ::aNo3DColors[i]    := lNo3DColors
   ::aForceScale[i]    := lForceScale
   ::aDIBSection[i]    := lDIBSection
   ::aBackColor[i]     := aBackColor
   ::aSolid[i]         := lSolid
   ::aNoHotLight[i]    := lNoHotLight
   ::aFontColor[i]     := aFontColor
   ::aAlignH[i]        := iif( lHLeft, "LEFT", iif( lHRight, "RIGHT", iif( lHCenter, "CENTER", "NIL" ) ) )
   ::aAlignV[i]        := iif( lVTop, "TOP", iif( lVBottom, "BOTTOM", iif( lVCenter, "VCENTER", "NIL" ) ) )
   ::aNoPrint[i]       := lNoPrint
   ::aTxtMrgn[i]       := cTxtMrgn
   ::aFitTxt[i]        := lFitTxt
   ::aImageSize[i]     := lImgSize
   ::aTransparent[i]   := lTransp
   ::aNoFocusRect[i]   := ( cFocusRect == "F" .AND. cNoFocusRect == "T" )
   ::aNoImgList[i]     := lNoImgList
   ::aNoDestroy[i]     := lNoDestroy
   ::aHandCursor[i]    := lHandCursor
   ::aDefault[i]       := lDefault
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pCheckBox( i ) CLASS TFormEditor

   LOCAL aBackColor, aFontColor, cBackground, cCaption, cCargo, cField, cFillRect, cFocusRect, cFontName, cHelpID, cNoFillRect
   LOCAL cNoFocusRect, cObj, cOnChange, cOnGotFocus, cOnLostFocus, cOOHGDraw, cParent, cSubClass, cToolTip, cVal, cValue, cWinDraw
   LOCAL l3State, lAutoSize, lBold, lEnabled, lItalic, lLeftJust, lNoTabStop, lRTL, lStrikeout, lTrans, lUnderline, lVisible, nCol
   LOCAL nFontSize, nHeight, nRow, nWidth, oCtrl, uFontName, uFontSize

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( TCheckBox():nWidth ) ) ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( TCheckBox():nHeight ) ) ) )
   cCaption            := ::ReadStringData( i, "CAPTION", "" )
   cField              := ::ReadStringData( i, "FIELD", "" )
   cValue              := ::ReadStringData( i, "VALUE", "NIL" )
   uFontName           := ::ReadStringData( i, "FONT", "" )
   uFontName           := ::ReadStringData( i, "FONTNAME", uFontName )
   uFontName           := ::ReadOopData( i, "FONTNAME", uFontName )
   cFontName           := ::StrToValueCtrl( uFontName, "C", "" )
   uFontSize           := ::ReadStringData( i, "SIZE", "" )
   uFontSize           := ::ReadStringData( i, "FONTSIZE", uFontSize )
   uFontSize           := ::ReadOopData( i, "FONTSIZE", uFontSize )
   nFontSize           := ::StrToValueCtrl( uFontSize, "N", 0, 1, 9999 )
   lBold               := ( ::ReadLogicalData( i, "BOLD", "F" ) == "T" )
   lBold               := ( ::ReadLogicalData( i, "FONTBOLD", iif( lBold, "T", "F" ) ) == "T" )
   lBold               := ( Upper( ::ReadOopData( i, "FONTBOLD", iif( lBold, ".T.", ".F." ) ) ) == ".T." )
   lItalic             := ( ::ReadLogicalData( i, "ITALIC", "F" ) == "T" )
   lItalic             := ( ::ReadLogicalData( i, "FONTITALIC", iif( lItalic, "T", "F" ) ) == "T" )
   lItalic             := ( Upper( ::ReadOopData( i, "FONTITALIC", iif( lItalic, ".T.", ".F." ) ) ) == ".T." )
   lUnderline          := ( ::ReadLogicalData( i, "UNDERLINE", "F" ) == "T" )
   lUnderline          := ( ::ReadLogicalData( i, "FONTUNDERLINE", iif( lUnderline, "T", "F" ) ) == "T" )
   lUnderline          := ( Upper( ::ReadOopData( i, "FONTUNDERLINE", iif( lUnderline, ".T.", ".F." ) ) ) == ".T." )
   lStrikeout          := ( ::ReadLogicalData( i, "STRIKEOUT", "F" ) == "T" )
   lStrikeout          := ( ::ReadLogicalData( i, "FONTSTRIKEOUT", iif( lStrikeout, "T", "F" ) ) == "T" )
   lStrikeout          := ( Upper( ::ReadOopData( i, "FONTSTRIKEOUT", iif( lStrikeout, ".T.", ".F." ) ) ) == ".T." )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   aFontColor          := ::ReadStringData( i, "FONTCOLOR", "NIL" )
   aFontColor          := UpperNIL( ::ReadOopData( i, "FONTCOLOR", aFontColor ) )
   cOnGotFocus         := ::ReadStringData( i, "ON GOTFOCUS", "" )
   cOnGotFocus         := ::ReadStringData( i, "ONGOTFOCUS", cOnGotFocus )
   cOnChange           := ::ReadStringData( i, "ON CHANGE", "" )
   cOnChange           := ::ReadStringData( i, "ONCHANGE", cOnChange )
   cOnLostFocus        := ::ReadStringData( i, "ON LOSTFOCUS", "" )
   cOnLostFocus        := ::ReadStringData( i, "ONLOSTFOCUS", cOnLostFocus )
   lTrans              := ( ::ReadLogicalData( i, "TRANSPARENT", "F" ) == "T" )
   cHelpID             := ::ReadStringData( i, "HELPID", "" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lNoTabStop          := ( ( cVal := ::ReadLogicalData( i, "TABSTOP", "N" ) ) == "F" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "NOTABSTOP", "N" ) == "T" ) )
   lAutoSize           := ( ::ReadLogicalData( i, "AUTOSIZE", "F" ) == "T" )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   l3State             := ( ::ReadLogicalData( i, "THREESTATE", "F" ) == "T" )
   lLeftJust           := ( ::ReadLogicalData( i, "LEFTALIGN", "F" ) == "T" )
   lLeftJust           := ( ::ReadLogicalData( i, "LEFTJUSTIFY", iif( lLeftJust, "T", "F" ) ) == "T" )
   cOOHGDraw           := ::ReadLogicalData( i, "THEMED", "N" )
   cOOHGDraw           := ::ReadLogicalData( i, "OOHGDRAW", cOOHGDraw )
   cWinDraw            := ::ReadLogicalData( i, "NOTHEME", "N" )
   cWinDraw            := ::ReadLogicalData( i, "WINDRAW", cWinDraw )
   cBackground         := ::ReadStringData( i, "BACKGROUND", "" )
   cFocusRect          := ::ReadLogicalData( i, "FOCUSRECT", "F" )
   cNoFocusRect        := ::ReadLogicalData( i, "NOFOCUSRECT", "F" )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )
   cFillRect           := ::ReadLogicalData( i, "FILLRECT", "N" )
   cNoFillRect         := ::ReadLogicalData( i, "NOFILLRECT", "N" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_CHECKBOX ]
   ::aCObj[i]          := cObj
   ::aCaption[i]       := cCaption
   ::aField[i]         := cField
   ::aValue[i]         := cValue
   ::aFontName[i]      := cFontName
   ::aFontNameFrm[i]   := uFontName
   ::aFontSize[i]      := nFontSize
   ::aFontSizeFrm[i]   := uFontSize
   ::aFontBold[i]      := lBold
   ::aFontItalic[i]    := lItalic
   ::aFontUnderline[i] := lUnderline
   ::aFontStrikeout[i] := lStrikeout
   ::aToolTip[i]       := cToolTip
   ::aBackColor[i]     := aBackColor
   ::aFontColor[i]     := aFontColor
   ::aOnGotFocus[i]    := cOnGotFocus
   ::aOnChange[i]      := cOnChange
   ::aOnLostFocus[i]   := cOnLostFocus
   ::aTransparent[i]   := lTrans
   ::aHelpID[i]        := cHelpID
   ::aInvisible[i]     := ! lVisible
   ::aNoTabStop[i]     := lNoTabStop
   ::aAutoSize[i]      := lAutoSize
   ::aDisabled[i]      := ! lEnabled
   ::aSubClass[i]      := cSubClass
   ::aRTL[i]           := lRTL
   ::a3State[i]        := l3State
   ::aLeftJust[i]      := lLeftJust
   ::aDrawBy[i]        := iif( cOOHGDraw == cWinDraw, "NIL", iif( cOOHGDraw == "T" .OR. cWinDraw == "F", "OOHGDRAW", "WINDRAW" ) )
   ::aBackground[i]    := cBackground
   ::aNoFocusRect[i]   := ( cFocusRect == "F" .AND. cNoFocusRect == "T" )
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo
   ::aFillRect[i]      := iif( cFillRect == cNoFillRect, "NIL", iif( cFillRect == "T" .OR. cNoFillRect == "F", "YES", "NO" ) )

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pCheckButton( i ) CLASS TFormEditor

   LOCAL aBackColor, aFontColor, cAlign, cBuffer, cCaption, cCargo, cField, cFocusRect, cFontName, cHBitmap, cHelpId, cImgMargin
   LOCAL cNoFocusRect, cObj, cOnChange, cOnGotFocus, cOnLostFocus, cOnMouseMove, cOOHGDraw, cParent, cPicture, cSubClass, cToolTip
   LOCAL cTxtAlignH, cTxtAlignV, cTxtMrgn, cVal, cWinDraw, lBold, lBottom, lCenter, lDIBSection, lEnabled, lFitImg, lFitTxt, lFlat
   LOCAL lForceScale, lHandCursor, lHCenter, lHLeft, lHRight, lImgSize, lItalic, lLeft, lMultiLine, lNo3DColors, lNoDestroy
   LOCAL lNoHotLight, lNoImgList, lNoLoadTrans, lNoPrint, lNoTabStop, lRight, lRTL, lSolid, lStretch, lStrikeout, lTop, lTransp
   LOCAL lUnderline, lVBottom, lVCenter, lVisible, lVTop, nCol, nFontSize, nHeight, nRow, nWidth, oCtrl, uFontName, uFontSize
   LOCAL uValue

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( TButtonCheck():nWidth ) ) ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( TButtonCheck():nHeight ) ) ) )
   cCaption            := ::ReadStringData( i, "CAPTION", i )
   uValue              := ::ReadStringData( i, "VALUE", "" )
   uFontName           := ::ReadStringData( i, "FONT", "" )
   uFontName           := ::ReadStringData( i, "FONTNAME", uFontName )
   uFontName           := ::ReadOopData( i, "FONTNAME", uFontName )
   cFontName           := ::StrToValueCtrl( uFontName, "C", "" )
   uFontSize           := ::ReadStringData( i, "SIZE", "" )
   uFontSize           := ::ReadStringData( i, "FONTSIZE", uFontSize )
   uFontSize           := ::ReadOopData( i, "FONTSIZE", uFontSize )
   nFontSize           := ::StrToValueCtrl( uFontSize, "N", 0, 1, 9999 )
   lBold               := ( ::ReadLogicalData( i, "BOLD", "F" ) == "T" )
   lBold               := ( ::ReadLogicalData( i, "FONTBOLD", iif( lBold, "T", "F" ) ) == "T" )
   lBold               := ( Upper( ::ReadOopData( i, "FONTBOLD", iif( lBold, ".T.", ".F." ) ) ) == ".T." )
   lItalic             := ( ::ReadLogicalData( i, "ITALIC", "F" ) == "T" )
   lItalic             := ( ::ReadLogicalData( i, "FONTITALIC", iif( lItalic, "T", "F" ) ) == "T" )
   lItalic             := ( Upper( ::ReadOopData( i, "FONTITALIC", iif( lItalic, ".T.", ".F." ) ) ) == ".T." )
   lUnderline          := ( ::ReadLogicalData( i, "UNDERLINE", "F" ) == "T" )
   lUnderline          := ( ::ReadLogicalData( i, "FONTUNDERLINE", iif( lUnderline, "T", "F" ) ) == "T" )
   lUnderline          := ( Upper( ::ReadOopData( i, "FONTUNDERLINE", iif( lUnderline, ".T.", ".F." ) ) ) == ".T." )
   lStrikeout          := ( ::ReadLogicalData( i, "STRIKEOUT", "F" ) == "T" )
   lStrikeout          := ( ::ReadLogicalData( i, "FONTSTRIKEOUT", iif( lStrikeout, "T", "F" ) ) == "T" )
   lStrikeout          := ( Upper( ::ReadOopData( i, "FONTSTRIKEOUT", iif( lStrikeout, ".T.", ".F." ) ) ) == ".T." )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   cOnGotFocus         := ::ReadStringData( i, "ON GOTFOCUS", "" )
   cOnGotFocus         := ::ReadStringData( i, "ONGOTFOCUS", cOnGotFocus )
   cOnChange           := ::ReadStringData( i, "ON CHANGE", "" )
   cOnChange           := ::ReadStringData( i, "ONCHANGE", cOnChange )
   cOnLostFocus        := ::ReadStringData( i, "ON LOSTFOCUS", "" )
   cOnLostFocus        := ::ReadStringData( i, "ONLOSTFOCUS", cOnLostFocus )
   cHelpId             := ::ReadStringData( i, "HELPID", "" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lNoTabStop          := ( ( cVal := ::ReadLogicalData( i, "TABSTOP", "N" ) ) == "F" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "NOTABSTOP", "N" ) == "T" ) )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   cPicture            := ::ReadStringData( i, "PICTURE", "" )
   cPicture            := ::ReadStringData( i, "ICON", cPicture )
   cBuffer             := ::ReadStringData( i, "BUFFER", "" )
   cHBitmap            := ::ReadStringData( i, "HBITMAP", "" )
   lNoLoadTrans        := ( ::ReadLogicalData( i, "NOLOADTRANSPARENT", "F" ) == "T" )
   lStretch            := ( ::ReadLogicalData( i, "STRETCH", "F" ) == "T" )
   cField              := ::ReadStringData( i, "FIELD", "" )
   lNo3DColors         := ( ::ReadLogicalData( i, "NO3DCOLORS", "F" ) == "T" )
   lForceScale         := ::ReadLogicalData( i, "FORCESCALE", "F" )
   lForceScale         := ::ReadLogicalData( i, "AUTOFIT", lForceScale )
   lForceScale         := ( ::ReadLogicalData( i, "ADJUST", lForceScale ) == "T" )
   lDIBSection         := ( ::ReadLogicalData( i, "DIBSECTION", "F" ) == "T" )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   lSolid              := ( ::ReadLogicalData( i, "SOLID", "F" ) == "T" )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   cOOHGDraw           := ::ReadLogicalData( i, "THEMED", "N" )
   cOOHGDraw           := ::ReadLogicalData( i, "OOHGDRAW", cOOHGDraw )
   cWinDraw            := ::ReadLogicalData( i, "NOTHEME", "N" )
   cWinDraw            := ::ReadLogicalData( i, "WINDRAW", cWinDraw )
   cImgMargin          := ::ReadStringData( i, "IMAGEMARGIN", "" )
   lFitImg             := ( ::ReadLogicalData( i, "FITIMG", "F" ) == "T" )
   cOnMouseMove        := ::ReadStringData( i, "ON MOUSEMOVE", "" )
   cOnMouseMove        := ::ReadStringData( i, "ONMOUSEMOVE", cOnMouseMove )
   cOnMouseMove        := ::ReadStringData( i, "ON MOUSEHOVER", cOnMouseMove )
   cOnMouseMove        := ::ReadStringData( i, "ONMOUSEHOVER", cOnMouseMove )
   cAlign              := ::ReadStringData( i, "PICTALIGNMENT", "" )
   cAlign              := ::ReadStringData( i, "IMAGEALIGN", cAlign )
   lTop                := ( cAlign == "TOP" )
   lTop                := lTop .OR. ( ::ReadLogicalData( i, "TOP", "F" ) == "T" )
   lBottom             := ( cAlign == "BOTTOM" )
   lBottom             := lBottom .OR. ( ::ReadLogicalData( i, "BOTTOM", "F" ) == "T" )
   lLeft               := ( cAlign == "LEFT" )
   lLeft               := lLeft .OR. ( ::ReadLogicalData( i, "LEFT", "F" ) == "T" )
   lRight              := ( cAlign == "RIGHT" )
   lRight              := lRight .OR. ( ::ReadLogicalData( i, "RIGHT", "F" ) == "T" )
   lCenter             := ( cAlign == "CENTER" )
   lCenter             := lCenter .OR. ( ::ReadLogicalData( i, "CENTER", "F" ) == "T" )
   lMultiLine          := ( ::ReadLogicalData( i, "MULTILINE", "F" ) == "T" )
   lFlat               := ( ::ReadLogicalData( i, "FLAT", "F" ) == "T" )
   lNoHotLight         := ( ::ReadLogicalData( i, "NOHOTLIGHT", "F" ) == "T" )
   aFontColor          := ::ReadStringData( i, "FONTCOLOR", "NIL" )
   aFontColor          := UpperNIL( ::ReadOopData( i, "FONTCOLOR", aFontColor ) )
   cTxtAlignH          := ::ReadStringData( i, "TEXTALIGNH", "" )
   lHLeft              := ( cTxtAlignH == "LEFT" )
   lHRight             := ( cTxtAlignH == "RIGHT" )
   lHCenter            := ( cTxtAlignH == "CENTER" )
   cTxtAlignV          := ::ReadStringData( i, "TEXTALIGNV", "" )
   lVTop               := ( cTxtAlignV == "TOP" )
   lVBottom            := ( cTxtAlignV == "BOTTOM" )
   lVCenter            := ( cTxtAlignV == "VCENTER" )
   lNoPrint            := ( ::ReadLogicalData( i, "NOPRINTOVER", "F" ) == "T" )
   cTxtMrgn            := ::ReadStringData( i, "TEXTMARGIN", "" )
   lFitTxt             := ( ::ReadLogicalData( i, "FITTXT", "F" ) == "T" )
   lImgSize            := ( ::ReadLogicalData( i, "IMAGESIZE", "F" ) == "T" )
   lTransp             := ( ::ReadLogicalData( i, "TRANSPARENT", "F" ) == "T" )
   cFocusRect          := ::ReadLogicalData( i, "FOCUSRECT", "F" )
   cNoFocusRect        := ::ReadLogicalData( i, "NOFOCUSRECT", "F" )
   lNoImgList          := ( ::ReadLogicalData( i, "NOIMAGELIST", "F" ) == "T" )
   lNoDestroy          := ( ::ReadLogicalData( i, "NODESTROY", "F" ) == "T" )
   lHandCursor         := ( ::ReadLogicalData( i, "HANDCURSOR", "F" ) == "T" )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_CHECKBUTTON ]
   ::aCObj[i]          := cObj
   ::aCaption[i]       := cCaption
   ::aValue[i]         := uValue
   ::aFontName[i]      := cFontName
   ::aFontNameFrm[i]   := uFontName
   ::aFontSize[i]      := nFontSize
   ::aFontSizeFrm[i]   := uFontSize
   ::aFontBold[i]      := lBold
   ::aFontItalic[i]    := lItalic
   ::aFontUnderline[i] := lUnderline
   ::aFontStrikeout[i] := lStrikeout
   ::aToolTip[i]       := cToolTip
   ::aOnGotFocus[i]    := cOnGotFocus
   ::aOnChange[i]      := cOnChange
   ::aOnLostFocus[i]   := cOnLostFocus
   ::aHelpID[i]        := cHelpId
   ::aInvisible[i]     := ! lVisible
   ::aNoTabStop[i]     := lNoTabStop
   ::aSubClass[i]      := cSubClass
   ::aRTL[i]           := lRTL
   ::aPicture[i]       := cPicture
   ::aBuffer[i]        := cBuffer
   ::aHBitmap[i]       := cHBitmap
   ::aNoLoadTrans[i]   := lNoLoadTrans
   ::aStretch[i]       := lStretch
   ::aField[i]         := cField
   ::aNo3DColors[i]    := lNo3DColors
   ::aForceScale[i]    := lForceScale
   ::aDIBSection[i]    := lDIBSection
   ::aBackColor[i]     := aBackColor
   ::aSolid[i]         := lSolid
   ::aDisabled[i]      := ! lEnabled
   ::aDrawBy[i]        := iif( cOOHGDraw == cWinDraw, "NIL", iif( cOOHGDraw == "T" .OR. cWinDraw == "F", "OOHGDRAW", "WINDRAW" ) )
   ::aImageMargin[i]   := cImgMargin
   ::aFitImg[i]        := lFitImg
   ::aOnMouseMove[i]   := cOnMouseMove
   ::aImageAlign[i]    := iif( lTop, "TOP", iif( lBottom, "BOTTOM", iif( lLeft, "LEFT", iif( lRight, "RIGHT", iif( lCenter, "CENTER", "NIL" ) ) ) ) )
   ::aMultiLine[i]     := lMultiLine
   ::aFlat[i]          := lFlat
   ::aNoHotLight[i]    := lNoHotLight
   ::aFontColor[i]     := aFontColor
   ::aAlignH[i]        := iif( lHLeft, "LEFT", iif( lHRight, "RIGHT", iif( lHCenter, "CENTER", "NIL" ) ) )
   ::aAlignV[i]        := iif( lVTop, "TOP", iif( lVBottom, "BOTTOM", iif( lVCenter, "VCENTER", "NIL" ) ) )
   ::aNoPrint[i]       := lNoPrint
   ::aTxtMrgn[i]       := cTxtMrgn
   ::aFitTxt[i]        := lFitTxt
   ::aImageSize[i]     := lImgSize
   ::aTransparent[i]   := lTransp
   ::aNoFocusRect[i]   := ( cFocusRect == "F" .AND. cNoFocusRect == "T" )
   ::aNoImgList[i]     := lNoImgList
   ::aParent[i]        := cParent
   ::aNoDestroy[i]     := lNoDestroy
   ::aHandCursor[i]    := lHandCursor
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pCheckList( i ) CLASS TFormEditor

   LOCAL aBackColor, aFontColor, aSelColor, cAction, cCargo, cFontName, cHelpId, cImage, cItems, cJustify, cObj, cOnChange
   LOCAL cOnGotFocus, cOnLostFocus, cParent, cSubClass, cToolTip, cVal, cValue, lBold, lBreak, lDescending, lEnabled, lItalic
   LOCAL lNoTabStop, lRTL, lSingleBuffer, lSort, lStrikeout, lUnderline, lVisible, nCol, nFontSize, nHeight, nRow, nWidth, oCtrl
   LOCAL uFontName, uFontSize

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( TCheckList():nWidth ) ) ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( TCheckList():nHeight ) ) ) )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   cItems              := ::ReadStringData( i, "ITEMS", "")
   cImage              := ::ReadStringData( i, "IMAGE", "" )
   cValue              := ::ReadStringData( i, "VALUE", "")
   uFontName           := ::ReadStringData( i, "FONT", "" )
   uFontName           := ::ReadStringData( i, "FONTNAME", uFontName )
   uFontName           := ::ReadOopData( i, "FONTNAME", uFontName )
   cFontName           := ::StrToValueCtrl( uFontName, "C", "" )
   uFontSize           := ::ReadStringData( i, "SIZE", "" )
   uFontSize           := ::ReadStringData( i, "FONTSIZE", uFontSize )
   uFontSize           := ::ReadOopData( i, "FONTSIZE", uFontSize )
   nFontSize           := ::StrToValueCtrl( uFontSize, "N", 0, 1, 9999 )
   lBold               := ( ::ReadLogicalData( i, "BOLD", "F" ) == "T" )
   lBold               := ( ::ReadLogicalData( i, "FONTBOLD", iif( lBold, "T", "F" ) ) == "T" )
   lBold               := ( Upper( ::ReadOopData( i, "FONTBOLD", iif( lBold, ".T.", ".F." ) ) ) == ".T." )
   lItalic             := ( ::ReadLogicalData( i, "ITALIC", "F" ) == "T" )
   lItalic             := ( ::ReadLogicalData( i, "FONTITALIC", iif( lItalic, "T", "F" ) ) == "T" )
   lItalic             := ( Upper( ::ReadOopData( i, "FONTITALIC", iif( lItalic, ".T.", ".F." ) ) ) == ".T." )
   lUnderline          := ( ::ReadLogicalData( i, "UNDERLINE", "F" ) == "T" )
   lUnderline          := ( ::ReadLogicalData( i, "FONTUNDERLINE", iif( lUnderline, "T", "F" ) ) == "T" )
   lUnderline          := ( Upper( ::ReadOopData( i, "FONTUNDERLINE", iif( lUnderline, ".T.", ".F." ) ) ) == ".T." )
   lStrikeout          := ( ::ReadLogicalData( i, "STRIKEOUT", "F" ) == "T" )
   lStrikeout          := ( ::ReadLogicalData( i, "FONTSTRIKEOUT", iif( lStrikeout, "T", "F" ) ) == "T" )
   lStrikeout          := ( Upper( ::ReadOopData( i, "FONTSTRIKEOUT", iif( lStrikeout, ".T.", ".F." ) ) ) == ".T." )
   cJustify            := ::ReadStringData( i, "JUSTIFY", "" )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   aFontColor          := ::ReadStringData( i, "FONTCOLOR", "NIL" )
   aFontColor          := UpperNIL( ::ReadOopData( i, "FONTCOLOR", aFontColor ) )
   aSelColor           := UpperNIL( ::ReadStringData( i, "SELECTEDCOLORS", "" ) )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   cOnChange           := ::ReadStringData( i, "ON CHANGE", "" )
   cOnChange           := ::ReadStringData( i, "ONCHANGE", cOnChange )
   cOnGotFocus         := ::ReadStringData( i, "ON GOTFOCUS", "" )
   cOnGotFocus         := ::ReadStringData( i, "ONGOTFOCUS", cOnGotFocus )
   cOnLostFocus        := ::ReadStringData( i, "ON LOSTFOCUS", "" )
   cOnLostFocus        := ::ReadStringData( i, "ONLOSTFOCUS", cOnLostFocus )
   cAction             := ::ReadStringData( i, "ACTION", "" )
   cAction             := ::ReadStringData( i, "ON CLICK",cAction )
   cAction             := ::ReadStringData( i, "ONCLICK", cAction )
   lBreak              := ( ::ReadLogicalData( i, "BREAK", "F" ) == "T" )
   cHelpId             := ::ReadStringData( i, "HELPID", "" )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   lNoTabStop          := ( ( cVal := ::ReadLogicalData( i, "TABSTOP", "N" ) ) == "F" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "NOTABSTOP", "N" ) == "T" ) )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lSort               := ( ::ReadLogicalData( i, "SORT", "F" ) == "T" )
   lDescending         := ( ::ReadLogicalData( i, "DESCENDING", "F" ) == "T" )
   lSingleBuffer       := ( ::ReadLogicalData( i, "SINGLEBUFFER", "F" ) == "T" )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_CHECKLIST ]
   ::aCObj[i]          := cObj
   ::aSubClass[i]      := cSubClass
   ::aItems[i]         := cItems
   ::aImage[i]         := cImage
   ::aValue[i]         := cValue
   ::aFontName[i]      := cFontName
   ::aFontNameFrm[i]   := uFontName
   ::aFontSize[i]      := nFontSize
   ::aFontSizeFrm[i]   := uFontSize
   ::aFontBold[i]      := lBold
   ::aFontItalic[i]    := lItalic
   ::aFontUnderline[i] := lUnderline
   ::aFontStrikeout[i] := lStrikeout
   ::aJustify[i]       := cJustify
   ::aRTL[i]           := lRTL
   ::aBackColor[i]     := aBackColor
   ::aFontColor[i]     := aFontColor
   ::aSelColor[i]      := aSelColor
   ::aToolTip[i]       := cToolTip
   ::aOnChange[i]      := cOnChange
   ::aOnGotFocus[i]    := cOnGotFocus
   ::aOnLostFocus[i]   := cOnLostFocus
   ::aAction[i]        := cAction
   ::aBreak[i]         := lBreak
   ::aHelpID[i]        := cHelpId
   ::aDisabled[i]      := ! lEnabled
   ::aNoTabStop[i]     := lNoTabStop
   ::aInvisible[i]     := ! lVisible
   ::aSort[i]          := lSort
   ::aDescend[i]       := lDescending
   ::aSingleBuffer[i]  := lSingleBuffer
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pComboBox( i ) CLASS TFormEditor

   LOCAL aBackColor, aFontColor, cCargo, cCue, cEditHeight, cFontName, cGripperText, cHelpId, cImage, cImageSource, cIsIndex
   LOCAL cIsValue, cItemImageNumber, cItemSource, cItems, cListWidth, cMaxLen, cNoRefresh, cObj, cOnCancel, cOnChange
   LOCAL cOnDisplayChange, cOnEnter, cOnGotFocus, cOnListClose, cOnListDisplay, cOnLostFocus, cOnRefresh, cOptHeight, cParent
   LOCAL cRefresh, cSearchLapse, cSourceOrder, cSubClass, cTextHeight, cToolTip, cVal, cValue, cValueSource, lAutoSize, lBold
   LOCAL lBreak, lDelayedLoad, lDisplayEdit, lEnabled, lFirstItem, lFit, lIncremental, lIntegralHeight, lItalic, lNoClone
   LOCAL lNoHScroll, lNoLoadTrans, lNoTabStop, lRTL, lSort, lStrikeout, lUnderline, lVisible, nCol, nFontSize, nHeight, nRow, nWidth
   LOCAL oCtrl, uFontName, uFontSize

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( TCombo():nWidth ) ) ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( TCombo():nHeight ) ) ) )
   cItems              := ::ReadStringData( i, "ITEMS", "" )
   lNoClone            := ( ::ReadLogicalData( i, "NOCLONE", "F" ) == "T" )
   cItemSource         := ::ReadStringData( i, "ITEMSOURCE", "" )
   cItemImageNumber    := ::ReadStringData( i, "ITEMIMAGENUMBER", "" )
   cValue              := ::ReadStringData( i, "VALUE", "" )
   cValueSource        := ::ReadStringData( i, "VALUESOURCE", "" )
   lDisplayEdit        := ( ::ReadLogicalData( i, "DISPLAYEDIT", "F" ) == "T" )
   cMaxLen             := ::ReadStringData( i, "MAXLENGTH", "" )
   lNoHScroll          := ( ::ReadLogicalData( i, "NOHSCROLL", "F" ) == "T" )
   lNoLoadTrans        := ( ::ReadLogicalData( i, "NOLOADTRANSPARENT", "F" ) == "T" )
   uFontName           := ::ReadStringData( i, "FONT", "" )
   uFontName           := ::ReadStringData( i, "FONTNAME", uFontName )
   uFontName           := ::ReadOopData( i, "FONTNAME", uFontName )
   cFontName           := ::StrToValueCtrl( uFontName, "C", "" )
   uFontSize           := ::ReadStringData( i, "SIZE", "" )
   uFontSize           := ::ReadStringData( i, "FONTSIZE", uFontSize )
   uFontSize           := ::ReadOopData( i, "FONTSIZE", uFontSize )
   nFontSize           := ::StrToValueCtrl( uFontSize, "N", 0, 1, 9999 )
   lBold               := ( ::ReadLogicalData( i, "BOLD", "F" ) == "T" )
   lBold               := ( ::ReadLogicalData( i, "FONTBOLD", iif( lBold, "T", "F" ) ) == "T" )
   lBold               := ( Upper( ::ReadOopData( i, "FONTBOLD", iif( lBold, ".T.", ".F." ) ) ) == ".T." )
   lItalic             := ( ::ReadLogicalData( i, "ITALIC", "F" ) == "T" )
   lItalic             := ( ::ReadLogicalData( i, "FONTITALIC", iif( lItalic, "T", "F" ) ) == "T" )
   lItalic             := ( Upper( ::ReadOopData( i, "FONTITALIC", iif( lItalic, ".T.", ".F." ) ) ) == ".T." )
   lUnderline          := ( ::ReadLogicalData( i, "UNDERLINE", "F" ) == "T" )
   lUnderline          := ( ::ReadLogicalData( i, "FONTUNDERLINE", iif( lUnderline, "T", "F" ) ) == "T" )
   lUnderline          := ( Upper( ::ReadOopData( i, "FONTUNDERLINE", iif( lUnderline, ".T.", ".F." ) ) ) == ".T." )
   lStrikeout          := ( ::ReadLogicalData( i, "STRIKEOUT", "F" ) == "T" )
   lStrikeout          := ( ::ReadLogicalData( i, "FONTSTRIKEOUT", iif( lStrikeout, "T", "F" ) ) == "T" )
   lStrikeout          := ( Upper( ::ReadOopData( i, "FONTSTRIKEOUT", iif( lStrikeout, ".T.", ".F." ) ) ) == ".T." )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   cOnCancel           := ::ReadStringData( i, "ON CANCEL", "" )
   cOnCancel           := ::ReadStringData( i, "ONCANCEL", cOnCancel )
   cOnGotFocus         := ::ReadStringData( i, "ON GOTFOCUS", "" )
   cOnGotFocus         := ::ReadStringData( i, "ONGOTFOCUS", cOnGotFocus )
   cOnChange           := ::ReadStringData( i, "ON CHANGE", "" )
   cOnChange           := ::ReadStringData( i, "ONCHANGE", cOnChange )
   cOnLostFocus        := ::ReadStringData( i, "ON LOSTFOCUS", "" )
   cOnLostFocus        := ::ReadStringData( i, "ONLOSTFOCUS", cOnLostFocus )
   cOnEnter            := ::ReadStringData( i, "ON ENTER", "" )
   cOnEnter            := ::ReadStringData( i, "ONENTER", cOnEnter )
   cOnDisplayChange    := ::ReadStringData( i, "ON DISPLAYCHANGE", "" )
   cOnDisplayChange    := ::ReadStringData( i, "ONDISPLAYCHANGE", cOnDisplayChange )
   lNoTabStop          := ( ( cVal := ::ReadLogicalData( i, "TABSTOP", "N" ) ) == "F" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "NOTABSTOP", "N" ) == "T" ) )
   cHelpId             := ::ReadStringData( i, "HELPID", "" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   cImage              := ::ReadStringData( i, "IMAGE", "" )
   cImage              := ::ReadStringData( i, "IMAGES", cImage )
   cImageSource        := ::ReadStringData( i, "IMAGESOURCE", "" )
   lFit                := ( ::ReadLogicalData( i, "FIT", "F" ) == "T" )
   lSort               := ( ::ReadLogicalData( i, "SORT", "F" ) == "T" )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   cTextHeight         := ::ReadStringData( i, "TEXTHEIGHT", "" )
   cEditHeight         := ::ReadStringData( i, "EDITHEIGHT", "" )
   cOptHeight          := ::ReadStringData( i, "OPTIONSHEIGHT", "" )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   lFirstItem          := ( ::ReadLogicalData( i, "FIRSTITEM", "F" ) == "T" )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   aFontColor          := ::ReadStringData( i, "FONTCOLOR", "NIL" )
   aFontColor          := UpperNIL( ::ReadOopData( i, "FONTCOLOR", aFontColor ) )
   cListWidth          := ::ReadStringData( i, "LISTWIDTH", "" )
   cOnListDisplay      := ::ReadStringData( i, "ON LISTDISPLAY", "" )
   cOnListDisplay      := ::ReadStringData( i, "ONLISTDISPLAY", cOnListDisplay )
   cOnListClose        := ::ReadStringData( i, "ON LISTCLOSE", "" )
   cOnListClose        := ::ReadStringData( i, "ONLISTCLOSE", cOnListClose )
   lDelayedLoad        := ( ::ReadLogicalData( i, "DELAYEDLOAD", "F" ) == "T" )
   lIncremental        := ( ::ReadLogicalData( i, "INCREMENTAL", "F" ) == "T" )
   lIntegralHeight     := ( ::ReadLogicalData( i, "INTEGRALHEIGHT", "F" ) == "T" )
   cRefresh            := ::ReadLogicalData( i, "REFRESH", "N" )
   cNoRefresh          := ::ReadLogicalData( i, "NOREFRESH", "N" )
   cSourceOrder        := ::ReadStringData( i, "SOURCEORDER", "" )
   cOnRefresh          := ::ReadStringData( i, "ON REFRESH", "" )
   cOnRefresh          := ::ReadStringData( i, "ONREFRESH", cOnRefresh )
   cSearchLapse        := ::ReadStringData( i, "SEARCHLAPSE", "" )
   cGripperText        := ::ReadStringData( i, "GRIPPERTEXT", "" )
   lBreak              := ( ::ReadLogicalData( i, "BREAK", "F" ) == "T" )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cIsIndex            := ::ReadLogicalData( i, "INDEXISVALUE", "N" )
   cIsValue            := ::ReadLogicalData( i, "SOURCEISVALUE", "N" )
   cCue                := ::ReadStringData( i, "CUEBANNER", "" )
   cCue                := ::ReadStringData( i, "PLACEHOLDER", cCue )
   lAutoSize           := ( ::ReadLogicalData( i, "AUTOSIZE", "F" ) == "T" )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_COMBOBOX ]
   ::aCObj[i]          := cObj
   ::aItems[i]         := cItems
   ::aNoClone[i]       := lNoClone
   ::aItemSource[i]    := cItemSource
   ::aItemImgNumber[i] := cItemImageNumber
   ::aValue[i]         := cValue
   ::aValueSource[i]   := cValueSource
   ::aDisplayEdit[i]   := lDisplayEdit
   ::aMaxLength[i]     := cMaxLen
   ::aNoHScroll[i]     := lNoHScroll
   ::aNoLoadTrans[i]   := lNoLoadTrans
   ::aFontName[i]      := cFontName
   ::aFontNameFrm[i]   := uFontName
   ::aFontSize[i]      := nFontSize
   ::aFontSizeFrm[i]   := uFontSize
   ::aFontBold[i]      := lBold
   ::aFontItalic[i]    := lItalic
   ::aFontUnderline[i] := lUnderline
   ::aFontStrikeout[i] := lStrikeout
   ::aToolTip[i]       := cToolTip
   ::aOnCancel[i]      := cOnCancel
   ::aOnGotFocus[i]    := cOnGotFocus
   ::aOnChange[i]      := cOnChange
   ::aOnLostFocus[i]   := cOnLostFocus
   ::aOnEnter[i]       := cOnEnter
   ::aOnDispChange[i]  := cOnDisplayChange
   ::aNoTabStop[i]     := lNoTabStop
   ::aHelpID[i]        := cHelpId
   ::aInvisible[i]     := ! lVisible
   ::aImage[i]         := cImage
   ::aImageSource[i]   := cImageSource
   ::aFit[i]           := lFit
   ::aSort[i]          := lSort
   ::aRTL[i]           := lRTL
   ::aTextHeight[i]    := cTextHeight
   ::aEditHeight[i]    := cEditHeight
   ::aOptHeight[i]     := cOptHeight
   ::aSubClass[i]      := cSubClass
   ::aDisabled[i]      := ! lEnabled
   ::aFirstItem[i]     := lFirstItem
   ::aBackColor[i]     := aBackColor
   ::aFontColor[i]     := aFontColor
   ::aListWidth[i]     := cListWidth
   ::aOnListDisplay[i] := cOnListDisplay
   ::aOnListClose[i]   := cOnListClose
   ::aDelayedLoad[i]   := lDelayedLoad
   ::aIncremental[i]   := lIncremental
   ::aIntegHeight[i]   := lIntegralHeight
   ::aRefresh[i]       := iif( cRefresh == cNoRefresh, "NIL", iif( cRefresh == "T" .OR. cNoRefresh == "F", ".T.", ".F." ) )
   ::aSourceOrder[i]   := cSourceOrder
   ::aOnRefresh[i]     := cOnRefresh
   ::aSearchLapse[i]   := cSearchLapse
   ::aGripperText[i]   := cGripperText
   ::aBreak[i]         := lBreak
   ::aParent[i]        := cParent
   ::aValueIs[i]       := iif( cIsIndex == cIsValue, "NIL", iif( cIsIndex == "T" .OR. cIsValue == "F", "INDEXISVALUE", "SOURCEISVALUE" ) )
   ::aCue[i]           := cCue
   ::aAutoSize[i]      := lAutoSize
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pDatePicker( i ) CLASS TFormEditor

   LOCAL cCargo, cField, cFontName, cFormat, cHelpID, cObj, cOnChange, cOnEnter, cOnGotFocus, cOnLostFocus, cParent, cRange
   LOCAL cSubClass, cToolTip, cVal, cValid, cValue, lBold, lEnabled, lItalic, lNoBorder, lNoTabStop, lRTL, lRightAlign, lShowNone
   LOCAL lStrikeout, lUnderline, lUpDown, lVisible, nCol, nFontSize, nHeight, nRow, nWidth, oCtrl, uFontName, uFontSize

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( TDatePick():nWidth ) ) ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( TDatePick():nHeight ) ) ) )
   cValue              := ::ReadStringData( i, "VALUE", "" )
   cField              := ::ReadStringData( i, "FIELD", "" )
   uFontName           := ::ReadStringData( i, "FONT", "" )
   uFontName           := ::ReadStringData( i, "FONTNAME", uFontName )
   uFontName           := ::ReadOopData( i, "FONTNAME", uFontName )
   cFontName           := ::StrToValueCtrl( uFontName, "C", "" )
   uFontSize           := ::ReadStringData( i, "SIZE", "" )
   uFontSize           := ::ReadStringData( i, "FONTSIZE", uFontSize )
   uFontSize           := ::ReadOopData( i, "FONTSIZE", uFontSize )
   nFontSize           := ::StrToValueCtrl( uFontSize, "N", 0, 1, 9999 )
   lBold               := ( ::ReadLogicalData( i, "BOLD", "F" ) == "T" )
   lBold               := ( ::ReadLogicalData( i, "FONTBOLD", iif( lBold, "T", "F" ) ) == "T" )
   lBold               := ( Upper( ::ReadOopData( i, "FONTBOLD", iif( lBold, ".T.", ".F." ) ) ) == ".T." )
   lItalic             := ( ::ReadLogicalData( i, "ITALIC", "F" ) == "T" )
   lItalic             := ( ::ReadLogicalData( i, "FONTITALIC", iif( lItalic, "T", "F" ) ) == "T" )
   lItalic             := ( Upper( ::ReadOopData( i, "FONTITALIC", iif( lItalic, ".T.", ".F." ) ) ) == ".T." )
   lUnderline          := ( ::ReadLogicalData( i, "UNDERLINE", "F" ) == "T" )
   lUnderline          := ( ::ReadLogicalData( i, "FONTUNDERLINE", iif( lUnderline, "T", "F" ) ) == "T" )
   lUnderline          := ( Upper( ::ReadOopData( i, "FONTUNDERLINE", iif( lUnderline, ".T.", ".F." ) ) ) == ".T." )
   lStrikeout          := ( ::ReadLogicalData( i, "STRIKEOUT", "F" ) == "T" )
   lStrikeout          := ( ::ReadLogicalData( i, "FONTSTRIKEOUT", iif( lStrikeout, "T", "F" ) ) == "T" )
   lStrikeout          := ( Upper( ::ReadOopData( i, "FONTSTRIKEOUT", iif( lStrikeout, ".T.", ".F." ) ) ) == ".T." )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   lShowNone           := ( ::ReadLogicalData( i, "SHOWNONE", "F" ) == "T" )
   lUpDown             := ( ::ReadLogicalData( i, "UPDOWN", "F" ) == "T" )
   lRightAlign         := ( ::ReadLogicalData( i, "RIGHTALIGN", "F" ) == "T" )
   cOnGotFocus         := ::ReadStringData( i, "ON GOTFOCUS", "" )
   cOnGotFocus         := ::ReadStringData( i, "ONGOTFOCUS", cOnGotFocus )
   cOnChange           := ::ReadStringData( i, "ON CHANGE", "" )
   cOnChange           := ::ReadStringData( i, "ONCHANGE", cOnChange )
   cOnLostFocus        := ::ReadStringData( i, "ON LOSTFOCUS", "" )
   cOnLostFocus        := ::ReadStringData( i, "ONLOSTFOCUS", cOnLostFocus )
   cOnEnter            := ::ReadStringData( i, "ON ENTER", "" )
   cOnEnter            := ::ReadStringData( i, "ONENTER", cOnEnter )
   cHelpID             := ::ReadStringData( i, "HELPID", "" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lNoTabStop          := ( ( cVal := ::ReadLogicalData( i, "TABSTOP", "N" ) ) == "F" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "NOTABSTOP", "N" ) == "T" ) )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   lNoBorder           := ( ::ReadLogicalData( i, "NOBORDER", "F" ) == "T" )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   cRange              := ::ReadStringData( i, "RANGE", "" )
   cFormat             := ::ReadStringData( i, "DATEFORMAT", "" )
   cValid              := ::ReadStringData( i, "VALID", "" )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_DATEPICKER ]
   ::aCObj[i]          := cObj
   ::aValue[i]         := cValue
   ::aField[i]         := cField
   ::aFontName[i]      := cFontName
   ::aFontNameFrm[i]   := uFontName
   ::aFontSize[i]      := nFontSize
   ::aFontSizeFrm[i]   := uFontSize
   ::aFontBold[i]      := lBold
   ::aFontItalic[i]    := lItalic
   ::aFontUnderline[i] := lUnderline
   ::aFontStrikeout[i] := lStrikeout
   ::aToolTip[i]       := cToolTip
   ::aShowNone[i]      := lShowNone
   ::aUpDown[i]        := lUpDown
   ::aRightAlign[i]    := lRightAlign
   ::aOnGotFocus[i]    := cOnGotFocus
   ::aOnChange[i]      := cOnChange
   ::aOnLostFocus[i]   := cOnLostFocus
   ::aOnEnter[i]       := cOnEnter
   ::aHelpID[i]        := cHelpID
   ::aInvisible[i]     := ! lVisible
   ::aNoTabStop[i]     := lNoTabStop
   ::aDisabled[i]      := ! lEnabled
   ::aNoBorder[i]      := lNoBorder
   ::aRTL[i]           := lRTL
   ::aSubClass[i]      := cSubClass
   ::aRange[i]         := cRange
   ::aFormat[i]        := cFormat
   ::aValid[i]         := cValid
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pEditbox( i ) CLASS TFormEditor

   LOCAL aBackColor, aFontColor, cCargo, cField, cFocusedPos, cFontName, cHelpID, cInsertType, cMaxLength, cObj, cOnChange
   LOCAL cOnGotFocus, cOnHScroll, cOnLostFocus, cOnVScroll, cParent, cSubClass, cToolTip, cVal, cValue, lBold, lBreak, lEnabled
   LOCAL lItalic, lNoBorder, lNoHScroll, lNoTabStop, lNoVScroll, lReadonly, lRTL, lStrikeout, lUnderline, lVisible, nCol, nFontSize
   LOCAL nHeight, nRow, nWidth, oCtrl, uFontName, uFontSize

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( TEdit():nWidth ) ) ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( TEdit():nHeight ) ) ) )
   cField              := ::ReadStringData( i, "FIELD", "" )
   cValue              := ::ReadStringData( i, "VALUE", "" )
   lReadonly           := ( ::ReadLogicalData( i, "READONLY", "F" ) == "T" )
   uFontName           := ::ReadStringData( i, "FONT", "" )
   uFontName           := ::ReadStringData( i, "FONTNAME", uFontName )
   uFontName           := ::ReadOopData( i, "FONTNAME", uFontName )
   cFontName           := ::StrToValueCtrl( uFontName, "C", "" )
   uFontSize           := ::ReadStringData( i, "SIZE", "" )
   uFontSize           := ::ReadStringData( i, "FONTSIZE", uFontSize )
   uFontSize           := ::ReadOopData( i, "FONTSIZE", uFontSize )
   nFontSize           := ::StrToValueCtrl( uFontSize, "N", 0, 1, 9999 )
   lBold               := ( ::ReadLogicalData( i, "BOLD", "F" ) == "T" )
   lBold               := ( ::ReadLogicalData( i, "FONTBOLD", iif( lBold, "T", "F" ) ) == "T" )
   lBold               := ( Upper( ::ReadOopData( i, "FONTBOLD", iif( lBold, ".T.", ".F." ) ) ) == ".T." )
   lItalic             := ( ::ReadLogicalData( i, "ITALIC", "F" ) == "T" )
   lItalic             := ( ::ReadLogicalData( i, "FONTITALIC", iif( lItalic, "T", "F" ) ) == "T" )
   lItalic             := ( Upper( ::ReadOopData( i, "FONTITALIC", iif( lItalic, ".T.", ".F." ) ) ) == ".T." )
   lUnderline          := ( ::ReadLogicalData( i, "UNDERLINE", "F" ) == "T" )
   lUnderline          := ( ::ReadLogicalData( i, "FONTUNDERLINE", iif( lUnderline, "T", "F" ) ) == "T" )
   lUnderline          := ( Upper( ::ReadOopData( i, "FONTUNDERLINE", iif( lUnderline, ".T.", ".F." ) ) ) == ".T." )
   lStrikeout          := ( ::ReadLogicalData( i, "STRIKEOUT", "F" ) == "T" )
   lStrikeout          := ( ::ReadLogicalData( i, "FONTSTRIKEOUT", iif( lStrikeout, "T", "F" ) ) == "T" )
   lStrikeout          := ( Upper( ::ReadOopData( i, "FONTSTRIKEOUT", iif( lStrikeout, ".T.", ".F." ) ) ) == ".T." )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   aFontColor          := ::ReadStringData( i, "FONTCOLOR", "NIL" )
   aFontColor          := UpperNIL( ::ReadOopData( i, "FONTCOLOR", aFontColor ) )
   cMaxLength          := ::ReadStringData( i, "MAXLENGTH", "" )
   cOnGotFocus         := ::ReadStringData( i, "ON GOTFOCUS", "" )
   cOnGotFocus         := ::ReadStringData( i, "ONGOTFOCUS", cOnGotFocus )
   cOnChange           := ::ReadStringData( i, "ON CHANGE", "" )
   cOnChange           := ::ReadStringData( i, "ONCHANGE", cOnChange )
   cOnLostFocus        := ::ReadStringData( i, "ON LOSTFOCUS", "" )
   cOnLostFocus        := ::ReadStringData( i, "ONLOSTFOCUS", cOnLostFocus )
   cHelpID             := ::ReadStringData( i, "HELPID", "" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lNoTabStop          := ( ( cVal := ::ReadLogicalData( i, "TABSTOP", "N" ) ) == "F" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "NOTABSTOP", "N" ) == "T" ) )
   lNoVScroll          := ( ( cVal := ::ReadLogicalData( i, "NOVSCROLL", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "VSCROLLBAR", "N" ) == "F" ) )
   lNoHScroll          := ( ( cVal := ::ReadLogicalData( i, "NOHSCROLL", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "HSCROLLBAR", "N" ) == "F" ) )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   lNoBorder           := ( ::ReadLogicalData( i, "NOBORDER", "F" ) == "T" )
   cFocusedPos         := ::ReadStringData( i, "FOCUSEDPOS", "" )
   cOnVScroll          := ::ReadStringData( i, "ON VSCROLL", "" )
   cOnVScroll          := ::ReadStringData( i, "ONVSCROLL", cOnVScroll )
   cOnHScroll          := ::ReadStringData( i, "ON HSCROLL", "" )
   cOnHScroll          := ::ReadStringData( i, "ONHSCROLL", cOnHScroll )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   cInsertType         := ::ReadStringData( i, "INSERTTYPE", "" )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   lBreak              := ( ::ReadLogicalData( i, "BREAK", "F" ) == "T" )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_EDITBOX ]
   ::aCObj[i]          := cObj
   ::aField[i]         := cField
   ::aValue[i]         := cValue
   ::aReadOnly[i]      := lReadonly
   ::aFontName[i]      := cFontName
   ::aFontNameFrm[i]   := uFontName
   ::aFontSize[i]      := nFontSize
   ::aFontSizeFrm[i]   := uFontSize
   ::aFontBold[i]      := lBold
   ::aFontItalic[i]    := lItalic
   ::aFontUnderline[i] := lUnderline
   ::aFontStrikeout[i] := lStrikeout
   ::aToolTip[i]       := cTooltip
   ::aBackColor[i]     := aBackColor
   ::aFontColor[i]     := aFontColor
   ::aMaxLength[i]     := cMaxLength
   ::aOnGotFocus[i]    := cOnGotFocus
   ::aOnChange[i]      := cOnChange
   ::aOnLostFocus[i]   := cOnLostFocus
   ::aHelpID[i]        := cHelpID
   ::aInvisible[i]     := ! lVisible
   ::aNoTabStop[i]     := lNoTabStop
   ::aNoVScroll[i]     := lNoVScroll
   ::aNoHScroll[i]     := lNoHScroll
   ::aRTL[i]           := lRTL
   ::aNoBorder[i]      := lNoBorder
   ::aFocusedPos[i]    := cFocusedPos
   ::aOnVScroll[i]     := cOnVScroll
   ::aOnHScroll[i]     := cOnHScroll
   ::aDisabled[i]      := ! lEnabled
   ::aInsertType[i]    := cInsertType
   ::aSubClass[i]      := cSubClass
   ::aBreak[i]         := lBreak
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pFrame( i ) CLASS TFormEditor

   LOCAL aBackColor, aFontColor, cCaption, cCargo, cExclude, cFontName, cObj, cParent, cSubClass, cToolTip, cVal, lBold, lEnabled
   LOCAL lItalic, lOpaque, lRTL, lStrikeout, lTrans, lUnderline, lVisible, nCol, nFontSize, nHeight, nRow, nWidth, oCtrl, uFontName
   LOCAL uFontSize

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( TFrame():nWidth ) ) ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( TFrame():nHeight ) ) ) )
   cCaption            := ::ReadStringData( i, "CAPTION", "" )
   uFontName           := ::ReadStringData( i, "FONT", "" )
   uFontName           := ::ReadStringData( i, "FONTNAME", uFontName )
   uFontName           := ::ReadOopData( i, "FONTNAME", uFontName )
   cFontName           := ::StrToValueCtrl( uFontName, "C", "" )
   uFontSize           := ::ReadStringData( i, "SIZE", "" )
   uFontSize           := ::ReadStringData( i, "FONTSIZE", uFontSize )
   uFontSize           := ::ReadOopData( i, "FONTSIZE", uFontSize )
   nFontSize           := ::StrToValueCtrl( uFontSize, "N", 0, 1, 9999 )
   lBold               := ( ::ReadLogicalData( i, "BOLD", "F" ) == "T" )
   lBold               := ( ::ReadLogicalData( i, "FONTBOLD", iif( lBold, "T", "F" ) ) == "T" )
   lBold               := ( Upper( ::ReadOopData( i, "FONTBOLD", iif( lBold, ".T.", ".F." ) ) ) == ".T." )
   lItalic             := ( ::ReadLogicalData( i, "ITALIC", "F" ) == "T" )
   lItalic             := ( ::ReadLogicalData( i, "FONTITALIC", iif( lItalic, "T", "F" ) ) == "T" )
   lItalic             := ( Upper( ::ReadOopData( i, "FONTITALIC", iif( lItalic, ".T.", ".F." ) ) ) == ".T." )
   lUnderline          := ( ::ReadLogicalData( i, "UNDERLINE", "F" ) == "T" )
   lUnderline          := ( ::ReadLogicalData( i, "FONTUNDERLINE", iif( lUnderline, "T", "F" ) ) == "T" )
   lUnderline          := ( Upper( ::ReadOopData( i, "FONTUNDERLINE", iif( lUnderline, ".T.", ".F." ) ) ) == ".T." )
   lStrikeout          := ( ::ReadLogicalData( i, "STRIKEOUT", "F" ) == "T" )
   lStrikeout          := ( ::ReadLogicalData( i, "FONTSTRIKEOUT", iif( lStrikeout, "T", "F" ) ) == "T" )
   lStrikeout          := ( Upper( ::ReadOopData( i, "FONTSTRIKEOUT", iif( lStrikeout, ".T.", ".F." ) ) ) == ".T." )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   aFontColor          := ::ReadStringData( i, "FONTCOLOR", "NIL" )
   aFontColor          := UpperNIL( ::ReadOopData( i, "FONTCOLOR", aFontColor ) )
   lOpaque             := ( ::ReadLogicalData( i, "OPAQUE", "F") == "T" )
   lTrans              := ( ::ReadLogicalData( i, "TRANSPARENT", "F" ) == "T" )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   cExclude            := ::ReadStringData( i, "EXCLUDEAREA", "" )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_FRAME ]
   ::aCObj[i]          := cObj
   ::aCaption[i]       := cCaption
   ::aFontName[i]      := cFontName
   ::aFontNameFrm[i]   := uFontName
   ::aFontSize[i]      := nFontSize
   ::aFontSizeFrm[i]   := uFontSize
   ::aFontBold[i]      := lBold
   ::aFontItalic[i]    := lItalic
   ::aFontUnderline[i] := lUnderline
   ::aFontStrikeout[i] := lStrikeout
   ::aBackColor[i]     := aBackColor
   ::aFontColor[i]     := aFontColor
   ::aOpaque[i]        := lOpaque
   ::aTransparent[i]   := lTrans
   ::aRTL[i]           := lRTL
   ::aInvisible[i]     := ! lVisible
   ::aDisabled[i]      := ! lEnabled
   ::aSubClass[i]      := cSubClass
   ::aToolTip[i]       := cToolTip
   ::aExclude[i]       := cExclude
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pGrid( i ) CLASS TFormEditor

   LOCAL aBackColor, aFontColor, aSelColor, cAction, cAfterColMove, cAfterColSize, cBeforeAutoFit, cBeforeColMove, cBeforeColSize
   LOCAL cCargo, cColControls, cDeleteMsg, cDeleteWhen, cDynamicCtrls, cDynBackColor, cDynForecolor, cEditCell, cEditKeys
   LOCAL cEditKeysFun, cFixedCtrls, cFocusRect, cFontName, cHdrImgAlign, cHdrBackClrs, cHdrFontClrs, cHdrImgs, cHdrs, cHelpId, cImage
   LOCAL cInputMask, cItemCount, cItems, cJustify, cNoFocusRect, cObj, cOnAbortEdit, cOnAppend, cOnBeforeIns, cOnBFREdtCell
   LOCAL cOnChange, cOnCheckChg, cOnDblClick, cOnDelete, cOnEditCell, cOnEditEnd, cOnEnter, cOnGotFocus, cOnHeadClick, cOnHeadDClick
   LOCAL cOnHeadRClick, cOnInsert, cOnLostFocus, cOnQueryData, cOnRClick, cParent, cReadOnly, cSubClass, cTimeOut, cToolTip, cVal
   LOCAL cValid, cValidMess, cValue, cWhen, cWidths, lAppend, lBold, lBreak, lButtons, lByCell, lCBE, lCellTT, lCheckBoxes, lDelete
   LOCAL lDisableAltA, lEdit, lEditFV, lEnableAltA, lEnabled, lExtDblClick, lFixedCols, lFixedWidths, lFullMove, lInPlace, lItalic
   LOCAL lKeysLkClp, lLikeExcel, lMultiSelect, lNoClickOnChk, lNoDefaultMsg, lNoDeleteMsg, lNoHeaders, lNoHScroll, lNoLines
   LOCAL lNoModalEdit, lNoneUnsels, lNoRClickOnChk, lNoShow, lNoTabStop, lNoVScroll, lPLM, lRTL, lSilent, lSingleBuffer, lStrikeout
   LOCAL lUnderline, lVirtual, lVisible, nCol, nFontSize, nHeight, nRow, nWidth, oCtrl, uFontName, uFontSize

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( TGrid():nWidth ) ) ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( TGrid():nHeight ) ) ) )
   cHdrs            := ::ReadStringData( i, "HEADERS", "{ 'one', 'two' }")
   cWidths             := ::ReadStringData( i, "WIDTHS", "{ 80, 60 }")
   cInputMask          := ::ReadStringData( i, "INPUTMASK", "")
   cItems              := ::ReadStringData( i, "ITEMS", "")
   cValue              := ::ReadStringData( i, "VALUE", "")
   uFontName           := ::ReadStringData( i, "FONT", "" )
   uFontName           := ::ReadStringData( i, "FONTNAME", uFontName )
   uFontName           := ::ReadOopData( i, "FONTNAME", uFontName )
   cFontName           := ::StrToValueCtrl( uFontName, "C", "" )
   uFontSize           := ::ReadStringData( i, "SIZE", "" )
   uFontSize           := ::ReadStringData( i, "FONTSIZE", uFontSize )
   uFontSize           := ::ReadOopData( i, "FONTSIZE", uFontSize )
   nFontSize           := ::StrToValueCtrl( uFontSize, "N", 0, 1, 9999 )
   lBold               := ( ::ReadLogicalData( i, "BOLD", "F" ) == "T" )
   lBold               := ( ::ReadLogicalData( i, "FONTBOLD", iif( lBold, "T", "F" ) ) == "T" )
   lBold               := ( Upper( ::ReadOopData( i, "FONTBOLD", iif( lBold, ".T.", ".F." ) ) ) == ".T." )
   lItalic             := ( ::ReadLogicalData( i, "ITALIC", "F" ) == "T" )
   lItalic             := ( ::ReadLogicalData( i, "FONTITALIC", iif( lItalic, "T", "F" ) ) == "T" )
   lItalic             := ( Upper( ::ReadOopData( i, "FONTITALIC", iif( lItalic, ".T.", ".F." ) ) ) == ".T." )
   lUnderline          := ( ::ReadLogicalData( i, "UNDERLINE", "F" ) == "T" )
   lUnderline          := ( ::ReadLogicalData( i, "FONTUNDERLINE", iif( lUnderline, "T", "F" ) ) == "T" )
   lUnderline          := ( Upper( ::ReadOopData( i, "FONTUNDERLINE", iif( lUnderline, ".T.", ".F." ) ) ) == ".T." )
   lStrikeout          := ( ::ReadLogicalData( i, "STRIKEOUT", "F" ) == "T" )
   lStrikeout          := ( ::ReadLogicalData( i, "FONTSTRIKEOUT", iif( lStrikeout, "T", "F" ) ) == "T" )
   lStrikeout          := ( Upper( ::ReadOopData( i, "FONTSTRIKEOUT", iif( lStrikeout, ".T.", ".F." ) ) ) == ".T." )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   aFontColor          := ::ReadStringData( i, "FONTCOLOR", "NIL" )
   aFontColor          := UpperNIL( ::ReadOopData( i, "FONTCOLOR", aFontColor ) )
   cDynBackColor       := ::ReadStringData( i, "DYNAMICBACKCOLOR", "" )
   cDynForecolor       := ::ReadStringData( i, "DYNAMICFORECOLOR", "" )
   cOnGotFocus         := ::ReadStringData( i, "ON GOTFOCUS", "" )
   cOnGotFocus         := ::ReadStringData( i, "ONGOTFOCUS", cOnGotFocus )
   cOnChange           := ::ReadStringData( i, "ON CHANGE", "" )
   cOnChange           := ::ReadStringData( i, "ONCHANGE", cOnChange )
   cOnLostFocus        := ::ReadStringData( i, "ON LOSTFOCUS", "" )
   cOnLostFocus        := ::ReadStringData( i, "ONLOSTFOCUS", cOnLostFocus )
   cOnDblClick         := ::ReadStringData( i, "ON DBLCLICK", "" )
   cOnDblClick         := ::ReadStringData( i, "ONDBLCLICK", cOnDblClick )
   cAction             := ::ReadStringData( i, "ACTION", "" )
   cAction             := ::ReadStringData( i, "ON CLICK",cAction )
   cAction             := ::ReadStringData( i, "ONCLICK", cAction )
   cOnHeadClick        := ::ReadStringData( i, "ON HEADCLICK", "" )
   cOnHeadClick        := ::ReadStringData( i, "ONHEADCLICK", cOnHeadClick )
   lEdit               := ( ::ReadLogicalData( i, "EDIT", "F" ) == "T" )
   lEdit               := ( ::ReadLogicalData( i, "ALLOWEDIT", iif( lEdit, "T", "F" ) ) == "T" )
   lVirtual            := ( ::ReadLogicalData( i, "VIRTUAL", "F" ) == "T" )
   cItemCount          := ::ReadStringData( i, "ITEMCOUNT", "" )
   cTimeOut            := ::ReadStringData( i, "TIMEOUT", "" )
   cOnQueryData        := ::ReadStringData( i, "ON QUERYDATA", "" )
   cOnQueryData        := ::ReadStringData( i, "ONQUERYDATA", cOnQueryData )
   lMultiSelect        := ( ::ReadLogicalData( i, "MULTISELECT", "F" ) == "T" )
   lNoLines            := ( ::ReadLogicalData( i, "NOLINES", "F" ) == "T" )
   cImage              := ::ReadStringData( i, "IMAGE", "" )
   cJustify            := ::ReadStringData( i, "JUSTIFY", "" )
   cHelpId             := ::ReadStringData( i, "HELPID", "" )
   lBreak              := ( ::ReadLogicalData( i, "BREAK", "F" ) == "T" )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   lInPlace            := ( ::ReadLogicalData( i, "INPLACE", "F" ) == "T" )
   cColControls        := ::ReadStringData( i, "COLUMNCONTROLS", "" )
   cReadOnly           := ::ReadStringData( i, "READONLY", "")
   cValid              := ::ReadStringData( i, "VALID", "" )
   cValid              := ::ReadStringData( i, "COLUMNVALID", cValid )
   cValidMess          := ::ReadStringData( i, "VALIDMESSAGES", "" )
   cOnEditCell         := ::ReadStringData( i, "ON EDITCELL", "" )
   cOnEditCell         := ::ReadStringData( i, "ONEDITCELL", cOnEditCell )
   lNoHeaders          := ( ( cVal := ::ReadLogicalData( i, "NOHEADERS", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "SHOWHEADERS", "N" ) == "F" ) )
   cWhen               := ::ReadStringData( i, "WHEN", "" )
   cWhen               := ::ReadStringData( i, "COLUMNWHEN", cWhen )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   lNoTabStop          := ( ( cVal := ::ReadLogicalData( i, "TABSTOP", "N" ) ) == "F" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "NOTABSTOP", "N" ) == "T" ) )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   cOnEnter            := ::ReadStringData( i, "ON ENTER", "" )
   cOnEnter            := ::ReadStringData( i, "ONENTER", cOnEnter )
   cHdrBackClrs        := ::ReadStringData( i, "HEADERBACKCOLORS", "" )
   cHdrFontClrs        := ::ReadStringData( i, "HEADERCOLORS", "" )
   cHdrFontClrs        := ::ReadStringData( i, "HEADERFONTCOLORS", cHdrFontClrs )
   cHdrImgs            := ::ReadStringData( i, "HEADERIMAGES", "" )
   cHdrImgs            := ::ReadStringData( i, "HEADERIMAGE", cHdrImgs )
   cHdrImgAlign        := ::ReadStringData( i, "IMAGESALIGN", "" )
   cHdrImgAlign        := ::ReadStringData( i, "HEADERIMAGESALIGN", cHdrImgAlign )
   lFullMove           := ( ::ReadLogicalData( i, "FULLMOVE", "F" ) == "T" )
   lByCell             := ( ::ReadLogicalData( i, "NAVIGATEBYCELL", "F" ) == "T" )
   lByCell             := ( ::ReadLogicalData( i, "CELLNAVIGATION", iif( lByCell, "T", "F" ) ) == "T" )
   aSelColor           := UpperNIL( ::ReadStringData( i, "SELECTEDCOLORS", "" ) )
   cEditKeys           := ::ReadStringData( i, "EDITKEYS", "" )
   cEditKeysFun        := ::ReadStringData( i, "EDITKEYSFUN", "" )
   lCheckBoxes         := ( ::ReadLogicalData( i, "CHECKBOXES", "F" ) == "T" )
   cOnCheckChg         := ::ReadStringData( i, "ON CHECKCHANGE", "" )
   cOnCheckChg         := ::ReadStringData( i, "ONCHECKCHANGE", cOnCheckChg )
   lSingleBuffer       := ( ::ReadLogicalData( i, "SINGLEBUFFER", "F" ) == "T" )
   cFocusRect          := ::ReadLogicalData( i, "FOCUSRECT", "F" )
   cNoFocusRect        := ::ReadLogicalData( i, "NOFOCUSRECT", "F" )
   lPLM                := ( ::ReadLogicalData( i, "PAINTLEFTMARGIN", "F" ) == "T" )
   lFixedCols          := ( ::ReadLogicalData( i, "FIXEDCOLS", "F" ) == "T" )
   cOnAbortEdit        := ::ReadStringData( i, "ON ABORTEDIT", "" )
   cOnAbortEdit        := ::ReadStringData( i, "ONABORTEDIT", cOnAbortEdit )
   lFixedWidths        := ( ::ReadLogicalData( i, "FIXEDWIDTHS", "F" ) == "T" )
   cBeforeColMove      := ::ReadStringData( i, "BEFORECOLMOVE", "" )
   cAfterColMove       := ::ReadStringData( i, "AFTERCOLMOVE", "" )
   cBeforeColSize      := ::ReadStringData( i, "BEFORECOLSIZE", "" )
   cAfterColSize       := ::ReadStringData( i, "AFTERCOLSIZE", "" )
   cBeforeAutoFit      := ::ReadStringData( i, "BEFOREAUTOFIT", "" )
   lLikeExcel          := ( ::ReadLogicalData( i, "EDITLIKEEXCEL", "F" ) == "T" )
   lButtons            := ( ::ReadLogicalData( i, "USEBUTTONS", "F" ) == "T" )
   lDelete             := ( ::ReadLogicalData( i, "DELETE", "F" ) == "T" )
   lDelete             := ( ::ReadLogicalData( i, "ALLOWDELETE", iif( lDelete, "T", "F" ) ) == "T" )
   cDeleteWhen         := ::ReadStringData( i, "DELETEWHEN", "" )
   cDeleteMsg          := ::ReadStringData( i, "DELETEMSG", "" )
   cOnDelete           := ::ReadStringData( i, "ON DELETE", "" )
   cOnDelete           := ::ReadStringData( i, "ONDELETE", cOnDelete )
   lNoDefaultMsg       := ( ::ReadLogicalData( i, "NODEFAULTMSG", "F" ) == "T" )
   lNoDeleteMsg        := ( ::ReadLogicalData( i, "NODELETEMSG", "F" ) == "T" )
   lAppend             := ( ::ReadLogicalData( i, "APPEND", "F" ) == "T" )
   lAppend             := ( ::ReadLogicalData( i, "ALLOWAPPEND", iif( lAppend, "T", "F" ) ) == "T" )
   cOnAppend           := ::ReadStringData( i, "ON APPEND", "" )
   cOnAppend           := ::ReadStringData( i, "ONAPPEND", cOnAppend )
   lNoModalEdit        := ( ::ReadLogicalData( i, "NOMODALEDIT", "F" ) == "T" )
   cFixedCtrls         := ::ReadLogicalData( i, "FIXEDCONTROLS", "N" )
   cDynamicCtrls       := ::ReadLogicalData( i, "DYNAMICCONTROLS", "N" )
   cOnHeadDClick       := ::ReadStringData( i, "ON HEADDBLCLICK", "" )
   cOnHeadDClick       := ::ReadStringData( i, "ONHEADBLCLICK", cOnHeadDClick )
   cOnHeadRClick       := ::ReadStringData( i, "ON HEADRCLICK", "" )
   cOnHeadRClick       := ::ReadStringData( i, "ONHEADRCLICK", cOnHeadRClick )
   lNoClickOnChk       := ( ::ReadLogicalData( i, "NOCLICKONCHECKBOX", "F" ) == "T" )
   lNoRClickOnChk      := ( ::ReadLogicalData( i, "NORCLICKONCHECKBOX", "F" ) == "T" )
   lExtDblClick        := ( ::ReadLogicalData( i, "EXTDBLCLICK", "F" ) == "T" )
   lSilent             := ( ::ReadLogicalData( i, "SILENT", "F" ) == "T" )
   lEnableAltA         := ( ::ReadLogicalData( i, "ENABLEALTA", "F" ) == "T" )
   lDisableAltA        := ( ::ReadLogicalData( i, "DISABLEALTA", "F" ) == "T" )
   lNoShow             := ( ::ReadLogicalData( i, "NOSHOWALWAYS", "F" ) == "T" )
   lNoneUnsels         := ( ::ReadLogicalData( i, "NONEUNSELS", "F" ) == "T" )
   lCBE                := ( ::ReadLogicalData( i, "CHANGEBEFOREEDIT", "F" ) == "T" )
   cOnRClick           := ::ReadStringData( i, "ON RCLICK", "" )
   cOnRClick           := ::ReadStringData( i, "ONRCLICK", cOnRClick )
   cOnBeforeIns        := ::ReadStringData( i, "ON BEFOREINSERT", "" )
   cOnBeforeIns        := ::ReadStringData( i, "ONBEFOREINSERT", cOnBeforeIns )
   cOnInsert           := ::ReadStringData( i, "ON INSERT", "" )
   cOnInsert           := ::ReadStringData( i, "ONINSERT", cOnInsert )
   cOnEditEnd          := ::ReadStringData( i, "ON EDITCELLEND", "" )
   cOnEditEnd          := ::ReadStringData( i, "ONEDITCELLEND", cOnEditEnd )
   lEditFV             := ( ::ReadLogicalData( i, "EDITFIRSTVISIBLE", "F" ) == "T" )
   cOnBfrEdtCell       := ::ReadStringData( i, "ON BEFOREEDITCELL", "" )
   cOnBfrEdtCell       := ::ReadStringData( i, "ONBEFOREEDITCELL", cOnBfrEdtCell )
   cEditCell           := ::ReadStringData( i, "EDITCELLVALUE", "" )
   lKeysLkClp          := ( ::ReadLogicalData( i, "KEYSLIKECLIPPER", "F" ) == "T" )
   lCellTT             := ( ::ReadLogicalData( i, "CELLTOOLTIP", "F" ) == "T" )
   lNoHScroll          := ( ::ReadLogicalData( i, "NOHSCROLL", "F" ) == "T" )
   lNoHScroll          := ( ::ReadLogicalData( i, "NOHSCROLLBAR", iif( lNoHScroll, "T", "F" ) ) == "T" )
   lNoVScroll          := ( ::ReadLogicalData( i, "NOVSCROLL", "F" ) == "T" )
   lNoVScroll          := ( ::ReadLogicalData( i, "NOVSCROLLBAR", iif( lNoVScroll, "T", "F" ) ) == "T" )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_GRID ]
   ::aCObj[i]          := cObj
   ::aHeaders[i]       := cHdrs
   ::aWidths[i]        := cWidths
   ::aInputMask[i]     := cInputMask
   ::aItems[i]         := cItems
   ::aValue[i]         := cValue
   ::aFontName[i]      := cFontName
   ::aFontNameFrm[i]   := uFontName
   ::aFontSize[i]      := nFontSize
   ::aFontSizeFrm[i]   := uFontSize
   ::aFontBold[i]      := lBold
   ::aFontItalic[i]    := lItalic
   ::aFontUnderline[i] := lUnderline
   ::aFontStrikeout[i] := lStrikeout
   ::aToolTip[i]       := cToolTip
   ::aBackColor[i]     := aBackColor
   ::aFontColor[i]     := aFontColor
   ::aDynBackColor[i]  := cDynBackColor
   ::aDynForeColor[i]  := cDynForecolor
   ::aOnGotFocus[i]    := cOnGotFocus
   ::aOnChange[i]      := cOnChange
   ::aOnLostFocus[i]   := cOnLostFocus
   ::aOnDblClick[i]    := cOnDblClick
   ::aAction[i]        := cAction
   ::aOnHeadClick[i]   := cOnHeadClick
   ::aOnHeadDClick[i]  := cOnHeadDClick
   ::aEdit[i]          := lEdit
   ::aVirtual[i]       := lVirtual
   ::aItemCount[i]     := cItemCount
   ::aTimeOut[i]       := cTimeOut
   ::aOnQueryData[i]   := cOnQueryData
   ::aMultiSelect[i]   := lMultiSelect
   ::aNoLines[i]       := lNoLines
   ::aImage[i]         := cImage
   ::aJustify[i]       := cJustify
   ::aHelpID[i]        := cHelpId
   ::aBreak[i]         := lBreak
   ::aRTL[i]           := lRTL
   ::aInPlace[i]       := lInPlace
   ::aColumnCtrls[i]   := cColControls
   ::aReadOnlyArray[i] := cReadOnly
   ::aValid[i]         := cValid
   ::aValidMess[i]     := cValidMess
   ::aOnEditCell[i]    := cOnEditCell
   ::aNoHeaders[i]     := lNoHeaders
   ::aWhen[i]          := cWhen
   ::aSubClass[i]      := cSubClass
   ::aDisabled[i]      := ! lEnabled
   ::aNoTabStop[i]     := lNoTabStop
   ::aInvisible[i]     := ! lVisible
   ::aOnEnter[i]       := cOnEnter
   ::aHdrBackClrs[i]   := cHdrBackClrs
   ::aHdrFontClrs[i]   := cHdrFontClrs
   ::aHdrImages[i]     := cHdrImgs
   ::aHdrImgAlign[i]   := cHdrImgAlign
   ::aFullMove[i]      := lFullMove
   ::aNavByCell[i]     := lByCell
   ::aSelColor[i]      := aSelColor
   ::aEditKeys[i]      := cEditKeys
   ::aEditKeysFun[i]   := cEditKeysFun
   ::aCheckBoxes[i]    := lCheckBoxes
   ::aOnCheckChg[i]    := cOnCheckChg
   ::aSingleBuffer[i]  := lSingleBuffer
   ::aFocusRect[i]     := iif( cFocusRect == cNoFocusRect, "NIL", iif( cFocusRect == "T" .OR. cNoFocusRect == "F", ".T.", ".F." ) )
   ::aPLM[i]           := lPLM
   ::aFixedCols[i]     := lFixedCols
   ::aOnAbortEdit[i]   := cOnAbortEdit
   ::aFixedWidths[i]   := lFixedWidths
   ::aBeforeColMove[i] := cBeforeColMove
   ::aAfterColMove[i]  := cAfterColMove
   ::aBeforeColSize[i] := cBeforeColSize
   ::aAfterColSize[i]  := cAfterColSize
   ::aBeforeAutoFit[i] := cBeforeAutoFit
   ::aEditLikeExcel[i] := lLikeExcel
   ::aUseButtons[i]    := lButtons
   ::aDelete[i]        := lDelete
   ::aDeleteWhen[i]    := cDeleteWhen
   ::aDeleteMsg[i]     := cDeleteMsg
   ::aOnDelete[i]      := cOnDelete
   ::aNoDefMsg[i]      := lNoDefaultMsg
   ::aNoDelMsg[i]      := lNoDeleteMsg
   ::aAppend[i]        := lAppend
   ::aOnAppend[i]      := cOnAppend
   ::aNoModalEdit[i]   := lNoModalEdit
   ::aFixedCtrls[i]    := iif( cDynamicCtrls == cFixedCtrls, "NIL", iif( cFixedCtrls == "T" .OR. cDynamicCtrls == "F", ".T.", ".F." ) )
   ::aOnHeadRClick[i]  := cOnHeadRClick
   ::aNoClickOnChk[i]  := lNoClickOnChk
   ::aNoRClickOnChk[i] := lNoRClickOnChk
   ::aExtDblClick[i]   := lExtDblClick
   ::aSilent[i]        := lSilent
   ::aEnableAltA[i]    := lEnableAltA .AND. ! lDisableAltA
   ::aNoShowAlways[i]  := lNoShow
   ::aNoneUnsels[i]    := lNoneUnsels
   ::aChgBefEdit[i]    := lCBE
   ::aOnRClick[i]      := cOnRClick
   ::aOnBfrInsert[i]   := cOnBeforeIns
   ::aOnInsert[i]      := cOnInsert
   ::aOnEditCellEnd[i] := cOnEditEnd
   ::aEditFirstVis[i]  := lEditFV
   ::aOnBfrEdtCell[i]  := cOnBfrEdtCell
   ::aEditCellValue[i] := cEditCell
   ::aKeysLkClp[i]     := lKeysLkClp
   ::aCellToolTip[i]   := lCellTT
   ::aNoHScroll[i]     := lNoHScroll
   ::aNoVScroll[i]     := lNoVScroll
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pHotKeyBox( i ) CLASS TFormEditor

   LOCAL aBackColor, aFontColor, cCargo, cFontName, cHelpId, cObj, cOnChange, cOnEnter, cOnGotFocus, cOnLostFocus, cParent
   LOCAL cSubClass, cToolTip, cVal, cValue, lBold, lEnabled, lItalic, lNoAlt, lNoTabStop, lRTL, lStrikeout, lUnderline, lVisible
   LOCAL nCol, nFontSize, nHeight, nRow, nWidth, oCtrl, uFontName, uFontSize

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( THotKeyBox():nWidth ) ) ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( THotKeyBox():nHeight ) ) ) )
   cValue              := ::ReadStringData( i, "VALUE", "")
   uFontName           := ::ReadStringData( i, "FONT", "" )
   uFontName           := ::ReadStringData( i, "FONTNAME", uFontName )
   uFontName           := ::ReadOopData( i, "FONTNAME", uFontName )
   cFontName           := ::StrToValueCtrl( uFontName, "C", "" )
   uFontSize           := ::ReadStringData( i, "SIZE", "" )
   uFontSize           := ::ReadStringData( i, "FONTSIZE", uFontSize )
   uFontSize           := ::ReadOopData( i, "FONTSIZE", uFontSize )
   nFontSize           := ::StrToValueCtrl( uFontSize, "N", 0, 1, 9999 )
   lBold               := ( ::ReadLogicalData( i, "BOLD", "F" ) == "T" )
   lBold               := ( ::ReadLogicalData( i, "FONTBOLD", iif( lBold, "T", "F" ) ) == "T" )
   lBold               := ( Upper( ::ReadOopData( i, "FONTBOLD", iif( lBold, ".T.", ".F." ) ) ) == ".T." )
   lItalic             := ( ::ReadLogicalData( i, "ITALIC", "F" ) == "T" )
   lItalic             := ( ::ReadLogicalData( i, "FONTITALIC", iif( lItalic, "T", "F" ) ) == "T" )
   lItalic             := ( Upper( ::ReadOopData( i, "FONTITALIC", iif( lItalic, ".T.", ".F." ) ) ) == ".T." )
   lUnderline          := ( ::ReadLogicalData( i, "UNDERLINE", "F" ) == "T" )
   lUnderline          := ( ::ReadLogicalData( i, "FONTUNDERLINE", iif( lUnderline, "T", "F" ) ) == "T" )
   lUnderline          := ( Upper( ::ReadOopData( i, "FONTUNDERLINE", iif( lUnderline, ".T.", ".F." ) ) ) == ".T." )
   lStrikeout          := ( ::ReadLogicalData( i, "STRIKEOUT", "F" ) == "T" )
   lStrikeout          := ( ::ReadLogicalData( i, "FONTSTRIKEOUT", iif( lStrikeout, "T", "F" ) ) == "T" )
   lStrikeout          := ( Upper( ::ReadOopData( i, "FONTSTRIKEOUT", iif( lStrikeout, ".T.", ".F." ) ) ) == ".T." )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   aFontColor          := ::ReadStringData( i, "FONTCOLOR", "NIL" )
   aFontColor          := UpperNIL( ::ReadOopData( i, "FONTCOLOR", aFontColor ) )
   cOnChange           := ::ReadStringData( i, "ON CHANGE", "" )
   cOnChange           := ::ReadStringData( i, "ONCHANGE", cOnChange )
   cOnGotFocus         := ::ReadStringData( i, "ON GOTFOCUS", "" )
   cOnGotFocus         := ::ReadStringData( i, "ONGOTFOCUS", cOnGotFocus )
   cOnLostFocus        := ::ReadStringData( i, "ON LOSTFOCUS", "" )
   cOnLostFocus        := ::ReadStringData( i, "ONLOSTFOCUS", cOnLostFocus )
   cOnEnter            := ::ReadStringData( i, "ON ENTER", "" )
   cOnEnter            := ::ReadStringData( i, "ONENTER", cOnEnter )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lNoTabStop          := ( ( cVal := ::ReadLogicalData( i, "TABSTOP", "N" ) ) == "F" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "NOTABSTOP", "N" ) == "T" ) )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   cHelpId             := ::ReadStringData( i, "HELPID", "" )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   lNoAlt              := ( ::ReadLogicalData( i, "NOALT", "F" ) == "T" )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_HOTKEYBOX ]
   ::aCObj[i]          := cObj
   ::aValue[i]         := cValue
   ::aFontName[i]      := cFontName
   ::aFontNameFrm[i]   := uFontName
   ::aFontSize[i]      := nFontSize
   ::aFontSizeFrm[i]   := uFontSize
   ::aFontBold[i]      := lBold
   ::aFontItalic[i]    := lItalic
   ::aFontUnderline[i] := lUnderline
   ::aFontStrikeout[i] := lStrikeout
   ::aToolTip[i]       := cToolTip
   ::aBackColor[i]     := aBackColor
   ::aFontColor[i]     := aFontColor
   ::aOnChange[i]      := cOnChange
   ::aOnGotFocus[i]    := cOnGotFocus
   ::aOnLostFocus[i]   := cOnLostFocus
   ::aOnEnter[i]       := cOnEnter
   ::aInvisible[i]     := ! lVisible
   ::aNoTabStop[i]     := lNoTabStop
   ::aRTL[i]           := lRTL
   ::aHelpID[i]        := cHelpId
   ::aSubClass[i]      := cSubClass
   ::aDisabled[i]      := ! lEnabled
   ::aNoAlt[i]         := lNoAlt
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pHyperLink( i ) CLASS TFormEditor

   LOCAL aBackColor, aFontColor, cAddress, cCargo, cFontName, cHelpID, cObj, cParent, cSubClass, cToolTip, cVal, cValue, lAutoSize
   LOCAL lBold, lBorder, lClientEdge, lHandCursor, lHScroll, lItalic, lRTL, lTrans, lVisible, lVScroll, nCol, nFontSize, nHeight
   LOCAL nRow, nWidth, oCtrl, uFontName, uFontSize

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( THyperLink():nWidth ) ) ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( THyperLink():nHeight ) ) ) )
   cValue              := ::ReadStringData( i, "VALUE", "ooHG Home" )
   cAddress            := ::ReadStringData( i, "ADDRESS", "https://oohg.github.io/" )
   lAutoSize           := ( ::ReadLogicalData( i, "AUTOSIZE", "F" ) == "T" )
   uFontName           := ::ReadStringData( i, "FONT", "" )
   uFontName           := ::ReadStringData( i, "FONTNAME", uFontName )
   uFontName           := ::ReadOopData( i, "FONTNAME", uFontName )
   cFontName           := ::StrToValueCtrl( uFontName, "C", "" )
   uFontSize           := ::ReadStringData( i, "SIZE", "" )
   uFontSize           := ::ReadStringData( i, "FONTSIZE", uFontSize )
   uFontSize           := ::ReadOopData( i, "FONTSIZE", uFontSize )
   nFontSize           := ::StrToValueCtrl( uFontSize, "N", 0, 1, 9999 )
   lBold               := ( ::ReadLogicalData( i, "BOLD", "F" ) == "T" )
   lBold               := ( ::ReadLogicalData( i, "FONTBOLD", iif( lBold, "T", "F" ) ) == "T" )
   lBold               := ( Upper( ::ReadOopData( i, "FONTBOLD", iif( lBold, ".T.", ".F." ) ) ) == ".T." )
   lItalic             := ( ::ReadLogicalData( i, "ITALIC", "F" ) == "T" )
   lItalic             := ( ::ReadLogicalData( i, "FONTITALIC", iif( lItalic, "T", "F" ) ) == "T" )
   lItalic             := ( Upper( ::ReadOopData( i, "FONTITALIC", iif( lItalic, ".T.", ".F." ) ) ) == ".T." )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   aFontColor          := ::ReadStringData( i, "FONTCOLOR", "NIL" )
   aFontColor          := UpperNIL( ::ReadOopData( i, "FONTCOLOR", aFontColor ) )
   lBorder             := ( ::ReadLogicalData( i, "BORDER", "F" ) == "T" )
   lClientEdge         := ( ::ReadLogicalData( i, "CLIENTEDGE", "F") == "T" )
   lHScroll            := ( ::ReadLogicalData( i, "HSCROLL", "F" ) == "T" )
   lVScroll            := ( ::ReadLogicalData( i, "VSCROLL", "F" ) == "T" )
   lTrans              := ( ::ReadLogicalData( i, "TRANSPARENT", "F" ) == "T" )
   lHandCursor         := ( ::ReadLogicalData( i, "HANDCURSOR", "F" ) == "T" )
   cHelpID             := ::ReadStringData( i, "HELPID", "" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_HYPERLINK ]
   ::aCObj[i]          := cObj
   ::aValue[i]         := cValue
   ::aAddress[i]       := cAddress
   ::aAutoSize[i]      := lAutoSize
   ::aFontName[i]      := cFontName
   ::aFontNameFrm[i]   := uFontName
   ::aFontSize[i]      := nFontSize
   ::aFontSizeFrm[i]   := uFontSize
   ::aFontBold[i]      := lBold
   ::aFontItalic[i]    := lItalic
   ::aToolTip[i]       := cToolTip
   ::aBackColor[i]     := aBackColor
   ::aFontColor[i]     := aFontColor
   ::aBorder[i]        := lBorder
   ::aClientEdge[i]    := lClientEdge
   ::aHScroll[i]       := lHScroll
   ::aVScroll[i]       := lVScroll
   ::aTransparent[i]   := lTrans
   ::aHandCursor[i]    := lHandCursor
   ::aHelpID[i]        := cHelpId
   ::aInvisible[i]     := ! lVisible
   ::aRTL[i]           := lRTL
   ::aSubClass[i]      := cSubClass
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pImage( i ) CLASS TFormEditor

   LOCAL aBackColor, cAction, cBuffer, cCargo, cExclude, cHBitmap, cHelpId, cObj, cOnChange, cOnDblClick, cOnMClick, cOnMDClick
   LOCAL cOnMouseLeave, cOnMouseMove, cOnRClick, cOnRDClick, cParent, cPicture, cSubClass, cToolTip, cVal, lBorder, lClientEdge
   LOCAL lEnabled, lImageSize, lNo3DColors, lNoChkDepth, lNoDIBSection, lNoLoadTrans, lNoPRedraw, lNoResize, lRTL, lStretch, lTrans
   LOCAL lVisible, lWhiteBack, nCol, nHeight, nRow, nWidth, oCtrl

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( TImage():nWidth ) ) ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( TImage():nHeight ) ) ) )
   cAction             := ::ReadStringData( i, "ACTION", "" )
   cAction             := ::ReadStringData( i, "ON CLICK",cAction )
   cAction             := ::ReadStringData( i, "ONCLICK", cAction )
   lStretch            := ( ::ReadLogicalData( i, "STRETCH", "F") == "T" )
   cHelpId             := ::ReadStringData( i, "HELPID", "" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   lWhiteBack          := ( ::ReadLogicalData( i, "WHITEBACKGROUND", "F" ) == "T" )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   cPicture            := ::ReadStringData(i, "PICTURE", "" )
   cBuffer             := ::ReadStringData( i, "BUFFER", "" )
   cHBitmap            := ::ReadStringData( i, "HBITMAP", "" )
   lNoResize           := ( ::ReadLogicalData( i, "NORESIZE", "F" ) == "T" )
   lImageSize          := ( ::ReadLogicalData( i, "IMAGESIZE", "F" ) == "T" )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   lBorder             := ( ::ReadLogicalData( i, "BORDER", "F" ) == "T" )
   lClientEdge         := ( ::ReadLogicalData( i, "CLIENTEDGE", "F") == "T" )
   lNoLoadTrans        := ( ::ReadLogicalData( i, "NOLOADTRANSPARENT", "F" ) == "T" )
   lNo3DColors         := ( ::ReadLogicalData( i, "NO3DCOLORS", "F" ) == "T" )
   lNoDIBSection       := ( ::ReadLogicalData( i, "NODIBSECTION", "F" ) == "T" )
   lTrans              := ( ::ReadLogicalData( i, "TRANSPARENT", "F" ) == "T" )
   cExclude            := ::ReadStringData( i, "EXCLUDEAREA", "" )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   cOnChange           := ::ReadStringData( i, "ON CHANGE", "" )
   cOnChange           := ::ReadStringData( i, "ONCHANGE", cOnChange )
   cOnRClick           := ::ReadStringData( i, "ON RCLICK", "" )
   cOnRClick           := ::ReadStringData( i, "ONRCLICK", cOnRClick )
   cOnMClick           := ::ReadStringData( i, "ON MCLICK", "" )
   cOnMClick           := ::ReadStringData( i, "ONMCLICK", cOnMClick )
   cOnDblClick         := ::ReadStringData( i, "ON DBLCLICK", "" )
   cOnDblClick         := ::ReadStringData( i, "ONDBLCLICK", cOnDblClick )
   cOnRDClick          := ::ReadStringData( i, "ON RDBLCLICK", "" )
   cOnRDClick          := ::ReadStringData( i, "ONRDBLCLICK", cOnRDClick )
   cOnMDClick          := ::ReadStringData( i, "ON MDBLCLICK", "" )
   cOnMDClick          := ::ReadStringData( i, "ONMDBLCLICK", cOnMDClick )
   cOnMouseMove        := ::ReadStringData( i, "ON MOUSEMOVE", "" )
   cOnMouseMove        := ::ReadStringData( i, "ONMOUSEMOVE", cOnMouseMove )
   cOnMouseMove        := ::ReadStringData( i, "ON MOUSEHOVER", cOnMouseMove )
   cOnMouseMove        := ::ReadStringData( i, "ONMOUSEHOVER", cOnMouseMove )
   cOnMouseLeave       := ::ReadStringData( i, "ON MOUSELEAVE", "" )
   cOnMouseLeave       := ::ReadStringData( i, "ONMOUSELEAVE", cOnMouseLeave )
   lNoChkDepth         := ( ::ReadLogicalData( i, "NOCHECKDEPTH", "F") == "T" )
   lNoPRedraw          := ( ::ReadLogicalData( i, "NOPARENTREDRAW", "F") == "T" )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_IMAGE ]
   ::aCObj[i]          := cObj
   ::aAction[i]        := cAction
   ::aStretch[i]       := lStretch
   ::aHelpID[i]        := cHelpid
   ::aInvisible[i]     := ! lVisible
   ::aRTL[i]           := lRTL
   ::aSubClass[i]      := cSubClass
   ::aWhiteBack[i]     := lWhiteBack
   ::aBackColor[i]     := aBackColor
   ::aPicture[i]       := cPicture
   ::aBuffer[i]        := cBuffer
   ::aHBitmap[i]       := cHBitmap
   ::aNoResize[i]      := lNoResize
   ::aImageSize[i]     := lImageSize
   ::aToolTip[i]       := cToolTip
   ::aBorder[i]        := lBorder
   ::aClientEdge[i]    := lClientEdge
   ::aNoLoadTrans[i]   := lNoLoadTrans
   ::aNo3DColors[i]    := lNo3DColors
   ::aNoDIBSection[i]  := lNoDIBSection
   ::aTransparent[i]   := lTrans
   ::aExclude[i]       := cExclude
   ::aDisabled[i]      := ! lEnabled
   ::aOnChange[i]      := cOnChange
   ::aOnRClick[i]      := cOnRClick
   ::aOnMClick[i]      := cOnMClick
   ::aOnDblClick[i]    := cOnDblClick
   ::aOnRDClick[i]     := cOnRDClick
   ::aOnMDClick[i]     := cOnMDClick
   ::aOnMouseMove[i]   := cOnMouseMove
   ::aOnMouseLeave[i]  := cOnMouseLeave
   ::aNoChkDepth[i]    := lNoChkDepth
   ::aNoPRedraw[i]     := lNoPRedraw
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pIPAddress( i ) CLASS TFormEditor

   LOCAL aBackColor, aFontColor, cCargo, cFontName, cHelpId, cObj, cOnChange, cOngotfocus, cOnLostfocus, cParent, cSubClass
   LOCAL cToolTip, cVal, cValue, lBold, lEnabled, lItalic, lNoTabStop, lRTL, lStrikeout, lUnderline, lVisible, nCol, nFontSize
   LOCAL nHeight, nRow, nWidth, oCtrl, uFontName, uFontSize

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( TIpAddress():nHeight ) ) ) )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( TIpAddress():nWidth ) ) ) )
   cValue              := ::ReadStringData( i, "VALUE", "" )
   uFontName           := ::ReadStringData( i, "FONT", "" )
   uFontName           := ::ReadStringData( i, "FONTNAME", uFontName )
   uFontName           := ::ReadOopData( i, "FONTNAME", uFontName )
   cFontName           := ::StrToValueCtrl( uFontName, "C", "" )
   uFontSize           := ::ReadStringData( i, "SIZE", "" )
   uFontSize           := ::ReadStringData( i, "FONTSIZE", uFontSize )
   uFontSize           := ::ReadOopData( i, "FONTSIZE", uFontSize )
   nFontSize           := ::StrToValueCtrl( uFontSize, "N", 0, 1, 9999 )
   lBold               := ( ::ReadLogicalData( i, "BOLD", "F" ) == "T" )
   lBold               := ( ::ReadLogicalData( i, "FONTBOLD", iif( lBold, "T", "F" ) ) == "T" )
   lBold               := ( Upper( ::ReadOopData( i, "FONTBOLD", iif( lBold, ".T.", ".F." ) ) ) == ".T." )
   lItalic             := ( ::ReadLogicalData( i, "ITALIC", "F" ) == "T" )
   lItalic             := ( ::ReadLogicalData( i, "FONTITALIC", iif( lItalic, "T", "F" ) ) == "T" )
   lItalic             := ( Upper( ::ReadOopData( i, "FONTITALIC", iif( lItalic, ".T.", ".F." ) ) ) == ".T." )
   lUnderline          := ( ::ReadLogicalData( i, "UNDERLINE", "F" ) == "T" )
   lUnderline          := ( ::ReadLogicalData( i, "FONTUNDERLINE", iif( lUnderline, "T", "F" ) ) == "T" )
   lUnderline          := ( Upper( ::ReadOopData( i, "FONTUNDERLINE", iif( lUnderline, ".T.", ".F." ) ) ) == ".T." )
   lStrikeout          := ( ::ReadLogicalData( i, "STRIKEOUT", "F" ) == "T" )
   lStrikeout          := ( ::ReadLogicalData( i, "FONTSTRIKEOUT", iif( lStrikeout, "T", "F" ) ) == "T" )
   lStrikeout          := ( Upper( ::ReadOopData( i, "FONTSTRIKEOUT", iif( lStrikeout, ".T.", ".F." ) ) ) == ".T." )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   cOnChange           := ::ReadStringData( i, "ON CHANGE", "" )
   cOnChange           := ::ReadStringData( i, "ONCHANGE", cOnChange )
   cOnGotfocus         := ::ReadStringData( i, "ON GOTFOCUS", "" )
   cOnGotfocus         := ::ReadStringData( i, "ONGOTFOCUS", cOnGotfocus )
   cOnLostfocus        := ::ReadStringData( i, "ON LOSTFOCUS", "" )
   cOnLostfocus        := ::ReadStringData( i, "ONLOSTFOCUS", cOnLostfocus )
   cHelpId             := ::ReadStringData( i, "HELPID", "" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lNoTabStop          := ( ( cVal := ::ReadLogicalData( i, "TABSTOP", "N" ) ) == "F" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "NOTABSTOP", "N" ) == "T" ) )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   aFontColor          := ::ReadStringData( i, "FONTCOLOR", "NIL" )
   aFontColor          := UpperNIL( ::ReadOopData( i, "FONTCOLOR", aFontColor ) )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_IPADDRESS ]
   ::aCObj[i]          := cObj
   ::aValue[i]         := cValue
   ::aFontName[i]      := cFontName
   ::aFontNameFrm[i]   := uFontName
   ::aFontSize[i]      := nFontSize
   ::aFontSizeFrm[i]   := uFontSize
   ::aFontBold[i]      := lBold
   ::aFontItalic[i]    := lItalic
   ::aFontUnderline[i] := lUnderline
   ::aFontStrikeout[i] := lStrikeout
   ::aToolTip[i]       := cToolTip
   ::aOnChange[i]      := cOnChange
   ::aOnGotFocus[i]    := cOnGotFocus
   ::aOnLostFocus[i]   := cOnLostFocus
   ::aHelpID[i]        := cHelpId
   ::aInvisible[i]     := ! lVisible
   ::aNoTabStop[i]     := lNoTabStop
   ::aDisabled[i]      := ! lEnabled
   ::aRTL[i]           := lRTL
   ::aSubClass[i]      := cSubClass
   ::aFontColor[i]     := aFontColor
   ::aBackColor[i]     := aBackColor
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pLabel( i ) CLASS TFormEditor

   LOCAL aBackColor, aFontColor, cAction, cCargo, cCursor, cFontName, cHelpId, cInputMask, cObj, cOnDblClick, cOnMouseLeave
   LOCAL cOnMouseMove, cParent, cSubClass, cToolTip, cVal, cValue, lAutoHeight, lAutoSize, lAutoWidth, lBold, lBorder, lCenterAlign
   LOCAL lClientEdge, lEnabled, lHScroll, lItalic, lNoPrefix, lNoWrap, lRightAlign, lRTL, lStrikeout, lTrans, lUnderline, lVCenter
   LOCAL lVisible, lVScroll, nCol, nFontSize, nHeight, nRow, nWidth, oCtrl, uFontName, uFontSize

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( TLabel():nWidth ) ) ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( TLabel():nHeight ) ) ) )
   cValue              := ::ReadStringData( i, "VALUE", "" )
   cAction             := ::ReadStringData( i, "ACTION", "" )
   cAction             := ::ReadStringData( i, "ON CLICK",cAction )
   cAction             := ::ReadStringData( i, "ONCLICK", cAction )
   lAutoHeight         := ( ::ReadLogicalData( i, "AUTOHEIGHT", "F" ) == "T" )
   lAutoSize           := ( ::ReadLogicalData( i, "AUTOSIZE", "F" ) == "T" )
   lAutoWidth          := ( ::ReadLogicalData( i, "AUTOWIDTH", "F" ) == "T" )
   uFontName           := ::ReadStringData( i, "FONT", "" )
   uFontName           := ::ReadStringData( i, "FONTNAME", uFontName )
   uFontName           := ::ReadOopData( i, "FONTNAME", uFontName )
   cFontName           := ::StrToValueCtrl( uFontName, "C", "" )
   uFontSize           := ::ReadStringData( i, "SIZE", "" )
   uFontSize           := ::ReadStringData( i, "FONTSIZE", uFontSize )
   uFontSize           := ::ReadOopData( i, "FONTSIZE", uFontSize )
   nFontSize           := ::StrToValueCtrl( uFontSize, "N", 0, 1, 9999 )
   lBold               := ( ::ReadLogicalData( i, "BOLD", "F" ) == "T" )
   lBold               := ( ::ReadLogicalData( i, "FONTBOLD", iif( lBold, "T", "F" ) ) == "T" )
   lBold               := ( Upper( ::ReadOopData( i, "FONTBOLD", iif( lBold, ".T.", ".F." ) ) ) == ".T." )
   lItalic             := ( ::ReadLogicalData( i, "ITALIC", "F" ) == "T" )
   lItalic             := ( ::ReadLogicalData( i, "FONTITALIC", iif( lItalic, "T", "F" ) ) == "T" )
   lItalic             := ( Upper( ::ReadOopData( i, "FONTITALIC", iif( lItalic, ".T.", ".F." ) ) ) == ".T." )
   lUnderline          := ( ::ReadLogicalData( i, "UNDERLINE", "F" ) == "T" )
   lUnderline          := ( ::ReadLogicalData( i, "FONTUNDERLINE", iif( lUnderline, "T", "F" ) ) == "T" )
   lUnderline          := ( Upper( ::ReadOopData( i, "FONTUNDERLINE", iif( lUnderline, ".T.", ".F." ) ) ) == ".T." )
   lStrikeout          := ( ::ReadLogicalData( i, "STRIKEOUT", "F" ) == "T" )
   lStrikeout          := ( ::ReadLogicalData( i, "FONTSTRIKEOUT", iif( lStrikeout, "T", "F" ) ) == "T" )
   lStrikeout          := ( Upper( ::ReadOopData( i, "FONTSTRIKEOUT", iif( lStrikeout, ".T.", ".F." ) ) ) == ".T." )
   cCursor             := ::ReadStringData( i, "CURSOR", "" )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   aFontColor          := ::ReadStringData( i, "FONTCOLOR", "NIL" )
   aFontColor          := UpperNIL( ::ReadOopData( i, "FONTCOLOR", aFontColor ) )
   lBorder             := ( ::ReadLogicalData( i, "BORDER", "F" ) == "T" )
   lClientEdge         := ( ::ReadLogicalData( i, "CLIENTEDGE", "F") == "T" )
   lHScroll            := ( ::ReadLogicalData( i, "HSCROLL", "F" ) == "T" )
   lVScroll            := ( ::ReadLogicalData( i, "VSCROLL", "F" ) == "T" )
   lTrans              := ( ::ReadLogicalData( i, "TRANSPARENT", "F" ) == "T" )
   lRightAlign         := ( ::ReadLogicalData( i, "RIGHTALIGN", "F" ) == "T" )
   lCenterAlign        := ( ::ReadLogicalData( i, "CENTERALIGN", "F" ) == "T" )
   cHelpId             := ::ReadStringData( i, "HELPID", "" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   lNoWrap             := ( ::ReadLogicalData( i, "NOWORDWRAP", "F" ) == "T" )
   lNoPrefix           := ( ::ReadLogicalData( i, "NOPREFIX", "F" ) == "T" )
   cInputMask          := ::ReadStringData( i, "INPUTMASK", "" )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   lVCenter            := ( ::ReadLogicalData( i, "VCENTERALIGN", "F" ) == "T" )
   cOnDblClick         := ::ReadStringData( i, "ON DBLCLICK", "" )
   cOnDblClick         := ::ReadStringData( i, "ONDBLCLICK", cOnDblClick )
   cOnMouseLeave       := ::ReadStringData( i, "ON MOUSELEAVE", "" )
   cOnMouseLeave       := ::ReadStringData( i, "ONMOUSELEAVE", cOnMouseLeave )
   cOnMouseMove        := ::ReadStringData( i, "ON MOUSEMOVE", "" )
   cOnMouseMove        := ::ReadStringData( i, "ONMOUSEMOVE", cOnMouseMove )
   cOnMouseMove        := ::ReadStringData( i, "ON MOUSEHOVER", cOnMouseMove )
   cOnMouseMove        := ::ReadStringData( i, "ONMOUSEHOVER", cOnMouseMove )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_LABEL ]
   ::aCObj[i]          := cObj
   ::aValue[i]         := cValue
   ::aAction[i]        := cAction
   ::aAutoHeight[i]    := lAutoHeight
   ::aAutoSize[i]      := lAutoSize
   ::aAutoWidth[i]     := lAutoWidth
   ::aFontName[i]      := cFontName
   ::aFontNameFrm[i]   := uFontName
   ::aFontSize[i]      := nFontSize
   ::aFontSizeFrm[i]   := uFontSize
   ::aFontBold[i]      := lBold
   ::aFontItalic[i]    := lItalic
   ::aFontUnderline[i] := lUnderline
   ::aFontStrikeout[i] := lStrikeout
   ::aToolTip[i]       := cToolTip
   ::aBackColor[i]     := aBackColor
   ::aFontColor[i]     := aFontColor
   ::aBorder[i]        := lBorder
   ::aClientEdge[i]    := lClientEdge
   ::aHScroll[i]       := lHScroll
   ::aVScroll[i]       := lVScroll
   ::aTransparent[i]   := lTrans
   ::aRightAlign[i]    := lRightAlign
   ::aCenterAlign[i]   := lCenterAlign
   ::aHelpID[i]        := cHelpid
   ::aInvisible[i]     := ! lVisible
   ::aRTL[i]           := lRTL
   ::aNoWrap[i]        := lNoWrap
   ::aNoPrefix[i]      := lNoPrefix
   ::aInputMask[i]     := cInputMask
   ::aSubClass[i]      := cSubClass
   ::aDisabled[i]      := ! lEnabled
   ::aVCenter[i]       := lVCenter
   ::aOnDblClick[i]    := cOnDblClick
   ::aOnMouseLeave[i]  := cOnMouseLeave
   ::aOnMouseMove[i]   := cOnMouseMove
   ::aCursor[i]        := cCursor
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pListBox( i ) CLASS TFormEditor

   LOCAL aBackColor, aFontColor, cCargo, cColWidth, cFontName, cHelpId, cImage, cItems, cObj, cOnChange, cOnDblClick, cOnEnter
   LOCAL cOnGotFocus, cOnLostFocus, cParent, cSubClass, cTabs, cTextHeight, cToolTip, cVal, cValue, lBold, lBreak, lDragItems
   LOCAL lEnabled, lFit, lItalic, lMultiColumn, lMultiSelect, lMultiTab, lNoTabStop, lNoVScroll, lRTL, lSort, lStrikeout, lUnderline
   LOCAL lVisible, nCol, nFontSize, nHeight, nRow, nWidth, oCtrl, uFontName, uFontSize

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( TList():nWidth ) ) ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( TList():nHeight ) ) ) )
   cItems              := ::ReadStringData( i, "ITEMS", "" )
   cValue              := ::ReadStringData( i, "VALUE", "" )
   uFontName           := ::ReadStringData( i, "FONT", "" )
   uFontName           := ::ReadStringData( i, "FONTNAME", uFontName )
   uFontName           := ::ReadOopData( i, "FONTNAME", uFontName )
   cFontName           := ::StrToValueCtrl( uFontName, "C", "" )
   uFontSize           := ::ReadStringData( i, "SIZE", "" )
   uFontSize           := ::ReadStringData( i, "FONTSIZE", uFontSize )
   uFontSize           := ::ReadOopData( i, "FONTSIZE", uFontSize )
   nFontSize           := ::StrToValueCtrl( uFontSize, "N", 0, 1, 9999 )
   lBold               := ( ::ReadLogicalData( i, "BOLD", "F" ) == "T" )
   lBold               := ( ::ReadLogicalData( i, "FONTBOLD", iif( lBold, "T", "F" ) ) == "T" )
   lBold               := ( Upper( ::ReadOopData( i, "FONTBOLD", iif( lBold, ".T.", ".F." ) ) ) == ".T." )
   lItalic             := ( ::ReadLogicalData( i, "ITALIC", "F" ) == "T" )
   lItalic             := ( ::ReadLogicalData( i, "FONTITALIC", iif( lItalic, "T", "F" ) ) == "T" )
   lItalic             := ( Upper( ::ReadOopData( i, "FONTITALIC", iif( lItalic, ".T.", ".F." ) ) ) == ".T." )
   lUnderline          := ( ::ReadLogicalData( i, "UNDERLINE", "F" ) == "T" )
   lUnderline          := ( ::ReadLogicalData( i, "FONTUNDERLINE", iif( lUnderline, "T", "F" ) ) == "T" )
   lUnderline          := ( Upper( ::ReadOopData( i, "FONTUNDERLINE", iif( lUnderline, ".T.", ".F." ) ) ) == ".T." )
   lStrikeout          := ( ::ReadLogicalData( i, "STRIKEOUT", "F" ) == "T" )
   lStrikeout          := ( ::ReadLogicalData( i, "FONTSTRIKEOUT", iif( lStrikeout, "T", "F" ) ) == "T" )
   lStrikeout          := ( Upper( ::ReadOopData( i, "FONTSTRIKEOUT", iif( lStrikeout, ".T.", ".F." ) ) ) == ".T." )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   aFontColor          := ::ReadStringData( i, "FONTCOLOR", "NIL" )
   aFontColor          := UpperNIL( ::ReadOopData( i, "FONTCOLOR", aFontColor ) )
   cOnGotFocus         := ::ReadStringData( i, "ON GOTFOCUS", "" )
   cOnGotFocus         := ::ReadStringData( i, "ONGOTFOCUS", cOnGotFocus )
   cOnChange           := ::ReadStringData( i, "ON CHANGE", "" )
   cOnChange           := ::ReadStringData( i, "ONCHANGE", cOnChange )
   cOnLostFocus        := ::ReadStringData( i, "ON LOSTFOCUS", "" )
   cOnLostFocus        := ::ReadStringData( i, "ONLOSTFOCUS", cOnLostFocus )
   cOnDblClick         := ::ReadStringData( i, "ON DBLCLICK", "" )
   cOnDblClick         := ::ReadStringData( i, "ONDBLCLICK", cOnDblClick )
   cOnEnter            := ::ReadStringData( i, "ON ENTER", "" )
   cOnEnter            := ::ReadStringData( i, "ONENTER", cOnEnter )
   lMultiSelect        := ( ::ReadLogicalData( i, "MULTISELECT", "F" ) == "T" )
   cHelpId             := ::ReadStringData( i, "HELPID", "" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lNoTabStop          := ( ( cVal := ::ReadLogicalData( i, "TABSTOP", "N" ) ) == "F" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "NOTABSTOP", "N" ) == "T" ) )
   lSort               := ( ::ReadLogicalData( i, "SORT", "F" ) == "T" )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   cImage              := ::ReadStringData( i, "IMAGE", "" )
   lFit                := ( ::ReadLogicalData( i, "FIT", "F" ) == "T" )
   cTextHeight         := ::ReadStringData( i, "TEXTHEIGHT", "" )
   lNoVScroll          := ( ::ReadLogicalData( i, "NOVSCROLL", "F" ) == "T" )
   lMultiColumn        := ( ::ReadLogicalData( i, "MULTICOLUMN", "F" ) == "T" )
   cColWidth           := ::ReadStringData( i, "COLUMNWIDTH", "" )
   lMultiTab           := ( ::ReadLogicalData( i, "MULTITAB", "F" ) == "T" )
   cTabs               := ::ReadStringData( i, "TABSWIDTH", "" )
   lDragItems          := ( ::ReadLogicalData( i, "DRAGITEMS", "F" ) == "T" )
   lBreak              := ( ::ReadLogicalData( i, "BREAK", "F" ) == "T" )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_LISTBOX ]
   ::aCObj[i]          := cObj
   ::aItems[i]         := cItems
   ::aValue[i]         := cValue
   ::aFontName[i]      := cFontName
   ::aFontNameFrm[i]   := uFontName
   ::aFontSize[i]      := nFontSize
   ::aFontSizeFrm[i]   := uFontSize
   ::aFontBold[i]      := lBold
   ::aFontItalic[i]    := lItalic
   ::aFontUnderline[i] := lUnderline
   ::aFontStrikeout[i] := lStrikeout
   ::aToolTip[i]       := cToolTip
   ::aBackColor[i]     := aBackColor
   ::aFontColor[i]     := aFontColor
   ::aOnGotFocus[i]    := cOnGotFocus
   ::aOnChange[i]      := cOnChange
   ::aOnLostFocus[i]   := cOnLostFocus
   ::aOnDblClick[i]    := cOnDblClick
   ::aOnEnter[i]       := cOnEnter
   ::aMultiSelect[i]   := lMultiSelect
   ::aHelpID[i]        := cHelpid
   ::aInvisible[i]     := ! lVisible
   ::aNoTabStop[i]     := lNoTabStop
   ::aSort[i]          := lSort
   ::aRTL[i]           := lRTL
   ::aDisabled[i]      := ! lEnabled
   ::aSubClass[i]      := cSubClass
   ::aImage[i]         := cImage
   ::aFit[i]           := lFit
   ::aTextHeight[i]    := cTextHeight
   ::aNoVScroll[i]     := lNoVScroll
   ::aMultiCol[i]      := lMultiColumn
   ::aColWidth[i]      := cColWidth
   ::aMultiTab[i]      := lMultiTab
   ::aTabsWidth[i]     := cTabs
   ::aDragItems[i]     := lDragItems
   ::aBreak[i]         := lBreak
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pMonthcalendar( i ) CLASS TFormEditor

   LOCAL aBackColor, aBckgrndClr, aFontColor, aTitleBckClr, aTitleFntClr, aTrlngFntClr, cCargo, cFontName, cHelpID, cObj, cOnChange
   LOCAL cOnGotFocus, cOnLostFocus, cOnViewChange, cParent, cSubClass, cToolTip, cVal, cValue, lBold, lEnabled, lItalic
   LOCAL lMultiSelect, lNoTabStop, lNoToday, lNoTodayCircle, lRTL, lStrikeout, lUnderline, lVisible, lWeekNumbers, nCol, nFontSize
   LOCAL nRow, oCtrl, uFontName, uFontSize

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   cValue              := ::ReadStringData( i, "VALUE", "" )
   uFontName           := ::ReadStringData( i, "FONT", "" )
   uFontName           := ::ReadStringData( i, "FONTNAME", uFontName )
   uFontName           := ::ReadOopData( i, "FONTNAME", uFontName )
   cFontName           := ::StrToValueCtrl( uFontName, "C", "" )
   uFontSize           := ::ReadStringData( i, "SIZE", "" )
   uFontSize           := ::ReadStringData( i, "FONTSIZE", uFontSize )
   uFontSize           := ::ReadOopData( i, "FONTSIZE", uFontSize )
   nFontSize           := ::StrToValueCtrl( uFontSize, "N", 0, 1, 9999 )
   lBold               := ( ::ReadLogicalData( i, "BOLD", "F" ) == "T" )
   lBold               := ( ::ReadLogicalData( i, "FONTBOLD", iif( lBold, "T", "F" ) ) == "T" )
   lBold               := ( Upper( ::ReadOopData( i, "FONTBOLD", iif( lBold, ".T.", ".F." ) ) ) == ".T." )
   lItalic             := ( ::ReadLogicalData( i, "ITALIC", "F" ) == "T" )
   lItalic             := ( ::ReadLogicalData( i, "FONTITALIC", iif( lItalic, "T", "F" ) ) == "T" )
   lItalic             := ( Upper( ::ReadOopData( i, "FONTITALIC", iif( lItalic, ".T.", ".F." ) ) ) == ".T." )
   lUnderline          := ( ::ReadLogicalData( i, "UNDERLINE", "F" ) == "T" )
   lUnderline          := ( ::ReadLogicalData( i, "FONTUNDERLINE", iif( lUnderline, "T", "F" ) ) == "T" )
   lUnderline          := ( Upper( ::ReadOopData( i, "FONTUNDERLINE", iif( lUnderline, ".T.", ".F." ) ) ) == ".T." )
   lStrikeout          := ( ::ReadLogicalData( i, "STRIKEOUT", "F" ) == "T" )
   lStrikeout          := ( ::ReadLogicalData( i, "FONTSTRIKEOUT", iif( lStrikeout, "T", "F" ) ) == "T" )
   lStrikeout          := ( Upper( ::ReadOopData( i, "FONTSTRIKEOUT", iif( lStrikeout, ".T.", ".F." ) ) ) == ".T." )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   lNoToday            := ( ::ReadLogicalData( i, "NOTODAY", "F" ) == "T" )
   lNoTodayCircle      := ( ::ReadLogicalData( i, "NOTODAYCIRCLE", "F" ) == "T" )
   lWeekNumbers        := ( ::ReadLogicalData( i, "WEEKNUMBERS", "F" ) == "T" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lNoTabStop          := ( ( cVal := ::ReadLogicalData( i, "TABSTOP", "N" ) ) == "F" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "NOTABSTOP", "N" ) == "T" ) )
   cOnChange           := ::ReadStringData( i, "ON CHANGE", "" )
   cOnChange           := ::ReadStringData( i, "ONCHANGE", cOnChange )
   cHelpID             := ::ReadStringData( i, "HELPID", "" )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   aFontColor          := ::ReadStringData( i, "FONTCOLOR", "NIL" )
   aFontColor          := UpperNIL( ::ReadOopData( i, "FONTCOLOR", aFontColor ) )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   aTitleFntClr        := ::ReadStringData( i, "TITLEFONTCOLOR", "NIL" )
   aTitleBckClr        := ::ReadStringData( i, "TITLEBACKCOLOR", "NIL" )
   aTrlngFntClr        := ::ReadStringData( i, "TRAILINGFONTCOLOR", "NIL" )
   aBckgrndClr         := ::ReadStringData( i, "BACKGROUNDCOLOR", "NIL" )
   aBckgrndClr         := ::ReadStringData( i, "BKGNDCOLOR", aBckgrndClr )
   lMultiSelect        := ( ::ReadLogicalData( i, "MULTISELECT", "F" ) == "T" )
   cOnViewChange       := ::ReadStringData( i, "ON VIEWCHANGE", "" )
   cOnViewChange       := ::ReadStringData( i, "ONVIEWCHANGE", cOnViewChange )
   cOnGotFocus         := ::ReadStringData( i, "ON GOTFOCUS", "" )
   cOnGotFocus         := ::ReadStringData( i, "ONGOTFOCUS", cOnGotFocus )
   cOnLostFocus        := ::ReadStringData( i, "ON LOSTFOCUS", "" )
   cOnLostFocus        := ::ReadStringData( i, "ONLOSTFOCUS", cOnLostFocus )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_MONTHCALENDAR ]
   ::aCObj[i]          := cObj
   ::aValue[i]         := cValue
   ::aFontName[i]      := cFontName
   ::aFontNameFrm[i]   := uFontName
   ::aFontSize[i]      := nFontSize
   ::aFontSizeFrm[i]   := uFontSize
   ::aFontBold[i]      := lBold
   ::aFontItalic[i]    := lItalic
   ::aFontUnderline[i] := lUnderline
   ::aFontStrikeout[i] := lStrikeout
   ::aToolTip[i]       := cToolTip
   ::aNoToday[i]       := lNoToday
   ::aNoTodayCircle[i] := lNoTodayCircle
   ::aWeekNumbers[i]   := lWeekNumbers
   ::aInvisible[i]     := ! lVisible
   ::aNoTabStop[i]     := lNoTabStop
   ::aOnChange[i]      := cOnChange
   ::aHelpID[i]        := cHelpId
   ::aRTL[i]           := lRTL
   ::aSubClass[i]      := cSubClass
   ::aDisabled[i]      := ! lEnabled
   ::aFontColor[i]     := aFontColor
   ::aBackColor[i]     := aBackColor
   ::aTitleFontClr[i]  := aTitleFntClr
   ::aTitleBackClr[i]  := aTitleBckClr
   ::aTrailFontClr[i]  := aTrlngFntClr
   ::aBackgroundClr[i] := aBckgrndClr
   ::aMultiSelect[i]   := lMultiSelect
   ::aOnViewChange[i]  := cOnViewChange
   ::aOnGotFocus[i]    := cOnGotFocus
   ::aOnLostFocus[i]   := cOnLostFocus
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, 0, 0, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pPicButt( i ) CLASS TFormEditor

   LOCAL aBackColor, cAction, cAlign, cBuffer, cCargo, cFocusRect, cHBitmap, cHelpId, cImgMargin, cNoFocusRect, cObj, cOnGotFocus
   LOCAL cOnLostFocus, cOnMouseMove, cOOHGDraw, cParent, cPicture, cSubClass, cToolTip, cVal, cWinDraw, lBottom, lCancel, lCenter
   LOCAL lDefault, lDIBSection, lEnabled, lFitImg, lFlat, lForceScale, lHand, lImgSize, lLeft, lNo3DColors, lNoDestroy, lNoHotLight
   LOCAL lNoImgList, lNoLoadTrans, lNoTabStop, lRight, lSolid, lStretch, lTop, lTransp, lVisible, nCol, nHeight, nRow, nWidth, oCtrl

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( TButton():nWidth ) ) ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( TButton():nHeight ) ) ) )
   cAction             := ::ReadStringData( i, "ACTION", "MsgInfo( 'Picbutton Pressed!' )" )
   cAction             := ::ReadStringData( i, "ON CLICK",cAction )
   cAction             := ::ReadStringData( i, "ONCLICK", cAction )
   lFlat               := ( ::ReadLogicalData( i, "FLAT", "F" ) == "T" )
   cOnGotFocus         := ::ReadStringData( i, "ON GOTFOCUS", "" )
   cOnGotFocus         := ::ReadStringData( i, "ONGOTFOCUS", cOnGotFocus )
   cOnLostFocus        := ::ReadStringData( i, "ON LOSTFOCUS", "" )
   cOnLostFocus        := ::ReadStringData( i, "ONLOSTFOCUS", cOnLostFocus )
   cOnMouseMove        := ::ReadStringData( i, "ON MOUSEMOVE", "" )
   cOnMouseMove        := ::ReadStringData( i, "ONMOUSEMOVE", cOnMouseMove )
   cOnMouseMove        := ::ReadStringData( i, "ON MOUSEHOVER", cOnMouseMove )
   cOnMouseMove        := ::ReadStringData( i, "ONMOUSEHOVER", cOnMouseMove )
   lNoTabStop          := ( ( cVal := ::ReadLogicalData( i, "TABSTOP", "N" ) ) == "F" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "NOTABSTOP", "N" ) == "T" ) )
   cHelpId             := ::ReadStringData( i, "HELPID", "" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   cPicture            := ::ReadStringData( i, "PICTURE", "" )
   cPicture            := ::ReadStringData( i, "ICON", cPicture )
   cBuffer             := ::ReadStringData( i, "BUFFER", "" )
   cHBitmap            := ::ReadStringData( i, "HBITMAP", "" )
   lNoLoadTrans        := ( ::ReadLogicalData( i, "NOLOADTRANSPARENT", "F" ) == "T" )
   lStretch            := ( ::ReadLogicalData( i, "STRETCH", "F" ) == "T" )
   lCancel             := ( ::ReadLogicalData( i, "CANCEL", "F" ) == "T" )
   cAlign              := ::ReadStringData( i, "PICTALIGNMENT", "" )
   cAlign              := ::ReadStringData( i, "IMAGEALIGN", cAlign )
   lTop                := ( cAlign == "TOP" )
   lTop                := lTop .OR. ( ::ReadLogicalData( i, "TOP", "F" ) == "T" )
   lBottom             := ( cAlign == "BOTTOM" )
   lBottom             := lBottom .OR. ( ::ReadLogicalData( i, "BOTTOM", "F" ) == "T" )
   lLeft               := ( cAlign == "LEFT" )
   lLeft               := lLeft .OR. ( ::ReadLogicalData( i, "LEFT", "F" ) == "T" )
   lRight              := ( cAlign == "RIGHT" )
   lRight              := lRight .OR. ( ::ReadLogicalData( i, "RIGHT", "F" ) == "T" )
   lCenter             := ( cAlign == "CENTER" )
   lCenter             := lCenter .OR. ( ::ReadLogicalData( i, "CENTER", "F" ) == "T" )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   cOOHGDraw           := ::ReadLogicalData( i, "THEMED", "N" )
   cOOHGDraw           := ::ReadLogicalData( i, "OOHGDRAW", cOOHGDraw )
   cWinDraw            := ::ReadLogicalData( i, "NOTHEME", "N" )
   cWinDraw            := ::ReadLogicalData( i, "WINDRAW", cWinDraw )
   cImgMargin          := ::ReadStringData( i, "IMAGEMARGIN", "" )
   lFitImg             := ( ::ReadLogicalData( i, "FITIMG", "F" ) == "T" )
   lNo3DColors         := ( ::ReadLogicalData( i, "NO3DCOLORS", "F" ) == "T" )
   lForceScale         := ::ReadLogicalData( i, "FORCESCALE", "F" )
   lForceScale         := ::ReadLogicalData( i, "AUTOFIT", lForceScale )
   lForceScale         := ( ::ReadLogicalData( i, "ADJUST", lForceScale ) == "T" )
   lDIBSection         := ( ::ReadLogicalData( i, "DIBSECTION", "F" ) == "T" )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   lSolid              := ( ::ReadLogicalData( i, "SOLID", "F" ) == "T" )
   lNoHotLight         := ( ::ReadLogicalData( i, "NOHOTLIGHT", "F" ) == "T" )
   lImgSize            := ( ::ReadLogicalData( i, "IMAGESIZE", "F" ) == "T" )
   lTransp             := ( ::ReadLogicalData( i, "TRANSPARENT", "F" ) == "T" )
   cFocusRect          := ::ReadLogicalData( i, "FOCUSRECT", "F" )
   cNoFocusRect        := ::ReadLogicalData( i, "NOFOCUSRECT", "F" )
   lNoImgList          := ( ::ReadLogicalData( i, "NOIMAGELIST", "F" ) == "T" )
   lNoDestroy          := ( ::ReadLogicalData( i, "NODESTROY", "F" ) == "T" )
   lHand               := ( ::ReadLogicalData( i, "HANDCURSOR", "F" ) == "T" )
   lDefault            := ( ::ReadLogicalData( i, "DEFAULT", "F" ) == "T" )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_PICBUTT ]
   ::aCObj[i]          := cObj
   ::aAction[i]        := cAction
   ::aToolTip[i]       := cToolTip
   ::aFlat[i]          := lFlat
   ::aOnGotFocus[i]    := cOnGotFocus
   ::aOnLostFocus[i]   := cOnLostFocus
   ::aOnMouseMove[i]   := cOnMouseMove
   ::aNoTabStop[i]     := lNoTabStop
   ::aHelpID[i]        := cHelpId
   ::aInvisible[i]     := ! lVisible
   ::aDisabled[i]      := ! lEnabled
   ::aPicture[i]       := cPicture
   ::aBuffer[i]        := cBuffer
   ::aHBitmap[i]       := cHBitmap
   ::aNoLoadTrans[i]   := lNoLoadTrans
   ::aForceScale[i]    := lForceScale
   ::aCancel[i]        := lCancel
   ::aImageAlign[i]    := iif( lTop, "TOP", iif( lBottom, "BOTTOM", iif( lLeft, "LEFT", iif( lRight, "RIGHT", iif( lCenter, "CENTER", "NIL" ) ) ) ) )
   ::aDrawBy[i]        := iif( cOOHGDraw == cWinDraw, "NIL", iif( cOOHGDraw == "T" .OR. cWinDraw == "F", "OOHGDRAW", "WINDRAW" ) )
   ::aImageMargin[i]   := cImgMargin
   ::aFitImg[i]        := lFitImg
   ::aNo3DColors[i]    := lNo3DColors
   ::aDIBSection[i]    := lDIBSection
   ::aBackColor[i]     := aBackColor
   ::aNoHotLight[i]    := lNoHotLight
   ::aSubClass[i]      := cSubClass
   ::aStretch[i]       := lStretch
   ::aSolid[i]         := lSolid
   ::aImageSize[i]     := lImgSize
   ::aTransparent[i]   := lTransp
   ::aNoFocusRect[i]   := ( cFocusRect == "F" .AND. cNoFocusRect == "T" )
   ::aNoImgList[i]     := lNoImgList
   ::aNoDestroy[i]     := lNoDestroy
   ::aHandCursor[i]    := lHand
   ::aDefault[i]       := lDefault
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl              := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row          := nRow
   oCtrl:Col          := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pPicCheckButt( i ) CLASS TFormEditor

   LOCAL aBackColor, cAlign, cBuffer, cCargo, cField, cFocusRect, cHBitmap, cHelpId, cImgMargin, cNoFocusRect, cObj, cOnChange
   LOCAL cOnGotFocus, cOnLostFocus, cOnMouseMove, cOOHGDraw, cParent, cPicture, cSubClass, cToolTip, cVal, cWinDraw, lBottom
   LOCAL lCenter, lDIBSection, lEnabled, lFitImg, lFlat, lForceScale, lHand, lImgSize, lLeft, lNo3DColors, lNoDestroy, lNoHotLight
   LOCAL lNoImgList, lNoLoadTrans, lNoTabStop, lRight, lSolid, lStretch, lTop, lTransp, lVisible, nCol, nHeight, nRow, nWidth, oCtrl
   LOCAL uValue

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( TButtonCheck():nWidth ) ) ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( TButtonCheck():nHeight ) ) ) )
   uValue              := ::ReadStringData( i, "VALUE", "" )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   cOnGotFocus         := ::ReadStringData( i, "ON GOTFOCUS", "" )
   cOnGotFocus         := ::ReadStringData( i, "ONGOTFOCUS", cOnGotFocus )
   cOnChange           := ::ReadStringData( i, "ON CHANGE", "" )
   cOnChange           := ::ReadStringData( i, "ONCHANGE", cOnChange )
   cOnLostFocus        := ::ReadStringData( i, "ON LOSTFOCUS", "" )
   cOnLostFocus        := ::ReadStringData( i, "ONLOSTFOCUS", cOnLostFocus )
   cHelpId             := ::ReadStringData( i, "HELPID", "" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lNoTabStop          := ( ( cVal := ::ReadLogicalData( i, "TABSTOP", "N" ) ) == "F" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "NOTABSTOP", "N" ) == "T" ) )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   cPicture            := ::ReadStringData( i, "PICTURE", "" )
   cPicture            := iif( Empty( cPicture ), "ICON", cPicture )
   cBuffer             := ::ReadStringData( i, "BUFFER", "" )
   cHBitmap            := ::ReadStringData( i, "HBITMAP", "" )
   lNoLoadTrans        := ( ::ReadLogicalData( i, "NOLOADTRANSPARENT", "F" ) == "T" )
   lStretch            := ( ::ReadLogicalData( i, "STRETCH", "F" ) == "T" )
   cField              := ::ReadStringData( i, "FIELD", "" )
   lNo3DColors         := ( ::ReadLogicalData( i, "NO3DCOLORS", "F" ) == "T" )
   lForceScale         := ::ReadLogicalData( i, "FORCESCALE", "F" )
   lForceScale         := ::ReadLogicalData( i, "AUTOFIT", lForceScale )
   lForceScale         := ( ::ReadLogicalData( i, "ADJUST", lForceScale ) == "T" )
   lDIBSection         := ( ::ReadLogicalData( i, "DIBSECTION", "F" ) == "T" )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   lSolid              := ( ::ReadLogicalData( i, "SOLID", "F" ) == "T" )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   cOOHGDraw           := ::ReadLogicalData( i, "THEMED", "N" )
   cOOHGDraw           := ::ReadLogicalData( i, "OOHGDRAW", cOOHGDraw )
   cWinDraw            := ::ReadLogicalData( i, "NOTHEME", "N" )
   cWinDraw            := ::ReadLogicalData( i, "WINDRAW", cWinDraw )
   cImgMargin          := ::ReadStringData( i, "IMAGEMARGIN", "" )
   lFitImg             := ( ::ReadLogicalData( i, "FITIMG", "F" ) == "T" )
   cOnMouseMove        := ::ReadStringData( i, "ON MOUSEMOVE", "" )
   cOnMouseMove        := ::ReadStringData( i, "ONMOUSEMOVE", cOnMouseMove )
   cOnMouseMove        := ::ReadStringData( i, "ON MOUSEHOVER", cOnMouseMove )
   cOnMouseMove        := ::ReadStringData( i, "ONMOUSEHOVER", cOnMouseMove )
   cAlign              := ::ReadStringData( i, "PICTALIGNMENT", "" )
   cAlign              := ::ReadStringData( i, "IMAGEALIGN", cAlign )
   lTop                := ( cAlign == "TOP" )
   lTop                := lTop .OR. ( ::ReadLogicalData( i, "TOP", "F" ) == "T" )
   lBottom             := ( cAlign == "BOTTOM" )
   lBottom             := lBottom .OR. ( ::ReadLogicalData( i, "BOTTOM", "F" ) == "T" )
   lLeft               := ( cAlign == "LEFT" )
   lLeft               := lLeft .OR. ( ::ReadLogicalData( i, "LEFT", "F" ) == "T" )
   lRight              := ( cAlign == "RIGHT" )
   lRight              := lRight .OR. ( ::ReadLogicalData( i, "RIGHT", "F" ) == "T" )
   lCenter             := ( cAlign == "CENTER" )
   lCenter             := lCenter .OR. ( ::ReadLogicalData( i, "CENTER", "F" ) == "T" )
   lFlat               := ( ::ReadLogicalData( i, "FLAT", "F" ) == "T" )
   lNoHotLight         := ( ::ReadLogicalData( i, "NOHOTLIGHT", "F" ) == "T" )
   lImgSize            := ( ::ReadLogicalData( i, "IMAGESIZE", "F" ) == "T" )
   lTransp             := ( ::ReadLogicalData( i, "TRANSPARENT", "F" ) == "T" )
   cFocusRect          := ::ReadLogicalData( i, "FOCUSRECT", "F" )
   cNoFocusRect        := ::ReadLogicalData( i, "NOFOCUSRECT", "F" )
   lNoImgList          := ( ::ReadLogicalData( i, "NOIMAGELIST", "F" ) == "T" )
   lNoDestroy          := ( ::ReadLogicalData( i, "NODESTROY", "F" ) == "T" )
   lHand               := ( ::ReadLogicalData( i, "HANDCURSOR", "F" ) == "T" )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_PICCHECKBUTT ]
   ::aCObj[i]          := cObj
   ::aValue[i]         := uValue
   ::aToolTip[i]       := cToolTip
   ::aOnGotFocus[i]    := cOnGotFocus
   ::aOnChange[i]      := cOnChange
   ::aOnLostFocus[i]   := cOnLostFocus
   ::aHelpID[i]        := cHelpId
   ::aInvisible[i]     := ! lVisible
   ::aNoTabStop[i]     := lNoTabStop
   ::aPicture[i]       := cPicture
   ::aBuffer[i]        := cBuffer
   ::aHBitmap[i]       := cHBitmap
   ::aNoLoadTrans[i]   := lNoLoadTrans
   ::aForceScale[i]    := lForceScale
   ::aField[i]         := cField
   ::aNo3DColors[i]    := lNo3DColors
   ::aDIBSection[i]    := lDIBSection
   ::aBackColor[i]     := aBackColor
   ::aDisabled[i]      := ! lEnabled
   ::aDrawBy[i]        := iif( cOOHGDraw == cWinDraw, "NIL", iif( cOOHGDraw == "T" .OR. cWinDraw == "F", "OOHGDRAW", "WINDRAW" ) )
   ::aImageMargin[i]   := cImgMargin
   ::aFitImg[i]        := lFitImg
   ::aOnMouseMove[i]   := cOnMouseMove
   ::aImageAlign[i]    := iif( lTop, "TOP", iif( lBottom, "BOTTOM", iif( lLeft, "LEFT", iif( lRight, "RIGHT", iif( lCenter, "CENTER", "NIL" ) ) ) ) )
   ::aFlat[i]          := lFlat
   ::aNoHotLight[i]    := lNoHotLight
   ::aSubClass[i]      := cSubClass
   ::aStretch[i]       := lStretch
   ::aSolid[i]         := lSolid
   ::aImageSize[i]     := lImgSize
   ::aTransparent[i]   := lTransp
   ::aNoFocusRect[i]   := ( cFocusRect == "F" .AND. cNoFocusRect == "T" )
   ::aNoImgList[i]     := lNoImgList
   ::aNoDestroy[i]     := lNoDestroy
   ::aHandCursor[i]    := lHand
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pPicture( i ) CLASS TFormEditor

   LOCAL aBackColor, cAction, cCargo, cBuffer, cExclude, cHBitmap, cHelpId, cObj, cParent, cPicture, cSubClass, cToolTip, cVal
   LOCAL lBorder, lClientEdge, lEnabled, lForceScale, lImageSize, lNo3DColors, lNoDIBSection, lNoLoadTrans, lRTL, lStretch, lTrans
   LOCAL lVisible, nCol, nHeight, nRow, nWidth, oCtrl

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( TPicture():nWidth ) ) ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( TPicture():nHeight ) ) ) )
   cAction             := ::ReadStringData( i, "ACTION", "" )
   cAction             := ::ReadStringData( i, "ON CLICK",cAction )
   cAction             := ::ReadStringData( i, "ONCLICK", cAction )
   lStretch            := ( ::ReadLogicalData( i, "STRETCH", "F") == "T" )
   cHelpId             := ::ReadStringData( i, "HELPID", "" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   cPicture            := ::ReadStringData(i, "PICTURE", "" )
   cPicture            := ::ReadStringData(i, "ICON", cPicture )
   cBuffer             := ::ReadStringData( i, "BUFFER", "" )
   cHBitmap            := ::ReadStringData( i, "HBITMAP", "" )
   lForceScale         := ::ReadLogicalData( i, "FORCESCALE", "F" )
   lForceScale         := ::ReadLogicalData( i, "AUTOFIT", lForceScale )
   lForceScale         := ( ::ReadLogicalData( i, "ADJUST", lForceScale ) == "T" )
   lBorder             := ( ::ReadLogicalData( i, "BORDER", "F" ) == "T" )
   lClientEdge         := ( ::ReadLogicalData( i, "CLIENTEDGE", "F") == "T" )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   lImageSize          := ( ::ReadLogicalData( i, "IMAGESIZE", "F" ) == "T" )
   lNoLoadTrans        := ( ::ReadLogicalData( i, "NOLOADTRANSPARENT", "F" ) == "T" )
   lNo3DColors         := ( ::ReadLogicalData( i, "NO3DCOLORS", "F" ) == "T" )
   lNoDIBSection       := ( ::ReadLogicalData( i, "NODIBSECTION", "F" ) == "T" )
   lTrans              := ( ::ReadLogicalData( i, "TRANSPARENT", "F" ) == "T" )
   cExclude            := ::ReadStringData( i, "EXCLUDEAREA", "" )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_PICTURE ]
   ::aCObj[i]          := cObj
   ::aAction[i]        := cAction
   ::aStretch[i]       := lStretch
   ::aHelpID[i]        := cHelpid
   ::aInvisible[i]     := ! lVisible
   ::aRTL[i]           := lRTL
   ::aSubClass[i]      := cSubClass
   ::aBackColor[i]     := aBackColor
   ::aPicture[i]       := cPicture
   ::aBuffer[i]        := cBuffer
   ::aHBitmap[i]       := cHBitmap
   ::aForceScale[i]    := lForceScale
   ::aBorder[i]        := lBorder
   ::aClientEdge[i]    := lClientEdge
   ::aToolTip[i]       := cToolTip
   ::aImageSize[i]     := lImageSize
   ::aNoLoadTrans[i]   := lNoLoadTrans
   ::aNo3DColors[i]    := lNo3DColors
   ::aNoDIBSection[i]  := lNoDIBSection
   ::aTransparent[i]   := lTrans
   ::aExclude[i]       := cExclude
   ::aDisabled[i]      := ! lEnabled
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pPlayer( i ) CLASS TFormEditor

   LOCAL cCargo, cFile, cHelpId, cObj, cParent, cSubClass, cVal, lEnabled, lNoAutoSizeM, lNoAutoSizeW, lNoErrorDlg, lNoMenu, lNoOpen
   LOCAL lNoPlayBar, lNoTabStop, lRTL, lShowAll, lShowMode, lShowName, lShowPosition, lVisible, nCol, nHeight, nRow, nWidth, oCtrl

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", "100" ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", "100" ) )
   cFile               := ::ReadStringData( i, "FILE", "" )
   lNoAutoSizeW        := ( ::ReadLogicalData( i, "NOAUTOSIZEWINDOW", "F" ) == "T" )
   lNoAutoSizeM        := ( ::ReadLogicalData( i, "NOAUTOSIZEMOVIE", "F" ) == "T" )
   lNoErrorDlg         := ( ::ReadLogicalData( i, "NOERRORDLG", "F" ) == "T" )
   lNoMenu             := ( ::ReadLogicalData( i, "NOMENU", "F" ) == "T" )
   lNoOpen             := ( ::ReadLogicalData( i, "NOOPEN", "F" ) == "T" )
   lNoPlayBar          := ( ::ReadLogicalData( i, "NOPLAYBAR", "F" ) == "T" )
   lShowAll            := ( ::ReadLogicalData( i, "SHOWALL", "F" ) == "T" )
   lShowMode           := ( ::ReadLogicalData( i, "SHOWMODE", "F" ) == "T" )
   lShowName           := ( ::ReadLogicalData( i, "SHOWNAME", "F" ) == "T" )
   lShowPosition       := ( ::ReadLogicalData( i, "SHOWPOSITION", "F" ) == "T" )
   cHelpId             := ::ReadStringData( i, "HELPID", "" )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lNoTabStop          := ( ( cVal := ::ReadLogicalData( i, "TABSTOP", "N" ) ) == "F" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "NOTABSTOP", "N" ) == "T" ) )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_PLAYER ]
   ::aCObj[i]          := cObj
   ::aFile[i]          := cFile
   ::aNoAutoSizeWin[i] := lNoAutoSizeW
   ::aNoAutoSizeMov[i] := lNoAutoSizeM
   ::aNoErrorDlg[i]    := lNoErrorDlg
   ::aNoMenu[i]        := lNoMenu
   ::aNoOpen[i]        := lNoOpen
   ::aNoPlayBar[i]     := lNoPlayBar
   ::aShowAll[i]       := lShowAll
   ::aShowMode[i]      := lShowMode
   ::aShowName[i]      := lShowName
   ::aShowPosition[i]  := lShowPosition
   ::aHelpID[i]        := cHelpid
   ::aSubClass[i]      := cSubClass
   ::aInvisible[i]     := ! lVisible
   ::aNoTabStop[i]     := lNoTabStop
   ::aDisabled[i]      := ! lEnabled
   ::aRTL[i]           := lRTL
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl             := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row         := nRow
   oCtrl:Col         := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pProgressbar( i ) CLASS TFormEditor

   LOCAL aBackColor, aForeColor, cCargo, cHelpId, cMarquee, cObj, cParent, cRange, cSubClass, cToolTip, cVal, cValue, lRTL, lSmooth
   LOCAL lVertical, lVisible, nCol, nHeight, nRow, nWidth, oCtrl

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   lVertical           := ( ::ReadLogicalData( i, "VERTICAL", "F" ) == "T" )
   IF lVertical
      nWidth           := Val( ::ReadStringData( i, "WIDTH", "25" ) )
      nHeight          := Val( ::ReadStringData( i, "HEIGHT", "120" ) )
   ELSE
      nWidth           := Val( ::ReadStringData( i, "WIDTH", "120" ) )
      nHeight          := Val( ::ReadStringData( i, "HEIGHT", "25" ) )
   ENDIF
   cRange              := ::ReadStringData( i, "RANGE", "" )
   IF Empty( cRange )
      cRange           := ( ::ReadStringData( i, "RANGEMIN", "" ) + ", " + ::ReadStringData( i, "RANGEMAX", "" ) )
   ENDIF
   cValue              := ::ReadStringData( i, "VALUE", "" )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   lSmooth             := ( ::ReadLogicalData( i, "SMOOTH", "F" ) == "T" )
   cHelpId             := ::ReadStringData( i, "HELPID", "" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   aForeColor          := ::ReadStringData( i, "FORECOLOR", "NIL" )
   aForeColor          := UpperNIL( ::ReadOopData( i, "FORECOLOR", aForeColor ) )
   aForeColor          := ::ReadStringData( i, "BARCOLOR", aForeColor )
   aForeColor          := UpperNIL( ::ReadOopData( i, "BARCOLOR", aForeColor ) )
   aForeColor          := ::ReadStringData( i, "FONTCOLOR", aForeColor )
   aForeColor          := UpperNIL( ::ReadOopData( i, "FONTCOLOR", aForeColor ) )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   cMarquee            := ::ReadStringData( i, "MARQUEE", "" )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_PROGRESSBAR ]
   ::aCObj[i]          := cObj
   ::aRange[i]         := cRange
   ::aValue[i]         := cValue
   ::aVertical[i]      := lVertical
   ::aToolTip[i]       := cToolTip
   ::aSmooth[i]        := lSmooth
   ::aHelpID[i]        := cHelpID
   ::aInvisible[i]     := ! lVisible
   ::aBackColor[i]     := aBackColor
   ::aFontColor[i]     := aForeColor
   ::aRTL[i]           := lRTL
   ::aMarquee[i]       := cMarquee
   ::aSubClass[i]      := cSubClass
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pProgressMeter( i ) CLASS TFormEditor

   LOCAL aBackColor, aForeColor, cAction, cCargo, cFontName, cHelpId, cObj, cParent, cRange, cSubClass, cToolTip, cVal, cValue
   LOCAL lBold, lClientEdge, lEnabled, lItalic, lRTL, lStrikeout, lUnderline, lVisible, nCol, nFontSize, nHeight, nRow, nWidth
   LOCAL oCtrl, uFontName, uFontSize

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( TProgressMeter():nWidth ) ) ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( TProgressMeter():nHeight ) ) ) )
   cRange              := ::ReadStringData( i, "RANGE", "" )
   cValue              := ::ReadStringData( i, "VALUE", "")
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   cHelpId             := ::ReadStringData( i, "HELPID", "" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   aForeColor          := ::ReadStringData( i, "FORECOLOR", "NIL" )
   aForeColor          := UpperNIL( ::ReadOopData( i, "FORECOLOR", aForeColor ) )
   aForeColor          := ::ReadStringData( i, "BARCOLOR", aForeColor )
   aForeColor          := UpperNIL( ::ReadOopData( i, "BARCOLOR", aForeColor ) )
   aForeColor          := ::ReadStringData( i, "FONTCOLOR", aForeColor )
   aForeColor          := UpperNIL( ::ReadOopData( i, "FONTCOLOR", aForeColor ) )
   uFontName           := ::ReadStringData( i, "FONT", "" )
   uFontName           := ::ReadStringData( i, "FONTNAME", uFontName )
   uFontName           := ::ReadOopData( i, "FONTNAME", uFontName )
   cFontName           := ::StrToValueCtrl( uFontName, "C", "" )
   uFontSize           := ::ReadStringData( i, "SIZE", "" )
   uFontSize           := ::ReadStringData( i, "FONTSIZE", uFontSize )
   uFontSize           := ::ReadOopData( i, "FONTSIZE", uFontSize )
   nFontSize           := ::StrToValueCtrl( uFontSize, "N", 0, 1, 9999 )
   lBold               := ( ::ReadLogicalData( i, "BOLD", "F" ) == "T" )
   lBold               := ( ::ReadLogicalData( i, "FONTBOLD", iif( lBold, "T", "F" ) ) == "T" )
   lBold               := ( Upper( ::ReadOopData( i, "FONTBOLD", iif( lBold, ".T.", ".F." ) ) ) == ".T." )
   lItalic             := ( ::ReadLogicalData( i, "ITALIC", "F" ) == "T" )
   lItalic             := ( ::ReadLogicalData( i, "FONTITALIC", iif( lItalic, "T", "F" ) ) == "T" )
   lItalic             := ( Upper( ::ReadOopData( i, "FONTITALIC", iif( lItalic, ".T.", ".F." ) ) ) == ".T." )
   lUnderline          := ( ::ReadLogicalData( i, "UNDERLINE", "F" ) == "T" )
   lUnderline          := ( ::ReadLogicalData( i, "FONTUNDERLINE", iif( lUnderline, "T", "F" ) ) == "T" )
   lUnderline          := ( Upper( ::ReadOopData( i, "FONTUNDERLINE", iif( lUnderline, ".T.", ".F." ) ) ) == ".T." )
   lStrikeout          := ( ::ReadLogicalData( i, "STRIKEOUT", "F" ) == "T" )
   lStrikeout          := ( ::ReadLogicalData( i, "FONTSTRIKEOUT", iif( lStrikeout, "T", "F" ) ) == "T" )
   lStrikeout          := ( Upper( ::ReadOopData( i, "FONTSTRIKEOUT", iif( lStrikeout, ".T.", ".F." ) ) ) == ".T." )
   cAction             := ::ReadStringData( i, "ACTION", "" )
   cAction             := ::ReadStringData( i, "ON CLICK",cAction )
   cAction             := ::ReadStringData( i, "ONCLICK", cAction )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   lClientEdge         := ( ::ReadLogicalData( i, "CLIENTEDGE", "F") == "T" )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_PROGRESSMETER ]
   ::aCObj[i]          := cObj
   ::aRange[i]         := cRange
   ::aValue[i]         := cValue
   ::aToolTip[i]       := cToolTip
   ::aHelpID[i]        := cHelpid
   ::aInvisible[i]     := ! lVisible
   ::aBackColor[i]     := aBackColor
   ::aFontColor[i]     := aForeColor
   ::aFontName[i]      := cFontName
   ::aFontNameFrm[i]   := uFontName
   ::aFontSize[i]      := nFontSize
   ::aFontSizeFrm[i]   := uFontSize
   ::aFontBold[i]      := lBold
   ::aFontItalic[i]    := lItalic
   ::aFontUnderline[i] := lUnderline
   ::aFontStrikeout[i] := lStrikeout
   ::aAction[i]        := cAction
   ::aRTL[i]           := lRTL
   ::aClientEdge[i]    := lClientEdge
   ::aDisabled[i]      := ! lEnabled
   ::aSubClass[i]      := cSubClass
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pRadiogroup( i ) CLASS TFormEditor

   LOCAL aBackColor, aFontColor, cBackground, cCargo, cFocusRect, cFontName, cHelpid, cItems, cNoFocusRect, cObj, cParent, cOnChange
   LOCAL cOOHGDraw, cReadOnly, cSpacing, cSubClass, cToolTip, cVal, cValue, cWinDraw, lAutoSize, lBold, lEnabled, lHorizontal
   LOCAL lItalic, lLeftJust, lNoTabStop, lRTL, lStrikeout, lTrans, lUnderline, lVisible, nCol, nFontSize, nRow, oCtrl, uFontName
   LOCAL uFontSize, uHeight, uLimit, uShift, uWidth

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   uWidth              := ::ReadStringData( i, "WIDTH", "" )
   uHeight             := ::ReadStringData( i, "HEIGHT", "" )
   cItems              := ::ReadStringData( i, "OPTIONS", "{ 'option 1', 'option 2' }" )
   cValue              := ::ReadStringData( i, "VALUE", "" )
   cSpacing            := ::ReadStringData( i, "SPACING", "" )
   uFontName           := ::ReadStringData( i, "FONT", "" )
   uFontName           := ::ReadStringData( i, "FONTNAME", uFontName )
   uFontName           := ::ReadOopData( i, "FONTNAME", uFontName )
   cFontName           := ::StrToValueCtrl( uFontName, "C", "" )
   uFontSize           := ::ReadStringData( i, "SIZE", "" )
   uFontSize           := ::ReadStringData( i, "FONTSIZE", uFontSize )
   uFontSize           := ::ReadOopData( i, "FONTSIZE", uFontSize )
   nFontSize           := ::StrToValueCtrl( uFontSize, "N", 0, 1, 9999 )
   lBold               := ( ::ReadLogicalData( i, "BOLD", "F" ) == "T" )
   lBold               := ( ::ReadLogicalData( i, "FONTBOLD", iif( lBold, "T", "F" ) ) == "T" )
   lBold               := ( Upper( ::ReadOopData( i, "FONTBOLD", iif( lBold, ".T.", ".F." ) ) ) == ".T." )
   lItalic             := ( ::ReadLogicalData( i, "ITALIC", "F" ) == "T" )
   lItalic             := ( ::ReadLogicalData( i, "FONTITALIC", iif( lItalic, "T", "F" ) ) == "T" )
   lItalic             := ( Upper( ::ReadOopData( i, "FONTITALIC", iif( lItalic, ".T.", ".F." ) ) ) == ".T." )
   lUnderline          := ( ::ReadLogicalData( i, "UNDERLINE", "F" ) == "T" )
   lUnderline          := ( ::ReadLogicalData( i, "FONTUNDERLINE", iif( lUnderline, "T", "F" ) ) == "T" )
   lUnderline          := ( Upper( ::ReadOopData( i, "FONTUNDERLINE", iif( lUnderline, ".T.", ".F." ) ) ) == ".T." )
   lStrikeout          := ( ::ReadLogicalData( i, "STRIKEOUT", "F" ) == "T" )
   lStrikeout          := ( ::ReadLogicalData( i, "FONTSTRIKEOUT", iif( lStrikeout, "T", "F" ) ) == "T" )
   lStrikeout          := ( Upper( ::ReadOopData( i, "FONTSTRIKEOUT", iif( lStrikeout, ".T.", ".F." ) ) ) == ".T." )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   aFontColor          := ::ReadStringData( i, "FONTCOLOR", "NIL" )
   aFontColor          := UpperNIL( ::ReadOopData( i, "FONTCOLOR", aFontColor ) )
   cOnChange           := ::ReadStringData( i, "ON CHANGE", "" )
   cOnChange           := ::ReadStringData( i, "ONCHANGE", cOnChange )
   lTrans              := ( ::ReadLogicalData( i, "TRANSPARENT", "F" ) == "T" )
   cHelpid             := ::ReadStringData(i, "HELPID", "" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lNoTabStop          := ( ( cVal := ::ReadLogicalData( i, "TABSTOP", "N" ) ) == "F" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "NOTABSTOP", "N" ) == "T" ) )
   lAutoSize           := ( ::ReadLogicalData( i, "AUTOSIZE", "F" ) == "T" )
   lHorizontal         := ( ::ReadLogicalData( i, "HORIZONTAL", "F" ) == "T" )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   cOOHGDraw           := ::ReadLogicalData( i, "THEMED", "N" )
   cOOHGDraw           := ::ReadLogicalData( i, "OOHGDRAW", cOOHGDraw )
   cWinDraw            := ::ReadLogicalData( i, "NOTHEME", "N" )
   cWinDraw            := ::ReadLogicalData( i, "WINDRAW", cWinDraw )
   cBackground         := ::ReadStringData( i, "BACKGROUND", "" )
   lLeftJust           := ( ::ReadLogicalData( i, "LEFTJUSTIFY", "F" ) == "T" )
   lLeftJust           := lLeftJust .OR. ( ::ReadLogicalData( i, "LEFTALIGN", "F" ) == "T" )
   cReadOnly           := ::ReadStringData( i, "READONLY", "" )
   cFocusRect          := ::ReadLogicalData( i, "FOCUSRECT", "F" )
   cNoFocusRect        := ::ReadLogicalData( i, "NOFOCUSRECT", "F" )
   uLimit              := ::ReadStringData( i, "LIMIT", "" )
   uShift              := ::ReadStringData( i, "SHIFT", "" )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_RADIOGROUP ]
   ::aCObj[i]          := cObj
   ::aOptions[i]       := cItems
   ::aValue[i]         := cValue
   ::aSpacing[i]       := cSpacing
   ::aFontName[i]      := cFontName
   ::aFontNameFrm[i]   := uFontName
   ::aFontSize[i]      := nFontSize
   ::aFontSizeFrm[i]   := uFontSize
   ::aFontBold[i]      := lBold
   ::aFontItalic[i]    := lItalic
   ::aFontUnderline[i] := lUnderLine
   ::aFontStrikeout[i] := lStrikeout
   ::aToolTip[i]       := cToolTip
   ::aBackColor[i]     := aBackColor
   ::aFontColor[i]     := aFontColor
   ::aOnChange[i]      := cOnChange
   ::aTransparent[i]   := lTrans
   ::aHelpID[i]        := cHelpID
   ::aInvisible[i]     := ! lVisible
   ::aNoTabStop[i]     := lNoTabStop
   ::aAutoSize[i]      := lAutoSize
   ::aHorizontal[i]    := lHorizontal
   ::aDisabled[i]      := ! lEnabled
   ::aRTL[i]           := lRTL
   ::aSubClass[i]      := cSubClass
   ::aDrawBy[i]        := iif( cOOHGDraw == cWinDraw, "NIL", iif( cOOHGDraw == "T" .OR. cWinDraw == "F", "OOHGDRAW", "WINDRAW" ) )
   ::aBackground[i]    := cBackground
   ::aLeftJust[i]      := lLeftJust
   ::aReadOnlyArray[i] := cReadOnly
   ::aNoFocusRect[i]   := ( cFocusRect == "F" .AND. cNoFocusRect == "T" )
   ::aLimit[i]         := uLimit
   ::aShift[i]         := uShift
   ::aWidth[i]         := uWidth
   ::aHeight[i]        := uHeight
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, NIL, NIL, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pRichedit( i ) CLASS TFormEditor

   LOCAL aBackColor, aFontColor, cCargo, cField, cFile, cFileType, cFocusedPos, cFontName, cHelpID, cInsertType, cMaxLength, cObj
   LOCAL cOnChange, cOnGotFocus, cOnHScroll, cOnLostFocus, cOnSelChange, cOnVScroll, cParent, cSubClass, cToolTip, cVal, cValue
   LOCAL lBold, lBreak, lEnabled, lItalic, lNoHideSel, lNoHScroll, lNoTabStop, lNoVScroll, lPlainText, lReadonly, lRTL, lStrikeout
   LOCAL lUnderline, lVisible, nCol, nFontSize, nHeight, nRow, nWidth, oCtrl, uFontName, uFontSize, uVersion

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( TEditRich():nWidth ) ) ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( TEditRich():nHeight ) ) ) )
   cField              := ::ReadStringData( i, "FIELD", "" )
   cFile               := ::ReadStringData( i, "FILE", "" )
   lPlainText          := ( ::ReadLogicalData( i, "PLAINTEXT", "F" ) == "T" )
   cFileType           := ::ReadStringData( i, "FILETYPE", "" )
   cValue              := ::ReadStringData( i, "VALUE", "" )
   lReadonly           := ( ::ReadLogicalData( i, "READONLY", "F" ) == "T" )
   uFontName           := ::ReadStringData( i, "FONT", "" )
   uFontName           := ::ReadStringData( i, "FONTNAME", uFontName )
   uFontName           := ::ReadOopData( i, "FONTNAME", uFontName )
   cFontName           := ::StrToValueCtrl( uFontName, "C", "" )
   uFontSize           := ::ReadStringData( i, "SIZE", "" )
   uFontSize           := ::ReadStringData( i, "FONTSIZE", uFontSize )
   uFontSize           := ::ReadOopData( i, "FONTSIZE", uFontSize )
   nFontSize           := ::StrToValueCtrl( uFontSize, "N", 0, 1, 9999 )
   lBold               := ( ::ReadLogicalData( i, "BOLD", "F" ) == "T" )
   lBold               := ( ::ReadLogicalData( i, "FONTBOLD", iif( lBold, "T", "F" ) ) == "T" )
   lBold               := ( Upper( ::ReadOopData( i, "FONTBOLD", iif( lBold, ".T.", ".F." ) ) ) == ".T." )
   lItalic             := ( ::ReadLogicalData( i, "ITALIC", "F" ) == "T" )
   lItalic             := ( ::ReadLogicalData( i, "FONTITALIC", iif( lItalic, "T", "F" ) ) == "T" )
   lItalic             := ( Upper( ::ReadOopData( i, "FONTITALIC", iif( lItalic, ".T.", ".F." ) ) ) == ".T." )
   lUnderline          := ( ::ReadLogicalData( i, "UNDERLINE", "F" ) == "T" )
   lUnderline          := ( ::ReadLogicalData( i, "FONTUNDERLINE", iif( lUnderline, "T", "F" ) ) == "T" )
   lUnderline          := ( Upper( ::ReadOopData( i, "FONTUNDERLINE", iif( lUnderline, ".T.", ".F." ) ) ) == ".T." )
   lStrikeout          := ( ::ReadLogicalData( i, "STRIKEOUT", "F" ) == "T" )
   lStrikeout          := ( ::ReadLogicalData( i, "FONTSTRIKEOUT", iif( lStrikeout, "T", "F" ) ) == "T" )
   lStrikeout          := ( Upper( ::ReadOopData( i, "FONTSTRIKEOUT", iif( lStrikeout, ".T.", ".F." ) ) ) == ".T." )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   aFontColor          := ::ReadStringData( i, "FONTCOLOR", "NIL" )
   aFontColor          := UpperNIL( ::ReadOopData( i, "FONTCOLOR", aFontColor ) )
   cMaxLength          := ::ReadStringData( i, "MAXLENGTH", "" )
   cOnGotFocus         := ::ReadStringData( i, "ON GOTFOCUS", "" )
   cOnGotFocus         := ::ReadStringData( i, "ONGOTFOCUS", cOnGotFocus )
   cOnChange           := ::ReadStringData( i, "ON CHANGE", "" )
   cOnChange           := ::ReadStringData( i, "ONCHANGE", cOnChange )
   cOnLostFocus        := ::ReadStringData( i, "ON LOSTFOCUS", "" )
   cOnLostFocus        := ::ReadStringData( i, "ONLOSTFOCUS", cOnLostFocus )
   cOnSelChange        := ::ReadStringData( i, "ON SELCHANGE", "" )
   cOnSelChange        := ::ReadStringData( i, "ONSELCHANGE", cOnSelChange )
   cOnSelChange        := ::ReadStringData( i, "ON SELECT", cOnSelChange )
   cOnSelChange        := ::ReadStringData( i, "ONSELECT", cOnSelChange )
   cHelpID             := ::ReadStringData( i, "HELPID", "" )
   lBreak              := ( ::ReadLogicalData( i, "BREAK", "F" ) == "T" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lNoTabStop          := ( ( cVal := ::ReadLogicalData( i, "TABSTOP", "N" ) ) == "F" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "NOTABSTOP", "N" ) == "T" ) )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   lNoHideSel          := ( ::ReadLogicalData( i, "NOHIDESEL", "F" ) == "T" )
   cFocusedPos         := ::ReadStringData( i, "FOCUSEDPOS", "" )
   lNoVScroll          := ( ::ReadLogicalData( i, "NOVSCROLL", "F" ) == "T" )
   lNoHScroll          := ( ::ReadLogicalData( i, "NOHSCROLL", "F" ) == "T" )
   cOnVScroll          := ::ReadStringData( i, "ON VSCROLL", "" )
   cOnVScroll          := ::ReadStringData( i, "ONVSCROLL", cOnVScroll )
   cOnHScroll          := ::ReadStringData( i, "ON HSCROLL", "" )
   cOnHScroll          := ::ReadStringData( i, "ONHSCROLL", cOnHScroll )
   cInsertType         := ::ReadStringData( i, "INSERTTYPE", "" )
   uVersion            := ::ReadStringData( i, "VERSION", "" )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_RICHEDITBOX ]
   ::aCObj[i]          := cObj
   ::aField[i]         := cField
   ::aFile[i]          := cFile
   ::aPlainText[i]     := lPlainText
   ::aFileType[i]      := cFileType
   ::aValue[i]         := cValue
   ::aReadOnly[i]      := lReadonly
   ::aFontName[i]      := cFontName
   ::aFontNameFrm[i]   := uFontName
   ::aFontSize[i]      := nFontSize
   ::aFontSizeFrm[i]   := uFontSize
   ::aFontBold[i]      := lBold
   ::aFontItalic[i]    := lItalic
   ::aFontUnderline[i] := lUnderline
   ::aFontStrikeout[i] := lStrikeout
   ::aToolTip[i]       := cTooltip
   ::aBackColor[i]     := aBackColor
   ::aFontColor[i]     := aFontColor
   ::aMaxLength[i]     := cMaxLength
   ::aOnGotFocus[i]    := cOnGotFocus
   ::aOnChange[i]      := cOnChange
   ::aOnLostFocus[i]   := cOnLostFocus
   ::aOnSelChange[i]   := cOnSelChange
   ::aHelpID[i]        := cHelpID
   ::aBreak[i]         := lBreak
   ::aInvisible[i]     := ! lVisible
   ::aNoTabStop[i]     := lNoTabStop
   ::aRTL[i]           := lRTL
   ::aSubClass[i]      := cSubClass
   ::aDisabled[i]      := ! lEnabled
   ::aNoHideSel[i]     := lNoHideSel
   ::aFocusedPos[i]    := cFocusedPos
   ::aNoVScroll[i]     := lNoVScroll
   ::aNoHScroll[i]     := lNoHScroll
   ::aOnVScroll[i]     := cOnVScroll
   ::aOnHScroll[i]     := cOnHScroll
   ::aInsertType[i]    := cInsertType
   ::aVersion[i]       := uVersion
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pScrollBar( i ) CLASS TFormEditor

   LOCAL cCargo, cHelpId, cLineSkip, cObj, cOnBottom, cOnChange, cOnEndTrack, cOnLineDown, cOnLineUp, cOnPageDown, cOnPageUp
   LOCAL cOnThumb, cOnTop, cOnTrack, cParent, cPageSkip, cRange, cSubClass, cToolTip, cVal, cValue, lAttached, lAutoMove, lEnabled
   LOCAL lHorizontal, lRTL, lVertical, lVisible, nCol, nHeight, nRow, nWidth, oCtrl

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   lHorizontal         := ( ::ReadLogicalData( i, "HORIZONTAL", "F" ) == "T" )
   IF lHorizontal
      nHeight          := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( GetHScrollBarHeight() ) ) ) )
      nWidth           := Val( ::ReadStringData( i, "WIDTH", "100" ) )
   ELSE
      nHeight          := Val( ::ReadStringData( i, "HEIGHT", "100" ) )
      nWidth           := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( GetVScrollBarWidth() ) ) ) )
   ENDIF
   cRange              := ::ReadStringData( i, "RANGE", "" )
   cOnChange           := ::ReadStringData( i, "ON CHANGE", "" )
   cOnChange           := ::ReadStringData( i, "ONCHANGE", cOnChange )
   cOnLineUp           := ::ReadStringData( i, "ON LINEUP", "" )
   cOnLineUp           := ::ReadStringData( i, "ONLINEUP", cOnLineUp )
   cOnLineUp           := ::ReadStringData( i, "ON LINELEFT", cOnLineUp )
   cOnLineUp           := ::ReadStringData( i, "ONLINELEFT", cOnLineUp )
   cOnLineDown         := ::ReadStringData( i, "ON LINEDOWN", "" )
   cOnLineDown         := ::ReadStringData( i, "ONLINEDOWN", cOnLineDown )
   cOnLineDown         := ::ReadStringData( i, "ON LINERIGHT", cOnLineDown )
   cOnLineDown         := ::ReadStringData( i, "ONLINERIGHT", cOnLineDown )
   cOnPageUp           := ::ReadStringData( i, "ON PAGEUP", "" )
   cOnPageUp           := ::ReadStringData( i, "ONPAGEUP", cOnPageUp )
   cOnPageUp           := ::ReadStringData( i, "ON PAGELEFT", cOnPageUp )
   cOnPageUp           := ::ReadStringData( i, "ONPAGELEFT", cOnPageUp )
   cOnPageDown         := ::ReadStringData( i, "ON PAGEDOWN", "" )
   cOnPageDown         := ::ReadStringData( i, "ONPAGEDOWN", cOnPageDown )
   cOnPageDown         := ::ReadStringData( i, "ON PAGERIGHT", cOnPageDown )
   cOnPageDown         := ::ReadStringData( i, "ONPAGERIGHT", cOnPageDown )
   cOnTop              := ::ReadStringData( i, "ON TOP", "" )
   cOnTop              := ::ReadStringData( i, "ONTOP", cOnTop )
   cOnTop              := ::ReadStringData( i, "ON LEFT", cOnTop )
   cOnTop              := ::ReadStringData( i, "ONLEFT", cOnTop )
   cOnBottom           := ::ReadStringData( i, "ON BOTTOM", "" )
   cOnBottom           := ::ReadStringData( i, "ONBOTTOM", cOnBottom )
   cOnBottom           := ::ReadStringData( i, "ON RIGHT", cOnBottom )
   cOnBottom           := ::ReadStringData( i, "ONRIGHT", cOnBottom )
   cOnThumb            := ::ReadStringData( i, "ON THUMB", "" )
   cOnThumb            := ::ReadStringData( i, "ONTHUMB", cOnThumb )
   cOnTrack            := ::ReadStringData( i, "ON TRACK", "" )
   cOnTrack            := ::ReadStringData( i, "ONTRACK", cOnTrack )
   cOnEndTrack         := ::ReadStringData( i, "ON ENDTRACK", "" )
   cOnEndTrack         := ::ReadStringData( i, "ONENDTRACK", cOnEndTrack )
   cHelpId             := ::ReadStringData( i, "HELPID", "" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   lVertical           := ( ::ReadLogicalData( i, "VERTICAL", "F" ) == "T" )
   lAttached           := ( ::ReadLogicalData( i, "ATTACHED", "F" ) == "T" )
   cValue              := ::ReadStringData( i, "VALUE", "")
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   cLineSkip           := ::ReadStringData( i, "LINESKIP", "")
   cPageSkip           := ::ReadStringData( i, "PAGESKIP", "")
   lAutoMove           := ( ::ReadLogicalData( i, "AUTOMOVE", "F" ) == "T" )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_SCROLLBAR ]
   ::aCObj[i]          := cObj
   ::aHorizontal[i]    := lHorizontal
   ::aRange[i]         := cRange
   ::aOnChange[i]      := cOnChange
   ::aOnScrLineLU[i]   := cOnLineUp
   ::aOnScrLineRD[i]   := cOnLineDown
   ::aOnScrPageLU[i]   := cOnPageUp
   ::aOnScrPageRD[i]   := cOnPageDown
   ::aOnScrLT[i]       := cOnTop
   ::aOnScrRB[i]       := cOnBottom
   ::aOnScrThumb[i]    := cOnThumb
   ::aOnScrTrack[i]    := cOnTrack
   ::aOnScrEndTrack[i] := cOnEndTrack
   ::aHelpID[i]        := cHelpid
   ::aInvisible[i]     := ! lVisible
   ::aToolTip[i]       := cToolTip
   ::aRTL[i]           := lRTL
   ::aVertical[i]      := lVertical
   ::aAttached[i]      := lAttached
   ::aValue[i]         := cValue
   ::aDisabled[i]      := ! lEnabled
   ::aSubClass[i]      := cSubClass
   ::aLineSkip[i]      := cLineSkip
   ::aPageSkip[i]      := cPageSkip
   ::aAutoMove[i]      := lAutoMove
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pSlider( i ) CLASS TFormEditor

   LOCAL aBackColor, cCargo, cHelpId, cObj, cOnChange, cParent, cRange, cSubClass, cToolTip, cVal, cValue, lBoth, lEnabled, lLeft
   LOCAL lNoTabStop, lNoTicks, lRTL, lTop, lVertical, lVisible, nCol, nHeight, nRow, nWidth, oCtrl

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   cRange              := ::ReadStringData( i, "RANGE", "" )
   cValue              := ::ReadStringData( i, "VALUE", "" )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", "0" ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", "0" ) )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   cOnChange           := ::ReadStringData( i, "ON CHANGE", "" )
   cOnChange           := ::ReadStringData( i, "ONCHANGE", cOnChange )
   lVertical           := ( ::ReadLogicalData( i, "VERTICAL", "F" ) == "T" )
   lNoTicks            := ( ::ReadLogicalData( i, "NOTICKS", "F" ) == "T" )
   lBoth               := ( ::ReadLogicalData( i, "BOTH", "F" ) == "T" )
   lTop                := ( ::ReadLogicalData( i, "TOP", "F" ) == "T" )
   lLeft               := ( ::ReadLogicalData( i, "LEFT", "F" ) == "T" )
   cHelpId             := ::ReadStringData( i, "HELPID", "" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lNoTabStop          := ( ( cVal := ::ReadLogicalData( i, "TABSTOP", "N" ) ) == "F" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "NOTABSTOP", "N" ) == "T" ) )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_SLIDER ]
   ::aCObj[i]          := cObj
   ::aRange[i]         := cRange
   ::aValue[i]         := cValue
   ::aToolTip[i]       := cToolTip
   ::aBackColor[i]     := aBackColor
   ::aOnChange[i]      := cOnChange
   ::aVertical[i]      := lVertical
   ::aNoTicks[i]       := lNoTicks
   ::aBoth[i]          := lBoth
   ::aTop[i]           := lTop
   ::aLeft[i]          := lLeft
   ::aHelpID[i]        := cHelpID
   ::aInvisible[i]     := ! lVisible
   ::aNoTabStop[i]     := lNoTabStop
   ::aRTL[i]           := lRTL
   ::aSubClass[i]      := cSubClass
   ::aDisabled[i]      := ! lEnabled
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pSpinner( i ) CLASS TFormEditor

   LOCAL aBackColor, aFontColor, cCargo, cCue, cFontName, cHelpId, cIncrement, cObj, cOnChange, cOnGotfocus, cOnLostfocus, cParent
   LOCAL cRange, cSubClass, cToolTip, cVal, cValue, lBold, lBoundText, lEnabled, lItalic, lNoBorder, lNoTabStop, lReadOnly, lRTL
   LOCAL lStrikeout, lUnderline, lVisible, lWrap, nCol,nFontSize, nHeight, nRow, nWidth, oCtrl, uFontName, uFontSize

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   cRange              := ::ReadStringData( i, "RANGE", "" )
   cValue              := ::ReadStringData( i, "VALUE", "" )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( TSpinner():nWidth ) ) ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( TSpinner():nHeight ) ) ) )
   uFontName           := ::ReadStringData( i, "FONT", "" )
   uFontName           := ::ReadStringData( i, "FONTNAME", uFontName )
   uFontName           := ::ReadOopData( i, "FONTNAME", uFontName )
   cFontName           := ::StrToValueCtrl( uFontName, "C", "" )
   uFontSize           := ::ReadStringData( i, "SIZE", "" )
   uFontSize           := ::ReadStringData( i, "FONTSIZE", uFontSize )
   uFontSize           := ::ReadOopData( i, "FONTSIZE", uFontSize )
   nFontSize           := ::StrToValueCtrl( uFontSize, "N", 0, 1, 9999 )
   lBold               := ( ::ReadLogicalData( i, "BOLD", "F" ) == "T" )
   lBold               := ( ::ReadLogicalData( i, "FONTBOLD", iif( lBold, "T", "F" ) ) == "T" )
   lBold               := ( Upper( ::ReadOopData( i, "FONTBOLD", iif( lBold, ".T.", ".F." ) ) ) == ".T." )
   lItalic             := ( ::ReadLogicalData( i, "ITALIC", "F" ) == "T" )
   lItalic             := ( ::ReadLogicalData( i, "FONTITALIC", iif( lItalic, "T", "F" ) ) == "T" )
   lItalic             := ( Upper( ::ReadOopData( i, "FONTITALIC", iif( lItalic, ".T.", ".F." ) ) ) == ".T." )
   lUnderline          := ( ::ReadLogicalData( i, "UNDERLINE", "F" ) == "T" )
   lUnderline          := ( ::ReadLogicalData( i, "FONTUNDERLINE", iif( lUnderline, "T", "F" ) ) == "T" )
   lUnderline          := ( Upper( ::ReadOopData( i, "FONTUNDERLINE", iif( lUnderline, ".T.", ".F." ) ) ) == ".T." )
   lStrikeout          := ( ::ReadLogicalData( i, "STRIKEOUT", "F" ) == "T" )
   lStrikeout          := ( ::ReadLogicalData( i, "FONTSTRIKEOUT", iif( lStrikeout, "T", "F" ) ) == "T" )
   lStrikeout          := ( Upper( ::ReadOopData( i, "FONTSTRIKEOUT", iif( lStrikeout, ".T.", ".F." ) ) ) == ".T." )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   aFontColor          := ::ReadStringData( i, "FONTCOLOR", "NIL" )
   aFontColor          := UpperNIL( ::ReadOopData( i, "FONTCOLOR", aFontColor ) )
   cOnGotfocus         := ::ReadStringData( i, "ON GOTFOCUS", "" )
   cOnGotfocus         := ::ReadStringData( i, "ONGOTFOCUS", cOnGotfocus )
   cOnChange           := ::ReadStringData( i, "ON CHANGE", "" )
   cOnChange           := ::ReadStringData( i, "ONCHANGE", cOnChange )
   cOnLostfocus        := ::ReadStringData( i, "ON LOSTFOCUS", "" )
   cOnLostfocus        := ::ReadStringData( i, "ONLOSTFOCUS", cOnLostfocus )
   cHelpId             := ::ReadStringData( i, "HELPID", "" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lNoTabStop          := ( ( cVal := ::ReadLogicalData( i, "TABSTOP", "N" ) ) == "F" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "NOTABSTOP", "N" ) == "T" ) )
   lWrap               := ( ::ReadLogicalData( i, "WRAP", "F" ) == "T" )
   lReadOnly           := ( ::ReadLogicalData( i, "READONLY", "F" ) == "T" )
   cIncrement          := ::ReadStringData( i, "INCREMENT", "" )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   lNoBorder           := ( ::ReadLogicalData( i, "NOBORDER", "F" ) == "T" )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   lBoundText          := ( ::ReadLogicalData( i, "BOUNDTEXT", "F" ) == "T" )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCue                := ::ReadStringData( i, "CUEBANNER", "" )
   cCue                := ::ReadStringData( i, "PLACEHOLDER", cCue )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_SPINNER ]
   ::aCObj[i]          := cObj
   ::aRange[i]         := cRange
   ::aValue[i]         := cValue
   ::aFontName[i]      := cFontName
   ::aFontNameFrm[i]   := uFontName
   ::aFontSize[i]      := nFontSize
   ::aFontSizeFrm[i]   := uFontSize
   ::aFontBold[i]      := lBold
   ::aFontItalic[i]    := lItalic
   ::aFontUnderline[i] := lUnderLine
   ::aFontStrikeout[i] := lStrikeout
   ::aToolTip[i]       := cToolTip
   ::aBackColor[i]     := aBackColor
   ::aFontColor[i]     := aFontColor
   ::aOnGotFocus[i]    := cOnGotfocus
   ::aOnChange[i]      := cOnChange
   ::aOnLostFocus[i]   := cOnLostfocus
   ::aHelpID[i]        := cHelpId
   ::aInvisible[i]     := ! lVisible
   ::aNoTabStop[i]     := lNoTabStop
   ::aWrap[i]          := lWrap
   ::aReadOnly[i]      := lReadOnly
   ::aIncrement[i]     := cIncrement
   ::aRTL[i]           := lRTL
   ::aNoBorder[i]      := lNoBorder
   ::aDisabled[i]      := ! lEnabled
   ::aBoundText[i]     := lBoundText
   ::aSubClass[i]      := cSubClass
   ::aCue[i]           := cCue
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pTab( i ) CLASS TFormEditor

   LOCAL cAction, cCargo, cFontName, cItemSize, cMinWidth, cObj, cOnChange, cOnRClick, cPadding, cParent, cPCargo, cPCaption
   LOCAL cPImage, cPName, cPObj, cPSub, cPTTip, cSubClass, cToolTip, cVal, cValue, j, k, lBold, lBottom, lButtons, lCont
   LOCAL lDelay, lEnabled, lFixedWidth, lFlat, lHotTrack, lIconLeft, lInternals, lItalic, lLabelLeft, lMultiLine, lNoTabStop
   LOCAL lRagRight, lRight, lRightJust, lRTL, lScrollOp, lStrikeout, lUnderline, lVertical, lVisible, nCol, nFontSize, nHeight
   LOCAL nLevel, nRow, nWidth, oCtrl, uFontName, uFontSize

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", "0" ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", "0" ) )
   cValue              := ::ReadStringData( i, "VALUE", "" )
   uFontName           := ::ReadStringData( i, "FONT", "" )
   uFontName           := ::ReadStringData( i, "FONTNAME", uFontName )
   uFontName           := ::ReadOopData( i, "FONTNAME", uFontName )
   cFontName           := ::StrToValueCtrl( uFontName, "C", "" )
   uFontSize           := ::ReadStringData( i, "SIZE", "" )
   uFontSize           := ::ReadStringData( i, "FONTSIZE", uFontSize )
   uFontSize           := ::ReadOopData( i, "FONTSIZE", uFontSize )
   nFontSize           := ::StrToValueCtrl( uFontSize, "N", 0, 1, 9999 )
   lBold               := ( ::ReadLogicalData( i, "BOLD", "F" ) == "T" )
   lBold               := ( ::ReadLogicalData( i, "FONTBOLD", iif( lBold, "T", "F" ) ) == "T" )
   lBold               := ( Upper( ::ReadOopData( i, "FONTBOLD", iif( lBold, ".T.", ".F." ) ) ) == ".T." )
   lItalic             := ( ::ReadLogicalData( i, "ITALIC", "F" ) == "T" )
   lItalic             := ( ::ReadLogicalData( i, "FONTITALIC", iif( lItalic, "T", "F" ) ) == "T" )
   lItalic             := ( Upper( ::ReadOopData( i, "FONTITALIC", iif( lItalic, ".T.", ".F." ) ) ) == ".T." )
   lUnderline          := ( ::ReadLogicalData( i, "UNDERLINE", "F" ) == "T" )
   lUnderline          := ( ::ReadLogicalData( i, "FONTUNDERLINE", iif( lUnderline, "T", "F" ) ) == "T" )
   lUnderline          := ( Upper( ::ReadOopData( i, "FONTUNDERLINE", iif( lUnderline, ".T.", ".F." ) ) ) == ".T." )
   lStrikeout          := ( ::ReadLogicalData( i, "STRIKEOUT", "F" ) == "T" )
   lStrikeout          := ( ::ReadLogicalData( i, "FONTSTRIKEOUT", iif( lStrikeout, "T", "F" ) ) == "T" )
   lStrikeout          := ( Upper( ::ReadOopData( i, "FONTSTRIKEOUT", iif( lStrikeout, ".T.", ".F." ) ) ) == ".T." )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   lButtons            := ( ::ReadLogicalData( i, "BUTTONS", "F" ) == "T" )
   lFlat               := ( ::ReadLogicalData( i, "FLAT", "F" ) == "T" )
   lHotTrack           := ( ::ReadLogicalData( i, "HOTTRACK", "F" ) == "T" )
   lVertical           := ( ::ReadLogicalData( i, "VERTICAL", "F" ) == "T" )
   lVertical           := ( ::ReadLogicalData( i, "LEFT", iif( lVertical, "T", "F" ) ) == "T" )
   cAction             := ::ReadStringData( i, "ACTION", "" )
   cAction             := ::ReadStringData( i, "ON CLICK", cAction )
   cAction             := ::ReadStringData( i, "ONCLICK", cAction )
   cOnRClick           := ::ReadStringData( i, "ON RCLICK", "" )
   cOnRClick           := ::ReadStringData( i, "ONRCLICK", cOnRClick )
   cOnChange           := ::ReadStringData( i, "ON CHANGE", "" )
   cOnChange           := ::ReadStringData( i, "ONCHANGE", cOnChange )
   lNoTabStop          := ( ( cVal := ::ReadLogicalData( i, "TABSTOP", "N" ) ) == "F" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "NOTABSTOP", "N" ) == "T" ) )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   lInternals          := ( ::ReadLogicalData( i, "INTERNALS", "F" ) == "T" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   lMultiLine          := ( ::ReadLogicalData( i, "MULTILINE", "F" ) == "T" )
   lDelay              := ( ::ReadLogicalData( i, "DELAYMSGS", "F" ) == "T" )
   lRight              := ( ::ReadLogicalData( i, "RIGHT", "F" ) == "T" )
   lBottom             := ( ::ReadLogicalData( i, "BOTTOM", "F" ) == "T" )
   lRagRight           := ( ::ReadLogicalData( i, "RAGGEDRIGHT", "F" ) == "T" )
   lFixedWidth         := ( ::ReadLogicalData( i, "FIXEDWIDTH", "F" ) == "T" )
   cItemSize           := ::ReadStringData( i, "ITEMSIZE", "" )
   cMinWidth           := ::ReadStringData( i, "MINWIDTH", "" )
   cPadding            := ::ReadStringData( i, "PADDING", "" )
   lIconLeft           := ( ::ReadLogicalData( i, "ICONLEFT", "F" ) == "T" )
   lLabelLeft          := ( ::ReadLogicalData( i, "LABELLEFT", "F" ) == "T" )
   lRightJust          := ( ::ReadLogicalData( i, "RIGHTJUST", "F" ) == "T" )
   lScrollOp           := ( ::ReadLogicalData( i, "SCROLLOP", "F" ) == "T" )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_TAB ]
   ::aCObj[i]          := cObj
   ::aValue[i]         := cValue
   ::aFontName[i]      := cFontName
   ::aFontNameFrm[i]   := uFontName
   ::aFontSize[i]      := nFontSize
   ::aFontSizeFrm[i]   := uFontSize
   ::aFontBold[i]      := lBold
   ::aFontItalic[i]    := lItalic
   ::aFontUnderline[i] := lUnderline
   ::aFontStrikeout[i] := lStrikeout
   ::aToolTip[i]       := cToolTip
   ::aButtons[i]       := lButtons
   ::aFlat[i]          := lFlat
   ::aHotTrack[i]      := lHotTrack
   ::aVertical[i]      := lVertical
   ::aAction[i]        := cAction
   ::aOnRClick[i]      := cOnRClick
   ::aOnChange[i]      := cOnChange
   ::aNoTabStop[i]     := lNoTabStop
   ::aRTL[i]           := lRTL
   ::aSubClass[i]      := cSubClass
   ::aInternals[i]     := lInternals
   ::aInvisible[i]     := ! lVisible
   ::aDisabled[i]      := ! lEnabled
   ::aMultiLine[i]     := lMultiLine
   ::aDelayMsgs[i]     := lDelay
   ::aRightAlign[i]    := lRight
   ::aBottomAlign[i]   := lBottom
   ::aRaggedRight[i]   := lRagRight
   ::aFixedWidths[i]   := lFixedWidth
   ::aItemSize[i]      := cItemSize
   ::aMinWidth[i]      := cMinWidth
   ::aPadding[i]       := cPadding
   ::aIconLeft[i]      := lIconLeft
   ::aLabelLeft[i]     := lLabelLeft
   ::aRightJust[i]     := lRightJust
   ::aScrollOp[i]      := lScrollOp
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Load pages */
   ::aCaption[i]       := {}
   ::aImage[i]         := {}
   ::aPageCargos[i]    := {}
   ::aPageNames[i]     := {}
   ::aPageObjs[i]      := {}
   ::aPageSubClass[i]  := {}
   ::aPageToolTips[i]  := {}

   /* find start and end lines */
   IF ( j := AScan( ::aTabs, { |tabdata| tabdata[1] == Lower( ::aName[i] ) } ) ) > 0
      k := ::aTabs[j, 3]                /* END TAB */
      j := ::aTabs[j, 2]                /* DEFINE TAB or *****@ row, col TAB ; */
      IF Left( ::aLine[j], 8 ) == " *****@ " .AND. At( " TAB ", ::aLine[j] ) # 0
         j ++
      ENDIF
   ELSE
      k := j := Len( ::aLine )          /* Assume empty TAB */
   ENDIF
   j ++
   /* process lines */
   DO WHILE j <= Len( ::aLine ) .AND. j < k
      IF At( " DEFINE TAB ", Upper( ::aLine[j] ) ) # 0
         /* nested tab */
         nLevel := 1
         j ++
         DO WHILE j <= Len( ::aLine ) .AND. j < k .AND. nLevel > 0
            IF At( " END TAB ", Upper( ::aLine[j] ) ) # 0
               nLevel --
            ELSEIF At( " DEFINE TAB ", Upper( ::aLine[j] ) ) # 0
               nLevel ++
            ENDIF
            j ++
         ENDDO
         j ++
         IF j > Len( ::aLine ) .OR. j >= k
            MsgStop( i18n( "Form has a DEFINE TAB without matching END TAB." ), "OOHG IDE+" )
            EXIT
         ENDIF
      ELSEIF At( " DEFINE PAGE ", Upper( ::aLine[j] ) ) == 1
         /* caption clause */
         cPCaption := AllTrim( SubStr( ::aLine[j], 14 ) )
         IF Right( cPCaption, 1 ) == ";"
            cPCaption := AllTrim( SubStr( cPCaption, 1, Len( cPCaption ) - 1 ) )
            lCont := .T.
         ELSE
            lCont := .F.
         ENDIF
         j ++
         /* other clauses */
         cPImage := ""
         cPName  := ""
         cPObj   := ""
         cPSub   := ""
         cPTTip  := ""
         cPCargo := ""
         DO WHILE j <= Len( ::aLine ) .AND. lCont
            DO CASE
            CASE At( " IMAGE ", Upper( ::aLine[j] ) ) == 1
               cPImage := AllTrim( SubStr( ::aLine[j], 8) )
               IF Right( cPImage, 1 ) == ";"
                  cPImage := RTrim( SubStr( cPImage, 1, Len( cPImage ) - 1 ) )
               ELSE
                  lCont := .F.
               ENDIF
            CASE At( " NAME ", Upper( ::aLine[j] ) ) == 1
               cPName := AllTrim( SubStr( ::aLine[j], 7 ) )
               IF Right( cPName, 1 ) == ";"
                  cPName := RTrim( SubStr( cPName, 1, Len( cPName ) - 1 ) )
               ELSE
                  lCont := .F.
               ENDIF
            CASE At( " OBJ ", Upper( ::aLine[j] ) ) == 1
               cPObj := AllTrim( SubStr( ::aLine[j], 6 ) )
               IF Right( cPObj, 1 ) == ";"
                  cPObj := RTrim( SubStr( cPObj, 1, Len( cPObj ) - 1 ) )
               ELSE
                  lCont := .F.
               ENDIF
            CASE At( " SUBCLASS ", Upper( ::aLine[j] ) ) == 1
               cPSub := AllTrim( SubStr( ::aLine[j], 11 ) )
               IF Right( cPSub, 1 ) == ";"
                  cPSub := RTrim( SubStr( cPSub, 1, Len( cPSub ) - 1 ) )
               ELSE
                  lCont := .F.
               ENDIF
            CASE At( " TOOLTIP ", Upper( ::aLine[j] ) ) == 1
               cPTTip := AllTrim( SubStr( ::aLine[j], 10 ) )
               IF Right( cPTTip, 1 ) == ";"
                  cPTTip := RTrim( SubStr( cPTTip, 1, Len( cPTTip ) - 1 ) )
               ELSE
                  lCont := .F.
               ENDIF
            CASE At( " CARGO ", Upper( ::aLine[j] ) ) == 1
               cPCargo := AllTrim( SubStr( ::aLine[j], 8 ) )
               IF Right( cPCargo, 1 ) == ";"
                  cPCargo := RTrim( SubStr( cPCargo, 1, Len( cPCargo ) - 1 ) )
               ELSE
                  lCont := .F.
               ENDIF
            OTHERWISE
               lCont := .F.
            ENDCASE
            j ++
         ENDDO
         /* save page properties */
         IF ! Empty( cPCaption )
            AAdd( ::aCaption[i], cPCaption )
            AAdd( ::aImage[i], cPImage )
            AAdd( ::aPageNames[i], cPName )
            AAdd( ::aPageObjs[i], cPObj )
            AAdd( ::aPageSubClass[i], cPSub )
            AAdd( ::aPageToolTips[i], cPTTip )
            AAdd( ::aPageCargos[i], cPCargo )
         ENDIF
      ELSE
         j ++
      ENDIF
   ENDDO

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pTextArray( i ) CLASS TFormEditor

   LOCAL aBackColor, aFontColor, cAction, cCargo, cColCount, cFontName, cHelpID, cObj, cOnGotFocus, cOnLostFocus, cParent, cRowCount
   LOCAL cSubClass, cToolTip, cVal, cValue, lBold, lBorder, lClientEdge, lEnabled, lItalic, lNoTabStop, lRTL, lStrikeout, lUnderline
   LOCAL lVisible, nCol, nFontSize, nHeight, nRow, nWidth, oCtrl, uFontName, uFontSize

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   cAction             := ::ReadStringData( i, "ACTION", "" )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( TText():nWidth ) ) ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( TText():nHeight ) ) ) )
   cRowCount           := ::ReadStringData( i, "ROWCOUNT", "" )
   cColCount           := ::ReadStringData( i, "COLCOUNT", "" )
   uFontName           := ::ReadStringData( i, "FONT", "" )
   uFontName           := ::ReadStringData( i, "FONTNAME", uFontName )
   uFontName           := ::ReadOopData( i, "FONTNAME", uFontName )
   cFontName           := ::StrToValueCtrl( uFontName, "C", "" )
   uFontSize           := ::ReadStringData( i, "SIZE", "" )
   uFontSize           := ::ReadStringData( i, "FONTSIZE", uFontSize )
   uFontSize           := ::ReadOopData( i, "FONTSIZE", uFontSize )
   nFontSize           := ::StrToValueCtrl( uFontSize, "N", 0, 1, 9999 )
   lBold               := ( ::ReadLogicalData( i, "BOLD", "F" ) == "T" )
   lBold               := ( ::ReadLogicalData( i, "FONTBOLD", iif( lBold, "T", "F" ) ) == "T" )
   lBold               := ( Upper( ::ReadOopData( i, "FONTBOLD", iif( lBold, ".T.", ".F." ) ) ) == ".T." )
   lItalic             := ( ::ReadLogicalData( i, "ITALIC", "F" ) == "T" )
   lItalic             := ( ::ReadLogicalData( i, "FONTITALIC", iif( lItalic, "T", "F" ) ) == "T" )
   lItalic             := ( Upper( ::ReadOopData( i, "FONTITALIC", iif( lItalic, ".T.", ".F." ) ) ) == ".T." )
   lUnderline          := ( ::ReadLogicalData( i, "UNDERLINE", "F" ) == "T" )
   lUnderline          := ( ::ReadLogicalData( i, "FONTUNDERLINE", iif( lUnderline, "T", "F" ) ) == "T" )
   lUnderline          := ( Upper( ::ReadOopData( i, "FONTUNDERLINE", iif( lUnderline, ".T.", ".F." ) ) ) == ".T." )
   lStrikeout          := ( ::ReadLogicalData( i, "STRIKEOUT", "F" ) == "T" )
   lStrikeout          := ( ::ReadLogicalData( i, "FONTSTRIKEOUT", iif( lStrikeout, "T", "F" ) ) == "T" )
   lStrikeout          := ( Upper( ::ReadOopData( i, "FONTSTRIKEOUT", iif( lStrikeout, ".T.", ".F." ) ) ) == ".T." )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   aFontColor          := ::ReadStringData( i, "FONTCOLOR", "NIL" )
   aFontColor          := UpperNIL( ::ReadOopData( i, "FONTCOLOR", aFontColor ) )
   lBorder             := ( ::ReadLogicalData( i, "BORDER", "F" ) == "T" )
   lClientEdge         := ( ::ReadLogicalData( i, "CLIENTEDGE", "F") == "T" )
   cHelpID             := ::ReadStringData( i, "HELPID", "" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   cValue              := ::ReadStringData( i, "VALUE", "" )
   lNoTabStop          := ( ( cVal := ::ReadLogicalData( i, "TABSTOP", "N" ) ) == "F" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "NOTABSTOP", "N" ) == "T" ) )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   cOnGotFocus         := ::ReadStringData( i, "ON GOTFOCUS", "" )
   cOnGotFocus         := ::ReadStringData( i, "ONGOTFOCUS", cOnGotFocus )
   cOnLostFocus        := ::ReadStringData( i, "ON LOSTFOCUS", "" )
   cOnLostFocus        := ::ReadStringData( i, "ONLOSTFOCUS", cOnLostFocus )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_TEXTARRAY ]
   ::aCObj[i]          := cObj
   ::aAction[i]        := cAction
   ::aRowCount[i]      := cRowCount
   ::aColCount[i]      := cColCount
   ::aFontName[i]      := cFontName
   ::aFontNameFrm[i]   := uFontName
   ::aFontSize[i]      := nFontSize
   ::aFontSizeFrm[i]   := uFontSize
   ::aFontBold[i]      := lBold
   ::aFontItalic[i]    := lItalic
   ::aFontUnderline[i] := lUnderline
   ::aFontStrikeout[i] := lStrikeout
   ::aToolTip[i]       := cToolTip
   ::aBackColor[i]     := aBackColor
   ::aFontColor[i]     := aFontColor
   ::aBorder[i]        := lBorder
   ::aClientEdge[i]    := lClientEdge
   ::aHelpID[i]        := cHelpId
   ::aInvisible[i]     := ! lVisible
   ::aRTL[i]           := lRTL
   ::aSubClass[i]      := cSubClass
   ::aValue[i]         := cValue
   ::aNoTabStop[i]     := lNoTabStop
   ::aDisabled[i]      := ! lEnabled
   ::aOnGotFocus[i]    := cOnGotfocus
   ::aOnLostFocus[i]   := cOnLostfocus
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pTextBox( i ) CLASS TFormEditor

   LOCAL aBackColor, aFontColor, cAction1, cAction2, cButtonWidth, cCargo, cCue, cDefaultYear, cField, cFocusedPos, cFontName
   LOCAL cFormat, cHelpID, cImage, cInputMask, cInsertType, cMaxLength, cObj, cOnChange, cOnEnter, cOnGotFocus, cOnLostFocus
   LOCAL cOnTextFill, cParent, cSubClass, cToolTip, cToolTipA1, cToolTipA2, cVal, cValid, cValue, cWhen, lAutoSkip, lBold
   LOCAL lCenterAlign, lCtrlsLeft, lDate, lEnabled, lItalic, lLowerCase, lNoBorder, lNoContext, lNoTabStop, lNumeric, lPassword
   LOCAL lReadonly, lRightAlign, lRTL, lStrikeout, lUnderline, lUpperCase, lVisible, nCol, nFontSize, nHeight, nLinC, nLin1, nLin2
   LOCAL nRow, nWidth, oCtrl, uFontName, uFontSize

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( TText():nHeight ) ) ) )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( TText():nWidth ) ) ) )
   cField              := ::ReadStringData( i, "FIELD", "" )
   cValue              := ::ReadStringData( i, "VALUE", "" )
   lReadonly           := ( ::ReadLogicalData( i, "READONLY", "F" ) == "T" )
   uFontName           := ::ReadStringData( i, "FONT", "" )
   uFontName           := ::ReadStringData( i, "FONTNAME", uFontName )
   uFontName           := ::ReadOopData( i, "FONTNAME", uFontName )
   cFontName           := ::StrToValueCtrl( uFontName, "C", "" )
   uFontSize           := ::ReadStringData( i, "SIZE", "" )
   uFontSize           := ::ReadStringData( i, "FONTSIZE", uFontSize )
   uFontSize           := ::ReadOopData( i, "FONTSIZE", uFontSize )
   nFontSize           := ::StrToValueCtrl( uFontSize, "N", 0, 1, 9999 )
   lBold               := ( ::ReadLogicalData( i, "BOLD", "F" ) == "T" )
   lBold               := ( ::ReadLogicalData( i, "FONTBOLD", iif( lBold, "T", "F" ) ) == "T" )
   lBold               := ( Upper( ::ReadOopData( i, "FONTBOLD", iif( lBold, ".T.", ".F." ) ) ) == ".T." )
   lItalic             := ( ::ReadLogicalData( i, "ITALIC", "F" ) == "T" )
   lItalic             := ( ::ReadLogicalData( i, "FONTITALIC", iif( lItalic, "T", "F" ) ) == "T" )
   lItalic             := ( Upper( ::ReadOopData( i, "FONTITALIC", iif( lItalic, ".T.", ".F." ) ) ) == ".T." )
   lUnderline          := ( ::ReadLogicalData( i, "UNDERLINE", "F" ) == "T" )
   lUnderline          := ( ::ReadLogicalData( i, "FONTUNDERLINE", iif( lUnderline, "T", "F" ) ) == "T" )
   lUnderline          := ( Upper( ::ReadOopData( i, "FONTUNDERLINE", iif( lUnderline, ".T.", ".F." ) ) ) == ".T." )
   lStrikeout          := ( ::ReadLogicalData( i, "STRIKEOUT", "F" ) == "T" )
   lStrikeout          := ( ::ReadLogicalData( i, "FONTSTRIKEOUT", iif( lStrikeout, "T", "F" ) ) == "T" )
   lStrikeout          := ( Upper( ::ReadOopData( i, "FONTSTRIKEOUT", iif( lStrikeout, ".T.", ".F." ) ) ) == ".T." )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   aFontColor          := ::ReadStringData( i, "FONTCOLOR", "NIL" )
   aFontColor          := UpperNIL( ::ReadOopData( i, "FONTCOLOR", aFontColor ) )
   cMaxLength          := ::ReadStringData( i, "MAXLENGTH", "" )
   lUpperCase          := ( ::ReadLogicalData( i, "UPPERCASE", "F" ) == "T" )
   lLowerCase          := ( ::ReadLogicalData( i, "LOWERCASE", "F" ) == "T" )
   lPassword           := ( ::ReadLogicalData( i, "PASSWORD", "F" ) == "T" )
   cOnChange           := ::ReadStringData( i, "ON CHANGE", "" )
   cOnChange           := ::ReadStringData( i, "ONCHANGE", cOnChange )
   cOnGotFocus         := ::ReadStringData( i, "ON GOTFOCUS", "" )
   cOnGotFocus         := ::ReadStringData( i, "ONGOTFOCUS", cOnGotFocus )
   cOnLostFocus        := ::ReadStringData( i, "ON LOSTFOCUS", "" )
   cOnLostFocus        := ::ReadStringData( i, "ONLOSTFOCUS", cOnLostFocus )
   cOnTextFill         := ::ReadStringData( i, "ON TEXTFILLED", "" )
   cOnTextFill         := ::ReadStringData( i, "ONTEXTFILLED", cOnTextFill )
   cOnEnter            := ::ReadStringData( i, "ON ENTER", "" )
   cOnEnter            := ::ReadStringData( i, "ONENTER", cOnEnter )
   cCue                := ::ReadStringData( i, "CUEBANNER", "" )
   cCue                := ::ReadStringData( i, "PLACEHOLDER", cCue )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )
   lRightAlign         := ( ::ReadLogicalData( i, "RIGHTALIGN", "F" ) == "T" )
   lCenterAlign        := ( ::ReadLogicalData( i, "CENTERALIGN", "F" ) == "T" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lNoTabStop          := ( ( cVal := ::ReadLogicalData( i, "TABSTOP", "N" ) ) == "F" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "NOTABSTOP", "N" ) == "T" ) )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   cHelpID             := ::ReadStringData( i, "HELPID", "" )
   lAutoSkip           :=  ( ::ReadLogicalData( i, "AUTOSKIP", "F" ) == "T" )
   lNoBorder           := ( ::ReadLogicalData( i, "NOBORDER", "F" ) == "T" )
   cFocusedPos         := ::ReadStringData( i, "FOCUSEDPOS", "" )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   cValid              := ::ReadStringData( i, "VALID", "" )
   lDate               := ( ::ReadLogicalData( i, "DATE", "F" ) == "T" )
   cDefaultYear        := ::ReadStringData( i, "DEFAULTYEAR", "" )
   lNumeric            := ( ::ReadLogicalData( i, "NUMERIC", "F" ) == "T" )
   cInputMask          := ::ReadStringData( i, "INPUTMASK", "" )
   cInputMask          := ::ReadStringData( i, "PICTURE", cInputMask )
   cFormat             := ::ReadStringData( i, "FORMAT", "" )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   cImage              := ::ReadStringData( i, "IMAGE", "" )
   cButtonWidth        := ::ReadStringData( i, "BUTTONWIDTH", "" )
   cWhen               := ::ReadStringData( i, "WHEN", "" )
   cInsertType         := ::ReadStringData( i, "INSERTTYPE", "" )
   lCtrlsLeft          := ( ::ReadLogicalData( i, "CTRLSATLEFT", "F" ) == "T" )
   lNoContext          := ( ::ReadLogicalData( i, "NOCONTEXTMENU", "F" ) == "T" )
   IF lUpperCase
      cValue := Upper( cValue )
      lLowerCase := .F.
   ELSEIF lLowerCase
      cValue := Lower( cValue )
   ENDIF
   IF lDate .OR. ! Empty( cInputMask )
      cMaxLength := ""
   ENDIF
   nLin1 := 0
   cAction1            := ::ReadStringData( i, "ACTION", "", @nLin1 )
   IF nLin1 > 0
      cToolTipA1       := ::ReadStringData( i, "TOOLTIP", "", @nLin1, 1 )
   ELSE
      cToolTipA1       := ""
   ENDIF
   nLin2 := 0
   cAction2            := ::ReadStringData( i, "ACTION2", "", @nLin2 )
   IF nLin2 > 0
      cToolTipA2       := ::ReadStringData( i, "TOOLTIP", "", @nLin2, 1 )
   ELSE
      cToolTipA2       := ""
   ENDIF
   nLinC := 0
   DO WHILE .T.
      cToolTip         := ::ReadStringData( i, "TOOLTIP", "", @nLinC )
      IF nLinC <= 0 .OR. ( nLinC # nLin1 .AND. nLinC # nLin2 )
         EXIT
      ENDIF
   ENDDO

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_TEXTBOX ]
   ::aCObj[i]          := cObj
   ::aField[i]         := cField
   ::aValue[i]         := cValue
   ::aReadOnly[i]      := lReadonly
   ::aFontName[i]      := cFontName
   ::aFontNameFrm[i]   := uFontName
   ::aFontSize[i]      := nFontSize
   ::aFontSizeFrm[i]   := uFontSize
   ::aFontBold[i]      := lBold
   ::aFontItalic[i]    := lItalic
   ::aFontUnderline[i] := lUnderline
   ::aFontStrikeout[i] := lStrikeout
   ::aToolTip[i]       := cToolTip
   ::aBackColor[i]     := aBackColor
   ::aFontColor[i]     := aFontColor
   ::aMaxLength[i]     := cMaxLength
   ::aUpperCase[i]     := lUpperCase
   ::aLowerCase[i]     := lLowerCase
   ::aPassword[i]      := lPassword
   ::aOnChange[i]      := cOnChange
   ::aOnGotFocus[i]    := cOnGotFocus
   ::aOnLostFocus[i]   := cOnLostFocus
   ::aOnTextFilled[i]  := cOnTextFill
   ::aOnEnter[i]       := cOnEnter
   ::aRightAlign[i]    := lRightAlign
   ::aCenterAlign[i]   := lCenterAlign
   ::aInvisible[i]     := ! lVisible
   ::aNoTabStop[i]     := lNoTabStop
   ::aRTL[i]           := lRTL
   ::aHelpID[i]        := cHelpId
   ::aAutoSkip[i]      := lAutoSkip
   ::aNoBorder[i]      := lNoBorder
   ::aFocusedPos[i]    := cFocusedPos
   ::aDisabled[i]      := ! lEnabled
   ::aValid[i]         := cValid
   ::aDate[i]          := lDate
   ::aDefaultYear[i]   := cDefaultYear
   ::aNumeric[i]       := lNumeric
   ::aInputMask[i]     := cInputMask
   ::aFormat[i]        := cFormat
   ::aSubClass[i]      := cSubClass
   ::aAction[i]        := cAction1
   ::aToolTipAct1[i]   := cToolTipA1
   ::aAction2[i]       := cAction2
   ::aToolTipAct2[i]   := cToolTipA2
   ::aImage[i]         := cImage
   ::aButtonWidth[i]   := cButtonWidth
   ::aWhen[i]          := cWhen
   ::aInsertType[i]    := cInsertType
   ::aCtrlsLeft[i]     := lCtrlsLeft
   ::aNoContext[i]     := lNoContext
   ::aCue[i]           := cCue
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pTimePicker( i ) CLASS TFormEditor

   LOCAL cCargo, cField, cFontName, cFormat, cHelpID, cObj, cOnChange, cOnEnter, cOnGotFocus, cOnLostFocus, cParent, cSubClass
   LOCAL cToolTip, cVal, cValid, cValue, lBold, lEnabled, lItalic, lNoBorder, lNoTabStop, lRTL, lShowNone
   LOCAL lStrikeout, lUnderline, lVisible, nCol, nFontSize, nHeight, nRow, nWidth, oCtrl, uFontName, uFontSize

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   cValue              := ::ReadStringData( i, "VALUE", "" )
   cField              := ::ReadStringData( i, "FIELD", "" )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( TDatePick():nWidth ) ) ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( TDatePick():nHeight ) ) ) )
   uFontName           := ::ReadStringData( i, "FONT", "" )
   uFontName           := ::ReadStringData( i, "FONTNAME", uFontName )
   uFontName           := ::ReadOopData( i, "FONTNAME", uFontName )
   cFontName           := ::StrToValueCtrl( uFontName, "C", "" )
   uFontSize           := ::ReadStringData( i, "SIZE", "" )
   uFontSize           := ::ReadStringData( i, "FONTSIZE", uFontSize )
   uFontSize           := ::ReadOopData( i, "FONTSIZE", uFontSize )
   nFontSize           := ::StrToValueCtrl( uFontSize, "N", 0, 1, 9999 )
   lBold               := ( ::ReadLogicalData( i, "BOLD", "F" ) == "T" )
   lBold               := ( ::ReadLogicalData( i, "FONTBOLD", iif( lBold, "T", "F" ) ) == "T" )
   lBold               := ( Upper( ::ReadOopData( i, "FONTBOLD", iif( lBold, ".T.", ".F." ) ) ) == ".T." )
   lItalic             := ( ::ReadLogicalData( i, "ITALIC", "F" ) == "T" )
   lItalic             := ( ::ReadLogicalData( i, "FONTITALIC", iif( lItalic, "T", "F" ) ) == "T" )
   lItalic             := ( Upper( ::ReadOopData( i, "FONTITALIC", iif( lItalic, ".T.", ".F." ) ) ) == ".T." )
   lUnderline          := ( ::ReadLogicalData( i, "UNDERLINE", "F" ) == "T" )
   lUnderline          := ( ::ReadLogicalData( i, "FONTUNDERLINE", iif( lUnderline, "T", "F" ) ) == "T" )
   lUnderline          := ( Upper( ::ReadOopData( i, "FONTUNDERLINE", iif( lUnderline, ".T.", ".F." ) ) ) == ".T." )
   lStrikeout          := ( ::ReadLogicalData( i, "STRIKEOUT", "F" ) == "T" )
   lStrikeout          := ( ::ReadLogicalData( i, "FONTSTRIKEOUT", iif( lStrikeout, "T", "F" ) ) == "T" )
   lStrikeout          := ( Upper( ::ReadOopData( i, "FONTSTRIKEOUT", iif( lStrikeout, ".T.", ".F." ) ) ) == ".T." )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   lShowNone           := ( ::ReadLogicalData( i, "SHOWNONE", "F" ) == "T" )
   cOnGotFocus         := ::ReadStringData( i, "ON GOTFOCUS", "" )
   cOnGotFocus         := ::ReadStringData( i, "ONGOTFOCUS", cOnGotFocus )
   cOnChange           := ::ReadStringData( i, "ON CHANGE", "" )
   cOnChange           := ::ReadStringData( i, "ONCHANGE", cOnChange )
   cOnLostFocus        := ::ReadStringData( i, "ON LOSTFOCUS", "" )
   cOnLostFocus        := ::ReadStringData( i, "ONLOSTFOCUS", cOnLostFocus )
   cOnEnter            := ::ReadStringData( i, "ON ENTER", "" )
   cOnEnter            := ::ReadStringData( i, "ONENTER", cOnEnter )
   cHelpID             := ::ReadStringData( i, "HELPID", "" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lNoTabStop          := ( ( cVal := ::ReadLogicalData( i, "TABSTOP", "N" ) ) == "F" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "NOTABSTOP", "N" ) == "T" ) )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   lNoBorder           := ( ::ReadLogicalData( i, "NOBORDER", "F" ) == "T" )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   cFormat             := ::ReadStringData( i, "TIMEFORMAT", "" )
   cValid              := ::ReadStringData( i, "VALID", "" )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_TIMEPICKER ]
   ::aCObj[i]          := cObj
   ::aValue[i]         := cValue
   ::aField[i]         := cField
   ::aFontName[i]      := cFontName
   ::aFontNameFrm[i]   := uFontName
   ::aFontSize[i]      := nFontSize
   ::aFontSizeFrm[i]   := uFontSize
   ::aFontBold[i]      := lBold
   ::aFontItalic[i]    := lItalic
   ::aFontUnderline[i] := lUnderline
   ::aFontStrikeout[i] := lStrikeout
   ::aToolTip[i]       := cToolTip
   ::aShowNone[i]      := lShowNone
   ::aOnGotFocus[i]    := cOnGotFocus
   ::aOnChange[i]      := cOnChange
   ::aOnLostFocus[i]   := cOnLostFocus
   ::aOnEnter[i]       := cOnEnter
   ::aHelpID[i]        := cHelpID
   ::aInvisible[i]     := ! lVisible
   ::aNoTabStop[i]     := lNoTabStop
   ::aDisabled[i]      := ! lEnabled
   ::aNoBorder[i]      := lNoBorder
   ::aRTL[i]           := lRTL
   ::aSubClass[i]      := cSubClass
   ::aFormat[i]        := cFormat
   ::aValid[i]         := cValid
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pTimer( i ) CLASS TFormEditor

   LOCAL cAction, cCargo, cInterval, cObj, cParent, cSubClass, lEnabled, lOnce, nCol, nRow, oCtrl

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   cInterval           := ::ReadStringData( i, "INTERVAL", "" )
   cAction             := ::ReadStringData( i, "ACTION", "" )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   lOnce               := ( ::ReadLogicalData( i, "ONCE", "F" ) == "T" )
   lOnce               := ( Upper( ::ReadOopData( i, "ONCE", iif( lOnce, ".T.", ".F." ) ) ) == ".T." )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_TIMER ]
   ::aCObj[i]          := cObj
   ::aValue[i]         := cInterval
   ::aAction[i]        := cAction
   ::aSubClass[i]      := cSubClass
   ::aDisabled[i]      := ! lEnabled
   ::aOnce[i]          := lOnce
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, NIL, NIL, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pTree( i ) CLASS TFormEditor

   LOCAL aBackColor, aFontColor, aSelColor, aTarget, cCargo, cFontName, cHelpId, cIndent, cItemImages, cNodeimages, cObj, cOnChange
   LOCAL cOnCheckChg, cOnCollapse, cOnDblClick, cOnDrop, cOnEnter, cOnExpand, cOnGotFocus, cOnLabelEdit, cOnLostFocus, cParent
   LOCAL cSubClass, cToolTip, cVal, cValid, cValue, lBold, lBreak, lCheckBoxes, lEditLabels, lEnabled, lEnableDrag, lEnableDrop
   LOCAL lFullRowSel, lHotTrack, lItalic, lItemIds, lNoBorder, lNoButtons, lNoHScroll, lNoLines, lNoRootButton, lNoScroll
   LOCAL lNoTabStop, lOwnTT, lRedrawOnAdd, lRTL, lSelBold, lSingleExpand, lStrikeout, lUnderline, lVisible, nCol, nFontSize, nHeight
   LOCAL nRow, nWidth, oCtrl, uFontName, uFontSize

   /* Load properties */
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( TTree():nWidth ) ) ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( TTree():nHeight ) ) ) )
   cValue              := ::ReadStringData( i, "VALUE", "" )
   lFullRowSel         := ( ::ReadLogicalData( i, "FULLROWSELECT", "F" ) == "T" )
   uFontName           := ::ReadStringData( i, "FONT", "" )
   uFontName           := ::ReadStringData( i, "FONTNAME", uFontName )
   uFontName           := ::ReadOopData( i, "FONTNAME", uFontName )
   cFontName           := ::StrToValueCtrl( uFontName, "C", "" )
   uFontSize           := ::ReadStringData( i, "SIZE", "" )
   uFontSize           := ::ReadStringData( i, "FONTSIZE", uFontSize )
   uFontSize           := ::ReadOopData( i, "FONTSIZE", uFontSize )
   nFontSize           := ::StrToValueCtrl( uFontSize, "N", 0, 1, 9999 )
   lBold               := ( ::ReadLogicalData( i, "BOLD", "F" ) == "T" )
   lBold               := ( ::ReadLogicalData( i, "FONTBOLD", iif( lBold, "T", "F" ) ) == "T" )
   lBold               := ( Upper( ::ReadOopData( i, "FONTBOLD", iif( lBold, ".T.", ".F." ) ) ) == ".T." )
   lItalic             := ( ::ReadLogicalData( i, "ITALIC", "F" ) == "T" )
   lItalic             := ( ::ReadLogicalData( i, "FONTITALIC", iif( lItalic, "T", "F" ) ) == "T" )
   lItalic             := ( Upper( ::ReadOopData( i, "FONTITALIC", iif( lItalic, ".T.", ".F." ) ) ) == ".T." )
   lUnderline          := ( ::ReadLogicalData( i, "UNDERLINE", "F" ) == "T" )
   lUnderline          := ( ::ReadLogicalData( i, "FONTUNDERLINE", iif( lUnderline, "T", "F" ) ) == "T" )
   lUnderline          := ( Upper( ::ReadOopData( i, "FONTUNDERLINE", iif( lUnderline, ".T.", ".F." ) ) ) == ".T." )
   lStrikeout          := ( ::ReadLogicalData( i, "STRIKEOUT", "F" ) == "T" )
   lStrikeout          := ( ::ReadLogicalData( i, "FONTSTRIKEOUT", iif( lStrikeout, "T", "F" ) ) == "T" )
   lStrikeout          := ( Upper( ::ReadOopData( i, "FONTSTRIKEOUT", iif( lStrikeout, ".T.", ".F." ) ) ) == ".T." )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip            := ::ReadOopData( i, "TOOLTIP", cToolTip )
   lOwnTT              := ( ::ReadLogicalData( i, "OWNTOOLTIP", "F" ) == "T" )
   cOnGotFocus         := ::ReadStringData( i, "ON GOTFOCUS", "" )
   cOnGotFocus         := ::ReadStringData( i, "ONGOTFOCUS", cOnGotFocus )
   cOnChange           := ::ReadStringData( i, "ON CHANGE", "" )
   cOnChange           := ::ReadStringData( i, "ONCHANGE", cOnChange )
   cOnLostFocus        := ::ReadStringData( i, "ON LOSTFOCUS", "" )
   cOnLostFocus        := ::ReadStringData( i, "ONLOSTFOCUS", cOnLostFocus )
   cOnDblClick         := ::ReadStringData( i, "ON DBLCLICK", "" )
   cOnDblClick         := ::ReadStringData( i, "ONDBLCLICK", cOnDblClick )
   cNodeImages         := ::ReadStringData( i, "NODEIMAGES", "" )
   cItemImages         := ::ReadStringData( i, "ITEMIMAGES", "" )
   lNoRootButton       := ( ::ReadLogicalData( i, "NOROOTBUTTON", "F" ) == "T" )
   lItemIds            := ( ::ReadLogicalData( i, "ITEMIDS", "F" ) == "T" )
   cHelpId             := ::ReadStringData( i, "HELPID", "" )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   cOnEnter            := ::ReadStringData( i, "ON ENTER", "" )
   cOnEnter            := ::ReadStringData( i, "ONENTER", cOnEnter )
   lBreak              := ( ::ReadLogicalData( i, "BREAK", "F" ) == "T" )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lNoTabStop          := ( ( cVal := ::ReadLogicalData( i, "TABSTOP", "N" ) ) == "F" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "NOTABSTOP", "N" ) == "T" ) )
   aFontColor          := ::ReadStringData( i, "FONTCOLOR", "NIL" )
   aFontColor          := UpperNIL( ::ReadOopData( i, "FONTCOLOR", aFontColor ) )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   aSelColor           := UpperNIL( ::ReadStringData( i, "SELCOLOR", "NIL" ) )
   lSelBold            := ( ::ReadLogicalData( i, "SELBOLD", "F" ) == "T" )
   lCheckBoxes         := ( ::ReadLogicalData( i, "CHECKBOXES", "F" ) == "T" )
   lEditLabels         := ( ::ReadLogicalData( i, "EDITLABELS", "F" ) == "T" )
   lNoHScroll          := ( ::ReadLogicalData( i, "NOHSCROLL", "F" ) == "T" )
   lNoScroll           := ( ::ReadLogicalData( i, "NOSCROLL", "F" ) == "T" )
   lHotTrack           := ( ::ReadLogicalData( i, "HOTTRACKING", "F" ) == "T" )
   lNoButtons          := ( ::ReadLogicalData( i, "NOBUTTONS", "F" ) == "T" )
   lNoLines            := ( ::ReadLogicalData( i, "NOLINES", "F" ) == "T" )
   lEnableDrag         := ( ::ReadLogicalData( i, "ENABLEDRAG", "F" ) == "T" )
   lEnableDrop         := ( ::ReadLogicalData( i, "ENABLEDROP", "F" ) == "T" )
   lRedrawOnAdd        := ( ::ReadLogicalData( i, "REDRAWONADD", "F" ) == "T" )
   aTarget             := ::ReadStringData( i, "TARGET", "" )
   lSingleExpand       := ( ::ReadLogicalData( i, "SINGLEEXPAND", "F" ) == "T" )
   lNoBorder           := ::ReadLogicalData( i, "BORDERLESS", "F" )
   lNoBorder           := ( ::ReadLogicalData( i, "NOBORDER", lNoBorder ) == "T" )
   cOnLabelEdit        := ::ReadStringData( i, "ON LABELEDIT", "" )
   cOnLabelEdit        := ::ReadStringData( i, "ONLABELEDIT", cOnLabelEdit )
   cValid              := ::ReadStringData( i, "VALID", "" )
   cOnCheckChg         := ::ReadStringData( i, "ON CHECKCHANGE", "" )
   cOnCheckChg         := ::ReadStringData( i, "ONCHECKCHANGE", cOnCheckChg )
   cIndent             := ::ReadStringData( i, "INDENT", "" )
   cOnDrop             := ::ReadStringData( i, "ON DROP", "" )
   cOnDrop             := ::ReadStringData( i, "ONDROP", cOnDrop )
   cOnExpand           := ::ReadStringData( i, "ON EXPAND", "" )
   cOnExpand           := ::ReadStringData( i, "ONEXPAND", cOnExpand )
   cOnCollapse         := ::ReadStringData( i, "ON COLLAPSE", "" )
   cOnCollapse         := ::ReadStringData( i, "ONCOLLAPSE", cOnCollapse )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_TREE ]
   ::aCObj[i]          := cObj
   ::aValue[i]         := cValue
   ::aFullRowSelect[i] := lFullRowSel
   ::aFontName[i]      := cFontName
   ::aFontNameFrm[i]   := uFontName
   ::aFontSize[i]      := nFontSize
   ::aFontSizeFrm[i]   := uFontSize
   ::aFontBold[i]      := lBold
   ::aFontItalic[i]    := lItalic
   ::aFontUnderline[i] := lUnderline
   ::aFontStrikeout[i] := lStrikeout
   ::aToolTip[i]       := cToolTip
   ::aOwnTT[i]         := lOwnTT
   ::aOnGotFocus[i]    := cOnGotFocus
   ::aOnChange[i]      := cOnChange
   ::aOnLostFocus[i]   := cOnLostFocus
   ::aOnDblClick[i]    := cOnDblClick
   ::aNodeImages[i]    := cNodeImages
   ::aItemImages[i]    := cItemImages
   ::aNoRootButton[i]  := lNoRootButton
   ::aItemIDs[i]       := lItemIds
   ::aHelpID[i]        := cHelpId
   ::aRTL[i]           := lRTL
   ::aOnEnter[i]       := cOnEnter
   ::aBreak[i]         := lBreak
   ::aDisabled[i]      := ! lEnabled
   ::aSubClass[i]      := cSubClass
   ::aInvisible[i]     := ! lVisible
   ::aNoTabStop[i]     := lNoTabStop
   ::aFontColor[i]     := aFontColor
   ::aBackColor[i]     := aBackColor
   ::aSelColor[i]      := aSelColor
   ::aSelBold[i]       := lSelBold
   ::aCheckBoxes[i]    := lCheckBoxes
   ::aEditLabels[i]    := lEditLabels
   ::aNoHScroll[i]     := lNoHScroll
   ::aNoVScroll[i]     := lNoScroll
   ::aHotTrack[i]      := lHotTrack
   ::aNoButtons[i]     := lNoButtons
   ::aNoLines[i]       := lNoLines
   ::aDrag[i]          := lEnableDrag
   ::aDrop[i]          := lEnableDrop
   ::aRedrawOnAdd[i]   := lRedrawOnAdd
   ::aTarget[i]        := aTarget
   ::aSingleExpand[i]  := lSingleExpand
   ::aNoBorder[i]      := lNoBorder
   ::aOnLabelEdit[i]   := cOnLabelEdit
   ::aValid[i]         := cValid
   ::aOnCheckChg[i]    := cOnCheckChg
   ::aIndent[i]        := cIndent
   ::aOnDrop[i]        := cOnDrop
   ::aOnExpand[i]      := cOnExpand
   ::aOnCollapse[i]    := cOnCollapse
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD pXBrowse( i ) CLASS TFormEditor

   LOCAL aBackColor, aFontColor, aSelColor, cAction, cAfterColMove, cAfterColSize, cBeforeAutoFit, cBeforeColMove, cBeforeColSize
   LOCAL cCargo, cColControls, cColumnInfo, cDefVal, cDeleteMsg, cDeleteWhen, cDynamicBlocks, cDynamicCtrls, cDynBackColor
   LOCAL cDynForecolor, cEditCell, cEditKeys, cEditKeysFun, cFields, cFixedBlocks, cFixedCtrls, cFocusRect, cFontName, cHdrImgAlign
   LOCAL cHdrBackClrs, cHdrFontClrs, cHdrImgs, cHdrs, cHelpId, cImage, cInputMask, cJustify, cNoFocusRect, cObj, cOnAbortEdit, cOnAppend
   LOCAL cOnBfrEdtCell, cOnChange, cOnCheckChg, cOnDblClick, cOnDelete, cOnEditCell, cOnEditEnd, cOnEnter, cOnGotFocus, cOnHeadClick
   LOCAL cOnHeadDClick, cOnHeadRClick, cOnLostFocus, cOnRClick, cOnRowRefresh, cParent, cReadOnly, cReplaceField, cSubClass
   LOCAL cTimeOut, cToolTip, cVal, cValid, cValidMess, cValue, cWhen, cWidths, cWorkArea, lAppend, lBold, lBreak, lButtons, lByCell
   LOCAL lCellTT, lCheckBoxes, lDelete, lDescending, lDisableAltA, lEdit, lEditFV, lEnableAltA, lEnabled, lExtDblClick, lFixedCols
   LOCAL lFixedWidths, lFullMove, lInPlace, lItalic, lKeysLkClp, lLikeExcel, lLock, lNoDefaultMsg, lNoDeleteMsg, lNoHeaders
   LOCAL lNoHScroll, lNoLines, lNoModalEdit, lNoShow, lNoShowEmpty, lNoTabStop, lNoVScroll, lPLM, lRecCount, lRTL, lSilent
   LOCAL lSingleBuffer, lStrikeout, lUnderline, lUpdateColors, lVisible, nCol, nFontSize, nHeight, nRow, nWidth, oCtrl, uFontName
   LOCAL uFontSize

   /* Load properties */
   nRow                := Val( ::ReadCtrlRow( i ) )
   nCol                := Val( ::ReadCtrlCol( i ) )
   cObj                := ::ReadStringData( i, "OBJ", "" )
   cObj                := ::ReadStringData( i, "OBJECT", cObj )
   nWidth              := Val( ::ReadStringData( i, "WIDTH", LTrim( Str( TXBrowse():nWidth ) ) ) )
   nHeight             := Val( ::ReadStringData( i, "HEIGHT", LTrim( Str( TXBrowse():nHeight ) ) ) )
   cHdrs            := ::ReadStringData( i, "HEADERS", "{ '', '' } ")
   cWidths             := ::ReadStringData( i, "WIDTHS", "{ 100, 60 }")
   cWorkArea           := ::ReadStringData( i, "WORKAREA", "ALIAS()" )
   cFields             := ::ReadStringData( i, "FIELDS", "{ 'field1', 'field2' }" )
   cInputMask          := ::ReadStringData( i, "INPUTMASK", "")
   cValue              := ::ReadStringData( i, "VALUE", "" )
   uFontName           := ::ReadStringData( i, "FONT", "" )
   uFontName           := ::ReadStringData( i, "FONTNAME", uFontName )
   uFontName           := ::ReadOopData( i, "FONTNAME", uFontName )
   cFontName           := ::StrToValueCtrl( uFontName, "C", "" )
   uFontSize           := ::ReadStringData( i, "SIZE", "" )
   uFontSize           := ::ReadStringData( i, "FONTSIZE", uFontSize )
   uFontSize           := ::ReadOopData( i, "FONTSIZE", uFontSize )
   nFontSize           := ::StrToValueCtrl( uFontSize, "N", 0, 1, 9999 )
   lBold               := ( ::ReadLogicalData( i, "BOLD", "F" ) == "T" )
   lBold               := ( ::ReadLogicalData( i, "FONTBOLD", iif( lBold, "T", "F" ) ) == "T" )
   lBold               := ( Upper( ::ReadOopData( i, "FONTBOLD", iif( lBold, ".T.", ".F." ) ) ) == ".T." )
   lItalic             := ( ::ReadLogicalData( i, "ITALIC", "F" ) == "T" )
   lItalic             := ( ::ReadLogicalData( i, "FONTITALIC", iif( lItalic, "T", "F" ) ) == "T" )
   lItalic             := ( Upper( ::ReadOopData( i, "FONTITALIC", iif( lItalic, ".T.", ".F." ) ) ) == ".T." )
   lUnderline          := ( ::ReadLogicalData( i, "UNDERLINE", "F" ) == "T" )
   lUnderline          := ( ::ReadLogicalData( i, "FONTUNDERLINE", iif( lUnderline, "T", "F" ) ) == "T" )
   lUnderline          := ( Upper( ::ReadOopData( i, "FONTUNDERLINE", iif( lUnderline, ".T.", ".F." ) ) ) == ".T." )
   lStrikeout          := ( ::ReadLogicalData( i, "STRIKEOUT", "F" ) == "T" )
   lStrikeout          := ( ::ReadLogicalData( i, "FONTSTRIKEOUT", iif( lStrikeout, "T", "F" ) ) == "T" )
   lStrikeout          := ( Upper( ::ReadOopData( i, "FONTSTRIKEOUT", iif( lStrikeout, ".T.", ".F." ) ) ) == ".T." )
   cToolTip            := ::ReadStringData( i, "TOOLTIP", "" )
   cToolTip           := ::ReadOopData( i, "TOOLTIP", cToolTip )
   aBackColor          := ::ReadStringData( i, "BACKCOLOR", "NIL" )
   aBackColor          := UpperNIL( ::ReadOopData( i, "BACKCOLOR", aBackColor ) )
   cDynBackColor       := ::ReadStringData( i, "DYNAMICBACKCOLOR", "" )
   cDynForecolor       := ::ReadStringData( i, "DYNAMICFORECOLOR", "" )
   aFontColor          := ::ReadStringData( i, "FONTCOLOR", "NIL" )
   aFontColor          := UpperNIL( ::ReadOopData( i, "FONTCOLOR", aFontColor ) )
   cOnGotFocus         := ::ReadStringData( i, "ON GOTFOCUS", "" )
   cOnGotFocus         := ::ReadStringData( i, "ONGOTFOCUS", cOnGotFocus )
   cOnChange           := ::ReadStringData( i, "ON CHANGE", "" )
   cOnChange           := ::ReadStringData( i, "ONCHANGE", cOnChange )
   cOnLostFocus        := ::ReadStringData( i, "ON LOSTFOCUS", "" )
   cOnLostFocus        := ::ReadStringData( i, "ONLOSTFOCUS", cOnLostFocus )
   cOnDblClick         := ::ReadStringData( i, "ON DBLCLICK", "" )
   cOnDblClick         := ::ReadStringData( i, "ONDBLCLICK", cOnDblClick )
   cAction             := ::ReadStringData( i, "ACTION", "" )
   cAction             := ::ReadStringData( i, "ON CLICK",cAction )
   cAction             := ::ReadStringData( i, "ONCLICK", cAction )
   lEdit               := ( ::ReadLogicalData( i, "EDIT", "F" ) == "T" )
   lEdit               := ( ::ReadLogicalData( i, "ALLOWEDIT", iif( lEdit, "T", "F" ) ) == "T" )
   lInPlace            := ( ::ReadLogicalData( i, "INPLACE", "F" ) == "T" )
   lAppend             := ( ::ReadLogicalData( i, "APPEND", "F" ) == "T" )
   cOnHeadClick        := ::ReadStringData( i, "ON HEADCLICK", "" )
   cOnHeadClick        := ::ReadStringData( i, "ONHEADCLICK", cOnHeadClick )
   cWhen               := ::ReadStringData( i, "WHEN", "" )
   cWhen               := ::ReadStringData( i, "COLUMNWHEN", cWhen )
   cValid              := ::ReadStringData( i, "VALID", "" )
   cValid              := ::ReadStringData( i, "COLUMNVALID", cValid )
   cValidMess          := ::ReadStringData( i, "VALIDMESSAGES", "" )
   cReadOnly           := ::ReadStringData( i, "READONLY", "")
   lLock               := ( ::ReadLogicalData( i, "LOCK", "F" ) == "T" )
   lDelete             := ( ::ReadLogicalData( i, "DELETE", "F" ) == "T" )
   lNoLines            := ( ::ReadLogicalData( i, "NOLINES", "F" ) == "T" )
   cImage              := ::ReadStringData( i, "IMAGE", "" )
   cJustify            := ::ReadStringData( i, "JUSTIFY", "" )
   lNoVScroll          := ( ::ReadLogicalData( i, "NOVSCROLL", "F" ) == "T" )
   lNoVScroll          := ( ::ReadLogicalData( i, "NOVSCROLLBAR", iif( lNoVScroll, "T", "F" ) ) == "T" )
   cHelpId             := ::ReadStringData( i, "HELPID", "" )
   lBreak              := ( ::ReadLogicalData( i, "BREAK", "F" ) == "T" )
   lRTL                := ( ::ReadLogicalData( i, "RTL", "F" ) == "T" )
   cOnAppend           := ::ReadStringData( i, "ON APPEND", "" )
   cOnAppend           := ::ReadStringData( i, "ONAPPEND", cOnAppend )
   cOnEditCell         := ::ReadStringData( i, "ON EDITCELL", "" )
   cOnEditCell         := ::ReadStringData( i, "ONEDITCELL", cOnEditCell )
   cColControls        := ::ReadStringData( i, "COLUMNCONTROLS", "" )
   cReplaceField       := ::ReadStringData( i, "REPLACEFIELD", "" )
   cSubClass           := ::ReadStringData( i, "SUBCLASS", "" )
   lRecCount           := ( ::ReadLogicalData( i, "RECCOUNT", "F" ) == "T" )
   cColumnInfo         := ::ReadStringData( i, "COLUMNINFO", "" )
   lNoHeaders          := ( ( cVal := ::ReadLogicalData( i, "NOHEADERS", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "SHOWHEADERS", "N" ) == "F" ) )
   cOnEnter            := ::ReadStringData( i, "ON ENTER", "" )
   cOnEnter            := ::ReadStringData( i, "ONENTER", cOnEnter )
   lEnabled            := ( ::ReadLogicalData( i, "DISABLED", "F" ) == "F" )
   lEnabled            := ( Upper( ::ReadOopData( i, "ENABLED", iif( lEnabled, ".T.", ".F." ) ) ) == ".T." )
   lNoTabStop          := ( ( cVal := ::ReadLogicalData( i, "TABSTOP", "N" ) ) == "F" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "NOTABSTOP", "N" ) == "T" ) )
   lVisible            := ( ( cVal := ::ReadLogicalData( i, "VISIBLE", "N" ) ) == "T" ) .OR. ( cVal == "N" .AND. ( ::ReadLogicalData( i, "INVISIBLE", "N" ) $ "FN" ) )
   lVisible            := ( Upper( ::ReadOopData( i, "VISIBLE", iif( lVisible, ".T.", ".F." ) ) ) == ".T." )
   lDescending         := ( ::ReadLogicalData( i, "DESCENDING", "F" ) == "T" )
   cDeleteWhen         := ::ReadStringData( i, "DELETEWHEN", "" )
   cDeleteMsg          := ::ReadStringData( i, "DELETEMSG", "" )
   cOnDelete           := ::ReadStringData( i, "ON DELETE", "" )
   cOnDelete           := ::ReadStringData( i, "ONDELETE", cOnDelete )
   cHdrBackClrs        := ::ReadStringData( i, "HEADERBACKCOLORS", "" )
   cHdrFontClrs        := ::ReadStringData( i, "HEADERCOLORS", "" )
   cHdrFontClrs        := ::ReadStringData( i, "HEADERFONTCOLORS", cHdrFontClrs )
   cHdrImgs            := ::ReadStringData( i, "HEADERIMAGES", "" )
   cHdrImgs            := ::ReadStringData( i, "HEADERIMAGE", cHdrImgs )
   cHdrImgAlign        := ::ReadStringData( i, "IMAGESALIGN", "" )
   cHdrImgAlign        := ::ReadStringData( i, "HEADERIMAGESALIGN", cHdrImgAlign )
   lFullMove           := ( ::ReadLogicalData( i, "FULLMOVE", "F" ) == "T" )
   aSelColor           := UpperNIL( ::ReadStringData( i, "SELECTEDCOLORS", "" ) )
   cEditKeys           := ::ReadStringData( i, "EDITKEYS", "" )
   cEditKeysFun        := ::ReadStringData( i, "EDITKEYSFUN", "" )
   lSingleBuffer       := ( ::ReadLogicalData( i, "SINGLEBUFFER", "F" ) == "T" )
   cFocusRect          := ::ReadLogicalData( i, "FOCUSRECT", "F" )
   cNoFocusRect        := ::ReadLogicalData( i, "NOFOCUSRECT", "F" )
   lPLM                := ( ::ReadLogicalData( i, "PAINTLEFTMARGIN", "F" ) == "T" )
   lFixedCols          := ( ::ReadLogicalData( i, "FIXEDCOLS", "F" ) == "T" )
   cOnAbortEdit        := ::ReadStringData( i, "ON ABORTEDIT", "" )
   cOnAbortEdit        := ::ReadStringData( i, "ONABORTEDIT", cOnAbortEdit )
   lFixedWidths        := ( ::ReadLogicalData( i, "FIXEDWIDTHS", "F" ) == "T" )
   cFixedBlocks        := ::ReadLogicalData( i, "FIXEDBLOCKS", "F" )
   cDynamicBlocks      := ::ReadLogicalData( i, "DYNAMICBLOCKS", "F" )
   cBeforeColMove      := ::ReadStringData( i, "BEFORECOLMOVE", "" )
   cAfterColMove       := ::ReadStringData( i, "AFTERCOLMOVE", "" )
   cBeforeColSize      := ::ReadStringData( i, "BEFORECOLSIZE", "" )
   cAfterColSize       := ::ReadStringData( i, "AFTERCOLSIZE", "" )
   cBeforeAutoFit      := ::ReadStringData( i, "BEFOREAUTOFIT", "" )
   lLikeExcel          := ( ::ReadLogicalData( i, "EDITLIKEEXCEL", "F" ) == "T" )
   lButtons            := ( ::ReadLogicalData( i, "USEBUTTONS", "F" ) == "T" )
   lNoDefaultMsg       := ( ::ReadLogicalData( i, "NODEFAULTMSG", "F" ) == "T" )
   lNoDeleteMsg        := ( ::ReadLogicalData( i, "NODELETEMSG", "F" ) == "T" )
   cFixedCtrls         := ::ReadLogicalData( i, "FIXEDCONTROLS", "N" )
   cDynamicCtrls       := ::ReadLogicalData( i, "DYNAMICCONTROLS", "N" )
   lNoShowEmpty        := ( ::ReadLogicalData( i, "NOSHOWEMPTYROW", "F" ) == "T" )
   lUpdateColors       := ( ::ReadLogicalData( i, "UPDATECOLORS", "F" ) == "T" )
   cOnHeadDClick       := ::ReadStringData( i, "ON HEADDBLCLICK", "" )
   cOnHeadDClick       := ::ReadStringData( i, "ONHEADBLCLICK", cOnHeadDClick )
   cOnHeadRClick       := ::ReadStringData( i, "ON HEADRCLICK", "" )
   cOnHeadRClick       := ::ReadStringData( i, "ONHEADRCLICK", cOnHeadRClick )
   lNoModalEdit        := ( ::ReadLogicalData( i, "NOMODALEDIT", "F" ) == "T" )
   lByCell             := ( ::ReadLogicalData( i, "NAVIGATEBYCELL", "F" ) == "T" )
   lExtDblClick        := ( ::ReadLogicalData( i, "EXTDBLCLICK", "F" ) == "T" )
   lSilent             := ( ::ReadLogicalData( i, "SILENT", "F" ) == "T" )
   lEnableAltA         := ( ::ReadLogicalData( i, "ENABLEALTA", "F" ) == "T" )
   lDisableAltA        := ( ::ReadLogicalData( i, "DISABLEALTA", "F" ) == "T" )
   lNoShow             := ( ::ReadLogicalData( i, "NOSHOWALWAYS", "F" ) == "T" )
   cOnRClick           := ::ReadStringData( i, "ON RCLICK", "" )
   cOnRClick           := ::ReadStringData( i, "ONRCLICK", cOnRClick )
   lCheckBoxes         := ( ::ReadLogicalData( i, "CHECKBOXES", "F" ) == "T" )
   cOnCheckChg         := ::ReadStringData( i, "ON CHECKCHANGE", "" )
   cOnCheckChg         := ::ReadStringData( i, "ONCHECKCHANGE", cOnCheckChg )
   cOnRowRefresh       := ::ReadStringData( i, "ON ROWREFRESH", "" )
   cOnRowRefresh       := ::ReadStringData( i, "ONROWREFRESH", cOnRowRefresh )
   cDefVal             := ::ReadStringData( i, "DEFAULTVALUES", "")
   cOnEditEnd          := ::ReadStringData( i, "ON EDITCELLEND", "" )
   cOnEditEnd          := ::ReadStringData( i, "ONEDITCELLEND", cOnEditEnd )
   lEditFV             := ( ::ReadLogicalData( i, "EDITFIRSTVISIBLE", "F" ) == "T" )
   cOnBfrEdtCell       := ::ReadStringData( i, "ON BEFOREEDITCELL", "" )
   cOnBfrEdtCell       := ::ReadStringData( i, "ONBEFOREEDITCELL", cOnBfrEdtCell )
   cEditCell           := ::ReadStringData( i, "EDITCELLVALUE", "" )
   lKeysLkClp          := ( ::ReadLogicalData( i, "KEYSLIKECLIPPER", "F" ) == "T" )
   lCellTT             := ( ::ReadLogicalData( i, "CELLTOOLTIP", "F" ) == "T" )
   lNoHScroll          := ( ::ReadLogicalData( i, "NOHSCROLL", "F" ) == "T" )
   lNoHScroll          := ( ::ReadLogicalData( i, "NOHSCROLLBAR", iif( lNoHScroll, "T", "F" ) ) == "T" )
   cTimeOut            := ::ReadStringData( i, "TIMEOUT", "" )
   cParent             := ::ReadStringData( i, "PARENT", "" )
   cParent             := ::ReadStringData( i, "OF", cParent )
   cCargo              := ::ReadCargo( i, "LASTFORM.LASTCONTROL.CARGO" )

   /* Save properties */
   ::aCtrlType[i]      := ::ControlType[ TYPE_XBROWSE ]
   ::aCObj[i]          := cObj
   ::aHeaders[i]       := cHdrs
   ::aWidths[i]        := cWidths
   ::aWorkArea[i]      := cWorkArea
   ::aFields[i]        := cFields
   ::aInputMask[i]     := cInputMask
   ::aValue[i]         := cValue
   ::aFontName[i]      := cFontName
   ::aFontNameFrm[i]   := uFontName
   ::aFontSize[i]      := nFontSize
   ::aFontSizeFrm[i]   := uFontSize
   ::aFontBold[i]      := lBold
   ::aFontItalic[i]    := lItalic
   ::aFontUnderline[i] := lUnderline
   ::aFontStrikeout[i] := lStrikeout
   ::aToolTip[i]       := cToolTip
   ::aBackColor[i]     := aBackColor
   ::aDynBackColor[i]  := cDynBackColor
   ::aDynForeColor[i]  := cDynForecolor
   ::aFontColor[i]     := aFontColor
   ::aOnGotFocus[i]    := cOnGotFocus
   ::aOnChange[i]      := cOnChange
   ::aOnLostFocus[i]   := cOnLostFocus
   ::aOnDblClick[i]    := cOnDblClick
   ::aAction[i]        := cAction
   ::aEdit[i]          := lEdit
   ::aInPlace[i]       := lInPlace
   ::aAppend[i]        := lAppend
   ::aOnHeadClick[i]   := cOnHeadClick
   ::aOnHeadDClick[i]  := cOnHeadDClick
   ::aWhen[i]          := cWhen
   ::aValid[i]         := cValid
   ::aValidMess[i]     := cValidMess
   ::aReadOnlyArray[i] := cReadOnly
   ::aLock[i]          := lLock
   ::aDelete[i]        := lDelete
   ::aNoLines[i]       := lNoLines
   ::aImage[i]         := cImage
   ::aJustify[i]       := cJustify
   ::aNoVScroll[i]     := lNoVScroll
   ::aHelpID[i]        := cHelpId
   ::aBreak[i]         := lBreak
   ::aRTL[i]           := lRTL
   ::aOnAppend[i]      := cOnAppend
   ::aOnEditCell[i]    := cOnEditCell
   ::aColumnCtrls[i]   := cColControls
   ::aReplaceField[i]  := cReplaceField
   ::aSubClass[i]      := cSubClass
   ::aRecCount[i]      := lRecCount
   ::aColumnInfo[i]    := cColumnInfo
   ::aNoHeaders[i]     := lNoHeaders
   ::aOnEnter[i]       := cOnEnter
   ::aDisabled[i]      := ! lEnabled
   ::aNoTabStop[i]     := lNoTabStop
   ::aInvisible[i]     := ! lVisible
   ::aDescend[i]       := lDescending
   ::aDeleteWhen[i]    := cDeleteWhen
   ::aDeleteMsg[i]     := cDeleteMsg
   ::aOnDelete[i]      := cOnDelete
   ::aHdrBackClrs[i]   := cHdrBackClrs
   ::aHdrFontClrs[i]   := cHdrFontClrs
   ::aHdrImages[i]     := cHdrImgs
   ::aHdrImgAlign[i]   := cHdrImgAlign
   ::aFullMove[i]      := lFullMove
   ::aSelColor[i]      := aSelColor
   ::aEditKeys[i]      := cEditKeys
   ::aEditKeysFun[i]   := cEditKeysFun
   ::aSingleBuffer[i]  := lSingleBuffer
   ::aFocusRect[i]     := iif( cFocusRect == cNoFocusRect, "NIL", iif( cFocusRect == "T" .OR. cNoFocusRect == "F", ".T.", ".F." ) )
   ::aPLM[i]           := lPLM
   ::aFixedCols[i]     := lFixedCols
   ::aOnAbortEdit[i]   := cOnAbortEdit
   ::aFixedWidths[i]   := lFixedWidths
   ::aFixBlocks[i]     := iif( cDynamicBlocks == cFixedBlocks, "NIL", iif( cFixedBlocks == "T" .OR. cDynamicBlocks == "F", ".T.", ".F." ) )
   ::aBeforeColMove[i] := cBeforeColMove
   ::aAfterColMove[i]  := cAfterColMove
   ::aBeforeColSize[i] := cBeforeColSize
   ::aAfterColSize[i]  := cAfterColSize
   ::aBeforeAutoFit[i] := cBeforeAutoFit
   ::aEditLikeExcel[i] := lLikeExcel
   ::aUseButtons[i]    := lButtons
   ::aNoDefMsg[i]      := lNoDefaultMsg
   ::aNoDelMsg[i]      := lNoDeleteMsg
   ::aFixedCtrls[i]    := iif( cDynamicCtrls == cFixedCtrls, "NIL", iif( cFixedCtrls == "T" .OR. cDynamicCtrls == "F", ".T.", ".F." ) )
   ::aShowNone[i]      := lNoShowEmpty
   ::aUpdateColors[i]  := lUpdateColors
   ::aOnHeadRClick[i]  := cOnHeadRClick
   ::aNoModalEdit[i]   := lNoModalEdit
   ::aNavByCell[i]     := lByCell
   ::aExtDblClick[i]   := lExtDblClick
   ::aSilent[i]        := lSilent
   ::aDisableAltA[i]   := lDisableAltA .AND. ! lEnableAltA
   ::aNoShowAlways[i]  := lNoShow
   ::aOnRClick[i]      := cOnRClick
   ::aCheckBoxes[i]    := lCheckBoxes
   ::aOnCheckChg[i]    := cOnCheckChg
   ::aOnRowRefresh[i]  := cOnRowRefresh
   ::aDefaultValues[i] := cDefVal
   ::aOnEditCellEnd[i] := cOnEditEnd
   ::aEditFirstVis[i]  := lEditFV
   ::aOnBfrEdtCell[i]  := cOnBfrEdtCell
   ::aEditCellValue[i] := cEditCell
   ::aKeysLkClp[i]     := lKeysLkClp
   ::aCellToolTip[i]   := lCellTT
   ::aNoHScroll[i]     := lNoHScroll
   ::aTimeOut[i]       := cTimeOut
   ::aParent[i]        := cParent
   ::aCargo[i]         := cCargo

   /* Create control */
   oCtrl               := ::CreateControl( AScan( ::ControlType, ::aCtrlType[i] ), i, nWidth, nHeight, NIL )
   oCtrl:Row           := nRow
   oCtrl:Col           := nCol

   ::AddCtrlToTabPage( i, nRow, nCol )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD AddCtrlToTabPage( z, nRow, nCol ) CLASS TFormEditor

   LOCAL nStaRTLine, nPageCount := 0, i, j, cTabName, nFrom, nTo, nLevel := 0

   IF Len( ::aTabs ) > 0
      /* Check if the control is inside a TAB */
      nStaRTLine := ::aSpeed[z]
      FOR j := Len( ::aTabs ) TO 1 STEP -1
         IF nStaRTLine > ::aTabs[j, 2] .AND. nStaRTLine < ::aTabs[j, 3]
            EXIT
         ENDIF
      NEXT i
      IF j < 1
         RETURN NIL
      ENDIF
      /* Locate the container page */
      nFrom := nStaRTLine - 1
      nTo   := ::aTabs[j, 2] + 1
      FOR i := nFrom TO nTo STEP -1
         /* Do no count pages from other TABs */
         IF At( " END TAB ", Upper( ::aLine[i] ) ) == 1
            nLevel ++
         ELSEIF At( " DEFINE TAB ", Upper( ::aLine[i] ) ) == 1
            nLevel --
         ELSEIF nLevel == 0 .AND. At( " DEFINE PAGE ", Upper( ::aLine[i] ) ) == 1
            nPageCount ++
         ENDIF
      NEXT i
      cTabName := ::aTabs[j, 1]
      IF ! Empty( cTabName ) .AND. nPageCount > 0
         ::aTabPage[z, 1] := cTabName
         ::aTabPage[z, 2] := nPageCount
         ::oDesignForm:&cTabName:AddControl( ::aControlW[z], nPageCount, nRow, nCol )
      ENDIF
   ENDIF

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD RefreshControlInspector( ControlName ) CLASS TFormEditor

   LOCAL i, aSelCtrl, aVal, cControl, cName, cType, nl, j, oControl, nRow, nCol
   LOCAL nWidth, nHeight, bOnChange
   STATIC lBusy := .F.

   IF lBusy
      RETURN NIL
   ENDIF
   lBusy := .T.

   IF HB_ISSTRING( ControlName ) .AND. ! Empty( ControlName )
      aSelCtrl := { Lower( ControlName ) }
   ELSE
      aSelCtrl := {}
      aVal := ::oCtrlList:Value
      FOR i := 1 to Len( aVal )
        AAdd( aSelCtrl, ::oCtrlList:Cell( aVal[i], 6 ) )
      NEXT i
   ENDIF

   ::oCtrlList:SetRedraw( .F. )

   bOnChange := ::oCtrlList:OnChange
   ::oCtrlList:OnChange := NIL

   ::oCtrlList:DeleteAllItems()
   FOR i := 2 TO ::nControlW
      cControl := ::aControlW[i]
      cName    := ::aName[i]
      cType    := ::aCtrlType[i]
      IF ( nl := AScan( ::oDesignForm:aControls, { |c| Lower( c:Name ) == cControl } ) ) > 0
         oControl := ::oDesignForm:aControls[nl]
         nRow     := oControl:Row
         nCol     := oControl:Col
         nWidth   := oControl:Width
         nHeight  := oControl:Height
         ::oCtrlList:AddItem( { cName, Str( nRow, 4 ), Str( nCol, 4 ), Str( nWidth, 4 ), Str( nHeight, 4 ), cControl, cType } )
      ENDIF
   NEXT i

   aVal := {}
   IF Len( aSelCtrl ) > 0
      nl := ::oCtrlList:ItemCount
      FOR i := 1 TO nl
         j := AScan( aSelCtrl, ::oCtrlList:Cell( i, 6 ) )
         IF j > 0
            AAdd( aVal, i )
         ENDIF
      NEXT i
   ENDIF
   ::oCtrlList:Value := aVal

   SetHeightForWholeRows( ::oCtrlList, 400 )

   ::oCtrlList:SetRedraw( .T. )

   ::oCtrlList:OnChange := bOnChange

   lBusy := .F.

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD ConfirmDelete() CLASS TFormEditor

   IF Len( ::oCtrlList:Value ) > 0
      IF ::oCtrlList:lDeleteAll
         IF MsgYesNo( i18n( "Select [Yes] to confirm the removal of ALL the selected controls." ), "OOHG IDE+" )
            RETURN .T.
         ENDIF
      ELSE
         IF MsgYesNo( i18n( "Select [Yes] to confirm the removal of the FIRST selected control." ), "OOHG IDE+" )
            RETURN .T.
         ENDIF
      ENDIF
   ENDIF

   RETURN .F.

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD DeleteControls( aDeleted ) CLASS TFormEditor

   LOCAL nCount, i, ia, oControl

   nCount := Len( aDeleted )
   FOR i := 1 to nCount
      ia := AScan( ::aControlW, Lower( aDeleted[i,1] ) )
      oControl := ::oDesignForm:aControls[ia]
      ::DelCtrlAndChildsArrays( ia )
      oControl:Release()
   NEXT i
   ::lIsFormModified := .T.
   EraseWindow( ::oDesignForm:Name )
   ::DrawPoints()
   ::RefreshControlInspector()

   RETURN .T.

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD DelCtrlAndChildsArrays( i ) CLASS TFormEditor

   LOCAL cName, j

   IF ::aCtrlType[i] == "TAB"
      cName := ::aControlW[i]
      FOR j := ::nControlW TO i + 1 STEP -1
         IF ::aTabPage[j, 1] == cName
            ::DelCtrlAndChildsArrays( j )
         ENDIF
      NEXT j
   ENDIF
   ::DelArray( i )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD MouseTrack() CLASS TFormEditor

   LOCAL iMin, w_OOHG_MouseRow, w_OOHG_MouseCol, i, oControl, ia

/*
   STATIC nLastTime := 0
   IF hb_MilliSeconds() < nLastTime + 250
      RETURN NIL
   ENDIF
   nLastTime := hb_MilliSeconds()
*/
   w_OOHG_MouseRow := _ooHG_MouseRow
   w_OOHG_MouseCol := _ooHG_MouseCol
   ::Form_Main:lbl_yx:Value := StrZero( w_OOHG_MouseRow, 4 ) + "," + StrZero( w_OOHG_MouseCol, 4 )

   /* Check to see if mouse is over the red square at top-left corner */
   iMin := 0
   FOR i := 2 TO ::nControlW
      IF ! ::aCtrlType[i] == "STATUSBAR"
         IF ( ia := AScan( ::oDesignForm:aControls, { |c| Lower( c:Name ) == ::aControlW[i] } ) ) > 0
            oControl := ::oDesignForm:aControls[ia]

            IF oControl:Row == oControl:ContainerRow .AND. oControl:Col == oControl:ContainerCol
               IF ( w_OOHG_MouseRow >= oControl:Row - 10 ) .AND. ;
                  ( w_OOHG_MouseRow <= oControl:Row ) .AND. ;
                  ( w_OOHG_MouseCol >= oControl:Col - 10 ) .AND. ;
                  ( w_OOHG_MouseCol <= oControl:Col )
                  iMin := i
                  EXIT
               ENDIF
            ELSE
               IF ( w_OOHG_MouseRow >= oControl:ContainerRow - 10 ) .AND. ;
                  ( w_OOHG_MouseRow <= oControl:ContainerRow )  .AND. ;
                  ( w_OOHG_MouseCol >= oControl:ContainerCol - 10 ) .AND. ;
                  ( w_OOHG_MouseCol <= oControl:ContainerCol )
                  iMin := i
                  EXIT
               ENDIF
            ENDIF
         ENDIF
      ENDIF
   NEXT i

   IF iMin > 0
      CursorHand()
      ::swCursor := 1                      /* drag */
      ::nIndexW  := iMin
      RETURN NIL
   ENDIF

   /* Check to see if mouse is over the red square at bottom-right corner */
   iMin := 0
   FOR i := 2 TO ::nControlW
      IF ! ( " " + ::aCtrlType[i] + " " ) $ " STATUSBAR TOOLBAR TBBUTTON MONTHCALENDAR TIMER HOTKEYBOX "
         IF ( ia := AScan( ::oDesignForm:aControls, { |c| Lower( c:Name ) == ::aControlW[i] } ) ) > 0
            oControl := ::oDesignForm:aControls[ia]

            IF ::aCtrlType[i] == "RADIOGROUP"
               IF ( w_OOHG_MouseRow >= oControl:Row + oControl:GroupHeight ) .AND. ;
                  ( w_OOHG_MouseRow <= oControl:Row + oControl:GroupHeight + 5 ) .AND. ;
                  ( w_OOHG_MouseCol >= oControl:Col + oControl:GroupWidth ) .AND. ;
                  ( w_OOHG_MouseCol <= oControl:Col + oControl:GroupWidth + 5 )
                  iMin := i
                  EXIT
               ENDIF
            ELSEIF oControl:Row == oControl:ContainerRow .AND. oControl:Col == oControl:ContainerCol
               IF ( w_OOHG_MouseRow >= oControl:Row + oControl:Height ) .AND. ;
                  ( w_OOHG_MouseRow <= oControl:Row + oControl:Height + 5 ) .AND. ;
                  ( w_OOHG_MouseCol >= oControl:Col + oControl:Width ) .AND. ;
                  ( w_OOHG_MouseCol <= oControl:Col + oControl:Width + 5 )
                  iMin := i
                  EXIT
               ENDIF
            ELSE
               IF ( w_OOHG_MouseRow >= oControl:ContainerRow + oControl:Height ) .AND. ;
                  ( w_OOHG_MouseRow <= oControl:ContainerRow + oControl:Height + 5 ) .AND. ;
                  ( w_OOHG_MouseCol >= oControl:ContainerCol + oControl:Width ) .AND. ;
                  ( w_OOHG_MouseCol <= oControl:ContainerCol + oControl:Width + 5 )
                  iMin := i
                  EXIT
               ENDIF
            ENDIF
         ENDIF
      ENDIF
   NEXT i

   IF iMin > 0
      CursorSizeNWSE()
      ::swCursor := 2                      /* size */
      ::nIndexW  := iMin
   ELSE
      CursorArrow()
      ::swCursor := 0                      /* none */
      ::nIndexW  := 0
   ENDIF

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD Debug() CLASS TFormEditor

   LOCAL i, cs

   cs := "# of controls: " + Str( ::nControlW - 1, 4 ) + CRLF
   FOR i := 2 TO ::nControlW
       IF ! Empty( ::aTabPage[i, 1] )
          cs := cs + ::aControlW[i] + " | " + ::aCtrlType[i] + " | " + Str( ::aTabPage[i, 2] ) + " | " + ::aTabPage[i, 1] + CRLF
       ELSE
          cs := cs + ::aControlW[i] + " | " + ::aCtrlType[i] + " |-> " + ::aCaption[i] + CRLF
       ENDIF
   NEXT i
   MsgInfo( cs )

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
STATIC FUNCTION SetHeightForWholeRows( oGrid, nMaxHeight )

   LOCAL nAreaUsed, nItemHeight, nNewHeight
STATIC nOldHeight := 0

   nItemHeight := oGrid:ItemHeight()
   IF nItemHeight <= 0
      nNewHeight := nMaxHeight
   ELSE
      nAreaUsed := oGrid:HeaderHeight + ;
                   iif( IsWindowStyle( oGrid:hWnd, WS_HSCROLL ), ;
                        GetHScrollBarHeight(), ;
                        0 ) + ;
                   iif( IsWindowExStyle( oGrid:hWnd, WS_EX_CLIENTEDGE ), ;
                        GetEdgeHeight() * 2, ;
                        0 )
      nNewHeight := ( Int( ( nMaxHeight - nAreaUsed ) / nItemHeight ) * nItemHeight + nAreaUsed )
   ENDIF
   IF nNewHeight # nOldHeight
      oGrid:Height := nNewHeight
      nOldHeight := nNewHeight
   ENDIF

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD Save( lSaveAs ) CLASS TFormEditor

   LOCAL Output, nSpacing := 3, aCaptions, aWidths
   LOCAL aActions, aIcons, aStyles, aToolTips, aAligns
   LOCAL i, j, aOnKey, aOnAction, nCtrlPos

   CursorWait()
   ::oWaitMsg:label_1:Value := i18n( "Saving form ..." )

   /* Header */
   Output := "" + CRLF
   Output += "* Generated by " + APP_FULL_NAME + CRLF
   Output += "* Visit us at https://oohg.github.io" + CRLF
   Output += CRLF

   /* Defines */
   IF ( j := Len( ::aFDefines ) ) > 0
      FOR i := 1 TO j
         Output += "#define " + ::aFDefines[i, 1] + " " + ::aFDefines[i, 2] + CRLF
      NEXT i
      Output += CRLF
   ENDIF

   /*
      All keywords, properties and control names must be followed by a space.
   */

   /* Save Form's actual values in case the specified values are not directly usable */
   IF ::myIde:lSaveDefaultValues
      Output += "*****TEMPLATE ;" + CRLF
      Output += "*****   ROW " + LTrim( Str( GetWindowRow( ::oDesignForm:hWnd ) ) ) + " ;" + CRLF
      Output += "*****   COL " + LTrim( Str( GetWindowCol( ::oDesignForm:hWnd ) ) ) + " ;" + CRLF
      Output += "*****   TITLE " + StrToStr( ::oDesignForm:Title ) + " ;" + CRLF
      Output += "*****   FONT " + StrToStr( ::oDesignForm:cFontName ) + " ;" + CRLF
      Output += "*****   SIZE " + LTrim( Str( ::oDesignForm:nFontSize ) ) + " ;" + CRLF
      Output += "*****   FONTCOLOR " + ::ColorStrToColorDef( ::myIde:ColorToStr( ::oDesignForm:FontColor ) ) + " ;" + CRLF
      Output += "*****   BACKCOLOR " + ::ColorStrToColorDef( ::myIde:ColorToStr( ::oDesignForm:BackColor ) ) + " ;" + CRLF
      IF ::lFClientArea
         Output += "*****   WIDTH " + LTrim( Str( ::oDesignForm:ClientWidth ) ) + " ;" + CRLF
         Output += "*****   HEIGHT " + LTrim( Str( ::oDesignForm:ClientHeight ) ) + " ;" + CRLF
      ELSE
         Output += "*****   WIDTH " + LTrim( Str( ::oDesignForm:Width ) ) + " ;" + CRLF
         Output += "*****   HEIGHT " + LTrim( Str( ::oDesignForm:Height ) ) + " ;" + CRLF
      ENDIF
      Output += "*****   VIRTUAL WIDTH " + LTrim( Str( ::oDesignForm:VirtualWidth ) ) + " ;" + CRLF
      Output += "*****   VIRTUAL HEIGHT " + LTrim( Str( ::oDesignForm:VirtualHeight ) ) + " ;" + CRLF
      Output += "*****   MAXWIDTH " + LTrim( Str( ::oDesignForm:MaxWidth ) ) + " ;" + CRLF
      Output += "*****   MAXHEIGHT " + LTrim( Str( ::oDesignForm:MaxHeight ) ) + " ;" + CRLF
      Output += "*****   MINWIDTH " + LTrim( Str( ::oDesignForm:MinWidth ) ) + " ;" + CRLF
      Output += "*****   MINHEIGHT " + LTrim( Str( ::oDesignForm:MinHeight ) ) + " ;" + CRLF
   ENDIF
   /* Save Form's specified values */
   Output += "DEFINE WINDOW TEMPLATE"
   IF NOTEMPTY( ::cFObj )
      Output += " ;" + CRLF + Space( nSpacing ) + "OBJ " + AllTrim( ::cFObj )
   ENDIF
   IF NOTEMPTY( ::cFParent )
      Output += " ;" + CRLF + Space( nSpacing ) + "PARENT " + AllTrim( ::cFParent )
   ENDIF
   IF NOTEMPTY( ::cFPosition[1] ) .OR. NOTEMPTY( ::cFPosition[2] )
      Output += " ;" + CRLF + Space( nSpacing ) + "AT " + AllTrim( ::cFPosition[1] ) + ", " + AllTrim( ::cFPosition[2] )
   ENDIF
   IF NOTZERO( ::cFWidth )
      Output += " ;" + CRLF + Space( nSpacing ) + "WIDTH " + AllTrim( ::cFWidth )
   ENDIF
   IF NOTZERO( ::cFHeight ) 
      Output += " ;" + CRLF + Space( nSpacing ) + "HEIGHT " + AllTrim( ::cFHeight )
   ENDIF
   IF NOTZERO( ::cFVirtualW ) 
      Output += " ;" + CRLF + Space( nSpacing ) + "VIRTUAL WIDTH " + AllTrim( ::cFVirtualW )      /* Must be declared after WIDTH */
   ENDIF
   IF NOTZERO( ::cFVirtualH ) 
      Output += " ;" + CRLF + Space( nSpacing ) + "VIRTUAL HEIGHT " + AllTrim( ::cFVirtualH )     /* Must be declared after HEIGHT */
   ENDIF
   IF NOTEMPTY( ::cFTitle )
      Output += " ;" + CRLF + Space( nSpacing ) + "TITLE " + AllTrim( ::cFTitle )
   ENDIF
   IF NOTEMPTY( ::cFIcon )
      Output += " ;" + CRLF + Space( nSpacing ) + "ICON " + AllTrim( ::cFIcon )
   ENDIF
   IF NOTEMPTY( ::cFCursor )
      Output += " ;" + CRLF + Space( nSpacing ) + "CURSOR " + AllTrim( ::cFCursor )
   ENDIF
   IF NOTEMPTY( ::cFBackColor )
      Output += " ;" + CRLF + Space( nSpacing ) + "BACKCOLOR " + ::ColorStrToColorDef( ::cFBackColor )
   ENDIF
   IF NOTEMPTY( ::cFFontName )
      Output += " ;" + CRLF + Space( nSpacing ) + "FONT " + AllTrim( ::cFFontName )
   ENDIF
   IF NOTZERO( ::cFFontSize )
      Output += " ;" + CRLF + Space( nSpacing ) + "SIZE " + AllTrim( ::cFFontSize )
   ENDIF
   IF NOTEMPTY( ::cFFontColor )
      Output += " ;" + CRLF + Space( nSpacing ) + "FONTCOLOR " + ::ColorStrToColorDef( ::cFFontColor )
   ENDIF
   IF NOTEMPTY( ::cFNotifyIcon ) 
      Output += " ;" + CRLF + Space( nSpacing ) + "NOTIFYICON " + AllTrim( ::cFNotifyIcon )
   ENDIF
   IF NOTEMPTY( ::cFNotifyToolTip ) 
      Output += " ;" + CRLF + Space( nSpacing ) + "NOTIFYTOOLTIP " + AllTrim( ::cFNotifyToolTip )
   ENDIF
   IF NOTEMPTY( ::cFGripperText )
      Output += " ;" + CRLF + Space( nSpacing ) + "GRIPPERTEXT " + AllTrim( ::cFGripperText )
   ENDIF
   IF NOTEMPTY( ::cFInterActClose )
      Output += " ;" + CRLF + Space( nSpacing ) + "INTERACTIVECLOSE " + AllTrim( ::cFInterActClose )
   ENDIF
   IF NOTEMPTY( ::cFSubClass )
      Output += " ;" + CRLF + Space( nSpacing ) + "SUBCLASS " + AllTrim( ::cFSubClass )
   ENDIF
   IF NOTZERO( ::cFMinWidth )
      Output += " ;" + CRLF + Space( nSpacing ) + "MINWIDTH " + AllTrim( ::cFMinWidth )
   ENDIF
   IF NOTZERO( ::cFMaxWidth )
      Output += " ;" + CRLF + Space( nSpacing ) + "MAXWIDTH " + AllTrim( ::cFMaxWidth )
   ENDIF
   IF NOTZERO( ::cFMinHeight )
      Output += " ;" + CRLF + Space( nSpacing ) + "MINHEIGHT " + AllTrim( ::cFMinHeight )
   ENDIF
   IF NOTZERO( ::cFMaxHeight )
      Output += " ;" + CRLF + Space( nSpacing ) + "MAXHEIGHT " + AllTrim( ::cFMaxHeight )
   ENDIF
   IF NOTEMPTY( ::cFBackImage )
      Output += " ;" + CRLF + Space( nSpacing ) + "BACKIMAGE " + AllTrim( ::cFBackImage )
      Output += iif( ::lFStretch, " ;" + CRLF + Space( nSpacing ) + "STRETCH ", "")
   ENDIF
   Output += iif( ::lFmain, " ;" + CRLF + Space( nSpacing ) + "MAIN", "" )
   Output += iif( ::lFchild, " ;" + CRLF + Space( nSpacing ) + "CHILD", "" )
   Output += iif( ::lFmodal, " ;" + CRLF + Space( nSpacing ) + "MODAL", "" )
   Output += iif( ::lFModalSize, " ;" + CRLF + Space( nSpacing ) + "MODALSIZE", "")
   Output += iif( ::lFsplitchild, " ;" + CRLF + Space( nSpacing ) + "SPLITCHILD", "" )
   Output += iif( ::lFMDI, " ;" + CRLF + Space( nSpacing ) + "MDI", "")
   Output += iif( ::lFMDIClient, " ;" + CRLF + Space( nSpacing ) + "MDICLIENT", "")
   Output += iif( ::lFMDIChild, " ;" + CRLF + Space( nSpacing ) + "MDICHILD", "")
   Output += iif( ::lFInternal, " ;" + CRLF + Space( nSpacing ) + "INTERNAL", "")
   Output += iif( ::lFnoshow, " ;" + CRLF + Space( nSpacing ) + "NOSHOW", "" )
   Output += iif( ::lFtopmost, " ;" + CRLF + Space( nSpacing ) + "TOPMOST", "" )
   Output += iif( ::lFnoautorelease, " ;" + CRLF + Space( nSpacing ) + "NOAUTORELEASE", "" )
   Output += iif( ::lFNoMinimize, " ;" + CRLF + Space( nSpacing ) + "NOMINIMIZE", "" )
   Output += iif( ::lFNoMaximize, " ;" + CRLF + Space( nSpacing ) + "NOMAXIMIZE", "" )
   Output += iif( ::lFNoDefWinProc, " ;" + CRLF + Space( nSpacing ) + "NODWP", "" )
   Output += iif( ::lFnosize, " ;" + CRLF + Space( nSpacing ) + "NOSIZE", "" )
   Output += iif( ::lFnosysmenu, " ;" + CRLF + Space( nSpacing ) + "NOSYSMENU", "" )
   Output += iif( ::lFnocaption, " ;" + CRLF + Space( nSpacing ) + "NOCAPTION", "" )
   Output += iif( ::lFHelpButton, " ;" + CRLF + Space( nSpacing ) + "HELPBUTTON", "")
   Output += iif( ::lFRTL, " ;" + CRLF + Space( nSpacing ) + "RTL", "")
   Output += iif( ::lFBorder, " ;" + CRLF + Space( nSpacing ) + "BORDER", "")
   Output += iif( ::lFBreak, " ;" + CRLF + Space( nSpacing ) + "BREAK", "")
   Output += iif( ::lFFocused, " ;" + CRLF + Space( nSpacing ) + "FOCUSED", "")
   Output += iif( ::lFClientArea, " ;" + CRLF + Space( nSpacing ) + "CLIENTAREA", "")
   IF NOTEMPTY( ::cFOnInit )
      Output += " ;" + CRLF + Space( nSpacing ) + "ON INIT " + AllTrim( ::cFOnInit )
   ENDIF
   IF NOTEMPTY( ::cFMoveProcedure ) 
      Output += " ;" + CRLF + Space( nSpacing ) + "ON MOVE " + AllTrim( ::cFMoveProcedure )
   ENDIF
   IF NOTEMPTY( ::cFOnRelease )
      Output += " ;" + CRLF + Space( nSpacing ) + "ON RELEASE " + AllTrim( ::cFOnRelease )
   ENDIF
   IF NOTEMPTY( ::cFOnInteractiveClose )
      Output += " ;" + CRLF + Space( nSpacing ) + "ON INTERACTIVECLOSE " + AllTrim( ::cFOnInteractiveClose )
   ENDIF
   IF NOTEMPTY( ::cFOnMouseClick ) 
      Output += " ;" + CRLF + Space( nSpacing ) + "ON MOUSECLICK " + AllTrim( ::cFOnMouseClick )
   ENDIF
   IF NOTEMPTY( ::cFOnMouseDrag )
      Output += " ;" + CRLF + Space( nSpacing ) + "ON MOUSEDRAG " + AllTrim( ::cFOnMouseDrag )
   ENDIF
   IF NOTEMPTY( ::cFOnMouseMove )
      Output += " ;" + CRLF + Space( nSpacing ) + "ON MOUSEMOVE " + AllTrim( ::cFOnMouseMove )
   ENDIF
   IF NOTEMPTY( ::cFOnSize )
      Output += " ;" + CRLF + Space( nSpacing ) + "ON SIZE " + AllTrim( ::cFOnSize )
   ENDIF
   IF NOTEMPTY( ::cFOnMaximize )
      Output += " ;" + CRLF + Space( nSpacing ) + "ON MAXIMIZE " + AllTrim( ::cFonmaximize )
   ENDIF
   IF NOTEMPTY( ::cFOnMinimize )
      Output += " ;" + CRLF + Space( nSpacing ) + "ON MINIMIZE " + AllTrim( ::cFonminimize )
   ENDIF
   IF NOTEMPTY( ::cFRestoreProcedure )
      Output += " ;" + CRLF + Space( nSpacing ) + "ON RESTORE " + AllTrim( ::cFRestoreProcedure )
   ENDIF
   IF NOTEMPTY( ::cFOnPaint )
      Output += " ;" + CRLF + Space( nSpacing ) + "ON PAINT " + AllTrim( ::cFOnPaint )
   ENDIF
   IF NOTEMPTY( ::cFOnNotifyClick )
      Output += " ;" + CRLF + Space( nSpacing ) + "ON NOTIFYCLICK " + AllTrim( ::cFOnNotifyClick )
   ENDIF
   IF NOTEMPTY( ::cFOnGotFocus )
      Output += " ;" + CRLF + Space( nSpacing ) + "ON GOTFOCUS " + AllTrim( ::cFOnGotFocus )
   ENDIF
   IF NOTEMPTY( ::cFOnLostFocus )
      Output += " ;" + CRLF + Space( nSpacing ) + "ON LOSTFOCUS " + AllTrim( ::cFOnLostFocus )
   ENDIF
   IF NOTEMPTY( ::cFOnScrollUp )
      Output += " ;" + CRLF + Space( nSpacing ) + "ON SCROLLUP " + AllTrim( ::cFOnScrollUp )
   ENDIF
   IF NOTEMPTY( ::cFOnScrollDown )
      Output += " ;" + CRLF + Space( nSpacing ) + "ON SCROLLDOWN " + AllTrim( ::cFOnScrollDown )
   ENDIF
   IF NOTEMPTY( ::cFOnScrollLeft )
      Output += " ;" + CRLF + Space( nSpacing ) + "ON SCROLLLEFT " + AllTrim( ::cFOnScrollLeft )
   ENDIF
   IF NOTEMPTY( ::cFOnScrollRight )
      Output += " ;" + CRLF + Space( nSpacing ) + "ON SCROLLRIGHT " + AllTrim( ::cFOnScrollRight )
   ENDIF
   IF NOTEMPTY( ::cFOnHScrollbox )
      Output += " ;" + CRLF + Space( nSpacing ) + "ON HSCROLLBOX " + AllTrim( ::cFOnHScrollbox )
   ENDIF
   IF NOTEMPTY( ::cFOnVScrollbox )
      Output += " ;" + CRLF + Space( nSpacing ) + "ON VSCROLLBOX " + AllTrim( ::cFOnVScrollbox )
   ENDIF
   IF NOTEMPTY( ::cFRClickProcedure )
      Output += " ;" + CRLF + Space( nSpacing ) + "ON RCLICK " + AllTrim( ::cFRClickProcedure )
   ENDIF
   IF NOTEMPTY( ::cFMClickProcedure )
      Output += " ;" + CRLF + Space( nSpacing ) + "ON MCLICK " + AllTrim( ::cFMClickProcedure )
   ENDIF
   IF NOTEMPTY( ::cFDblClickProcedure )
      Output += " ;" + CRLF + Space( nSpacing ) + "ON DBLCLICK " + AllTrim( ::cFDblClickProcedure )
   ENDIF
   IF NOTEMPTY( ::cFRDblClickProcedure )
      Output += " ;" + CRLF + Space( nSpacing ) + "ON RDBLCLICK " + AllTrim( ::cFRDblClickProcedure )
   ENDIF
   IF NOTEMPTY( ::cFMDblClickProcedure )
      Output += " ;" + CRLF + Space( nSpacing ) + "ON MDBLCLICK " + AllTrim( ::cFMDblClickProcedure )
   ENDIF
   IF NOTEMPTY( ::cFCargo )
      Output += CRLF + CRLF + "LastForm.Cargo := " + AllTrim( ::cFCargo )
   ENDIF
   Output += CRLF + CRLF

   /* Statusbar */
   IF ::lSStat
      Output += Space( nSpacing ) + "DEFINE STATUSBAR "
      IF ! Empty( ::cSCObj )
         Output += ";" + CRLF + Space( nSpacing * 2 ) + "OBJ " + AllTrim( ::cSCObj )
      ENDIF
      IF ::lSTop
         Output += " ;" + CRLF + Space( nSpacing * 2 ) + "TOP"
      ENDIF
      IF ::lSNoAutoAdjust
         Output += " ;" + CRLF + Space( nSpacing * 2 ) + "NOAUTOADJUST"
      ENDIF
      IF NOTEMPTY( ::cSSubClass )
         Output += " ;" + CRLF + Space( nSpacing * 2 ) + "SUBCLASS " + AllTrim( ::cSSubClass )
      ENDIF
      IF NOTEMPTY( ::cSFontNameFrm )
         Output += " ;" + CRLF + Space( nSpacing * 2 ) + "FONT " + AllTrim( ::cSFontNameFrm )
      ENDIF
      IF NOTEMPTY( ::cSFontSizeFrm )
         Output += " ;" + CRLF + Space( nSpacing * 2 ) + "SIZE " + AllTrim( ::cSFontSizeFrm )
      ENDIF
      IF ::lSBold
         Output += " ;" + CRLF + Space( nSpacing * 2 ) + "BOLD"
      ENDIF
      IF ::lSItalic
         Output += " ;" + CRLF + Space( nSpacing * 2 ) + "ITALIC"
      ENDIF
      IF ::lSUnderline
         Output += " ;" + CRLF + Space( nSpacing * 2 ) + "UNDERLINE"
      ENDIF
      IF ::lSStrikeout
         Output += " ;" + CRLF + Space( nSpacing * 2 ) + "STRIKEOUT"
      ENDIF
      Output += CRLF + CRLF

      aCaptions := iif( Empty( ::cSCaption ), {}, &( ::cSCaption ) )
      aWidths   := iif( Empty( ::cSWidth ), {}, &( ::cSWidth ) )
      ASize( aWidths, Len( aCaptions ) )
      aActions  := iif( Empty( ::cSAction ), {}, &( ::cSAction ) )
      ASize( aWidths, Len( aCaptions ) )
      aIcons    := iif( Empty( ::cSIcon ), {}, &( ::cSIcon ) )
      ASize( aWidths, Len( aCaptions ) )
      aStyles   := iif( Empty( ::cSStyle ), {}, &( ::cSStyle ) )
      ASize( aWidths, Len( aCaptions ) )
      aToolTips := iif( Empty( ::cSToolTip ), {}, &( ::cSToolTip ) )
      ASize( aWidths, Len( aCaptions ) )
      aAligns   := iif( Empty( ::cSAlign ), {}, &( ::cSAlign ) )
      ASize( aAligns, Len( aCaptions ) )

      FOR i := 1 TO Len( aCaptions )
         IF ! HB_ISSTRING( aCaptions[i] ) .OR. Empty( aCaptions[i] )
            Output += Space( nSpacing * 2 ) + "STATUSITEM " + "' '"
         ELSE
            Output += Space( nSpacing * 2 ) + "STATUSITEM " + StrToStr( aCaptions[i], .T. )
         ENDIF
         IF HB_ISNUMERIC( aWidths[i] ) .AND. aWidths[i] > 0
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "WIDTH " + LTrim( Str( aWidths[i] ) )
         ENDIF
         IF HB_ISSTRING( aActions[i] ) .AND. NOTEMPTY( aActions[i] )
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "ACTION " + AllTrim( aActions[i] )
         ENDIF
         IF HB_ISSTRING( aIcons[i] ) .AND. ! Empty( aIcons[i] )
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "ICON " + StrToStr( aIcons[i] )
         ENDIF
         IF HB_ISSTRING( aStyles[i] )
            IF aStyles[i] == "FLAT"
               Output += " ;" + CRLF + Space( nSpacing * 3 ) + "FLAT"
            ELSEIF aStyles[i] == "RAISED"
               Output += " ;" + CRLF + Space( nSpacing * 3 ) + "RAISED"
            ENDIF
         ENDIF
         IF HB_ISSTRING( aToolTips[i] ) .AND. NOTEMPTY( aToolTips[i] )
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "TOOLTIP " + StrToStr( aToolTips[i], .T. )
         ENDIF
         IF HB_ISSTRING( aAligns[i] )
            IF aAligns[i] == "LEFT"
               Output += " ;" + CRLF + Space( nSpacing * 3 ) + "LEFT"
            ELSEIF aAligns[i] == "RIGHT"
               Output += " ;" + CRLF + Space( nSpacing * 3 ) + "RIGHT"
            ELSEIF aAligns[i] == "CENTER"
               Output += " ;" + CRLF + Space( nSpacing * 3 ) + "CENTER"
            ENDIF
         ENDIF
         Output += CRLF + CRLF
      NEXT i

      IF ::lSKeyboard
         Output += Space( nSpacing * 2 ) + "KEYBOARD"
         IF ::nSKWidth > 0
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "WIDTH " + LTrim( Str( ::nSKWidth ) )
         ENDIF
         IF NOTEMPTY( ::cSKAction )
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "ACTION " + AllTrim( ::cSKAction )
         ENDIF
         IF NOTEMPTY( ::cSKToolTip )
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "TOOLTIP " + AllTrim( ::cSKToolTip )
         ENDIF
         IF NOTEMPTY( ::cSKImage )
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "ICON " + AllTrim( ::cSKImage )
         ENDIF
         IF ::cSKStyle == "FLAT"
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "FLAT"
         ELSEIF ::cSKStyle == "RAISED"
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "RAISED"
         ENDIF
         IF ::cSKAlign == "LEFT"
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "LEFT"
         ELSEIF ::cSKAlign == "RIGHT"
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "RIGHT"
         ELSEIF ::cSKAlign == "CENTER"
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "CENTER"
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::lSDate
         Output += Space( nSpacing * 2 ) + "DATE"
         IF ::nSDWidth > 0
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "WIDTH " + LTrim( Str( ::nSDWidth ) )
         ENDIF
         IF NOTEMPTY( ::cSDAction )
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "ACTION " + AllTrim( ::cSDAction )
         ENDIF
         IF NOTEMPTY( ::cSDToolTip )
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "TOOLTIP " + AllTrim( ::cSDToolTip )
         ENDIF
         IF ::cSDStyle == "FLAT"
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "FLAT"
         ELSEIF ::cSDStyle == "RAISED"
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "RAISED"
         ENDIF
         IF ::cSDAlign == "LEFT"
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "LEFT"
         ELSEIF ::cSDAlign == "RIGHT"
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "RIGHT"
         ELSEIF ::cSDAlign == "CENTER"
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "CENTER"
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::lSTime
         Output += Space( nSpacing * 2 ) + "CLOCK"
         IF ::nSCWidth > 0
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "WIDTH " + LTrim( Str( ::nSCWidth ) )
         ENDIF
         IF NOTEMPTY( ::cSCAction )
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "ACTION " + AllTrim( ::cSCAction )
         ENDIF
         IF NOTEMPTY( ::cSCToolTip )
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "TOOLTIP " + AllTrim( ::cSCToolTip )
         ENDIF
         IF NOTEMPTY( ::cSCImage )
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "ICON " + AllTrim( ::cSCImage )
         ENDIF
         IF ::lSCAmPm
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "AMPM"
         ENDIF
         IF ::cSCStyle == "FLAT"
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "FLAT"
         ELSEIF ::cSCStyle == "RAISED"
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "RAISED"
         ENDIF
         IF ::cSCAlign == "LEFT"
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "LEFT"
         ELSEIF ::cSCAlign == "RIGHT"
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "RIGHT"
         ELSEIF ::cSCAlign == "CENTER"
            Output += " ;" + CRLF + Space( nSpacing * 3 ) + "CENTER"
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      Output += Space( nSpacing ) + "END STATUSBAR"
      IF NOTEMPTY( ::cSCargo )
         Output += CRLF + CRLF + Space( nSpacing ) + "LastForm.StatusBar.Cargo := " + AllTrim( ::cSCargo )
      ENDIF
      Output += CRLF + CRLF
   ENDIF

   /* Main menu */
   Output += TMyMenuEditor():FmgOutput( Self, 1, nSpacing )

   /* Context menu */
   Output += TMyMenuEditor():FmgOutput( Self, 2, nSpacing )

   /* Notify menu */
   Output += TMyMenuEditor():FmgOutput( Self, 3, nSpacing )

   /* ToolBars */
   Output += ::myTbEditor:FmgOutput( nSpacing )

   /* Controls */
   j := 2
   DO WHILE j <= ::nControlW
      IF Empty( ::aTabPage[j, 1] ) .AND. ;
         ! ::aControlW[j] $ " statusbar mainmenu contextmenu notifymenu " .AND. ;
         ( nCtrlPos := AScan( ::oDesignForm:aControls, { |c| Lower( c:Name ) == ::aControlW[j] } ) ) # 0

         WITH OBJECT ( ::oDesignForm:aControls[nCtrlPos] )
            Output := ::MakeControls( j, Output, :Row, :Col, :Width, :Height, nSpacing, 1 )
         END WITH
      ENDIF
      j ++
   ENDDO

   /* ON KEY */
   IF "A" == Type( ::cFOnKeyKeys ) .AND. "A" == Type( ::cFOnKeyActions )
      aOnKey := &( ::cFOnKeyKeys )
      aOnAction := &( ::cFOnKeyActions )
      IF Len( aOnKey ) == Len( aOnAction )
         FOR j := 1 TO Len( aOnKey )
            IF HB_ISSTRING( aOnKey[j] ) .AND. ! Empty( aOnKey[j] ) .AND. HB_ISSTRING( aOnAction[j] ) .AND. ! Empty( aOnAction[j] )
               Output += Space( nSpacing * 2 ) + "ON KEY " + AllTrim( aOnKey[j] ) + " ACTION " + AllTrim( aOnAction[j] ) + " " + CRLF
            ENDIF
         NEXT j
      ENDIF
   ENDIF

   /* Form's end */
   Output += "END WINDOW" + CRLF

   /* Undefs */
   IF ( j := Len( ::aFUndefs ) ) > 0
      Output += CRLF
      FOR i := 1 TO j
         Output += "#undef " + ::aFUndefs[i] + CRLF
      NEXT i
   ENDIF

   Output := StrTran( Output, "  ;", " ;" )

   ::oWaitMsg:Hide()

   /* Save FMG file */
   IF lSaveAs
      IF ! hb_MemoWrit( PutFile( { { i18n( "Form files *.fmg" ), i18n( "*.fmg" ) } }, i18n( "Save Form As" ), NIL, .T. ), Output )
         CursorArrow()
         MsgStop( i18n( "Error writing FMG file." ), "OOHG IDE+" )
         ::oDesignForm:SetFocus()
         RETURN NIL
      ENDIF
   ELSE
      IF ! HB_MemoWrit( ::cFormFullName, Output )
         CursorArrow()
         MsgStop( i18n( "Error writing " ) + ::cFormFullName + ".", "OOHG IDE+" )
         ::oDesignForm:SetFocus()
         RETURN NIL
      ENDIF
   ENDIF
   ::lIsFormModified := .F.

   ::oDesignForm:SetFocus()
   CursorArrow()

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
FUNCTION StrToStr( cData, lNoTrim )

   LOCAL cRet

   IF ! HB_ISLOGICAL( lNoTrim )
      lNoTrim := .F.
   ENDIF

   IF lNoTrim
      IF ! DOUBLE_QUOTATION_MARK $ cData
         cRet := DQM( cData )
      ELSEIF ! SINGLE_QUOTATION_MARK $ cData
         cRet := SQM( cData )
      ELSEIF ! "]" $ cData
         cRet := BKT( cData )
      ELSE
         cRet := cData
         /* cData contains a string that can't be represented using "content of cData"
            or 'content of cData' or [content of cData] without causing a RTE when
            compiling the FMG file. So I choosed to output the raw content of cData. */
      ENDIF
   ELSE
      IF ! DOUBLE_QUOTATION_MARK $ cData
         cRet := DQM( AllTrim( cData ) )
      ELSEIF ! SINGLE_QUOTATION_MARK $ cData
         cRet := SQM( AllTrim( cData ) )
      ELSEIF ! "]" $ cData
         cRet := BKT( AllTrim( cData ) )
      ELSE
         cRet := AllTrim( cData )
      ENDIF
   ENDIF

   RETURN cRet

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD MakeControls( j, Output, nRow, nCol, nWidth, nHeight, nSpacing, nLevel ) CLASS TFormEditor

   LOCAL CurrentPage, k, nCtrlPos

   IF ::myIde:nSyntax == 2                                                  /* Alternative syntax */
      // TODO: generate alternative syntax output
   ELSE                                                                     /* Standard syntax */
      IF ::aCtrlType[j] == ::ControlType[ TYPE_ACTIVEX ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " ACTIVEX " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF NOTEMPTY( ::aProgID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PROGID " + AllTrim( ::aProgID[j] )
         ENDIF
         IF ::aNoTabStop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTABSTOP"
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_ANIGIF ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " ANIGIF " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         IF NOTEMPTY( ::aAction[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ACTION " + AllTrim( ::aAction[j] )
         ENDIF
         IF nWidth > 0
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         ENDIF
         IF nHeight > 0
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aRTL[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF ::aWhiteBack[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WHITEBACKGROUND"
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF NOTEMPTY( ::aFile[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FILE " + AllTrim( ::aFile[j] )
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF ::aBorder[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BORDER"
         ENDIF
         IF ::aClientEdge[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CLIENTEDGE"
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_ANIMATEBOX ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " ANIMATEBOX " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF NOTEMPTY( ::aFile[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FILE " + AllTrim( ::aFile[j] )
         ENDIF
         IF ::aAutoPlay[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "AUTOPLAY"
         ENDIF
         IF ::aCenter[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CENTER"
         ENDIF
         IF ::aTransparent[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TRANSPARENT"
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aNoTabStop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTABSTOP"
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF ::aRTL[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_BROWSE ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " BROWSE " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF NOTEMPTY( ::aHeaders[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEADERS " + AllTrim( ::aHeaders[j] )
         ELSE
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEADERS " + "{ '', '' }"
         ENDIF
         IF NOTEMPTY( ::aWidths[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTHS " + AllTrim( ::aWidths[j] )
         ELSE
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTHS " + "{ 90, 60 }"
         ENDIF
         IF NOTEMPTY( ::aWorkArea[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WORKAREA " + AllTrim( ::aWorkArea[j] )
         ELSE
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WORKAREA " + "Alias()"
         ENDIF
         IF NOTEMPTY( ::aFields[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FIELDS " + AllTrim( ::aFields[j] )
         ELSE
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FIELDS " + "{ 'field1', 'field2' }"
         ENDIF
         IF NOTEMPTY( ::aInputMask[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INPUTMASK " + AllTrim( ::aInputMask[j] )
         ENDIF
         IF NOTZERO( ::aValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + AllTrim( ::aValue[j] )
         ENDIF
         IF NOTEMPTY( ::aFontNameFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONT " + ::aFontNameFrm[j]
         ENDIF
         IF NOTZERO( ::aFontSizeFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SIZE " + AllTrim( ::aFontSizeFrm[j] )
         ENDIF
         IF ::aFontBold[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOLD"
         ENDIF
         IF ::aFontItalic[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITALIC"
         ENDIF
         IF ::aFontUnderline[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UNDERLINE"
         ENDIF
         IF ::aFontStrikeout[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRIKEOUT"
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF NOTEMPTY( AllTrim( ::aDynBackColor[j] ) )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DYNAMICBACKCOLOR " + AllTrim( ::aDynBackColor[j] )
         ENDIF
         IF NOTEMPTY( AllTrim( ::aDynForeColor[j] ) )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DYNAMICFORECOLOR " + AllTrim( ::aDynForeColor[j] )
         ENDIF
         IF ::aFontColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONTCOLOR " + ::ColorStrToColorDef( ::aFontColor[j] )
         ENDIF
         IF NOTEMPTY( ::aOnGotFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON GOTFOCUS " + AllTrim( ::aOnGotFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnChange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CHANGE " + AllTrim( ::aOnChange[j] )
         ENDIF
         IF NOTEMPTY( ::aOnLostFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LOSTFOCUS " + AllTrim( ::aOnLostFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnDblClick[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON DBLCLICK " + AllTrim( ::aOnDblClick[j] )
         ENDIF
         IF NOTEMPTY( ::aAction[j] ) 
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ACTION " + AllTrim( ::aAction[j] )
         ENDIF
         IF ::aEdit[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "EDIT"
         ENDIF
         IF ::aInPlace[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INPLACE"
         ENDIF
         IF ::aAppend[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "APPEND"
         ENDIF
         IF NOTEMPTY( ::aOnHeadClick[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON HEADCLICK " + AllTrim( ::aOnHeadClick[j] )
         ENDIF
         IF NOTEMPTY( ::aOnHeadDClick[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON HEADDBLCLICK " + AllTrim( ::aOnHeadDClick[j] )
         ENDIF
         IF NOTEMPTY( ::aWhen[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WHEN " + AllTrim( ::aWhen[j] )
         ENDIF
         IF NOTEMPTY( ::aValid[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALID " + AllTrim( ::aValid[j] )
         ENDIF
         IF NOTEMPTY( ::aValidMess[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALIDMESSAGES " + AllTrim( ::aValidMess[j] )
         ENDIF
         IF NOTEMPTY( ::aReadOnlyArray[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "READONLY " + AllTrim( ::aReadOnlyArray[j] )
         ENDIF
         IF ::aLock[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "LOCK"
         ENDIF
         IF ::aDelete[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DELETE"
         ENDIF
         IF ::aNoLines[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOLINES"
         ENDIF
         IF NOTEMPTY( ::aImage[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "IMAGE " + AllTrim( ::aImage[j] )
         ENDIF
         IF NOTEMPTY( ::aJustify[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "JUSTIFY " + AllTrim( ::aJustify[j] )
         ENDIF
         IF ::aNoVScroll[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOVSCROLL"
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aBreak[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BREAK"
         ENDIF
         IF ::aRTL[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF NOTEMPTY( ::aOnAppend[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON APPEND " + AllTrim( ::aOnAppend[j] )
         ENDIF
         IF NOTEMPTY( ::aOnEditCell[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON EDITCELL " + AllTrim( ::aOnEditCell[j] )
         ENDIF
         IF NOTEMPTY( ::aColumnCtrls[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "COLUMNCONTROLS " + AllTrim( ::aColumnCtrls[j] )
         ENDIF
         IF NOTEMPTY( ::aReplaceField[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "REPLACEFIELD " + AllTrim( ::aReplaceField[j] )
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF ::aRecCount[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RECCOUNT"
         ENDIF
         IF NOTEMPTY( ::aColumnInfo[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "COLUMNINFO " + AllTrim( ::aColumnInfo[j] )
         ENDIF
         IF ::aNoHeaders[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOHEADERS"
         ENDIF
         IF NOTEMPTY( ::aOnEnter[j] ) 
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON ENTER " + AllTrim( ::aOnEnter[j] )
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF ::aNoTabStop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTABSTOP"
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aDescend[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DESCENDING"
         ENDIF
         IF NOTEMPTY( ::aDeleteWhen[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DELETEWHEN " + AllTrim( ::aDeleteWhen[j] )
         ENDIF
         IF NOTEMPTY( ::aDeleteMsg[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DELETEMSG " + AllTrim( ::aDeleteMsg[j] )
         ENDIF
         IF NOTEMPTY( ::aOnDelete[j] ) 
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON DELETE " + AllTrim( ::aOnDelete[j] )
         ENDIF
         IF NOTEMPTY( ::aHdrFontClrs[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEADERCOLORS " + AllTrim( ::aHdrFontClrs[j] )
         ENDIF
         IF NOTEMPTY( ::aHdrBackClrs[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEADERBACKCOLORS " + AllTrim( ::aHdrBackClrs[j] )
         ENDIF
         IF NOTEMPTY( ::aHdrImages[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEADERIMAGES " + AllTrim( ::aHdrImages[j] )
         ENDIF
         IF NOTEMPTY( ::aHdrImgAlign[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEADERIMAGESALIGN " + AllTrim( ::aHdrImgAlign[j] )
         ENDIF
         IF ::aFullMove[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FULLMOVE"
         ENDIF
         IF NOTEMPTY( AllTrim( ::aSelColor[j] ) ) 
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SELECTEDCOLORS " + AllTrim( ::aSelColor[j] )
         ENDIF
         IF NOTEMPTY( ::aEditKeys[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "EDITKEYS " + AllTrim( ::aEditKeys[j] )
         ENDIF
         IF NOTEMPTY( ::aEditKeysFun[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "EDITKEYSFUN " + AllTrim( ::aEditKeysFun[j] )
         ENDIF
         IF ::aRefresh[j] == "REFRESH_FORCE"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FORCEREFRESH"
         ELSEIF ::aRefresh[j] == "REFRESH_NO"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOREFRESH"
         ENDIF
         IF ::aSingleBuffer[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SINGLEBUFFER"
         ENDIF
         IF ::aPLM[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PAINTLEFTMARGIN"
         ENDIF
         IF ::aSync[j] == ".T."
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SYNCHRONIZED"
         ELSEIF ::aSync[j] == ".F."
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UNSYNCHRONIZED"
         ENDIF
         IF ::aFixedCols[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FIXEDCOLS"
         ENDIF
         IF ::aNoDefMsg[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NODEFAULTMSG"
         ENDIF
         IF ::aNoDelMsg[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NODELETEMSG"
         ENDIF
         IF ::aUpdate[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UPDATEALL"
         ENDIF
         IF NOTEMPTY( ::aOnAbortEdit[j] ) 
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON ABORTEDIT " + AllTrim( ::aOnAbortEdit[j] )
         ENDIF
         IF ::aFixedWidths[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FIXEDWIDTHS"
         ENDIF
         IF ::aFixBlocks[j] == ".T."
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FIXEDBLOCKS"
         ELSEIF ::aFixBlocks[j] == ".F."
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DYNAMICBLOCKS"
         ENDIF
         IF NOTEMPTY( ::aBeforeColMove[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BEFORECOLMOVE " + AllTrim( ::aBeforeColMove[j] )
         ENDIF
         IF NOTEMPTY( ::aAfterColMove[j] ) 
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "AFTERCOLMOVE " + AllTrim( ::aAfterColMove[j] )
         ENDIF
         IF NOTEMPTY( ::aBeforeColSize[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BEFORECOLSIZE " + AllTrim( ::aBeforeColSize[j] )
         ENDIF
         IF NOTEMPTY( ::aAfterColSize[j] ) 
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "AFTERCOLSIZE " + AllTrim( ::aAfterColSize[j] )
         ENDIF
         IF NOTEMPTY( ::aBeforeAutoFit[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BEFOREAUTOFIT " + AllTrim( ::aBeforeAutoFit[j] )
         ENDIF
         IF ::aEditLikeExcel[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "EDITLIKEEXCEL"
         ENDIF
         IF ::aUseButtons[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "USEBUTTONS"
         ENDIF
         IF ::aUpdateColors[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UPDATECOLORS"
         ENDIF
         IF ::aFixedCtrls[j] == ".T."
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FIXEDCONTROLS"
         ELSEIF ::aFixedCtrls[j] == ".F."
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DYNAMICCONTROLS"
         ENDIF
         IF NOTEMPTY( ::aOnHeadRClick[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON HEADRCLICK " + AllTrim( ::aOnHeadRClick[j] )
         ENDIF
         IF ::aNoModalEdit[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOMODALEDIT"
         ENDIF
         IF ::aNavByCell[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NAVIGATEBYCELL"
            IF ::aFocusRect[j] == ".T."
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FOCUSRECT"
            ENDIF
         ELSE
            IF ::aFocusRect[j] == ".F."
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOFOCUSRECT"
            ENDIF
         ENDIF
         IF ::aExtDblClick[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "EXTDBLCLICK"
         ENDIF
         IF ::aSilent[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SILENT"
         ENDIF
         IF ::aDisableAltA[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLEALTA"
         ENDIF
         IF ::aNoShowAlways[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOSHOWALWAYS"
         ENDIF
         IF ::aNoneUnsels[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NONEUNSELS"
         ENDIF
         IF ::aChgBefEdit[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CHANGEBEFOREEDIT"
         ENDIF
         IF NOTEMPTY( ::aOnRClick[j] ) 
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON RCLICK " + AllTrim( ::aOnRClick[j] )
         ENDIF
         IF ::aCheckBoxes[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CHECKBOXES"
         ENDIF
         IF NOTEMPTY( ::aOnCheckChg[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CHECKCHANGE " + AllTrim( ::aOnCheckChg[j] )
         ENDIF
         IF NOTEMPTY( ::aOnRowRefresh[j] ) 
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON ROWREFRESH " + AllTrim( ::aOnRowRefresh[j] )
         ENDIF
         IF NOTEMPTY( ::aDefaultValues[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DEFAULTVALUES " + AllTrim( ::aDefaultValues[j] )
         ENDIF
         IF NOTEMPTY( ::aOnEditCellEnd[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON EDITCELLEND " + AllTrim( ::aOnEditCellEnd[j] )
         ENDIF
         IF ::aEditFirstVis[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "EDITFIRSTVISIBLE"
         ENDIF
         IF NOTEMPTY( ::aOnBfrEdtCell[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON BEFOREEDITCELL " + AllTrim( ::aOnBfrEdtCell[j] )
         ENDIF
         IF NOTEMPTY( ::aEditCellValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "EDITCELLVALUE " + AllTrim( ::aEditLabels[j] )
         ENDIF
         IF ::aKeysLkClp[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "KEYSLIKECLIPPER"
         ENDIF
         IF ::aCellToolTip[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CELLTOOLTIP"
         ENDIF
         IF ::aNoHScroll[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOHSCROLL"
         ENDIF
         IF NOTEMPTY( ::aTimeOut[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TIMEOUT " + AllTrim( ::aTimeOut[j] )
         ENDIF
         IF NOTZERO( ::aNewAtRow[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NEWATROW " + AllTrim( ::aNewAtRow[j] )
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_BUTTON ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " BUTTON " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         IF NOTEMPTY( ::aAction[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ACTION " + AllTrim( ::aAction[j] )
         ELSE
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ACTION " + "MsgInfo( 'Button Pressed!' )"
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF NOTEMPTY( ::aFontNameFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONT " + ::aFontNameFrm[j]
         ENDIF
         IF NOTZERO( ::aFontSizeFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SIZE " + AllTrim( ::aFontSizeFrm[j] )
         ENDIF
         IF ::aFontBold[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOLD"
         ENDIF
         IF ::aFontItalic[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITALIC"
         ENDIF
         IF ::aFontUnderline[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UNDERLINE"
         ENDIF
         IF ::aFontStrikeout[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRIKEOUT"
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF ::aFlat[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FLAT"
         ENDIF
         IF NOTEMPTY( ::aOnGotFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON GOTFOCUS " + AllTrim( ::aOnGotFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnLostFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LOSTFOCUS " + AllTrim( ::aOnLostFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnMouseMove[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON MOUSEMOVE " + AllTrim( ::aOnMouseMove[j] )
         ENDIF
         IF ::aNoTabStop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTABSTOP"
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aRTL[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF ::aNoPrefix[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOPREFIX"
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF NOTEMPTY( ::aCaption[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CAPTION " + AllTrim( ::aCaption[j] )
         ENDIF
         IF NOTEMPTY( ::aPicture[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PICTURE " + AllTrim( ::aPicture[j] )
         ENDIF
         IF NOTEMPTY( ::aBuffer[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BUFFER " + AllTrim( ::aBuffer[j] )
         ENDIF
         IF NOTEMPTY( ::aHBitmap[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HBITMAP " + AllTrim( ::aHBitmap[j] )
         ENDIF
         IF ::aNoLoadTrans[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOLOADTRANSPARENT"
         ENDIF
         IF ::aStretch[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRETCH"
         ENDIF
         IF ::aCancel[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CANCEL"
         ENDIF
         IF NOTEMPTY( ::aImageAlign[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "IMAGEALIGN " + Upper( AllTrim( ::aImageAlign[j] ) )
         ENDIF
         IF ::aMultiLine[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "MULTILINE"
         ENDIF
         IF NOTEMPTY( ::aDrawBy[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + AllTrim( ::aDrawBy[j] )
         ENDIF
         IF NOTEMPTY( ::aImageMargin[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "IMAGEMARGIN " + AllTrim( ::aImageMargin[j] )
         ENDIF
         IF ::aFitImg[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FITIMG"
         ENDIF
         IF ::aNo3DColors[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NO3DCOLORS"
         ENDIF
         IF ::aForceScale[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FORCESCALE"
         ENDIF
         IF ::aDIBSection[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DIBSECTION"
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF ::aSolid[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SOLID"
         ENDIF
         IF ::aNoHotLight[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOHOTLIGHT"
         ENDIF
         IF ::aFontColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONTCOLOR " + ::ColorStrToColorDef( ::aFontColor[j] )
         ENDIF
         IF NOTEMPTY( ::aAlignH[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TEXTALIGNH " + AllTrim( ::aAlignH[j] )
         ENDIF
         IF NOTEMPTY( ::aAlignV[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TEXTALIGNV " + AllTrim( ::aAlignV[j] )
         ENDIF
         IF ::aNoPrint[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOPRINTOVER"
         ENDIF
         IF NOTZERO( ::aTxtMrgn[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TEXTMARGIN " + AllTrim( ::aTxtMrgn[j] )
         ENDIF
         IF ::aFitTxt[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FITTXT"
         ENDIF
         IF ::aImageSize[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "IMAGESIZE"
         ENDIF
         IF ::aTransparent[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TRANSPARENT"
         ENDIF
         IF ::aNoFocusRect[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOFOCUSRECT"
         ENDIF
         IF ::aNoImgList[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOIMAGELIST"
         ENDIF
         IF ::aNoDestroy[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NODESTROY"
         ENDIF
         IF ::aHandCursor[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HANDCURSOR"
         ENDIF
         IF ::aDefault[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DEFAULT"
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_CHECKBOX ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " CHECKBOX " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         IF NOTEMPTY( ::aCaption[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CAPTION " + AllTrim( ::aCaption[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF NOTEMPTY( ::aField[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FIELD " + AllTrim( ::aField[j] )
         ENDIF
         IF NOTEMPTY( ::aValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + AllTrim( ::aValue[j] )
         ENDIF
         IF NOTEMPTY( ::aFontNameFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONT " + ::aFontNameFrm[j]
         ENDIF
         IF NOTZERO( ::aFontSizeFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SIZE " + AllTrim( ::aFontSizeFrm[j] )
         ENDIF
         IF ::aFontBold[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOLD"
         ENDIF
         IF ::aFontItalic[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITALIC"
         ENDIF
         IF ::aFontUnderline[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UNDERLINE"
         ENDIF
         IF ::aFontStrikeout[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRIKEOUT"
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF ::aFontColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONTCOLOR " + ::ColorStrToColorDef( ::aFontColor[j] )
         ENDIF
         IF NOTEMPTY( ::aOnGotFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON GOTFOCUS " + AllTrim( ::aOnGotFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnChange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CHANGE " + AllTrim( ::aOnChange[j] )
         ENDIF
         IF NOTEMPTY( ::aOnLostFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LOSTFOCUS " + AllTrim( ::aOnLostFocus[j] )
         ENDIF
         IF ::aTransparent[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TRANSPARENT"
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aNoTabStop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTABSTOP"
         ENDIF
         IF ::aAutoSize[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "AUTOSIZE"
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF ::aRTL[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF ::a3State[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "THREESTATE"
         ENDIF
         IF ::aLeftJust[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "LEFTALIGN"
         ENDIF
         IF NOTEMPTY( ::aDrawBy[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + AllTrim( ::aDrawBy[j] )
         ENDIF
         IF NOTEMPTY( ::aBackground[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKGROUND " + AllTrim( ::aBackground[j] )
         ENDIF
         IF ::aNoFocusRect[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOFOCUSRECT"
         ENDIF
         IF ::aFillRect[j] == "YES"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FILLRECT"
         ELSEIF ::aFillRect[j] == "NO"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOFILLRECT"
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_CHECKBUTTON ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " CHECKBUTTON " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         IF NOTEMPTY( ::aCaption[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CAPTION " + AllTrim( ::aCaption[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF NOTEMPTY( ::aValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + AllTrim( ::aValue[j] )
         ENDIF
         IF NOTEMPTY( ::aFontNameFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONT " + ::aFontNameFrm[j]
         ENDIF
         IF NOTZERO( ::aFontSizeFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SIZE " + AllTrim( ::aFontSizeFrm[j] )
         ENDIF
         IF ::aFontBold[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOLD"
         ENDIF
         IF ::aFontItalic[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITALIC"
         ENDIF
         IF ::aFontUnderline[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UNDERLINE"
         ENDIF
         IF ::aFontStrikeout[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRIKEOUT"
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF NOTEMPTY( ::aOnGotFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON GOTFOCUS " + AllTrim( ::aOnGotFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnChange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CHANGE " + AllTrim( ::aOnChange[j] )
         ENDIF
         IF NOTEMPTY( ::aOnLostFocus[j] ) 
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LOSTFOCUS " + AllTrim( ::aOnLostFocus[j] )
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aNoTabStop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTABSTOP"
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF ::aRTL[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF NOTEMPTY( ::aPicture[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PICTURE " + AllTrim( ::aPicture[j] )
         ENDIF
         IF NOTEMPTY( ::aBuffer[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BUFFER " + AllTrim( ::aBuffer[j] )
         ENDIF
         IF NOTEMPTY( ::aHBitmap[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HBITMAP " + AllTrim( ::aHBitmap[j] )
         ENDIF
         IF ::aNoLoadTrans[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOLOADTRANSPARENT"
         ENDIF
         IF ::aStretch[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRETCH"
         ENDIF
         IF NOTEMPTY( ::aField[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FIELD " + AllTrim( ::aField[j] )
         ENDIF
         IF ::aNo3DColors[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NO3DCOLORS"
         ENDIF
         IF ::aForceScale[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FORCESCALE"
         ENDIF
         IF ::aDIBSection[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DIBSECTION"
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF ::aSolid[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SOLID"
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF NOTEMPTY( ::aDrawBy[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + AllTrim( ::aDrawBy[j] )
         ENDIF
         IF NOTEMPTY( ::aImageMargin[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "IMAGEMARGIN " + AllTrim( ::aImageMargin[j] )
         ENDIF
         IF ::aFitImg[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FITIMG"
         ENDIF
         IF NOTEMPTY( ::aOnMouseMove[j] ) 
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON MOUSEMOVE " + AllTrim( ::aOnMouseMove[j] )
         ENDIF
         IF NOTEMPTY( ::aImageAlign[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "IMAGEALIGN " + Upper( AllTrim( ::aImageAlign[j] ) ) + " "
         ENDIF
         IF ::aMultiLine[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "MULTILINE"
         ENDIF
         IF ::aFlat[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FLAT"
         ENDIF
         IF ::aNoHotLight[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOHOTLIGHT"
         ENDIF
         IF ::aFontColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONTCOLOR " + ::ColorStrToColorDef( ::aFontColor[j] )
         ENDIF
         IF NOTEMPTY( ::aAlignH[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TEXTALIGNH " + AllTrim( ::aAlignH[j] )
         ENDIF
         IF NOTEMPTY( ::aAlignV[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TEXTALIGNV " + AllTrim( ::aAlignV[j] )
         ENDIF
         IF ::aNoPrint[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOPRINTOVER"
         ENDIF
         IF NOTZERO( ::aTxtMrgn[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TEXTMARGIN " + AllTrim( ::aTxtMrgn[j] )
         ENDIF
         IF ::aFitTxt[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FITTXT"
         ENDIF
         IF ::aImageSize[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "IMAGESIZE"
         ENDIF
         IF ::aTransparent[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TRANSPARENT"
         ENDIF
         IF ::aNoFocusRect[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOFOCUSRECT"
         ENDIF
         IF ::aNoImgList[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOIMAGELIST"
         ENDIF
         IF ::aNoDestroy[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NODESTROY"
         ENDIF
         IF ::aHandCursor[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HANDCURSOR"
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_CHECKLIST ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " CHECKLIST " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF NOTEMPTY( ::aItems[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITEMS " + AllTrim( ::aItems[j] )
         ENDIF
         IF NOTEMPTY( ::aImage[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "IMAGE " + AllTrim( ::aImage[j] )
         ENDIF
         IF NOTZERO( ::aValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + AllTrim( ::aValue[j] )
         ENDIF
         IF NOTEMPTY( ::aFontNameFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONT " + ::aFontNameFrm[j]
         ENDIF
         IF NOTZERO( ::aFontSizeFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SIZE " + AllTrim( ::aFontSizeFrm[j] )
         ENDIF
         IF ::aFontBold[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOLD"
         ENDIF
         IF ::aFontItalic[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITALIC"
         ENDIF
         IF ::aFontUnderline[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UNDERLINE"
         ENDIF
         IF ::aFontStrikeout[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRIKEOUT"
         ENDIF
         IF NOTEMPTY( ::aJustify[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "JUSTIFY " + AllTrim( ::aJustify[j] )
         ENDIF
         IF ::aRTL[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF ::aFontColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONTCOLOR " + ::ColorStrToColorDef( ::aFontColor[j] )
         ENDIF
         IF NOTEMPTY( AllTrim( ::aSelColor[j] ) )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SELECTEDCOLORS " + AllTrim( ::aSelColor[j] )
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF NOTEMPTY( ::aOnChange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CHANGE " + AllTrim( ::aOnChange[j] )
         ENDIF
         IF NOTEMPTY( ::aOnGotFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON GOTFOCUS " + AllTrim( ::aOnGotFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnLostFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LOSTFOCUS " + AllTrim( ::aOnLostFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aAction[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ACTION " + AllTrim( ::aAction[j] )
         ENDIF
         IF ::aBreak[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BREAK"
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF ::aNoTabStop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTABSTOP"
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aSort[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SORT"
         ENDIF
         IF ::aDescend[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DESCENDING"
         ENDIF
         IF ::aSingleBuffer[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SINGLEBUFFER"
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_COMBOBOX ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " COMBOBOX " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         IF nHeight # TCombo():nHeight
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         ENDIF
         IF NOTEMPTY( ::aItems[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITEMS " + AllTrim( ::aItems[j] )
            IF ::aNoClone[j]
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOCLONE"
            ENDIF
         ENDIF
         IF NOTEMPTY( ::aItemSource[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITEMSOURCE " + AllTrim( ::aItemSource[j] )
         ENDIF
         IF NOTEMPTY( ::aItemImgNumber[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITEMIMAGENUMBER " + AllTrim( ::aItemImgNumber[j] )
         ENDIF
         IF NOTZERO( ::aValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + AllTrim( ::aValue[j] )
         ENDIF
         IF NOTEMPTY( ::aValueSource[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUESOURCE " + AllTrim( ::aValueSource[j] )
         ENDIF
         IF ::aDisplayEdit[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISPLAYEDIT"
            IF NOTZERO( ::aMaxLength[j] )
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "MAXLENGTH " + AllTrim( ::aMaxLength[j] )
            ENDIF
            IF ::aNoHScroll[j]
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOHSCROLL"
            ENDIF
         ENDIF
         IF ::aNoLoadTrans[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOLOADTRANSPARENT"
         ENDIF
         IF NOTEMPTY( ::aFontNameFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONT " + ::aFontNameFrm[j]
         ENDIF
         IF NOTZERO( ::aFontSizeFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SIZE " + AllTrim( ::aFontSizeFrm[j] )
         ENDIF
         IF ::aFontBold[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOLD"
         ENDIF
         IF ::aFontItalic[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITALIC"
         ENDIF
         IF ::aFontUnderline[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UNDERLINE"
         ENDIF
         IF ::aFontStrikeout[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRIKEOUT"
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF NOTEMPTY( ::aOnCancel[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CANCEL " + AllTrim( ::aOnCancel[j] )
         ENDIF
         IF NOTEMPTY( ::aOnGotFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON GOTFOCUS " + AllTrim( ::aOnGotFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnChange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CHANGE " + AllTrim( ::aOnChange[j] )
         ENDIF
         IF NOTEMPTY( ::aOnLostFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LOSTFOCUS " + AllTrim( ::aOnLostFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnEnter[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON ENTER " + AllTrim( ::aOnEnter[j] )
         ENDIF
         IF NOTEMPTY( ::aOnDispChange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON DISPLAYCHANGE " + AllTrim( ::aOnDispChange[j] )
         ENDIF
         IF ::aNoTabStop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTABSTOP"
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF NOTEMPTY( ::aImage[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "IMAGE " + AllTrim( ::aImage[j] )
         ENDIF
         IF NOTEMPTY( ::aImageSource[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "IMAGESOURCE " + AllTrim( ::aImageSource[j] )
         ENDIF
         IF ::aFit[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FIT"
         ENDIF
         IF ::aSort[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SORT"
         ENDIF
         IF ::aRTL[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF NOTZERO( ::aTextHeight[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TEXTHEIGHT " + AllTrim( ::aTextHeight[j] )
         ENDIF
         IF NOTZERO( ::aEditHeight[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "EDITHEIGHT " + AllTrim( ::aEditHeight[j] )
         ENDIF
         IF NOTZERO( ::aOptHeight[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OPTIONSHEIGHT " + AllTrim( ::aOptHeight[j] )
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF ::aFirstItem[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FIRSTITEM"
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF ::aFontColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONTCOLOR " + ::ColorStrToColorDef( ::aFontColor[j] )
         ENDIF
         IF NOTZERO( ::aListWidth[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "LISTWIDTH " + AllTrim( ::aListWidth[j] )
         ENDIF
         IF NOTEMPTY( ::aOnListDisplay[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LISTDISPLAY " + AllTrim( ::aOnListDisplay[j] )
         ENDIF
         IF NOTEMPTY( ::aOnListClose[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LISTCLOSE " + AllTrim( ::aOnListClose[j] )
         ENDIF
         IF ::aDelayedLoad[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DELAYEDLOAD"
         ENDIF
         IF ::aIncremental[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INCREMENTAL"
         ENDIF
         IF ::aIntegHeight[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INTEGRALHEIGHT"
         ENDIF
         IF ::aRefresh[j] == ".T."
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "REFRESH"
         ELSEIF ::aRefresh[j] == ".F."
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOREFRESH"
         ENDIF
         IF NOTEMPTY( ::aSourceOrder[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SOURCEORDER " + AllTrim( ::aSourceOrder[j] )
         ENDIF
         IF NOTEMPTY( ::aOnRefresh[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON REFRESH " + AllTrim( ::aOnRefresh[j] )
         ENDIF
         IF NOTZERO( ::aSearchLapse[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SEARCHLAPSE " + AllTrim( ::aSearchLapse[j] )
         ENDIF
         IF ::aBreak[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BREAK"
         ENDIF
         IF NOTEMPTY( ::aGripperText[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "GRIPPERTEXT " + AllTrim( ::aGripperText[j] )
         ENDIF
         IF ::aAutoSize[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "AUTOSIZE"
         ENDIF
         IF NOTEMPTY( ::aCue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CUEBANNER " + AllTrim( ::aCue[j] )
         ENDIF
         IF NOTEMPTY( ::aValueIs[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + AllTrim( ::aValueIs[j] )
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_DATEPICKER ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " DATEPICKER " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         IF NOTEMPTY( ::aValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + AllTrim( ::aValue[j] )
         ENDIF
         IF NOTEMPTY( ::aField[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FIELD " + AllTrim( ::aField[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF NOTEMPTY( ::aFontNameFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONT " + ::aFontNameFrm[j]
         ENDIF
         IF NOTZERO( ::aFontSizeFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SIZE " + AllTrim( ::aFontSizeFrm[j] )
         ENDIF
         IF ::aFontBold[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOLD"
         ENDIF
         IF ::aFontItalic[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITALIC"
         ENDIF
         IF ::aFontUnderline[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UNDERLINE"
         ENDIF
         IF ::aFontStrikeout[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRIKEOUT"
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF ::aShowNone[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SHOWNONE"
         ENDIF
         IF ::aUpDown[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UPDOWN"
         ENDIF
         IF ::aRightAlign[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RIGHTALIGN"
         ENDIF
         IF NOTEMPTY( ::aOnGotFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON GOTFOCUS " + AllTrim( ::aOnGotFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnChange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CHANGE " + AllTrim( ::aOnChange[j] )
         ENDIF
         IF NOTEMPTY( ::aOnLostFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LOSTFOCUS " + AllTrim( ::aOnLostFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnEnter[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON ENTER " + AllTrim( ::aOnEnter[j] )
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aNoTabStop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTABSTOP"
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF ::aNoBorder[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOBORDER"
         ENDIF
         IF ::aRTL[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF NOTEMPTY( ::aRange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RANGE " + AllTrim( ::aRange[j] )
         ENDIF
         IF NOTEMPTY( ::aFormat[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DATEFORMAT " + AllTrim( ::aFormat[j] )
         ENDIF
         IF NOTEMPTY( ::aValid[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALID " + AllTrim( ::aValid[j] )
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_EDITBOX ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " EDITBOX " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF NOTEMPTY( ::aField[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FIELD " + AllTrim( ::aField[j] )
         ENDIF
         IF Len( ::aValue[j] ) > 0
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + AllTrim( ::aValue[j] )
         ENDIF
         IF ::aReadOnly[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "READONLY"
         ENDIF
         IF NOTEMPTY( ::aFontNameFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONT " + ::aFontNameFrm[j]
         ENDIF
         IF NOTZERO( ::aFontSizeFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SIZE " + AllTrim( ::aFontSizeFrm[j] )
         ENDIF
         IF ::aFontBold[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOLD"
         ENDIF
         IF ::aFontItalic[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITALIC"
         ENDIF
         IF ::aFontUnderline[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UNDERLINE"
         ENDIF
         IF ::aFontStrikeout[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRIKEOUT"
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF ::aFontColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONTCOLOR " + ::ColorStrToColorDef( ::aFontColor[j] )
         ENDIF
         IF NOTZERO( ::aMaxLength[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "MAXLENGTH " + AllTrim( ::aMaxLength[j] )
         ENDIF
         IF NOTEMPTY( ::aOnGotFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON GOTFOCUS " + AllTrim( ::aOnGotFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnChange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CHANGE " + AllTrim( ::aOnChange[j] )
         ENDIF
         IF NOTEMPTY( ::aOnLostFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LOSTFOCUS " + AllTrim( ::aOnLostFocus[j] )
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aNoTabStop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTABSTOP"
         ENDIF
         IF ::aNoVScroll[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOVSCROLL"
         ENDIF
         IF ::aNoHScroll[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOHSCROLL"
         ENDIF
         IF ::aRTL[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF ::aNoBorder[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOBORDER"
         ENDIF
         IF NOTEMPTY( ::aFocusedPos[j] ) .AND. ( Type( ::aFocusedPos[j] ) # "N" .OR. ::aFocusedPos[j] <> "-4" )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FOCUSEDPOS " + AllTrim( ::aFocusedPos[j] )
         ENDIF
         IF NOTEMPTY( ::aOnVScroll[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON VSCROLL " + AllTrim( ::aOnVScroll[j] )
         ENDIF
         IF NOTEMPTY( ::aOnHScroll[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON HSCROLL " + AllTrim( ::aOnHScroll[j] )
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF NOTZERO( ::aInsertType[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INSERTTYPE " + AllTrim( ::aInsertType[j] )
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF ::aBreak[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BREAK"
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_FRAME ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " FRAME " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF NOTEMPTY( ::aCaption[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CAPTION " + AllTrim( ::aCaption[j] )
         ENDIF
         IF NOTEMPTY( ::aFontNameFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONT " + ::aFontNameFrm[j]
         ENDIF
         IF NOTZERO( ::aFontSizeFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SIZE " + AllTrim( ::aFontSizeFrm[j] )
         ENDIF
         IF ::aFontBold[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOLD"
         ENDIF
         IF ::aFontItalic[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITALIC"
         ENDIF
         IF ::aFontUnderline[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UNDERLINE"
         ENDIF
         IF ::aFontStrikeout[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRIKEOUT"
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF ::aFontColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONTCOLOR " + ::ColorStrToColorDef( ::aFontColor[j] )
         ENDIF
         IF ::aOpaque[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OPAQUE"
         ENDIF
         IF ::aTransparent[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TRANSPARENT"
         ENDIF
         IF ::aRTL[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
            IF NOTEMPTY( ::aExclude[j] )
              Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "EXCLUDEAREA " + AllTrim( ::aExclude[j] )
            ENDIF
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_GRID ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " GRID " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEADERS " + AllTrim( ::aHeaders[j] )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTHS " + AllTrim( ::aWidths[j] )
         IF NOTEMPTY( ::aInputMask[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INPUTMASK " + AllTrim( ::aInputMask[j] )
         ENDIF
         IF NOTEMPTY( ::aItems[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITEMS " + AllTrim( ::aItems[j] )
         ENDIF
         IF NOTZERO( ::aValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + AllTrim( ::aValue[j] )
         ENDIF
         IF NOTEMPTY( ::aFontNameFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONT " + ::aFontNameFrm[j]
         ENDIF
         IF NOTZERO( ::aFontSizeFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SIZE " + AllTrim( ::aFontSizeFrm[j] )
         ENDIF
         IF ::aFontBold[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOLD"
         ENDIF
         IF ::aFontItalic[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITALIC"
         ENDIF
         IF ::aFontUnderline[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UNDERLINE"
         ENDIF
         IF ::aFontStrikeout[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRIKEOUT"
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF ::aFontColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONTCOLOR " + ::ColorStrToColorDef( ::aFontColor[j] )
         ENDIF
         IF NOTEMPTY( AllTrim( ::aDynBackColor[j] ) )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DYNAMICBACKCOLOR " + AllTrim( ::aDynBackColor[j] )
         ENDIF
         IF NOTEMPTY( AllTrim( ::aDynForeColor[j] ) )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DYNAMICFORECOLOR " + AllTrim( ::aDynForeColor[j] )
         ENDIF
         IF NOTEMPTY( ::aOnGotFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON GOTFOCUS " + AllTrim( ::aOnGotFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnChange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CHANGE " + AllTrim( ::aOnChange[j] )
         ENDIF
         IF NOTEMPTY( ::aOnLostFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LOSTFOCUS " + AllTrim( ::aOnLostFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnDblClick[j] ) 
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON DBLCLICK " + AllTrim( ::aOnDblClick[j] )
         ENDIF
         IF NOTEMPTY( ::aAction[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ACTION " + AllTrim( ::aAction[j] )
         ENDIF
         IF NOTEMPTY( ::aOnHeadClick[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON HEADCLICK " + AllTrim( ::aOnHeadClick[j] )
         ENDIF
         IF NOTEMPTY( ::aOnHeadDClick[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON HEADDBLCLICK " + AllTrim( ::aOnHeadDClick[j] )
         ENDIF
         IF ::aEdit[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "EDIT"
         ENDIF
         IF ::aVirtual[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VIRTUAL"
         ENDIF
         IF NOTZERO( ::aItemCount[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITEMCOUNT " + AllTrim( ::aItemCount[j] )
         ENDIF
         IF NOTEMPTY( ::aTimeOut[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TIMEOUT " + AllTrim( ::aTimeOut[j] )
         ENDIF
         IF NOTEMPTY( ::aOnQueryData[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON QUERYDATA " + AllTrim( ::aOnQueryData[j] )
         ENDIF
         IF ::aMultiSelect[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "MULTISELECT"
         ENDIF
         IF ::aNoLines[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOLINES"
         ENDIF
         IF NOTEMPTY( ::aImage[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "IMAGE " + AllTrim( ::aImage[j] )
         ENDIF
         IF NOTEMPTY( ::aJustify[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "JUSTIFY " + AllTrim( ::aJustify[j] )
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aBreak[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BREAK"
         ENDIF
         IF ::aRTL[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF ::aInPlace[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INPLACE"
         ENDIF
         IF NOTEMPTY( ::aColumnCtrls[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "COLUMNCONTROLS " + AllTrim( ::aColumnCtrls[j] )
         ENDIF
         IF NOTEMPTY( ::aReadOnlyArray[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "READONLY " + AllTrim( ::aReadOnlyArray[j] )
         ENDIF
         IF NOTEMPTY( ::aValid[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALID " + AllTrim( ::aValid[j] )
         ENDIF
         IF NOTEMPTY( ::aValidMess[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALIDMESSAGES " + AllTrim( ::aValidMess[j] )
         ENDIF
         IF NOTEMPTY( ::aOnEditCell[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON EDITCELL " + AllTrim( ::aOnEditCell[j] )
         ENDIF
         IF ::aNoHeaders[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOHEADERS"
         ENDIF
         IF NOTEMPTY( ::aWhen[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WHEN " + AllTrim( ::aWhen[j] )
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF ::aNoTabStop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTABSTOP"
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF NOTEMPTY( ::aOnEnter[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON ENTER " + AllTrim( ::aOnEnter[j] )
         ENDIF
         IF NOTEMPTY( ::aHdrFontClrs[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEADERCOLORS " + AllTrim( ::aHdrFontClrs[j] )
         ENDIF
         IF NOTEMPTY( ::aHdrBackClrs[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEADERBACKCOLORS " + AllTrim( ::aHdrBackClrs[j] )
         ENDIF
         IF NOTEMPTY( ::aHdrImages[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEADERIMAGES " + AllTrim( ::aHdrImages[j] )
         ENDIF
         IF NOTEMPTY( ::aHdrImgAlign[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEADERIMAGESALIGN " + AllTrim( ::aHdrImgAlign[j] )
         ENDIF
         IF ::aFullMove[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FULLMOVE"
         ENDIF
         IF ::aNavByCell[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NAVIGATEBYCELL"
            IF ::aFocusRect[j] == ".T."
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FOCUSRECT"
            ENDIF
         ELSE
            IF ::aFocusRect[j] == ".F."
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOFOCUSRECT"
            ENDIF
         ENDIF
         IF NOTEMPTY( AllTrim( ::aSelColor[j] ) )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SELECTEDCOLORS " + AllTrim( ::aSelColor[j] )
         ENDIF
         IF NOTEMPTY( ::aEditKeys[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "EDITKEYS " + AllTrim( ::aEditKeys[j] )
         ENDIF
         IF NOTEMPTY( ::aEditKeysFun[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "EDITKEYSFUN " + AllTrim( ::aEditKeysFun[j] )
         ENDIF
         IF ::aCheckBoxes[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CHECKBOXES"
         ENDIF
         IF NOTEMPTY( ::aOnCheckChg[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CHECKCHANGE " + AllTrim( ::aOnCheckChg[j] )
         ENDIF
         IF ::aSingleBuffer[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SINGLEBUFFER"
         ENDIF
         IF ::aPLM[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PAINTLEFTMARGIN"
         ENDIF
         IF ::aFixedCols[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FIXEDCOLS"
         ENDIF
         IF NOTEMPTY( ::aOnAbortEdit[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON ABORTEDIT " + AllTrim( ::aOnAbortEdit[j] )
         ENDIF
         IF ::aFixedWidths[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FIXEDWIDTHS"
         ENDIF
         IF NOTEMPTY( ::aBeforeColMove[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BEFORECOLMOVE " + AllTrim( ::aBeforeColMove[j] )
         ENDIF
         IF NOTEMPTY( ::aAfterColMove[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "AFTERCOLMOVE " + AllTrim( ::aAfterColMove[j] )
         ENDIF
         IF NOTEMPTY( ::aBeforeColSize[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BEFORECOLSIZE " + AllTrim( ::aBeforeColSize[j] )
         ENDIF
         IF NOTEMPTY( ::aAfterColSize[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "AFTERCOLSIZE " + AllTrim( ::aAfterColSize[j] )
         ENDIF
         IF NOTEMPTY( ::aBeforeAutoFit[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BEFOREAUTOFIT " + AllTrim( ::aBeforeAutoFit[j] )
         ENDIF
         IF ::aEditLikeExcel[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "EDITLIKEEXCEL"
         ENDIF
         IF ::aUseButtons[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "USEBUTTONS"
         ENDIF
         IF ::aDelete[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DELETE"
         ENDIF
         IF NOTEMPTY( ::aDeleteWhen[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DELETEWHEN " + AllTrim( ::aDeleteWhen[j] )
         ENDIF
         IF NOTEMPTY( ::aDeleteMsg[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DELETEMSG " + AllTrim( ::aDeleteMsg[j] )
         ENDIF
         IF NOTEMPTY( ::aOnDelete[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON DELETE " + AllTrim( ::aOnDelete[j] )
         ENDIF
         IF ::aNoDefMsg[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NODEFAULTMSG"
         ENDIF
         IF ::aNoDelMsg[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NODELETEMSG"
         ENDIF
         IF ::aAppend[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "APPEND"
         ENDIF
         IF NOTEMPTY( ::aOnAppend[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON APPEND " + AllTrim( ::aOnAppend[j] )
         ENDIF
         IF ::aNoModalEdit[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOMODALEDIT"
         ENDIF
         IF ::aFixedCtrls[j] == ".T."
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FIXEDCONTROLS"
         ELSEIF ::aFixedCtrls[j] == ".F."
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DYNAMICCONTROLS"
         ENDIF
         IF NOTEMPTY( ::aOnHeadRClick[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON HEADRCLICK " + AllTrim( ::aOnHeadRClick[j] )
         ENDIF
         IF ::aNoClickOnChk[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOCLICKONCHECKBOX"
         ENDIF
         IF ::aNoRClickOnChk[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NORCLICKONCHECKBOX"
         ENDIF
         IF ::aExtDblClick[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "EXTDBLCLICK"
         ENDIF
         IF ::aSilent[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SILENT"
         ENDIF
         IF ::aEnableAltA[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ENABLEALTA"
         ENDIF
          IF ::aNoShowAlways[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOSHOWALWAYS"
         ENDIF
         IF ::aNoneUnsels[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NONEUNSELS"
         ENDIF
         IF ::aChgBefEdit[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CHANGEBEFOREEDIT"
         ENDIF
         IF NOTEMPTY( ::aOnRClick[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON RCLICK " + AllTrim( ::aOnRClick[j] )
         ENDIF
         IF NOTEMPTY( ::aOnBfrInsert[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON BEFOREINSERT " + AllTrim( ::aOnBfrInsert[j] )
         ENDIF
         IF NOTEMPTY( ::aOnInsert[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON INSERT " + AllTrim( ::aOnInsert[j] )
         ENDIF
         IF NOTEMPTY( ::aOnEditCellEnd[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON EDITCELLEND " + AllTrim( ::aOnEditCellEnd[j] )
         ENDIF
         IF ::aEditFirstVis[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "EDITFIRSTVISIBLE"
         ENDIF
         IF NOTEMPTY( ::aOnBfrEdtCell[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON BEFOREEDITCELL " + AllTrim( ::aOnBfrEdtCell[j] )
         ENDIF
         IF NOTEMPTY( ::aEditCellValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "EDITCELLVALUE " + AllTrim( ::aEditLabels[j] )
         ENDIF
         IF ::aKeysLkClp[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "KEYSLIKECLIPPER"
         ENDIF
         IF ::aCellToolTip[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CELLTOOLTIP"
         ENDIF
         IF ::aNoHScroll[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOHSCROLL"
         ENDIF
         IF ::aNoVScroll[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOVSCROLL"
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_HOTKEYBOX ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " HOTKEYBOX " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF NOTEMPTY( ::aValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + AllTrim( ::aValue[j] )
         ENDIF
         IF NOTEMPTY( ::aFontNameFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONT " + ::aFontNameFrm[j]
         ENDIF
         IF NOTZERO( ::aFontSizeFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SIZE " + AllTrim( ::aFontSizeFrm[j] )
         ENDIF
         IF ::aFontBold[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOLD"
         ENDIF
         IF ::aFontItalic[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITALIC"
         ENDIF
         IF ::aFontUnderline[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UNDERLINE"
         ENDIF
         IF ::aFontStrikeout[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRIKEOUT"
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF ::aFontColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONTCOLOR " + ::ColorStrToColorDef( ::aFontColor[j] )
         ENDIF
         IF NOTEMPTY( ::aOnChange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CHANGE " + AllTrim( ::aOnChange[j] )
         ENDIF
         IF NOTEMPTY( ::aOnGotFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON GOTFOCUS " + AllTrim( ::aOnGotFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnLostFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LOSTFOCUS " + AllTrim( ::aOnLostFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnEnter[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON ENTER " + AllTrim( ::aOnEnter[j] )
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aNoTabStop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTABSTOP"
         ENDIF
         IF ::aRTL[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF ::aNoAlt[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOALT"
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_HYPERLINK ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " HYPERLINK " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF NOTEMPTY( ::aValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + AllTrim( ::aValue[j], .T. )
         ELSE
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + "'ooHG Home'"
         ENDIF
         IF NOTEMPTY( ::aAddress[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ADDRESS " + AllTrim( ::aAddress[j] )
         ELSE
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ADDRESS " + DQM( "https://oohg.github.io/" )
         ENDIF
         IF ::aAutoSize[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "AUTOSIZE"
         ENDIF
         IF NOTEMPTY( ::aFontNameFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONT " + ::aFontNameFrm[j]
         ENDIF
         IF NOTZERO( ::aFontSizeFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SIZE " + AllTrim( ::aFontSizeFrm[j] )
         ENDIF
         IF ::aFontBold[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOLD"
         ENDIF
         IF ::aFontItalic[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITALIC"
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF ::aFontColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONTCOLOR " + ::ColorStrToColorDef( ::aFontColor[j] )
         ENDIF
         IF ::aBorder[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BORDER"
         ENDIF
         IF ::aClientEdge[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CLIENTEDGE"
         ENDIF
         IF ::aHScroll[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HSCROLL"
         ENDIF
         IF ::aVScroll[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VSCROLL"
         ENDIF
         IF ::aTransparent[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TRANSPARENT"
         ENDIF
         IF ::aHandCursor[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HANDCURSOR"
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aRTL[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_IMAGE ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " IMAGE " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         IF NOTEMPTY( ::aAction[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ACTION " + AllTrim( ::aAction[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF ::aStretch[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRETCH"
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aRTL[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF ::aWhiteBack[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WHITEBACKGROUND"
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF NOTEMPTY( ::aPicture[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PICTURE " + AllTrim( ::aPicture[j] )
         ENDIF
         IF NOTEMPTY( ::aBuffer[j] )
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BUFFER " + AllTrim( ::aBuffer[j] )
         ENDIF
         IF NOTEMPTY( ::aHBitmap[j] )
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HBITMAP " + AllTrim( ::aHBitmap[j] )
         ENDIF
         IF ::aNoResize[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NORESIZE" 
         ENDIF
         IF ::aImageSize[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "IMAGESIZE"
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF ::aBorder[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BORDER"
         ENDIF
         IF ::aClientEdge[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CLIENTEDGE"
         ENDIF
         IF ::aNoLoadTrans[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOLOADTRANSPARENT"
         ENDIF
         IF ::aNo3DColors[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NO3DCOLORS"
         ENDIF
         IF ::aNoDIBSection[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NODIBSECTION"
         ENDIF
         IF ::aTransparent[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TRANSPARENT"
         ENDIF
         IF NOTEMPTY( ::aExclude[j] )
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "EXCLUDEAREA " + AllTrim( ::aExclude[j] )
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF NOTEMPTY( ::aOnChange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CHANGE " + AllTrim( ::aOnChange[j] )
         ENDIF
         IF NOTEMPTY( ::aOnRClick[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON RCLICK " + AllTrim( ::aOnRClick[j] )
         ENDIF
         IF NOTEMPTY( ::aOnMClick[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON MCLICK " + AllTrim( ::aOnMClick[j] )
         ENDIF
         IF NOTEMPTY( ::aOnDblClick[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON DBLCLICK " + AllTrim( ::aOnDblClick[j] )
         ENDIF
         IF NOTEMPTY( ::aOnRDClick[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON RDBLCLICK " + AllTrim( ::aOnRDClick[j] )
         ENDIF
         IF NOTEMPTY( ::aOnMDClick[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON MDBLCLICK " + AllTrim( ::aOnMDClick[j] )
         ENDIF
         IF NOTEMPTY( ::aOnMouseMove[j] )
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON MOUSEMOVE " + AllTrim( ::aOnMouseMove[j] )
         ENDIF
         IF NOTEMPTY( ::aOnMouseLeave[j] )
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON MOUSELEAVE " + AllTrim( ::OnMouseLeave[j] )
         ENDIF
         IF ::aNoChkDepth[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOCHECKDEPTH"
         ENDIF
         IF ::aNoPRedraw[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOPARENTREDRAW"
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_IPADDRESS ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " IPADDRESS " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF NOTEMPTY( ::aValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + AllTrim( ::aValue[j] )
         ENDIF
         IF NOTEMPTY( ::aFontNameFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONT " + ::aFontNameFrm[j]
         ENDIF
         IF NOTZERO( ::aFontSizeFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SIZE " + AllTrim( ::aFontSizeFrm[j] )
         ENDIF
         IF ::aFontBold[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOLD"
         ENDIF
         IF ::aFontItalic[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITALIC"
         ENDIF
         IF ::aFontUnderline[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UNDERLINE"
         ENDIF
         IF ::aFontStrikeout[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRIKEOUT"
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF NOTEMPTY( ::aOnChange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CHANGE " + AllTrim( ::aOnChange[j] )
         ENDIF
         IF NOTEMPTY( ::aOnGotFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON GOTFOCUS " + AllTrim( ::aOnGotFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnLostFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LOSTFOCUS " + AllTrim( ::aOnLostFocus[j] )
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aNoTabStop[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTABSTOP"
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF ::aRTL[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF ::aFontColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONTCOLOR " + ::ColorStrToColorDef( ::aFontColor[j] )
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_LABEL ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " LABEL " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         IF NOTEMPTY( ::aValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + AllTrim( ::aValue[j] )
         ENDIF
         IF NOTEMPTY( ::aAction[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ACTION " + AllTrim( ::aAction[j] )
         ENDIF
         IF ::aAutoSize[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "AUTOSIZE"
         ELSEIF ::aAutoHeight[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "AUTOHEIGHT"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         ELSEIF ::aAutoWidth[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "AUTOWIDTH"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         ELSE
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         ENDIF
         IF NOTEMPTY( ::aFontNameFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONT " + ::aFontNameFrm[j]
         ENDIF
         IF NOTZERO( ::aFontSizeFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SIZE " + AllTrim( ::aFontSizeFrm[j] )
         ENDIF
         IF ::aFontBold[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOLD"
         ENDIF
         IF ::aFontItalic[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITALIC"
         ENDIF
         IF ::aFontUnderline[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UNDERLINE"
         ENDIF
         IF ::aFontStrikeout[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRIKEOUT"
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF ::aFontColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONTCOLOR " + ::ColorStrToColorDef( ::aFontColor[j] )
         ENDIF
         IF ::aBorder[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BORDER"
         ENDIF
         IF ::aClientEdge[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CLIENTEDGE"
         ENDIF
         IF ::aHScroll[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HSCROLL"
         ENDIF
         IF ::aVScroll[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VSCROLL"
         ENDIF
         IF ::aTransparent[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TRANSPARENT"
         ENDIF
         IF ::aRightAlign[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RIGHTALIGN"
         ENDIF
         IF ::aCenterAlign[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CENTERALIGN"
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aRTL[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF ::aNoWrap[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOWORDWRAP"
         ENDIF
         IF ::aNoPrefix[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOPREFIX"
         ENDIF
         IF NOTEMPTY( ::aInputMask[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INPUTMASK " + AllTrim( ::aInputMask[j] )
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF ::aVCenter[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VCENTERALIGN"
         ENDIF
         IF NOTEMPTY( ::aOnDblClick[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON DBLCLICK " + AllTrim( ::aOnDblClick[j] )
         ENDIF
         IF NOTEMPTY( ::aOnMouseLeave[j] )
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON MOUSELEAVE " + AllTrim( ::aOnMouseLeave[j] )
         ENDIF
         IF NOTEMPTY( ::aOnMouseMove[j] )
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON MOUSEMOVE " + AllTrim( ::aOnMouseMove[j] )
         ENDIF
         IF NOTEMPTY( ::aCursor[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CURSOR" + AllTrim( ::aCursor[j] )
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_LISTBOX ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " LISTBOX " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF NOTEMPTY( ::aItems[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITEMS " + AllTrim( ::aItems[j] )
         ENDIF
         IF NOTZERO( ::aValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + AllTrim( ::aValue[j] )
         ENDIF
         IF NOTEMPTY( ::aFontNameFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONT " + ::aFontNameFrm[j]
         ENDIF
         IF NOTZERO( ::aFontSizeFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SIZE " + AllTrim( ::aFontSizeFrm[j] )
         ENDIF
         IF ::aFontBold[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOLD"
         ENDIF
         IF ::aFontItalic[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITALIC"
         ENDIF
         IF ::aFontUnderline[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UNDERLINE"
         ENDIF
         IF ::aFontStrikeout[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRIKEOUT"
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF ::aFontColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONTCOLOR " + ::ColorStrToColorDef( ::aFontColor[j] )
         ENDIF
         IF NOTEMPTY( ::aOnGotFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON GOTFOCUS " + AllTrim( ::aOnGotFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnChange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CHANGE " + AllTrim( ::aOnChange[j] )
         ENDIF
         IF NOTEMPTY( ::aOnLostFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LOSTFOCUS " + AllTrim( ::aOnLostFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnDblClick[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON DBLCLICK " + AllTrim( ::aOnDblClick[j] )
         ENDIF
         IF NOTEMPTY( ::aOnEnter[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON ENTER " + AllTrim( ::aOnEnter[j] )
         ENDIF
         IF ::aMultiSelect[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "MULTISELECT"
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aNoTabStop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTABSTOP"
         ENDIF
         IF ::aSort[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SORT"
         ENDIF
         IF ::aRTL[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF NOTEMPTY( ::aImage[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "IMAGE " + AllTrim( ::aImage[j] )
            IF ::aFit[j]
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FIT "
            ENDIF
         ENDIF
         IF NOTZERO( ::aTextHeight[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TEXTHEIGHT " + AllTrim( ::aTextHeight[j] )
         ENDIF
         IF ::aNoVScroll[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOVSCROLL"
         ENDIF
         IF ::aMultiCol[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "MULTICOLUMN"
            IF NOTZERO( ::aColWidth[j] )
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "COLUMNWIDTH " + AllTrim( ::aColWidth[j] )
            ENDIF
         ENDIF
         IF ::aMultiTab[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "MULTITAB"
            IF NOTEMPTY( ::aTabsWidth[j] )
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TABSWIDTH " + AllTrim( ::aTabsWidth[j] )
            ENDIF
         ENDIF
         IF ::aDragItems[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DRAGITEMS"
         ENDIF
         IF ::aBreak[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BREAK"
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_MONTHCALENDAR ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " MONTHCALENDAR " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         IF NOTEMPTY( ::aValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + AllTrim( ::aValue[j] )
         ENDIF
         IF NOTEMPTY( ::aFontNameFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONT " + ::aFontNameFrm[j]
         ENDIF
         IF NOTZERO( ::aFontSizeFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SIZE " + AllTrim( ::aFontSizeFrm[j] )
         ENDIF
         IF ::aFontBold[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOLD"
         ENDIF
         IF ::aFontItalic[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITALIC"
         ENDIF
         IF ::aFontUnderline[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UNDERLINE"
         ENDIF
         IF ::aFontStrikeout[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRIKEOUT"
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF ::aNoToday[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTODAY"
         ENDIF
         IF ::aNoTodayCircle[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTODAYCIRCLE"
         ENDIF
         IF ::aWeekNumbers[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WEEKNUMBERS"
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aNoTabStop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTABSTOP"
         ENDIF
         IF NOTEMPTY( ::aOnChange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CHANGE " + AllTrim( ::aOnChange[j] )
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aRTL[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF ::aFontColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONTCOLOR " + ::ColorStrToColorDef( ::aFontColor[j] )
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF ::aTitleFontClr[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TITLEFONTCOLOR " + ::ColorStrToColorDef( ::aTitleFontClr[j] )
         ENDIF
         IF ::aTitleBackClr[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TITLEBACKCOLOR " + ::ColorStrToColorDef( ::aTitleBackClr[j] )
         ENDIF
         IF ::aTrailFontClr[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TRAILINGFONTCOLOR " + ::ColorStrToColorDef( ::aTrailFontClr[j] )
         ENDIF
         IF ::aBackgroundClr[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKGROUNDCOLOR " + ::ColorStrToColorDef( ::aBackgroundClr[j] )
         ENDIF
         IF ::aMultiSelect[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "MULTISELECT"
         ENDIF
         IF NOTEMPTY( ::aOnViewChange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON VIEWCHANGE " + AllTrim( ::aOnViewChange[j] )
         ENDIF
         IF NOTEMPTY( ::aOnGotFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON GOTFOCUS " + AllTrim( ::aOnGotFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnLostFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LOSTFOCUS " + AllTrim( ::aOnLostFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_PICBUTT ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " BUTTON " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         IF NOTEMPTY( ::aAction[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ACTION " + AllTrim( ::aAction[j] )
         ELSE
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ACTION " + "MsgInfo( 'Picbutton Pressed!' )"
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF ::aFlat[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FLAT"
         ENDIF
         IF NOTEMPTY( ::aOnGotFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON GOTFOCUS " + AllTrim( ::aOnGotFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnLostFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LOSTFOCUS " + AllTrim( ::aOnLostFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnMouseMove[j] )
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON MOUSEMOVE " + AllTrim( ::aOnMouseMove[j] )
         ENDIF
         IF ::aNoTabStop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTABSTOP"
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF NOTEMPTY( ::aPicture[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PICTURE " + AllTrim( ::aPicture[j] )
         ENDIF
         IF NOTEMPTY( ::aBuffer[j] )
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BUFFER " + AllTrim( ::aBuffer[j] )
         ENDIF
         IF NOTEMPTY( ::aHBitmap[j] )
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HBITMAP " + AllTrim( ::aHBitmap[j] )
         ENDIF
         IF ::aNoLoadTrans[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOLOADTRANSPARENT"
         ENDIF
         IF ::aStretch[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRETCH"
         ENDIF
         IF ::aCancel[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CANCEL"
         ENDIF
         IF NOTEMPTY( ::aImageAlign[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "IMAGEALIGN " + Upper( AllTrim( ::aImageAlign[j] ) ) + " "
         ENDIF
         IF NOTEMPTY( ::aDrawBy[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + AllTrim( ::aDrawBy[j] )
         ENDIF
         IF NOTEMPTY( ::aImageMargin[j] )
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "IMAGEMARGIN " + AllTrim( ::aImageMargin[j] )
         ENDIF
         IF ::aNo3DColors[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NO3DCOLORS"
         ENDIF
         IF ::aForceScale[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FORCESCALE"
         ENDIF
         IF ::aDIBSection[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DIBSECTION"
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF ::aSolid[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SOLID"
         ENDIF
         IF ::aNoHotLight[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOHOTLIGHT"
         ENDIF
         IF ::aImageSize[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "IMAGESIZE"
         ENDIF
         IF ::aFitImg[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FITIMG"
         ENDIF
         IF ::aTransparent[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TRANSPARENT"
         ENDIF
         IF ::aNoFocusRect[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOFOCUSRECT"
         ENDIF
         IF ::aNoImgList[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOIMAGELIST"
         ENDIF
         IF ::aNoDestroy[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NODESTROY"
         ENDIF
         IF ::aHandCursor[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HANDCURSOR"
         ENDIF
         IF ::aDefault[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DEFAULT"
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_PICCHECKBUTT ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " CHECKBUTTON " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF NOTEMPTY( ::aValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + AllTrim( ::aValue[j] )
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF NOTEMPTY( ::aOnGotFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON GOTFOCUS " + AllTrim( ::aOnGotFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnChange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CHANGE " + AllTrim( ::aOnChange[j] )
         ENDIF
         IF NOTEMPTY( ::aOnLostFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LOSTFOCUS " + AllTrim( ::aOnLostFocus[j] )
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aNoTabStop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTABSTOP"
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF NOTEMPTY( ::aPicture[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PICTURE " + AllTrim( ::aPicture[j] )
         ENDIF
         IF NOTEMPTY( ::aBuffer[j] )
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BUFFER " + AllTrim( ::aBuffer[j] )
         ENDIF
         IF NOTEMPTY( ::aHBitmap[j] )
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HBITMAP " + AllTrim( ::aHBitmap[j] )
         ENDIF
         IF ::aNoLoadTrans[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOLOADTRANSPARENT"
         ENDIF
         IF ::aStretch[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRETCH"
         ENDIF
         IF NOTEMPTY( ::aField[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FIELD " + AllTrim( ::aField[j] )
         ENDIF
         IF ::aNo3DColors[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NO3DCOLORS"
         ENDIF
         IF ::aForceScale[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FORCESCALE"
         ENDIF
         IF ::aDIBSection[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DIBSECTION"
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF ::aSolid[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SOLID"
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF NOTEMPTY( ::aDrawBy[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + AllTrim( ::aDrawBy[j] )
         ENDIF
         IF NOTEMPTY( ::aImageMargin[j] )
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "IMAGEMARGIN " + AllTrim( ::aImageMargin[j] )
         ENDIF
         IF ::aFitImg[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FITIMG"
         ENDIF
         IF NOTEMPTY( ::aOnMouseMove[j] )
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON MOUSEMOVE " + AllTrim( ::aOnMouseMove[j] )
         ENDIF
         IF NOTEMPTY( ::aImageAlign[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "IMAGEALIGN " + Upper( AllTrim( ::aImageAlign[j] ) ) + " "
         ENDIF
         IF ::aFlat[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FLAT"
         ENDIF
         IF ::aNoHotLight[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOHOTLIGHT"
         ENDIF
         IF ::aImageSize[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "IMAGESIZE"
         ENDIF
         IF ::aTransparent[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TRANSPARENT"
         ENDIF
         IF ::aNoFocusRect[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOFOCUSRECT"
         ENDIF
         IF ::aNoImgList[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOIMAGELIST"
         ENDIF
         IF ::aNoDestroy[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NODESTROY"
         ENDIF
         IF ::aHandCursor[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HANDCURSOR"
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_PICTURE ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " PICTURE " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         IF NOTEMPTY( ::aAction[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ACTION " + AllTrim( ::aAction[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF ::aStretch[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRETCH"
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aRTL[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF NOTEMPTY( ::aPicture[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PICTURE " + AllTrim( ::aPicture[j] )
         ENDIF
         IF NOTEMPTY( ::aBuffer[j] )
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BUFFER " + AllTrim( ::aBuffer[j] )
         ENDIF
         IF NOTEMPTY( ::aHBitmap[j] )
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HBITMAP " + AllTrim( ::aHBitmap[j] )
         ENDIF
         IF ::aForceScale[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FORCESCALE"
         ENDIF
         IF ::aBorder[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BORDER"
         ENDIF
         IF ::aClientEdge[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CLIENTEDGE"
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF ::aImageSize[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "IMAGESIZE"
         ENDIF
         IF ::aNoLoadTrans[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOLOADTRANSPARENT"
         ENDIF
         IF ::aNo3DColors[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NO3DCOLORS"
         ENDIF
         IF ::aNoDIBSection[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NODIBSECTION"
         ENDIF
         IF ::aTransparent[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TRANSPARENT"
         ENDIF
         IF NOTEMPTY( ::aExclude[j] )
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "EXCLUDEAREA " + AllTrim( ::aExclude[j] )
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_PLAYER ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " PLAYER " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FILE " + AllTrim( ::aFile[j] )
         IF ::aNoAutoSizeWin[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOAUTOSIZEWINDOW"
         ENDIF
         IF ::aNoAutoSizeMov[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOAUTOSIZEMOVIE"
         ENDIF
         IF ::aNoErrorDlg[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOERRORDLG"
         ENDIF
         IF ::aNoMenu[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOMENU"
         ENDIF
         IF ::aNoOpen[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOOPEN"
         ENDIF
         IF ::aNoPlayBar[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOPLAYBAR"
         ENDIF
         IF ::aShowAll[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SHOWALL"
         ENDIF
         IF ::aShowMode[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SHOWMODE"
         ENDIF
         IF ::aShowName[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SHOWNAME"
         ENDIF
         IF ::aShowPosition[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SHOWPOSITION"
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aNoTabStop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTABSTOP"
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF ::aRTL[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_PROGRESSBAR ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " PROGRESSBAR " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         IF NOTEMPTY( ::aRange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RANGE " + AllTrim( ::aRange[j] )
         ENDIF
         IF NOTZERO( ::aValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + AllTrim( ::aValue[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF ::aVertical[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VERTICAL"
         ENDIF
         IF ::aSmooth[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SMOOTH"
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF ::aFontColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FORECOLOR " + ::ColorStrToColorDef( ::aFontColor[j] )
         ENDIF
         IF ::aRTL[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF NOTZERO( ::aMarquee[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "MARQUEE " + AllTrim( ::aMarquee[j] )
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_PROGRESSMETER ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " PROGRESSMETER " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         IF NOTEMPTY( ::aRange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RANGE " + AllTrim( ::aRange[j] )
         ENDIF
         IF NOTZERO( ::aValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + AllTrim( ::aValue[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF ::aFontColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FORECOLOR " + ::ColorStrToColorDef( ::aFontColor[j] )
         ENDIF
         IF NOTEMPTY( ::aFontNameFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONT " + ::aFontNameFrm[j]
         ENDIF
         IF NOTZERO( ::aFontSizeFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SIZE " + AllTrim( ::aFontSizeFrm[j] )
         ENDIF
         IF ::aFontBold[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOLD"
         ENDIF
         IF ::aFontItalic[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITALIC"
         ENDIF
         IF ::aFontUnderline[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UNDERLINE"
         ENDIF
         IF ::aFontStrikeout[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRIKEOUT"
         ENDIF
         IF NOTEMPTY( ::aAction[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ACTION " + AllTrim( ::aAction[j] )
         ENDIF
         IF ::aRTL[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF ::aClientEdge[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CLIENTEDGE"
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_RADIOGROUP ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " RADIOGROUP " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         IF NOTEMPTY( ::aOptions[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OPTIONS " + AllTrim( ::aOptions[j] )
         ENDIF
         IF NOTZERO( ::aValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + AllTrim( ::aValue[j] )
         ENDIF
         IF NOTZERO( ::aWidth[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + AllTrim( ::aWidth[j] )
         ENDIF
         IF NOTZERO( ::aHeight[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + AllTrim( ::aHeight[j] )
         ENDIF
         IF NOTZERO( ::aSpacing[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SPACING " + AllTrim( ::aSpacing[j] )
         ENDIF
         IF NOTZERO( ::aShift[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SHIFT " + AllTrim( ::aShift[j] )
         ENDIF
         IF NOTEMPTY( ::aLimit[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "LIMIT " + AllTrim( ::aLimit[j] )
         ENDIF
         IF NOTEMPTY( ::aFontNameFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONT " + ::aFontNameFrm[j]
         ENDIF
         IF NOTZERO( ::aFontSizeFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SIZE " + AllTrim( ::aFontSizeFrm[j] )
         ENDIF
         IF ::aFontBold[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOLD"
         ENDIF
         IF ::aFontItalic[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITALIC"
         ENDIF
         IF ::aFontUnderline[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UNDERLINE"
         ENDIF
         IF ::aFontStrikeout[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRIKEOUT"
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF ::aFontColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONTCOLOR " + ::ColorStrToColorDef( ::aFontColor[j] )
         ENDIF
         IF NOTEMPTY( ::aOnChange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CHANGE " + AllTrim( ::aOnChange[j] )
         ENDIF
         IF ::aTransparent[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TRANSPARENT"
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aNoTabStop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTABSTOP"
         ENDIF
         IF ::aAutoSize[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "AUTOSIZE"
         ENDIF
         IF ::aHorizontal[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HORIZONTAL"
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF ::aRTL[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF NOTEMPTY( ::aDrawBy[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + AllTrim( ::aDrawBy[j] )
         ENDIF
         IF NOTEMPTY( ::aBackground[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKGROUND " + AllTrim( ::aBackground[j] )
         ENDIF
         IF ::aLeftJust[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "LEFTJUSTIFY"
         ENDIF
         IF NOTEMPTY( ::aReadOnlyArray[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "READONLY " + AllTrim( ::aReadOnlyArray[j] )
         ENDIF
         IF ::aNoFocusRect[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOFOCUSRECT"
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_RICHEDITBOX ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " RICHEDITBOX " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF NOTEMPTY( ::aField[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FIELD " + AllTrim( ::aField[j] )
         ENDIF
         IF NOTEMPTY( ::aFile[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FILE " + AllTrim( ::aFile[j] )
         ENDIF
         IF ::aPlainText[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PLAINTEXT"
         ENDIF
         IF NOTZERO( ::aFileType[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FILETYPE " + AllTrim( ::aFileType[j] )
         ENDIF
         IF Len( ::aValue[j] ) > 0
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + AllTrim( ::aValue[j] )
         ENDIF
         IF ::aReadOnly[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "READONLY"
         ENDIF
         IF NOTEMPTY( ::aFontNameFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONT " + ::aFontNameFrm[j]
         ENDIF
         IF NOTZERO( ::aFontSizeFrm[j] )
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SIZE " + AllTrim( ::aFontSizeFrm[j] )
         ENDIF
         IF ::aFontBold[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOLD"
         ENDIF
         IF ::aFontItalic[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITALIC"
         ENDIF
         IF ::aFontUnderline[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UNDERLINE"
         ENDIF
         IF ::aFontStrikeout[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRIKEOUT"
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF ::aFontColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONTCOLOR " + ::ColorStrToColorDef( ::aFontColor[j] )
         ENDIF
         IF NOTZERO( ::aMaxLength[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "MAXLENGTH " + AllTrim( ::aMaxLength[j] )
         ENDIF
         IF NOTEMPTY( ::aOnGotFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON GOTFOCUS " + AllTrim( ::aOnGotFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnChange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CHANGE " + AllTrim( ::aOnChange[j] )
         ENDIF
         IF NOTEMPTY( ::aOnLostFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LOSTFOCUS " + AllTrim( ::aOnLostFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnSelChange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON SELCHANGE " + AllTrim( ::aOnSelChange[j] )
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aBreak[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BREAK"
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aNoTabStop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTABSTOP"
         ENDIF
         IF ::aRTL[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF ::aNoHideSel[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOHIDESEL"
         ENDIF
         IF NOTEMPTY( ::aFocusedPos[j] ) .AND. ( Type( ::aFocusedPos[j] ) # "N" .OR. ::aFocusedPos[j] <> "-4" )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FOCUSEDPOS " + AllTrim( ::aFocusedPos[j] )
         ENDIF
         IF ::aNoVScroll[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOVSCROLL"
         ENDIF
         IF ::aNoHScroll[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOHSCROLL"
         ENDIF
         IF NOTEMPTY( ::aOnVScroll[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON VSCROLL " + AllTrim( ::aOnVScroll[j] )
         ENDIF
         IF NOTEMPTY( ::aOnHScroll[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON HSCROLL " + AllTrim( ::aOnHScroll[j] )
         ENDIF
         IF NOTZERO( ::aInsertType[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INSERTTYPE " + AllTrim( ::aInsertType[j] )
         ENDIF
         IF NOTEMPTY( ::aVersion[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VERSION " + AllTrim( ::aVersion[j] )
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_SCROLLBAR ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " SCROLLBAR " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF ::aHorizontal[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HORIZONTAL"
         ELSEIF ::aVertical[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VERTICAL"
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         IF NOTEMPTY( ::aRange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RANGE " + AllTrim( ::aRange[j] )
         ENDIF
         IF NOTEMPTY( ::aOnScrLineLU[j] )
            IF ::aHorizontal[j]
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LINELEFT " + AllTrim( ::aOnScrLineLU[j] )
            ELSE
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LINEUP " + AllTrim( ::aOnScrLineLU[j] )
            ENDIF
         ENDIF
         IF NOTEMPTY( ::aOnScrLineRD[j] )
            IF ::aHorizontal[j]
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LINERIGHT " + AllTrim( ::aOnScrLineRD[j] )
            ELSE
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LINEDOWN " + AllTrim( ::aOnScrLineRD[j] )
            ENDIF
         ENDIF
         IF NOTEMPTY( ::aOnScrPageLU[j] )
            IF ::aHorizontal[j]
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON PAGELEFT " + AllTrim( ::aOnScrPageLU[j] )
            ELSE
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON PAGEUP " + AllTrim( ::aOnScrPageLU[j] )
            ENDIF
         ENDIF
         IF NOTEMPTY( ::aOnScrPageRD[j] )
            IF ::aHorizontal[j]
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON PAGERIGHT " + AllTrim( ::aOnScrPageRD[j] )
            ELSE
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON PAGEDOWN " + AllTrim( ::aOnScrPageRD[j] )
            ENDIF
         ENDIF
         IF NOTEMPTY( ::aOnScrLT[j] )
            IF ::aHorizontal[j]
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LEFT " + AllTrim( ::aOnScrLT[j] )
            ELSE
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON TOP " + AllTrim( ::aOnScrLT[j] )
            ENDIF
         ENDIF
         IF NOTEMPTY( ::aOnScrRB[j] )
            IF ::aHorizontal[j]
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON RIGHT " + AllTrim( ::aOnScrRB[j] )
            ELSE
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON BOTTOM " + AllTrim( ::aOnScrRB[j] )
            ENDIF
         ENDIF
         IF NOTEMPTY( ::aOnScrThumb[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON THUMB " + AllTrim( ::aOnScrThumb[j] )
         ENDIF
         IF NOTEMPTY( ::aOnScrTrack[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON TRACK " + AllTrim( ::aOnScrTrack[j] )
         ENDIF
         IF NOTEMPTY( ::aOnScrEndTrack[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON ENDTRACK " + AllTrim( ::aOnScrEndTrack[j] )
         ENDIF
         IF NOTEMPTY( ::aOnChange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CHANGE " + AllTrim( ::aOnChange[j] )
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF ::aRTL[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF ::aAttached[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ATTACHED"
         ENDIF
         IF NOTZERO( ::aValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + AllTrim( ::aValue[j] )
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF NOTZERO( ::aLineSkip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "LINESKIP " + AllTrim( ::aIncrement[j] )
         ENDIF
         IF NOTZERO( ::aPageSkip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PAGESKIP " + AllTrim( ::aIndent[j] )
         ENDIF
         IF ::aAutoMove[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "AUTOMOVE"
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_SLIDER ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " SLIDER " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         IF NOTEMPTY( ::aRange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RANGE " + AllTrim( ::aRange[j] )
         ELSE
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RANGE 1, 100"
         ENDIF
         IF NOTZERO( ::aValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + AllTrim( ::aValue[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF NOTEMPTY( ::aOnChange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CHANGE " + AllTrim( ::aOnChange[j] )
         ENDIF
         IF ::aVertical[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VERTICAL"
         ENDIF
         IF ::aNoTicks[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTICKS"
         ENDIF
         IF ::aBoth[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOTH"
         ENDIF
         IF ::aTop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOP"
         ENDIF
         IF ::aLeft[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "LEFT"
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aNoTabStop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTABSTOP"
         ENDIF
         IF ::aRTL[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_SPINNER ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " SPINNER " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         IF NOTEMPTY( ::aRange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RANGE " + AllTrim( ::aRange[j] )
         ENDIF
         IF NOTZERO( ::aValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + AllTrim( ::aValue[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF NOTEMPTY( ::aFontNameFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONT " + ::aFontNameFrm[j]
         ENDIF
         IF NOTZERO( ::aFontSizeFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SIZE " + AllTrim( ::aFontSizeFrm[j] )
         ENDIF
         IF ::aFontBold[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOLD"
         ENDIF
         IF ::aFontItalic[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITALIC"
         ENDIF
         IF ::aFontUnderline[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UNDERLINE"
         ENDIF
         IF ::aFontStrikeout[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRIKEOUT"
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF ::aFontColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONTCOLOR " + ::ColorStrToColorDef( ::aFontColor[j] )
         ENDIF
         IF NOTEMPTY( ::aOnGotFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON GOTFOCUS " + AllTrim( ::aOnGotFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnChange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CHANGE " + AllTrim( ::aOnChange[j] )
         ENDIF
         IF NOTEMPTY( ::aOnLostFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LOSTFOCUS " + AllTrim( ::aOnLostFocus[j] )
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aNoTabStop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTABSTOP"
         ENDIF
         IF ::aWrap[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WRAP"
         ENDIF
         IF ::aReadOnly[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "READONLY"
         ENDIF
         IF NOTZERO( ::aIncrement[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INCREMENT " + AllTrim( ::aIncrement[j] )
         ENDIF
         IF ::aRTL[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF ::aNoBorder[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOBORDER"
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF ::aBoundText[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOUNDTEXT" 
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF NOTEMPTY( ::aCue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CUEBANNER " + AllTrim( ::aCue[j] )
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_TAB ]
         Output += Space( nSpacing * nLevel ) + "DEFINE TAB " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "AT " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF NOTZERO( ::aValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + AllTrim( ::aValue[j] )
         ENDIF
         IF NOTEMPTY( ::aFontNameFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONT " + ::aFontNameFrm[j]
         ENDIF
         IF NOTZERO( ::aFontSizeFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SIZE " + AllTrim( ::aFontSizeFrm[j] )
         ENDIF
         IF ::aFontBold[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOLD"
         ENDIF
         IF ::aFontItalic[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITALIC"
         ENDIF
         IF ::aFontUnderline[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UNDERLINE"
         ENDIF
         IF ::aFontStrikeout[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRIKEOUT"
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF ::aButtons[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BUTTONS"
         ENDIF
         IF ::aFlat[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FLAT"
         ENDIF
         IF ::aHotTrack[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HOTTRACK"
         ENDIF
         IF ::aVertical[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VERTICAL"
         ENDIF
         IF NOTEMPTY( ::aAction[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ACTION " + AllTrim( ::aAction[j] )
         ENDIF
         IF NOTEMPTY( ::aOnRClick[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON RCLICK " + AllTrim( ::aOnRClick[j] )
         ENDIF
         IF NOTEMPTY( ::aOnChange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CHANGE " + ::aOnChange[j]
         ENDIF
         IF ::aNoTabStop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTABSTOP"
         ENDIF
         IF ::aRTL[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF ::aInternals[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INTERNALS"
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF ::aMultiLine[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "MULTILINE"
         ENDIF
         IF ::aDelayMsgs[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DELAYMSGS"
         ENDIF
         IF ::aRightAlign[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RIGHT"
         ENDIF
         IF ::aBottomAlign[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOTTOM"
         ENDIF
         IF ::aRaggedRight[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RAGGEDRIGHT"
         ENDIF
         IF ::aFixedWidths[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FIXEDWIDTH"
         ENDIF
         IF NOTEMPTY( ::aItemSize[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITEMSIZE " + AllTrim( ::aItemSize[j] )
         ENDIF
         IF NOTZERO( ::aMinWidth[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "MINWIDTH " + AllTrim( ::aMinWidth[j] )
         ENDIF
         IF NOTEMPTY( ::aPadding[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PADDING " + AllTrim( ::aPadding[j] )
         ENDIF
         IF ::aIconLeft[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ICONLEFT"
         ENDIF
         IF ::aLabelLeft[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "LABELLEFT"
         ENDIF
         IF ::aRightJust[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RIGHTJUST"
         ENDIF
         IF ::aScrollOp[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SCROLLOP"
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
         /* Output pages */
         FOR CurrentPage := 1 TO Len( ::aCaption[j] )
            /* Output page data */
            Output += Space( nSpacing * ( nLevel + 1 ) ) + "DEFINE PAGE " + AllTrim( ::aCaption[j, CurrentPage ] )
            IF NOTEMPTY( ::aImage[j, CurrentPage ] )
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 2 ) ) + "IMAGE " + AllTrim( ::aImage[j, CurrentPage ] )
            ENDIF
            IF NOTEMPTY( ::aPageNames[j, CurrentPage ] )
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 2 ) ) + "NAME " + AllTrim( ::aPageNames[j, CurrentPage ] )
            ENDIF
            IF NOTEMPTY( ::aPageObjs[j, CurrentPage ] )
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 2 ) ) + "OBJ " + AllTrim( ::aPageObjs[j, CurrentPage ] )
            ENDIF
            IF NOTEMPTY( ::aPageSubClass[j, CurrentPage ] )
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 2 ) ) + "SUBCLASS " + AllTrim( ::aPageSubClass[j, CurrentPage ] )
            ENDIF
            IF NOTEMPTY( ::aPageToolTips[j, CurrentPage ] )
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 2 ) ) + "TOOLTIP " + AllTrim( ::aPageToolTips[j, CurrentPage ] )
            ENDIF
            IF NOTEMPTY( ::aPageCargos[j, CurrentPage ] )
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 2 ) ) + "CARGO " + AllTrim( ::aPageCargos[j, CurrentPage ] )
            ENDIF
            Output += CRLF + CRLF
            /* Output page controls */
            FOR k := 2 TO ::nControlW
               IF ::aTabPage[k, 1] == ::aControlW[j]
                  IF ::aTabPage[k, 2] == CurrentPage
                     /* Tab page controls */
                     nCtrlPos := AScan( ::oDesignForm:aControls, { |c| Lower( c:Name ) == ::aControlW[k] } )
                     IF nCtrlPos > 0
                        nRow    := ::oDesignForm:aControls[nCtrlPos]:Row
                        nCol    := ::oDesignForm:aControls[nCtrlPos]:Col
                        nWidth  := ::oDesignForm:aControls[nCtrlPos]:Width
                        nHeight := ::oDesignForm:aControls[nCtrlPos]:Height
                        Output  := ::MakeControls( k, Output, nRow, nCol, nWidth, nHeight, nSpacing, nLevel + 2 )
                     ENDIF
                  ELSEIF ::aTabPage[k, 2] > CurrentPage
                     EXIT
                  ENDIF
               ENDIF
            NEXT k
            /* Output page end */
            Output += Space( nSpacing * ( nLevel + 1 ) ) + "END PAGE" + CRLF + CRLF
         NEXT i
         /* Output TAB's end */
         Output += Space( nSpacing * nLevel ) + "END TAB" + CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_TEXTARRAY ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " TEXTARRAY " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         IF NOTEMPTY( ::aAction[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ACTION " + AllTrim( ::aAction[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF NOTZERO( ::aRowCount[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ROWCOUNT " + AllTrim( ::aRowCount[j] )
         ENDIF
         IF NOTZERO( ::aColCount[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "COLCOUNT " + AllTrim( ::aColCount[j] )
         ENDIF
         IF NOTEMPTY( ::aFontNameFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONT " + ::aFontNameFrm[j]
         ENDIF
         IF NOTZERO( ::aFontSizeFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SIZE " + AllTrim( ::aFontSizeFrm[j] )
         ENDIF
         IF ::aFontBold[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOLD"
         ENDIF
         IF ::aFontItalic[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITALIC"
         ENDIF
         IF ::aFontUnderline[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UNDERLINE"
         ENDIF
         IF ::aFontStrikeout[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRIKEOUT"
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF ::aFontColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONTCOLOR " + ::ColorStrToColorDef( ::aFontColor[j] )
         ENDIF
         IF ::aBorder[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BORDER"
         ENDIF
         IF ::aClientEdge[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CLIENTEDGE"
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aRTL[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF NOTEMPTY( ::aValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + AllTrim( ::aValue[j] )
         ENDIF
         IF ::aNoTabStop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTABSTOP"
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF NOTEMPTY( ::aOnGotFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON GOTFOCUS " + AllTrim( ::aOnGotFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnLostFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LOSTFOCUS " + AllTrim( ::aOnLostFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_TEXTBOX ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " TEXTBOX " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF NOTEMPTY( ::aField[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FIELD " + AllTrim( ::aField[j] )
         ENDIF
         IF NOTEMPTY( ::aValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + AllTrim( ::aValue[j] )
         ENDIF
         IF ::aReadOnly[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "READONLY"
         ENDIF
         IF NOTEMPTY( ::aFontNameFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONT " + ::aFontNameFrm[j]
         ENDIF
         IF NOTZERO( ::aFontSizeFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SIZE " + AllTrim( ::aFontSizeFrm[j] )
         ENDIF
         IF ::aFontBold[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOLD"
         ENDIF
         IF ::aFontItalic[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITALIC"
         ENDIF
         IF ::aFontUnderline[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UNDERLINE"
         ENDIF
         IF ::aFontStrikeout[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRIKEOUT"
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF ::aFontColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONTCOLOR " + ::ColorStrToColorDef( ::aFontColor[j] )
         ENDIF
         IF NOTZERO( ::aMaxLength[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "MAXLENGTH " + AllTrim( ::aMaxLength[j] )
         ENDIF
         IF ::aUpperCase[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UPPERCASE"
         ELSEIF ::aLowerCase[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "LOWERCASE"
         ENDIF
         IF ::aPassword[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PASSWORD"
         ENDIF
         IF NOTEMPTY( ::aOnChange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CHANGE " + AllTrim( ::aOnChange[j] )
         ENDIF
         IF NOTEMPTY( ::aOnGotFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON GOTFOCUS " + AllTrim( ::aOnGotFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnLostFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LOSTFOCUS " + AllTrim( ::aOnLostFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnTextFilled[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON TEXTFILLED " + AllTrim( ::aOnTextFilled[j] )
         ENDIF
         IF NOTEMPTY( ::aOnEnter[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON ENTER " + AllTrim( ::aOnEnter[j] )
         ENDIF
         IF ::aCenterAlign[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CENTERALIGN"
         ELSEIF ::aRightAlign[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RIGHTALIGN"
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aNoTabStop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTABSTOP"
         ENDIF
         IF ::aRTL[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aAutoSkip[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "AUTOSKIP"
         ENDIF
         IF ::aNoBorder[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOBORDER"
         ENDIF
         IF NOTEMPTY( ::aFocusedPos[j] ) .AND. ( Type( ::aFocusedPos[j] ) # "N" .OR. ::aFocusedPos[j] <> "-2" )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FOCUSEDPOS " + AllTrim( ::aFocusedPos[j] )
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF NOTEMPTY( ::aValid[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALID " + AllTrim( ::aValid[j] )
         ENDIF
         IF ::aDate[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DATE"
         ENDIF
         IF NOTZERO( ::aDefaultYear[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DEFAULTYEAR " + AllTrim( ::aDefaultYear[j] )
         ENDIF
         IF ::aNumeric[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NUMERIC"
            IF NOTEMPTY( ::aInputMask[j] )
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INPUTMASK " + AllTrim( ::aInputMask[j] )
            ENDIF
         ELSE
            IF NOTEMPTY( ::aInputMask[j] )
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INPUTMASK " + AllTrim( ::aInputMask[j] )
            ENDIF
         ENDIF
         IF NOTEMPTY( ::aFormat[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FORMAT " + AllTrim( ::aFormat[j], .T. )
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF NOTEMPTY( ::aAction[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ACTION " + AllTrim( ::aAction[j] )
            // This clause must immediately  follow ACTION
            IF NOTEMPTY( ::aToolTipAct1[j] )
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTipAct1[j] )
            ENDIF
         ENDIF
         IF NOTEMPTY( ::aAction2[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ACTION2 " + AllTrim( ::aAction2[j] )
            // This clause must immediately  follow ACTION2
            IF NOTEMPTY( ::aToolTipAct2[j] )
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTipAct2[j] )
            ENDIF
         ENDIF
         IF NOTEMPTY( ::aImage[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "IMAGE " + AllTrim( ::aImage[j] )
         ENDIF
         IF NOTZERO( ::aButtonWidth[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BUTTONWIDTH " + AllTrim( ::aButtonWidth[j] )
         ENDIF
         IF NOTEMPTY( ::aWhen[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WHEN " + AllTrim( ::aWhen[j] )
         ENDIF
         IF NOTZERO( ::aInsertType[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INSERTTYPE " + AllTrim( ::aInsertType[j] )
         ENDIF
         IF ::aCtrlsLeft[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CTRLSATLEFT"
         ENDIF
         IF ::aNoContext[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOCONTEXTMENU"
         ENDIF
         IF NOTEMPTY( ::aCue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CUEBANNER " + AllTrim( ::aCue[j] )
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_TIMEPICKER ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " TIMEPICKER " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         IF NOTEMPTY( ::aValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + AllTrim( ::aValue[j] )
         ENDIF
         IF NOTEMPTY( ::aField[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FIELD " + AllTrim( ::aField[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF NOTEMPTY( ::aFontNameFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONT " + ::aFontNameFrm[j]
         ENDIF
         IF NOTZERO( ::aFontSizeFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SIZE " + AllTrim( ::aFontSizeFrm[j] )
         ENDIF
         IF ::aFontBold[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOLD"
         ENDIF
         IF ::aFontItalic[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITALIC"
         ENDIF
         IF ::aFontUnderline[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UNDERLINE"
         ENDIF
         IF ::aFontStrikeout[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRIKEOUT"
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF ::aShowNone[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SHOWNONE"
         ENDIF
         IF NOTEMPTY( ::aOnGotFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON GOTFOCUS " + AllTrim( ::aOnGotFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnChange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CHANGE " + AllTrim( ::aOnChange[j] )
         ENDIF
         IF NOTEMPTY( ::aOnLostFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LOSTFOCUS " + AllTrim( ::aOnLostFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnEnter[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON ENTER " + AllTrim( ::aOnEnter[j] )
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aNoTabStop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTABSTOP"
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF ::aNoBorder[j]
           Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOBORDER"
         ENDIF
         IF ::aRTL[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF NOTEMPTY( ::aFormat[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TIMEFORMAT " + AllTrim( ::aFormat[j] )
         ENDIF
         IF NOTEMPTY( ::aValid[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALID " + AllTrim( ::aValid[j] )
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_TIMER ]
         /* Do not delete next line, it"s needed to load the control properly */
         Output += Space( nSpacing ) + "*****@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " TIMER " + ::aName[j] + " ;" + CRLF
         Output += Space( nSpacing * nLevel ) + "DEFINE TIMER " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         IF NOTZERO( ::aValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INTERVAL " + AllTrim( ::aValue[j] )
         ELSE
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INTERVAL " + "1000"
         ENDIF
         IF NOTEMPTY( ::aAction[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ACTION " + AllTrim( ::aAction[j] )
         ELSE
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ACTION " + "NIL"
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF ::aOnce[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ONCE"
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_TREE ]
         Output += Space( nSpacing * nLevel ) + "DEFINE TREE " + ::aName[j]
         IF ::aFullRowSelect[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FULLROWSELECT"
         ENDIF
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "AT " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF NOTZERO( ::aValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + AllTrim( ::aValue[j] )
         ENDIF
         IF NOTEMPTY( ::aFontNameFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONT " + ::aFontNameFrm[j]
         ENDIF
         IF NOTZERO( ::aFontSizeFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SIZE " + AllTrim( ::aFontSizeFrm[j] )
         ENDIF
         IF ::aFontBold[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOLD"
         ENDIF
         IF ::aFontItalic[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITALIC"
         ENDIF
         IF ::aFontUnderline[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UNDERLINE"
         ENDIF
         IF ::aFontStrikeout[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRIKEOUT"
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF ::aOwnTT[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OWNTOOLTIP"
         ENDIF
         IF NOTEMPTY( ::aOnCollapse[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON COLLAPSE " + AllTrim( ::aOnCollapse[j] )
         ENDIF
         IF NOTEMPTY( ::aOnExpand[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON EXPAND " + AllTrim( ::aOnExpand[j] )
         ENDIF
         IF NOTEMPTY( ::aOnGotFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON GOTFOCUS " + AllTrim( ::aOnGotFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnChange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CHANGE " + AllTrim( ::aOnChange[j] )
         ENDIF
         IF NOTEMPTY( ::aOnLostFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LOSTFOCUS " + AllTrim( ::aOnLostFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnDblClick[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON DBLCLICK " + AllTrim( ::aOnDblClick[j] )
         ENDIF
         IF NOTEMPTY( ::aNodeImages[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NODEIMAGES " + AllTrim( ::aNodeImages[j] )
         ENDIF
         IF NOTEMPTY( ::aItemImages[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITEMIMAGES " + AllTrim( ::aItemImages[j] )
         ENDIF
         IF ::aNoRootButton[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOROOTBUTTON"
         ENDIF
         IF ::aItemIDs[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITEMIDS"
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aRTL[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF NOTEMPTY( ::aOnEnter[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON ENTER " + AllTrim( ::aOnEnter[j] )
         ENDIF
         IF ::aBreak[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BREAK"
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aNoTabStop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTABSTOP"
         ENDIF
         IF ::aFontColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONTCOLOR " + ::ColorStrToColorDef( ::aFontColor[j] )
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF ::aSelColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SELCOLOR " + ::ColorStrToColorDef( ::aSelColor[j] )
         ENDIF
         IF ::aSelBold[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SELBOLD"
         ENDIF
         IF ::aCheckBoxes[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CHECKBOXES"
         ENDIF
         IF ::aEditLabels[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "EDITLABELS"
         ENDIF
         IF ::aNoHScroll[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOHSCROLL"
         ENDIF
         IF ::aNoVScroll[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOSCROLL"
         ENDIF
         IF ::aHotTrack[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HOTTRACKING"
         ENDIF
         IF ::aNoButtons[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOBUTTONS"
         ENDIF
         IF ::aNoLines[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOLINES"
         ENDIF
         IF ::aDrag[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ENABLEDRAG"
         ENDIF
         IF ::aDrop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ENABLEDROP"
         ENDIF
         IF ::aRedrawOnAdd[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "REDRAWONADD"
         ENDIF
         IF NOTEMPTY( ::aTarget[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TARGET " + AllTrim( ::aTarget[j] )
         ENDIF
         IF ::aSingleExpand[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SINGLEEXPAND"
         ENDIF
         IF ::aNoBorder[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NO BORDER"
         ENDIF
         IF NOTEMPTY( ::aOnLabelEdit[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LABELEDIT " + AllTrim( ::aOnLabelEdit[j] )
         ENDIF
         IF NOTEMPTY( ::aValid[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALID " + AllTrim( ::aValid[j] )
         ENDIF
         IF NOTEMPTY( ::aOnCheckChg[j] ) 
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CHECKCHANGE " + AllTrim( ::aOnCheckChg[j] )
         ENDIF
         IF NOTZERO( ::aIndent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INDENT " + AllTrim(  ::aIndent[j] )
         ENDIF
         IF NOTEMPTY( ::aOnDrop[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON DROP " + AllTrim( ::aOnDrop[j] )
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
   /*
      TODO: Add

      #xcommand NODE <text> ;
         ...

      #xcommand DEFINE NODE <text> ;
         [ IMAGES <aImage> ] ;
         [ ID <id> ] ;
         [ <checked: CHECKED> ] ;
         [ <readonly: READONLY> ] ;
         [ <bold: BOLD> ] ;
         [ <disabled: DISABLED> ] ;
         [ <nodrag: NODRAG> ] ;
         [ <autoid: AUTOID> ] ;

      #xcommand END NODE ;

      #xcommand TREEITEM <text> ;
         [ IMAGES <aImage> ] ;
         [ ID <id> ] ;
         [ <checked: CHECKED> ] ;
         [ <readonly: READONLY> ] ;
         [ <bold: BOLD> ] ;
         [ <disabled: DISABLED> ] ;
         [ <nodrag: NODRAG> ] ;
         [ <autoid: AUTOID> ] ;
   */
         Output += Space( nSpacing * nLevel ) + "END TREE " + CRLF + CRLF
      ENDIF

      IF ::aCtrlType[j] == ::ControlType[ TYPE_XBROWSE ]
         Output += Space( nSpacing * nLevel ) + "@ " + LTrim( Str( nRow ) ) + ", " + LTrim( Str( nCol ) ) + " XBROWSE " + ::aName[j]
         IF NOTEMPTY( ::aCObj[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "OBJ " + AllTrim( ::aCObj[j] )
         ENDIF
         IF NOTEMPTY( ::aParent[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PARENT " + AllTrim( ::aParent[j] )
         ENDIF
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTH " + LTrim( Str( nWidth ) )
         Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEIGHT " + LTrim( Str( nHeight ) )
         IF NOTEMPTY( ::aHeaders[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEADERS " + AllTrim( ::aHeaders[j] )
         ELSE
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEADERS " + "{ '', '' }"
         ENDIF
         IF NOTEMPTY( ::aWidths[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTHS " + AllTrim( ::aWidths[j] )
         ELSE
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WIDTHS " + "{ 90, 60 }"
         ENDIF
         IF NOTEMPTY( ::aWorkArea[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WORKAREA " + AllTrim( ::aWorkArea[j] )
         ELSE
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WORKAREA " + "Alias()"
         ENDIF
         IF NOTEMPTY( ::aFields[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FIELDS " + AllTrim( ::aFields[j] )
         ELSE
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FIELDS " + "{ 'field1', 'field2' }"
         ENDIF
         IF NOTEMPTY( ::aInputMask[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INPUTMASK " + AllTrim( ::aInputMask[j] )
         ENDIF
         IF NOTZERO( ::aValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALUE " + AllTrim( ::aValue[j] )
         ENDIF
         IF NOTEMPTY( ::aFontNameFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONT " + ::aFontNameFrm[j]
         ENDIF
         IF NOTZERO( ::aFontSizeFrm[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SIZE " + AllTrim( ::aFontSizeFrm[j] )
         ENDIF
         IF ::aFontBold[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BOLD"
         ENDIF
         IF ::aFontItalic[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ITALIC"
         ENDIF
         IF ::aFontUnderline[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UNDERLINE"
         ENDIF
         IF ::aFontStrikeout[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "STRIKEOUT"
         ENDIF
         IF NOTEMPTY( ::aToolTip[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TOOLTIP " + AllTrim( ::aToolTip[j] )
         ENDIF
         IF ::aBackColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BACKCOLOR " + ::ColorStrToColorDef( ::aBackColor[j] )
         ENDIF
         IF NOTEMPTY( AllTrim( ::aDynBackColor[j] ) )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DYNAMICBACKCOLOR " + AllTrim( ::aDynBackColor[j] )
         ENDIF
         IF NOTEMPTY( AllTrim( ::aDynForeColor[j] ) ) 
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DYNAMICFORECOLOR " + AllTrim( ::aDynForeColor[j] )
         ENDIF
         IF ::aFontColor[j] # "NIL"
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FONTCOLOR " + ::ColorStrToColorDef( ::aFontColor[j] )
         ENDIF
         IF NOTEMPTY( ::aOnGotFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON GOTFOCUS " + AllTrim( ::aOnGotFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnChange[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CHANGE " + AllTrim( ::aOnChange[j] )
         ENDIF
         IF NOTEMPTY( ::aOnLostFocus[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON LOSTFOCUS " + AllTrim( ::aOnLostFocus[j] )
         ENDIF
         IF NOTEMPTY( ::aOnDblClick[j] ) 
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON DBLCLICK " + AllTrim( ::aOnDblClick[j] )
         ENDIF
         IF NOTEMPTY( ::aAction[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ACTION " + AllTrim( ::aAction[j] )
         ENDIF
         IF ::aEdit[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "EDIT"
         ENDIF
         IF ::aInPlace[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INPLACE"
         ENDIF
         IF ::aAppend[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "APPEND"
         ENDIF
         IF NOTEMPTY( ::aOnHeadClick[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON HEADCLICK " + AllTrim( ::aOnHeadClick[j] )
         ENDIF
         IF NOTEMPTY( ::aOnHeadDClick[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON HEADDBLCLICK " + AllTrim( ::aOnHeadDClick[j] )
         ENDIF
         IF NOTEMPTY( ::aWhen[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "WHEN " + AllTrim( ::aWhen[j] )
         ENDIF
         IF NOTEMPTY( ::aValid[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALID " + AllTrim( ::aValid[j] )
         ENDIF
         IF NOTEMPTY( ::aValidMess[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "VALIDMESSAGES " + AllTrim( ::aValidMess[j] )
         ENDIF
         IF NOTEMPTY( ::aReadOnlyArray[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "READONLY " + AllTrim( ::aReadOnlyArray[j] )
         ENDIF
         IF ::aLock[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "LOCK"
         ENDIF
         IF ::aDelete[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DELETE"
         ENDIF
         IF ::aNoLines[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOLINES"
         ENDIF
         IF NOTEMPTY( ::aImage[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "IMAGE " + AllTrim( ::aImage[j] )
         ENDIF
         IF NOTEMPTY( ::aJustify[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "JUSTIFY " + AllTrim( ::aJustify[j] )
         ENDIF
         IF ::aNoVScroll[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOVSCROLL"
         ENDIF
         IF NOTZERO( ::aHelpID[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HELPID " + AllTrim( ::aHelpID[j] )
         ENDIF
         IF ::aBreak[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BREAK"
         ENDIF
         IF ::aRTL[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RTL"
         ENDIF
         IF NOTEMPTY( ::aOnAppend[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON APPEND " + AllTrim( ::aOnAppend[j] )
         ENDIF
         IF NOTEMPTY( ::aOnEditCell[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON EDITCELL " + AllTrim( ::aOnEditCell[j] )
         ENDIF
         IF NOTEMPTY( ::aColumnCtrls[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "COLUMNCONTROLS " + AllTrim( ::aColumnCtrls[j] )
         ENDIF
         IF NOTEMPTY( ::aReplaceField[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "REPLACEFIELD " + AllTrim( ::aReplaceField[j] )
         ENDIF
         IF NOTEMPTY( ::aSubClass[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SUBCLASS " + AllTrim( ::aSubClass[j] )
         ENDIF
         IF ::aRecCount[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "RECCOUNT"
         ENDIF
         IF NOTEMPTY( ::aColumnInfo[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "COLUMNINFO " + AllTrim( ::aColumnInfo[j] )
         ENDIF
         IF ::aNoHeaders[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOHEADERS"
         ENDIF
         IF NOTEMPTY( ::aOnEnter[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON ENTER " + AllTrim( ::aOnEnter[j] )
         ENDIF
         IF ::aDisabled[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLED"
         ENDIF
         IF ::aNoTabStop[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOTABSTOP"
         ENDIF
         IF ::aInvisible[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "INVISIBLE"
         ENDIF
         IF ::aDescend[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DESCENDING"
         ENDIF
         IF NOTEMPTY( ::aDeleteWhen[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DELETEWHEN " + AllTrim( ::aDeleteWhen[j] )
         ENDIF
         IF NOTEMPTY( ::aDeleteMsg[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DELETEMSG " + AllTrim( ::aDeleteMsg[j] )
         ENDIF
         IF NOTEMPTY( ::aOnDelete[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON DELETE " + AllTrim( ::aOnDelete[j] )
         ENDIF
         IF NOTEMPTY( ::aHdrFontClrs[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEADERCOLORS " + AllTrim( ::aHdrFontClrs[j] )
         ENDIF
         IF NOTEMPTY( ::aHdrBackClrs[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEADERBACKCOLORS " + AllTrim( ::aHdrBackClrs[j] )
         ENDIF
         IF NOTEMPTY( ::aHdrImages[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEADERIMAGES " + AllTrim( ::aHdrImages[j] )
         ENDIF
         IF NOTEMPTY( ::aHdrImgAlign[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "HEADERIMAGESALIGN " + AllTrim( ::aHdrImgAlign[j] )
         ENDIF
         IF ::aFullMove[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FULLMOVE"
         ENDIF
         IF NOTEMPTY( AllTrim( ::aSelColor[j] ) )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SELECTEDCOLORS " + AllTrim( ::aSelColor[j] )
         ENDIF
         IF NOTEMPTY( ::aEditKeys[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "EDITKEYS " + AllTrim( ::aEditKeys[j] )
         ENDIF
         IF NOTEMPTY( ::aEditKeysFun[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "EDITKEYSFUN " + AllTrim( ::aEditKeysFun[j] )
         ENDIF
         IF ::aSingleBuffer[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SINGLEBUFFER"
         ENDIF
         IF ::aPLM[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "PAINTLEFTMARGIN"
         ENDIF
         IF ::aFixedCols[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FIXEDCOLS"
         ENDIF
         IF NOTEMPTY( ::aOnAbortEdit[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON ABORTEDIT " + AllTrim( ::aOnAbortEdit[j] )
         ENDIF
         IF ::aFixedWidths[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FIXEDWIDTHS"
         ENDIF
         IF ::aFixBlocks[j] == ".T."
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FIXEDBLOCKS"
         ELSEIF ::aFixBlocks[j] == ".F."
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DYNAMICBLOCKS"
         ENDIF
         IF NOTEMPTY( ::aBeforeColMove[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BEFORECOLMOVE " + AllTrim( ::aBeforeColMove[j] )
         ENDIF
         IF NOTEMPTY( ::aAfterColMove[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "AFTERCOLMOVE " + AllTrim( ::aAfterColMove[j] )
         ENDIF
         IF NOTEMPTY( ::aBeforeColSize[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BEFORECOLSIZE " + AllTrim( ::aBeforeColSize[j] )
         ENDIF
         IF NOTEMPTY( ::aAfterColSize[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "AFTERCOLSIZE " + AllTrim( ::aAfterColSize[j] )
         ENDIF
         IF NOTEMPTY( ::aBeforeAutoFit[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "BEFOREAUTOFIT " + AllTrim( ::aBeforeAutoFit[j] )
         ENDIF
         IF ::aEditLikeExcel[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "EDITLIKEEXCEL"
         ENDIF
         IF ::aUseButtons[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "USEBUTTONS"
         ENDIF
         IF ::aNoDefMsg[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NODEFAULTMSG"
         ENDIF
         IF ::aNoDelMsg[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NODELETEMSG"
         ENDIF
         IF ::aFixedCtrls[j] == ".T."
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FIXEDCONTROLS"
         ELSEIF ::aFixedCtrls[j] == ".F."
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DYNAMICCONTROLS"
         ENDIF
         IF ::aShowNone[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOSHOWEMPTYROW"
         ENDIF
         IF ::aUpdateColors[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "UPDATECOLORS"
         ENDIF
         IF NOTEMPTY( ::aOnHeadRClick[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON HEADRCLICK " + AllTrim( ::aOnHeadRClick[j] )
         ENDIF
         IF ::aNoModalEdit[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOMODALEDIT"
         ENDIF
         IF ::aNavByCell[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NAVIGATEBYCELL"
            IF ::aFocusRect[j] == ".T."
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "FOCUSRECT"
            ENDIF
         ELSE
            IF ::aFocusRect[j] == ".F."
               Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOFOCUSRECT"
            ENDIF
         ENDIF
         IF ::aExtDblClick[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "EXTDBLCLICK"
         ENDIF
         IF ::aSilent[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "SILENT"
         ENDIF
         IF ::aDisableAltA[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DISABLEALTA"
         ENDIF
         IF ::aNoShowAlways[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOSHOWALWAYS"
         ENDIF
         IF NOTEMPTY( ::aOnRClick[j] ) 
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON RCLICK " + AllTrim( ::aOnRClick[j] )
         ENDIF
         IF ::aCheckBoxes[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CHECKBOXES"
         ENDIF
         IF NOTEMPTY( ::aOnCheckChg[j] ) 
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON CHECKCHANGE " + AllTrim( ::aOnCheckChg[j] )
         ENDIF
         IF NOTEMPTY( ::aOnRowRefresh[j] ) 
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON ROWREFRESH " + AllTrim( ::aOnRowRefresh[j] )
         ENDIF
         IF NOTEMPTY( ::aDefaultValues[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "DEFAULTVALUES " + AllTrim( ::aDefaultValues[j] )
         ENDIF
         IF NOTEMPTY( ::aOnEditCellEnd[j] ) 
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON EDITCELLEND " + AllTrim( ::aOnEditCellEnd[j] )
         ENDIF
         IF ::aEditFirstVis[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "EDITFIRSTVISIBLE"
         ENDIF
         IF NOTEMPTY( ::aOnBfrEdtCell[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "ON BEFOREEDITCELL " + AllTrim( ::aOnBfrEdtCell[j] )
         ENDIF
         IF NOTEMPTY( ::aEditCellValue[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "EDITCELLVALUE " + AllTrim( ::aEditLabels[j] )
         ENDIF
         IF ::aKeysLkClp[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "KEYSLIKECLIPPER"
         ENDIF
         IF ::aCellToolTip[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "CELLTOOLTIP"
         ENDIF
         IF ::aNoHScroll[j]
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "NOHSCROLL"
         ENDIF
         IF NOTEMPTY( ::aTimeOut[j] )
            Output += " ;" + CRLF + Space( nSpacing * ( nLevel + 1 ) ) + "TIMEOUT " + AllTrim( ::aTimeOut[j] )
         ENDIF
         IF NOTEMPTY( ::aCargo[j] )
            Output += CRLF + CRLF + Space( nSpacing * nLevel ) + "LastForm.LastControl.Cargo := " + AllTrim( ::aCargo[j] )
         ENDIF
         Output += CRLF + CRLF
      ENDIF
   ENDIF
/*
   TODO: Add this controls

   INTERNAL
   SPLITBOX
   SplitBox versions of controls
   i_graph.ch
   i_edit.ch

   TODO: Check all DEFINE * controls
*/

   RETURN Output

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD PropertiesClick() CLASS TFormEditor

   LOCAL aData, aFormats, aInitValues, aLabels, aResults, cName, cTitle, ia, j, k, nControlType, oControl, oTabProp

   IF ( ia := ::FirstCtrl() ) == 0
      RETURN NIL
   ENDIF

   oControl := ::oDesignForm:aControls[ia]
   j := AScan( ::aControlW, Lower( oControl:Name ) )
   IF j <= 0
      RETURN NIL
   ENDIF

   nControlType := AScan( ::ControlType, ::aCtrlType[j] )
   cTitle := DQM( ::cFName + ".fmg" ) + i18n( " - Properties of Control " ) + ::aName[j]

   SWITCH nControlType

   CASE TYPE_ACTIVEX
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "NoTabStop",          ::aNoTabStop[j],                                                               .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "ProgID",             ::aProgID[j],                                                                  1000 }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aNoTabStop[j]        := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aProgID[j]           := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      EXIT

   CASE TYPE_ANIGIF
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Border",             ::aBorder[j],                                                                  .F.  }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "ClientEdge",         ::aClientEdge[j],                                                              .F.  }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "File",               ::aFile[j],                                                                    1000 }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                .F.  }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "WhiteBackground",    ::aWhiteBack[j],                                                               .F.  } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aBorder[j]           := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aClientEdge[j]       := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aFile[j]             := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aWhiteBack[j]        := aResults[ ++k ]
      EXIT

   CASE TYPE_ANIMATEBOX
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "AutoPlay",           ::aAutoPlay[j],                                                                .F.  }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "Center",             ::aCenter[j],                                                                  .F.  }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "File",               ::aFile[j],                                                                    1000 }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "NoTabStop",          ::aNoTabStop[j],                                                               .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "Transparent",        ::aTransparent[j],                                                             .F.  } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aAutoPlay[j]         := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aCenter[j]           := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aFile[j]             := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aNoTabStop[j]        := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aTransparent[j]      := aResults[ ++k ]
      EXIT

   CASE TYPE_BROWSE
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Append",             ::aAppend[j],                                                                  .F.  }, ;
                       { "Break",              ::aBreak[j],                                                                   .F.  }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "CellToolTip",        ::aCellToolTip[j],                                                             .F.  }, ;
                       { "ChangeBeforeEdit",   ::aChgBefEdit[j],                                                              .F.  }, ;
                       { "CheckBoxes",         ::aCheckBoxes[j],                                                              .F.  }, ;
                       { "ColumnControls",     ::aColumnCtrls[j],                                                             1000 }, ;
                       { "ColumnInfo",         ::aColumnInfo[j],                                                              1000 }, ;
                       { "DefaultValues",      ::aDefaultValues[j],                                                           1000 }, ;
                       { "Delete",             ::aDelete[j],                                                                  .F.  }, ;
                       { "DeleteMsg",          ::aDeleteMsg[j],                                                               1000 }, ;
                       { "DeleteWhen",         ::aDeleteWhen[j],                                                              1000 }, ;
                       { "Descending",         ::aDescend[j],                                                                 .F.  }, ;
                       { "DisableAltA",        ::aDisableAltA[j],                                                             .F.  }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "DynamicBackColor",   ::aDynBackColor[j],                                                            1000 }, ;
                       { "DynamicForeColor",   ::aDynForeColor[j],                                                            1000 }, ;
                       { "Edit",               ::aEdit[j],                                                                    .F.  }, ;
                       { "EditCellValue",      ::aEditCellValue[j],                                                           .F.  }, ;
                       { "EditFirstVisible",   ::aEditFirstVis[j],                                                            .F.  }, ;
                       { "EditKeys",           ::aEditKeys[j],                                                                1000 }, ;
                       { "EditKeysFun",        ::aEditKeysFun[j],                                                             1000 }, ;
                       { "EditLikeExcel",      ::aEditLikeExcel[j],                                                           .F.  }, ;
                       { "ExtDblClick",        ::aExtDblClick[j],                                                             .F.  }, ;
                       { "Fields",             ::aFields[j],                                                                  1000 }, ;
                       { "FixedBlocks",        AScan( { ".T.", ".F." }, ::aFixBlocks[j] ) + 1,                                { "NIL", ".T.", ".F." } }, ;
                       { "FixedCols",          ::aFixedCols[j],                                                               .F.  }, ;
                       { "FixedControls",      AScan( { ".T.", ".F." }, ::aFixedCtrls[j] ) + 1,                               { "NIL", ".T.", ".F." } }, ;
                       { "FixedWidths",        ::aFixedWidths[j],                                                             .F.  }, ;
                       { "FocusRect",          AScan( { ".T.", ".F." }, ::aFocusRect[j] ) + 1,                                { "NIL", ".T.", ".F." } }, ;
                       { "FullMove",           ::aFullMove[j],                                                                .F.  }, ;
                       { "HeaderBackColors",   ::aHdrBackClrs[j],                                                             1000 }, ;
                       { "HeaderColors",       ::aHdrFontClrs[j],                                                             1000 }, ;
                       { "HeaderImages",       ::aHdrImages[j],                                                               1000 }, ;
                       { "HeaderImagesAlign",  ::aHdrImgAlign[j],                                                             1000 }, ;
                       { "Headers",            ::aHeaders[j],                                                                 1000 }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "Image",              ::aImage[j],                                                                   1000 }, ;
                       { "InPlace",            ::aInPlace[j],                                                                 .F.  }, ;
                       { "InputMask",          ::aInputMask[j],                                                               1000 }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "Justify",            ::aJustify[j],                                                                 1000 }, ;
                       { "KeysLikeClipper",    ::aKeysLkClp[j],                                                               .F.  }, ;
                       { "Lock",               ::aLock[j],                                                                    .F.  }, ;
                       { "NavigateByCell",     ::aNavByCell[j],                                                               .F.  }, ;
                       { "NewAtRow",           ::aNewAtRow[j],                                                                1000 }, ;
                       { "NoDefaultMsg",       ::aNoDefMsg[j],                                                                .F.  }, ;
                       { "NoDeleteMsg",        ::aNoDelMsg[j],                                                                .F.  }, ;
                       { "NoHeaders",          ::aNoHeaders[j],                                                               .F.  }, ;
                       { "NoHScroll",          ::aNoHScroll[j],                                                               .F.  }, ;
                       { "NoLines",            ::aNoLines[j],                                                                 .F.  }, ;
                       { "NoModalEdit",        ::aNoModalEdit[j],                                                             .F.  }, ;
                       { "NoneUnsels",         ::aNoneUnsels[j],                                                              .F.  }, ;
                       { "NoShowAlways",       ::aNoShowAlways[j],                                                            .F.  }, ;
                       { "NoTabStop",          ::aNoTabStop[j],                                                               .F.  }, ;
                       { "NoVScroll",          ::aNoVScroll[j],                                                               .F.  }, ;
                       { "PaintLeftMargin",    ::aPLM[j],                                                                     .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "ReadOnly",           ::aReadOnlyArray[j],                                                           1000 }, ;
                       { "RecCount",           ::aRecCount[j],                                                                .F.  }, ;
                       { "Refresh",            AScan( { "REFRESH_FORCE", "REFRESH_NO" }, ::aRefresh[j] ) + 1,                 { "REFRESH_DEFAULT", "REFRESH_FORCE", "REFRESH_NO" } }, ;
                       { "ReplaceField",       ::aReplaceField[j],                                                            1000 }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "SelectedColors",     ::aSelColor[j],                                                                1000 }, ;
                       { "Silent",             ::aSilent[j],                                                                  .F.  }, ;
                       { "SingleBuffer",       ::aSingleBuffer[j],                                                            .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "Synchronized",       AScan( { ".T.", ".F." }, ::aSync[j] ) + 1,                                     { "NIL", ".T.", ".F." } }, ;
                       { "TimeOut",            ::aTimeOut[j],                                                                 1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "UpdateAll",          ::aUpdate[j],                                                                  1000 }, ;
                       { "UpdateColors",       ::aUpdateColors[j],                                                            .F.  }, ;
                       { "UseButtons",         ::aUseButtons[j],                                                              .F.  }, ;
                       { "Valid",              ::aValid[j],                                                                   1000 }, ;
                       { "ValidMessages",      ::aValidMess[j],                                                               1000 }, ;
                       { "Value ",             ::aValue[j],                                                                   1000 }, ;
                       { "When",               ::aWhen[j],                                                                    1000 }, ;
                       { "Widths",             ::aWidths[j],                                                                  1000 }, ;
                       { "WorkArea",           ::aWorkArea[j],                                                                1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aAppend[j]           := aResults[ ++k ]
      ::aBreak[j]            := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aCellToolTip[j]      := aResults[ ++k ]
      ::aChgBefEdit[j]       := aResults[ ++k ]
      ::aCheckBoxes[j]       := aResults[ ++k ]
      ::aColumnCtrls[j]      := aResults[ ++k ]
      ::aColumnInfo[j]       := aResults[ ++k ]
      ::aDefaultValues[j]    := aResults[ ++k ]
      ::aDelete[j]           := aResults[ ++k ]
      ::aDeleteMsg[j]        := aResults[ ++k ]
      ::aDeleteWhen[j]       := aResults[ ++k ]
      ::aDescend[j]          := aResults[ ++k ]
      ::aDisableAltA[j]      := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aDynBackColor[j]     := aResults[ ++k ]
      ::aDynForeColor[j]     := aResults[ ++k ]
      ::aEdit[j]             := aResults[ ++k ]
      ::aEditCellValue[j]    := aResults[ ++k ]
      ::aEditFirstVis[j]     := aResults[ ++k ]
      ::aEditKeys[j]         := aResults[ ++k ]
      ::aEditKeysFun[j]      := aResults[ ++k ]
      ::aEditLikeExcel[j]    := aResults[ ++k ]
      ::aExtDblClick[j]      := aResults[ ++k ]
      ::aFields[j]           := aResults[ ++k ]
      ::aFixBlocks[j]        := { "NIL", ".T.", ".F." } [ aResults[ ++k ] ]
      ::aFixedCols[j]        := aResults[ ++k ]
      ::aFixedCtrls[j]       := { "NIL", ".T.", ".F." } [ aResults[ ++k ] ]
      ::aFixedWidths[j]      := aResults[ ++k ]
      ::aFocusRect[j]        := { "NIL", ".T.", ".F." } [ aResults[ ++k ] ]
      ::aFullMove[j]         := aResults[ ++k ]
      ::aHdrBackClrs[j]      := aResults[ ++k ]
      ::aHdrFontClrs[j]      := aResults[ ++k ]
      ::aHdrImages[j]        := aResults[ ++k ]
      ::aHdrImgAlign[j]      := aResults[ ++k ]
      ::aHeaders[j]          := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aImage[j]            := aResults[ ++k ]
      ::aInPlace[j]          := aResults[ ++k ]
      ::aInputMask[j]        := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aJustify[j]          := aResults[ ++k ]
      ::aKeysLkClp[j]        := aResults[ ++k ]
      ::aLock[j]             := aResults[ ++k ]
      ::aNavByCell[j]        := aResults[ ++k ]
      ::aNewAtRow[j]         := aResults[ ++k ]
      ::aNoDefMsg[j]         := aResults[ ++k ]
      ::aNoDelMsg[j]         := aResults[ ++k ]
      ::aNoHeaders[j]        := aResults[ ++k ]
      ::aNoHScroll[j]        := aResults[ ++k ]
      ::aNoLines[j]          := aResults[ ++k ]
      ::aNoModalEdit[j]      := aResults[ ++k ]
      ::aNoneUnsels[j]       := aResults[ ++k ]
      ::aNoShowAlways[j]     := aResults[ ++k ]
      ::aNoTabStop[j]        := aResults[ ++k ]
      ::aNoVScroll[j]        := aResults[ ++k ]
      ::aPLM[j]              := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aReadOnlyArray[j]    := aResults[ ++k ]
      ::aRecCount[j]         := aResults[ ++k ]
      ::aRefresh[j]          := { "REFRESH_DEFAULT", "REFRESH_FORCE", "REFRESH_NO" } [ aResults[ ++k ] ]
      ::aReplaceField[j]     := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aSelColor[j]         := aResults[ ++k ]
      ::aSilent[j]           := aResults[ ++k ]
      ::aSingleBuffer[j]     := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aSync[j]             := { "NIL", ".T.", ".F." } [ aResults[ ++k ] ]
      ::aTimeOut[j]          := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aUpdate[j]           := aResults[ ++k ]
      ::aUpdateColors[j]     := aResults[ ++k ]
      ::aUseButtons[j]       := aResults[ ++k ]
      ::aValid[j]            := aResults[ ++k ]
      ::aValidMess[j]        := aResults[ ++k ]
      ::aValue[j]            := aResults[ ++k ]
      ::aWhen[j]             := aResults[ ++k ]
      ::aWidths[j]           := aResults[ ++k ]
      ::aWorkArea[j]         := aResults[ ++k ]
      EXIT

   CASE TYPE_BUTTON
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Buffer",             ::aBuffer[j],                                                                  1000 }, ;
                       { "Cancel",             ::aCancel[j],                                                                  .F.  }, ;
                       { "Caption",            ::aCaption[j],                                                                 1000 }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "Default",            ::aDefault[j],                                                                 .F.  }, ;
                       { "DIBSection",         ::aDIBSection[j],                                                              .F. }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F. }, ;
                       { "DrawBy",             AScan( { "OOHGDRAW", "WINDRAW" }, ::aDrawBy[j] ) + 1,                          { "NIL", "OOHGDRAW", "WINDRAW" } }, ;
                       { "FitImg",             ::aFitImg[j],                                                                  .F. }, ;
                       { "FitTxt",             ::aFitTxt[j],                                                                  .F. }, ;
                       { "Flat",               ::aFlat[j],                                                                    .F. }, ;
                       { "ForceScale",         ::aForceScale[j],                                                              .F. }, ;
                       { "HandCursor",         ::aHandCursor[j],                                                              .F.  }, ;
                       { "HBitmap",            ::aHBitmap[j],                                                                 1000 }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "ImageAlign",         AScan( { "BOTTOM", "CENTER", "LEFT", "RIGHT", "TOP" }, ::aImageAlign[j] ) + 1, { "NIL", "BOTTOM",  "CENTER",  "LEFT",  "RIGHT",  "TOP" } }, ;
                       { "ImageMargin",        ::aImageMargin[j],                                                             1000 }, ;
                       { "ImageSize",          ::aImageSize[j],                                                               .F. }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F. }, ;
                       { "MultiLine",          ::aMultiLine[j],                                                               .F. }, ;
                       { "No3DColors",         ::aNo3DColors[j],                                                              .F. }, ;
                       { "NoDestroy",          ::aNoDestroy[j],                                                               .F. }, ;
                       { "NoFocusRect",        ::aNoFocusRect[j],                                                             .F. }, ;
                       { "NoHotLight",         ::aNoHotLight[j],                                                              .F. }, ;
                       { "NoImageList",        ::aNoImgList[j],                                                               .F. }, ;
                       { "NoLoadTransp.",      ::aNoLoadTrans[j],                                                             .F. }, ;
                       { "NoPrefix",           ::aNoPrefix[j],                                                                .F. }, ;
                       { "NoPrintOver",        ::aNoPrint[j],                                                                 .F. }, ;
                       { "NoTabStop",          ::aNoTabStop[j],                                                               .F. }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "Picture",            ::aPicture[j],                                                                 1000 }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F. }, ;
                       { "Solid",              ::aSolid[j],                                                                   .F. }, ;
                       { "Stretch",            ::aStretch[j],                                                                 .F. }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "TextAlignH",         AScan( { "LEFT", "RIGHT", "CENTER" }, ::aAlignH[j] ) + 1,                      { "NIL", "LEFT", "RIGHT", "CENTER" } }, ;
                       { "TextAlignV",         AScan( { "TOP", "BOTTOM", "VCENTER" }, ::aAlignV[j] ) + 1,                     { "NIL", "TOP", "BOTTOM", "VCENTER" } }, ;
                       { "TextMargin",         ::aTxtMrgn[j],                                                                 1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "Transparent",        ::aTransparent[j],                                                             .F. } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aBuffer[j]           := aResults[ ++k ]
      ::aCancel[j]           := aResults[ ++k ]
      ::aCaption[j]          := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aDefault[j]          := aResults[ ++k ]
      ::aDIBSection[j]       := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aDrawBy[j]           := { "NIL", "OOHGDRAW", "WINDRAW" } [ aResults[ ++k ] ]
      ::aFitImg[j]           := aResults[ ++k ]
      ::aFitTxt[j]           := aResults[ ++k ]
      ::aFlat[j]             := aResults[ ++k ]
      ::aForceScale[j]       := aResults[ ++k ]
      ::aHandCursor[j]       := aResults[ ++k ]
      ::aHBitmap[j]          := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aImageAlign[j]       := { "NIL", "BOTTOM",  "CENTER",  "LEFT",  "RIGHT",  "TOP" } [ aResults[ ++k ] ]
      ::aImageMargin[j]      := aResults[ ++k ]
      ::aImageSize[j]        := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aMultiLine[j]        := aResults[ ++k ]
      ::aNo3DColors[j]       := aResults[ ++k ]
      ::aNoDestroy[j]        := aResults[ ++k ]
      ::aNoFocusRect[j]      := aResults[ ++k ]
      ::aNoHotLight[j]       := aResults[ ++k ]
      ::aNoImgList[j]        := aResults[ ++k ]
      ::aNoLoadTrans[j]      := aResults[ ++k ]
      ::aNoPrefix[j]         := aResults[ ++k ]
      ::aNoPrint[j]          := aResults[ ++k ]
      ::aNoTabStop[j]        := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aPicture[j]          := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aSolid[j]            := aResults[ ++k ]
      ::aStretch[j]          := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aAlignH[j]           := { "NIL", "LEFT", "RIGHT", "CENTER" } [ aResults[ ++k ] ]
      ::aAlignV[j]           := { "NIL", "TOP", "BOTTOM", "VCENTER" } [ aResults[ ++k ] ]
      ::aTxtMrgn[j]          := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aTransparent[j]      := aResults[ ++k ]
      EXIT

   CASE TYPE_CHECKBOX
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "AutoSize",           ::aAutoSize[j],                                                                .F.  }, ;
                       { "Background",         ::aBackground[j],                                                              1000 }, ;
                       { "Caption",            ::aCaption[j],                                                                 1000 }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "DrawBy",             AScan( { "OOHGDRAW", "WINDRAW" }, ::aDrawBy[j] ) + 1,                          { "NIL", "OOHGDRAW", "WINDRAW" } }, ;
                       { "Field",              ::aField[j],                                                                   1000 }, ;
                       { "FillRect",           AScan( { "YES", "NO" }, ::aFillRect[j] ) + 1,                                  { "NIL", "YES", "NO" } }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "LeftAlign",          ::aLeftJust[j],                                                                .F.  }, ;
                       { "NoFocusRect",        ::aNoFocusRect[j],                                                             .F.  }, ;
                       { "NoTabStop",          ::aNoTabStop[j],                                                               .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "ThreeState",         ::a3State[j],                                                                  .F.  }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "Transparent",        ::aTransparent[j],                                                             .F.  }, ;
                       { "Value",              ::aValue[j],                                                                   1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aAutoSize[j]         := aResults[ ++k ]
      ::aBackground[j]       := aResults[ ++k ]
      ::aCaption[j]          := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aDrawBy[j]           := { "NIL", "OOHGDRAW", "WINDRAW" } [ aResults[ ++k ] ]
      ::aField[j]            := aResults[ ++k ]
      ::aFillRect[j]         := { "NIL", "YES", "NO" } [ aResults[ ++k ] ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aLeftJust[j]         := aResults[ ++k ]
      ::aNoFocusRect[j]      := aResults[ ++k ]
      ::aNoTabStop[j]        := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::a3State[j]           := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aTransparent[j]      := aResults[ ++k ]
      ::aValue[j]            := aResults[ ++k ]
      EXIT

   CASE TYPE_CHECKBUTTON
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Buffer",             ::aBuffer[j],                                                                  1000 }, ;
                       { "Caption",            ::aCaption[j],                                                                 1000 }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "DIBSection",         ::aDIBSection[j],                                                              .F.  }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "DrawBy",             AScan( { "OOHGDRAW", "WINDRAW" }, ::aDrawBy[j] ) + 1,                           { "NIL", "OOHGDRAW", "WINDRAW" } }, ;
                       { "Field",              ::aField[j],                                                                   1000 }, ;
                       { "FitImg",             ::aFitImg[j],                                                                  .F. }, ;
                       { "FitTxt",             ::aFitTxt[j],                                                                  .F. }, ;
                       { "Flat",               ::aFlat[j],                                                                    .F. }, ;
                       { "ForceScale",         ::aForceScale[j],                                                              .F. }, ;
                       { "HandCursor",         ::aHandCursor[j],                                                              .F.  }, ;
                       { "HBitmap",            ::aHBitmap[j],                                                                 1000 }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "ImageAlign",         AScan( { "BOTTOM", "CENTER", "LEFT", "RIGHT", "TOP" }, ::aImageAlign[j] ) + 1, { "NIL", "BOTTOM",  "CENTER",  "LEFT",  "RIGHT",  "TOP" } }, ;
                       { "ImageMargin",        ::aImageMargin[j],                                                             1000 }, ;
                       { "ImageSize",          ::aImageSize[j],                                                               .F.  }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "MultiLine",          ::aMultiLine[j],                                                               .F.  }, ;
                       { "No3DColors",         ::aNo3DColors[j],                                                              .F.  }, ;
                       { "NoDestroy",          ::aNoDestroy[j],                                                               .F. }, ;
                       { "NoFocusRect",        ::aNoFocusRect[j],                                                             .F. }, ;
                       { "NoHotLight",         ::aNoHotLight[j],                                                              .F.  }, ;
                       { "NoImageList",        ::aNoImgList[j],                                                               .F.  }, ;
                       { "NoLoadTransparent",  ::aNoLoadTrans[j],                                                             .F.  }, ;
                       { "NoPrintOver",        ::aNoPrint[j],                                                                 .F.  }, ;
                       { "NoTabStop",          ::aNoTabStop[j],                                                               .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "Picture",            ::aPicture[j],                                                                 1000 }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "Solid",              ::aSolid[j],                                                                   .F.  }, ;
                       { "Stretch",            ::aStretch[j],                                                                 .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "TextAlignH",         AScan( { "LEFT", "RIGHT", "CENTER" }, ::aAlignH[j] ) + 1,                      { "NIL", "LEFT", "RIGHT", "CENTER" } }, ;
                       { "TextAlignV",         AScan( { "TOP", "BOTTOM", "VCENTER" }, ::aAlignV[j] ) + 1,                     { "NIL", "TOP", "BOTTOM", "VCENTER" } }, ;
                       { "TextMargin",         ::aTxtMrgn[j],                                                                 1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "Transparent",        ::aTransparent[j],                                                             .F.  }, ;
                       { "Value",              ::aValue[j],                                                                   1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aBuffer[j]           := aResults[ ++k ]
      ::aCaption[j]          := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aDIBSection[j]       := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aDrawBy[j]           := { "NIL", "OOHGDRAW", "WINDRAW" } [ aResults[ ++k ] ]
      ::aField[j]            := aResults[ ++k ]
      ::aFitImg[j]           := aResults[ ++k ]
      ::aFitTxt[j]           := aResults[ ++k ]
      ::aFlat[j]             := aResults[ ++k ]
      ::aForceScale[j]       := aResults[ ++k ]
      ::aHandCursor[j]       := aResults[ ++k ]
      ::aHBitmap[j]          := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aImageAlign[j]       := { "NIL", "BOTTOM",  "CENTER",  "LEFT",  "RIGHT",  "TOP" } [ aResults[ ++k ] ]
      ::aImageMargin[j]      := aResults[ ++k ]
      ::aImageSize[j]        := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aMultiLine[j]        := aResults[ ++k ]
      ::aNo3DColors[j]       := aResults[ ++k ]
      ::aNoDestroy[j]        := aResults[ ++k ]
      ::aNoFocusRect[j]      := aResults[ ++k ]
      ::aNoHotLight[j]       := aResults[ ++k ]
      ::aNoImgList[j]        := aResults[ ++k ]
      ::aNoLoadTrans[j]      := aResults[ ++k ]
      ::aNoPrint[j]          := aResults[ ++k ]
      ::aNoTabStop[j]        := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aPicture[j]          := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aSolid[j]            := aResults[ ++k ]
      ::aStretch[j]          := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aAlignH[j]           := { "NIL", "LEFT", "RIGHT", "CENTER" } [ aResults[ ++k ] ]
      ::aAlignV[j]           := { "NIL", "TOP", "BOTTOM", "VCENTER" } [ aResults[ ++k ] ]
      ::aTxtMrgn[j]          := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aTransparent[j]      := aResults[ ++k ]
      ::aValue[j]            := aResults[ ++k ]
      EXIT

   CASE TYPE_CHECKLIST
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Break",              ::aBreak[j],                                                                   .F.  }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "Descending",         ::aDescend[j],                                                                 .F.  }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "Image",              ::aImage[j],                                                                   1000 }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "Items",              ::aItems[j],                                                                   1000 }, ;
                       { "Justify",            ::aJustify[j],                                                                 1000 }, ;
                       { "NoTabStop",          ::aNoTabStop[j],                                                               .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "SelectedColor",      ::aSelColor[j],                                                                1000 }, ;
                       { "SingleBuffer",       ::aSingleBuffer[j],                                                            .F.  }, ;
                       { "Sort",               ::aSort[j],                                                                    .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "Value",              ::aValue[j],                                                                   1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aBreak[j]            := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aDescend[j]          := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aImage[j]            := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aItems[j]            := aResults[ ++k ]
      ::aJustify[j]          := aResults[ ++k ]
      ::aNoTabStop[j]        := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aSelColor[j]         := aResults[ ++k ]
      ::aSingleBuffer[j]     := aResults[ ++k ]
      ::aSort[j]             := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aValue[j]            := aResults[ ++k ]
      EXIT

   CASE TYPE_COMBOBOX
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "AutoSize",           ::aAutoSize[j],                                                                .F.  }, ;
                       { "Break",              ::aBreak[j],                                                                   .F.  }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "CueBanner",          ::aCue[j],                                                                     1000 }, ;
                       { "DelayedLoad",        ::aDelayedLoad[j],                                                             .F.  }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "DisplayEdit",        ::aDisplayEdit[j],                                                             .F.  }, ;
                       { "EditHeight",         ::aEditHeight[j],                                                               1000 }, ;
                       { "FirstItem",          ::aFirstItem[j],                                                               .F.  }, ;
                       { "Fit",                ::aFit[j],                                                                     .F.  }, ;
                       { "GripperText",        ::aGripperText[j],                                                             1000 }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "Image",              ::aImage[j],                                                                   1000 }, ;
                       { "ImageSource",        ::aImageSource[j],                                                             1000 }, ;
                       { "Incremental",        ::aIncremental[j],                                                             .F.  }, ;
                       { "IntegralHeight",     ::aIntegHeight[j],                                                             .F.  }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "ItemImageNumber",    ::aItemImgNumber[j],                                                           1000 }, ;
                       { "Items",              ::aItems[j],                                                                   1000 }, ;
                       { "ItemSource",         ::aItemSource[j],                                                              1000 }, ;
                       { "ListWidth",          ::aListWidth[j],                                                               1000 }, ;
                       { "MaxLength",          ::aMaxLength[j],                                                               1000 }, ;
                       { "NoClone",            ::aNoClone[j],                                                                 .F.  }, ;
                       { "NoHScroll",          ::aNoHScroll[j],                                                               .F.  }, ;
                       { "NoLoadTransparent",  ::aNoLoadTrans[j],                                                             .F.  }, ;
                       { "NoTabStop",          ::aNoTabStop[j],                                                               .F.  }, ;
                       { "OptionsHeight",      ::aOptHeight[j],                                                               1000 }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "Refresh",            AScan( { ".T.", ".F."}, ::aRefresh[j] ) + 1,                                   { "NIL", ".T.", ".F."} }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "SearchLapse",        ::aSearchLapse[j],                                                             1000 }, ;
                       { "Sort",               ::aSort[j],                                                                    .F.  }, ;
                       { "SourceOrder",        ::aSourceOrder[j],                                                             1000 }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "TextHeight",         ::aTextHeight[j],                                                              1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "Value",              ::aValue[j],                                                                   1000 }, ;
                       { "ValueIs",            AScan( { "INDEXISVALUE", "SOURCEISVALUE" }, ::aValueIs[j] ) + 1,               { "NIL", "INDEXISVALUE", "SOURCEISVALUE" } }, ;
                       { "Valuesource",        ::aValueSource[j],                                                             1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aAutoSize[j]         := aResults[ ++k ]
      ::aBreak[j]            := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aCue[j]              := aResults[ ++k ]
      ::aDelayedLoad[j]      := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aDisplayEdit[j]      := aResults[ ++k ]
      ::aEditHeight[j]       := aResults[ ++k ]
      ::aFirstItem[j]        := aResults[ ++k ]
      ::aFit[j]              := aResults[ ++k ]
      ::aGripperText[j]      := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aImage[j]            := aResults[ ++k ]
      ::aImageSource[j]      := aResults[ ++k ]
      ::aIncremental[j]      := aResults[ ++k ]
      ::aIntegHeight[j]      := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aItemImgNumber[j]    := aResults[ ++k ]
      ::aItems[j]            := aResults[ ++k ]
      ::aItemSource[j]       := aResults[ ++k ]
      ::aListWidth[j]        := aResults[ ++k ]
      ::aMaxLength[j]        := aResults[ ++k ]
      ::aNoClone[j]          := aResults[ ++k ]
      ::aNoHScroll[j]        := aResults[ ++k ]
      ::aNoLoadTrans[j]      := aResults[ ++k ]
      ::aNoTabStop[j]        := aResults[ ++k ]
      ::aOptHeight[j]        := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aRefresh[j]          := { "NIL", ".T.", ".F."} [ aResults[ ++k ] ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aSearchLapse[j]      := aResults[ ++k ]
      ::aSort[j]             := aResults[ ++k ]
      ::aSourceOrder[j]      := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aTextHeight[j]       := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aValue[j]            := aResults[ ++k ]
      ::aValueIs[j]          := { "NIL", "INDEXISVALUE", "SOURCEISVALUE" } [ aResults[ ++k ] ]
      ::aValueSource[j]      := aResults[ ++k ]
      EXIT

   CASE TYPE_DATEPICKER
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "DateFormat",         ::aFormat[j],                                                                  1000 }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "Field",              ::aField[j],                                                                   1000 }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "NoBorder",           ::aNoBorder[j],                                                                .F.  }, ;
                       { "NoTabStop",          ::aNoTabStop[j],                                                               .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "Range",              ::aRange[j],                                                                   1000 }, ;
                       { "RightAlign",         ::aRightAlign[j],                                                              .F.  }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "ShowNone",           ::aShowNone[j],                                                                .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "UpDown",             ::aUpDown[j],                                                                  .F.  }, ;
                       { "Valid",              ::aValid[j],                                                                   1000 }, ;
                       { "Value",              ::aValue[j],                                                                   1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aFormat[j]           := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aField[j]            := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aNoBorder[j]         := aResults[ ++k ]
      ::aNoTabStop[j]        := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aRange[j]            := aResults[ ++k ]
      ::aRightAlign[j]       := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aShowNone[j]         := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aUpDown[j]           := aResults[ ++k ]
      ::aValid[j]            := aResults[ ++k ]
      ::aValue[j]            := aResults[ ++k ]
      EXIT

   CASE TYPE_EDITBOX
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Break",              ::aBreak[j],                                                                   .F.  }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "Field",              ::aField[j],                                                                   1000 }, ;
                       { "FocusedPos",         ::aFocusedPos[j],                                                              1000 }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "InsertType",         ::aInsertType[j],                                                              1000 }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "MaxLength",          ::aMaxLength[j],                                                               1000 }, ;
                       { "NoBorder",           ::aNoBorder[j],                                                                .F.  }, ;
                       { "NoHScroll",          ::aNoHScroll[j],                                                               .F.  }, ;
                       { "NoTabStop",          ::aNoTabStop[j],                                                               .F.  }, ;
                       { "NoVScroll",          ::aNoVScroll[j],                                                               .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "ReadOnly",           ::aReadOnly[j],                                                                .F.  }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "Value",              ::aValue[j],                                                                   1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aBreak[j]            := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aField[j]            := aResults[ ++k ]
      ::aFocusedPos[j]       := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aInsertType[j]       := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aMaxLength[j]        := aResults[ ++k ]
      ::aNoBorder[j]         := aResults[ ++k ]
      ::aNoHScroll[j]        := aResults[ ++k ]
      ::aNoTabStop[j]        := aResults[ ++k ]
      ::aNoVScroll[j]        := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aReadOnly[j]         := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aValue[j]            := aResults[ ++k ]
      EXIT

   CASE TYPE_FRAME
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Caption",            ::aCaption[j],                                                                 1000 }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "ExcludeArea",        ::aExclude[j],                                                                 1000 }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "Opaque",             ::aOpaque[j],                                                                  .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "Transparent",        ::aTransparent[j],                                                             .F.  } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
     aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aCaption[j]          := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aExclude[j]          := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aOpaque[j]           := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aTransparent[j]      := aResults[ ++k ]
      EXIT

   CASE TYPE_GRID
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Append",             ::aAppend[j],                                                                  .F.  }, ;
                       { "Break",              ::aBreak[j],                                                                   .F.  }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "CellToolTip",        ::aCellToolTip[j],                                                             1000 }, ;
                       { "ChangeBeforeEdit",   ::aChgBefEdit[j],                                                              .F.  }, ;
                       { "CheckBoxes",         ::aCheckBoxes[j],                                                              .F.  }, ;
                       { "ColumnControls",     ::aColumnCtrls[j],                                                             1000 }, ;
                       { "Delete",             ::aDelete[j],                                                                  .F.  }, ;
                       { "DeleteMsg",          ::aDeleteMsg[j],                                                               1000 }, ;
                       { "DeleteWhen",         ::aDeleteWhen[j],                                                              1000 }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "DynamicBackColor",   ::aDynBackColor[j],                                                            1000 }, ;
                       { "DynamicForeColor",   ::aDynForeColor[j],                                                            1000 }, ;
                       { "Edit",               ::aEdit[j],                                                                    .F.  }, ;
                       { "EditCellValue",      ::aEditCellValue[j],                                                           1000 }, ;
                       { "EditFirstVisible",   ::aEditFirstVis[j],                                                            .F.  }, ;
                       { "EditKeys",           ::aEditKeys[j],                                                                1000 }, ;
                       { "EditKeysFun",        ::aEditKeysFun[j],                                                             1000 }, ;
                       { "EditLikeExcel",      ::aEditLikeExcel[j],                                                           .F.  }, ;
                       { "EnableAltA",         ::aEnableAltA[j],                                                              .F.  }, ;
                       { "ExtDblClick",        ::aExtDblClick[j],                                                             .F.  }, ;
                       { "FixedCols",          ::aFixedCols[j],                                                               .F.  }, ;
                       { "FixedControls",      AScan( { ".T.", ".F." }, ::aFixedCtrls[j] ) + 1,                               { "NIL", ".T.", ".F." } }, ;
                       { "FixedWidths",        ::aFixedWidths[j],                                                             .F.  }, ;
                       { "FocusRect",          AScan( { ".T.", ".F." }, ::aFocusRect[j] ) + 1,                                { "NIL", ".T.", ".F." } }, ;
                       { "FullMove",           ::aFullMove[j],                                                                .F.  }, ;
                       { "HeaderBackColors",   ::aHdrBackClrs[j],                                                             1000 }, ;
                       { "HeaderColors",       ::aHdrFontClrs[j],                                                             1000 }, ;
                       { "HeaderImages",       ::aHdrImages[j],                                                               1000 }, ;
                       { "HeaderImagesAlign",  ::aHdrImgAlign[j],                                                             1000 }, ;
                       { "Headers",            ::aHeaders[j],                                                                 1000 }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "Image",              ::aImage[j],                                                                   1000 }, ;
                       { "InPlace",            ::aInPlace[j],                                                                 .F.  }, ;
                       { "InputMask",          ::aInputMask[j],                                                               1000 }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "ItemCount",          ::aItemCount[j],                                                               1000 }, ;
                       { "Items",              ::aItems[j],                                                                   1000 }, ;
                       { "Justify",            ::aJustify[j],                                                                 1000 }, ;
                       { "KeysLikeClipper",    ::aKeysLkClp[j],                                                               .F.  }, ;
                       { "MultiSelect",        ::aMultiSelect[j],                                                             .F.  }, ;
                       { "NavigateByCell",     ::aNavByCell[j],                                                               .F.  }, ;
                       { "NoClickOnCheckBox",  ::aNoClickOnChk[j],                                                            .F.  }, ;
                       { "NoDefaultMsg",       ::aNoDefMsg[j],                                                                .F.  }, ;
                       { "NoDeleteMsg",        ::aNoDelMsg[j],                                                                .F.  }, ;
                       { "NoHeaders",          ::aNoHeaders[j],                                                               .F.  }, ;
                       { "NoHScroll",          ::aNoHScroll[j],                                                               .F.  }, ;
                       { "NoLines",            ::aNoLines[j],                                                                 .F.  }, ;
                       { "NoModalEdit",        ::aNoModalEdit[j],                                                             .F.  }, ;
                       { "NoneUnsels",         ::aNoneUnsels[j],                                                              .F.  }, ;
                       { "NoRClickOnCheckbox", ::aNoRClickOnChk[j],                                                           .F.  }, ;
                       { "NoShowAlways",       ::aNoShowAlways[j],                                                            .F.  }, ;
                       { "NoTabStop",          ::aNoTabStop[j],                                                               .F.  }, ;
                       { "NoVScroll",          ::aNoVScroll[j],                                                               .F.  }, ;
                       { "PaintLeftMargin",    ::aPLM[j],                                                                     .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "Readonly",           ::aReadOnlyArray[j],                                                           1000 }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "SelectedColor",      ::aSelColor[j],                                                                1000 }, ;
                       { "Silent",             ::aSilent[j],                                                                  .F.  }, ;
                       { "SingleBuffer",       ::aSingleBuffer[j],                                                            .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "TimeOut",            ::aTimeOut[j],                                                                 1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "UseButtons",         ::aUseButtons[j],                                                              .F.  }, ;
                       { "Valid",              ::aValid[j],                                                                   1000 }, ;
                       { "ValidMessages",      ::aValidMess[j],                                                               1000 }, ;
                       { "Value",              ::aValue[j],                                                                   1000 }, ;
                       { "Virtual",            ::aVirtual[j],                                                                 .F.  }, ;
                       { "When",               ::aWhen[j],                                                                    1000 }, ;
                       { "Widths",             ::aWidths[j],                                                                  1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aAppend[j]           := aResults[ ++k ]
      ::aBreak[j]            := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aCellToolTip[j]      := aResults[ ++k ]
      ::aChgBefEdit[j]       := aResults[ ++k ]
      ::aCheckBoxes[j]       := aResults[ ++k ]
      ::aColumnCtrls[j]      := aResults[ ++k ]
      ::aDelete[j]           := aResults[ ++k ]
      ::aDeleteMsg[j]        := aResults[ ++k ]
      ::aDeleteWhen[j]       := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aDynBackColor[j]     := aResults[ ++k ]
      ::aDynForeColor[j]     := aResults[ ++k ]
      ::aEdit[j]             := aResults[ ++k ]
      ::aEditCellValue[j]    := aResults[ ++k ]
      ::aEditFirstVis[j]     := aResults[ ++k ]
      ::aEditKeys[j]         := aResults[ ++k ]
      ::aEditKeysFun[j]      := aResults[ ++k ]
      ::aEditLikeExcel[j]    := aResults[ ++k ]
      ::aEnableAltA[j]       := aResults[ ++k ]
      ::aExtDblClick[j]      := aResults[ ++k ]
      ::aFixedCols[j]        := aResults[ ++k ]
      ::aFixedCtrls[j]       := { "NIL", ".T.", ".F." } [ aResults[ ++k ] ]
      ::aFixedWidths[j]      := aResults[ ++k ]
      ::aFocusRect[j]        := { "NIL", ".T.", ".F." } [ aResults[ ++k ] ]
      ::aFullMove[j]         := aResults[ ++k ]
      ::aHdrImgAlign[j]      := aResults[ ++k ]
      ::aHdrBackClrs[j]      := aResults[ ++k ]
      ::aHdrFontClrs[j]      := aResults[ ++k ]
      ::aHdrImages[j]        := aResults[ ++k ]
      ::aHeaders[j]          := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aImage[j]            := aResults[ ++k ]
      ::aInPlace[j]          := aResults[ ++k ]
      ::aInputMask[j]        := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aItemCount[j]        := aResults[ ++k ]
      ::aItems[j]            := aResults[ ++k ]
      ::aJustify[j]          := aResults[ ++k ]
      ::aKeysLkClp[j]        := aResults[ ++k ]
      ::aMultiSelect[j]      := aResults[ ++k ]
      ::aNavByCell[j]        := aResults[ ++k ]
      ::aNoClickOnChk[j]     := aResults[ ++k ]
      ::aNoDefMsg[j]         := aResults[ ++k ]
      ::aNoDelMsg[j]         := aResults[ ++k ]
      ::aNoHeaders[j]        := aResults[ ++k ]
      ::aNoHScroll[j]        := aResults[ ++k ]
      ::aNoLines[j]          := aResults[ ++k ]
      ::aNoModalEdit[j]      := aResults[ ++k ]
      ::aNoneUnsels[j]       := aResults[ ++k ]
      ::aNoRClickOnChk[j]    := aResults[ ++k ]
      ::aNoShowAlways[j]     := aResults[ ++k ]
      ::aNoTabStop[j]        := aResults[ ++k ]
      ::aNoVScroll[j]        := aResults[ ++k ]
      ::aPLM[j]              := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aReadOnlyArray[j]    := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aSelColor[j]         := aResults[ ++k ]
      ::aSilent[j]           := aResults[ ++k ]
      ::aSingleBuffer[j]     := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aTimeOut[j]          := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aUseButtons[j]       := aResults[ ++k ]
      ::aValid[j]            := aResults[ ++k ]
      ::aValidMess[j]        := aResults[ ++k ]
      ::aValue[j]            := aResults[ ++k ]
      ::aVirtual[j]          := aResults[ ++k ]
      ::aWhen[j]             := aResults[ ++k ]
      ::aWidths[j]           := aResults[ ++k ]
      EXIT

   CASE TYPE_HOTKEYBOX
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "NoAlt",              ::aNoAlt[j],                                                                   .F.  }, ;
                       { "NoTabStop",          ::aNoTabStop[j],                                                               .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "Value",              ::aValue[j],                                                                   1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aNoAlt[j]            := aResults[ ++k ]
      ::aNoTabStop[j]        := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aValue[j]            := aResults[ ++k ]
      EXIT

   CASE TYPE_HYPERLINK
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Address",            ::aAddress[j],                                                                 1000 }, ;
                       { "AutoSize",           ::aAutoSize[j],                                                                .F.  }, ;
                       { "Border",             ::aBorder[j],                                                                  .F.  }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "ClientEdge",         ::aClientEdge[j],                                                              .F.  }, ;
                       { "HandCursor",         ::aHandCursor[j],                                                              .F.  }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "HScroll",            ::aHScroll[j],                                                                 .F.   }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "Transparent",        ::aTransparent[j],                                                             .F.  }, ;
                       { "Value",              ::aValue[j],                                                                   1000 }, ;
                       { "NoVScroll",          ::aVScroll[j],                                                                 .F.  } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aAddress[j]          := aResults[ ++k ]
      ::aAutoSize[j]         := aResults[ ++k ]
      ::aBorder[j]           := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aClientEdge[j]       := aResults[ ++k ]
      ::aHandCursor[j]       := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aHScroll[j]          := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aTransparent[j]      := aResults[ ++k ]
      ::aValue[j]            := iif( Empty( aResults[ ++k ] ), ::aValue[j], aResults[ k ] )
      ::aVScroll[j]          := aResults[ ++k ]
      EXIT

   CASE TYPE_IMAGE
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Border",             ::aBorder[j],                                                                  .F.  }, ;
                       { "Buffer",             ::aBuffer[j],                                                                  1000 }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "ClientEdge",         ::aClientEdge[j],                                                              .F.  }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "ExcludeArea",        ::aExclude[j],                                                                 1000 }, ;
                       { "HBitmap",            ::aHBitmap[j],                                                                 1000 }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "ImageSize",          ::aImageSize[j],                                                               .F.  }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "No3DColors",         ::aNo3DColors[j],                                                              .F.  }, ;
                       { "NoCheckDepth",       ::aNoChkDepth[j],                                                              .F.  }, ;
                       { "NoDIBSection",       ::aNoDIBSection[j],                                                            .F.  }, ;
                       { "NoLoadTransparent",  ::aNoLoadTrans[j],                                                             .F.  }, ;
                       { "NoParentRedraw",     ::aNoPRedraw[j],                                                               .F.  }, ;
                       { "NoResize",           ::aNoResize[j],                                                                .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "Picture",            ::aPicture[j],                                                                 1000 }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "Stretch",            ::aStretch[j],                                                                 .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "Transparent",        ::aTransparent[j],                                                             .F.  }, ;
                       { "WhiteBackground",    ::aWhiteBack[j],                                                               .F.  } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aBorder[j]           := aResults[ ++k ]
      ::aBuffer[j]           := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aClientEdge[j]       := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aExclude[j]          := aResults[ ++k ]
      ::aHBitmap[j]          := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aImageSize[j]        := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aNo3DColors[j]       := aResults[ ++k ]
      ::aNoChkDepth[j]       := aResults[ ++k ]
      ::aNoDIBSection[j]     := aResults[ ++k ]
      ::aNoLoadTrans[j]      := aResults[ ++k ]
      ::aNoPRedraw[j]        := aResults[ ++k ]
      ::aNoResize[j]         := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aPicture[j]          := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aStretch[j]          := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aTransparent[j]      := aResults[ ++k ]
      ::aWhiteBack[j]        := aResults[ ++k ]
      EXIT

   CASE TYPE_IPADDRESS
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "NoTabStop",          ::aNoTabStop[j],                                                               .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "Value",              ::aValue[j],                                                                   1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aNoTabStop[j]        := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aValue[j]            := aResults[ ++k ]
      EXIT

   CASE TYPE_LABEL
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "AutoHeight",         ::aAutoHeight[j],                                                              .F.  }, ;
                       { "AutoSize",           ::aAutoSize[j],                                                                .F.  }, ;
                       { "AutoWidth",          ::aAutoWidth[j],                                                               .F.  }, ;
                       { "Border",             ::aBorder[j],                                                                  .F.  }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "CenterAlign",        ::aCenterAlign[j],                                                             .F.  }, ;
                       { "ClientEdge",         ::aClientEdge[j],                                                              .F.  }, ;
                       { "Cursor",             ::aCursor[j],                                                                  1000 }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "HScroll",            ::aHScroll[j],                                                                 .F.  }, ;
                       { "InputMask",          ::aInputMask[j],                                                               1000 }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "NoPrefix",           ::aNoPrefix[j],                                                                .F.  }, ;
                       { "NoWordWrap",         ::aNoWrap[j],                                                                  .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "RightAlign",         ::aRightAlign[j],                                                              .F.  }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "Transparent",        ::aTransparent[j],                                                             .F.  }, ;
                       { "Value",              ::aValue[j],                                                                   1000 }, ;
                       { "VCenterAlign",       ::aVCenter[j],                                                                 .F.  }, ;
                       { "VScroll",            ::aVScroll[j],                                                                 .F.  } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aAutoHeight[j]       := aResults[ ++k ]
      ::aAutoSize[j]         := aResults[ ++k ]
      ::aAutoWidth[j]        := aResults[ ++k ]
      ::aBorder[j]           := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aCenterAlign[j]      := aResults[ ++k ]
      ::aClientEdge[j]       := aResults[ ++k ]
      ::aCursor[j]           := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aHScroll[j]          := aResults[ ++k ]
      ::aInputMask[j]        := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aNoPrefix[j]         := aResults[ ++k ]
      ::aNoWrap[j]           := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aRightAlign[j]       := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aTransparent[j]      := aResults[ ++k ]
      ::aValue[j]            := aResults[ ++k ]
      ::aVCenter[j]          := aResults[ ++k ]
      ::aVScroll[j]          := aResults[ ++k ]
      EXIT

   CASE TYPE_LISTBOX
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Break",              ::aBreak[j],                                                                   .F.  }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "ColumnWidth",        ::aColWidth[j],                                                                1000 }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "DragItems",          ::aDragItems[j],                                                               .F.  }, ;
                       { "Fit",                ::aFit[j],                                                                     .F.  }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "Image",              ::aImage[j],                                                                   1000 }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "Items",              ::aItems[j],                                                                   1000 }, ;
                       { "MultiColumn",        ::aMultiCol[j],                                                                .F.  }, ;
                       { "MultiSelect",        ::aMultiSelect[j],                                                             .F.  }, ;
                       { "MultiTab",           ::aMultiTab[j],                                                                .F.  }, ;
                       { "NoTabStop",          ::aNoTabStop[j],                                                               .F.  }, ;
                       { "NoVScroll",          ::aNoVScroll[j],                                                               .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "Sort",               ::aSort[j],                                                                    .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "TabsWidth",          ::aTabsWidth[j],                                                               1000 }, ;
                       { "TextHeight",         ::aTextHeight[j],                                                              1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "Value",              ::aValue[j],                                                                   1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aBreak[j]            := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aColWidth[j]         := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aDragItems[j]        := aResults[ ++k ]
      ::aFit[j]              := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aImage[j]            := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aItems[j]            := aResults[ ++k ]
      ::aMultiCol[j]         := aResults[ ++k ]
      ::aMultiSelect[j]      := aResults[ ++k ]
      ::aMultiTab[j]         := aResults[ ++k ]
      ::aNoTabStop[j]        := aResults[ ++k ]
      ::aNoVScroll[j]        := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aSort[j]             := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aTabsWidth[j]        := aResults[ ++k ]
      ::aTextHeight[j]       := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aValue[j]            := aResults[ ++k ]
      EXIT

   CASE TYPE_MONTHCALENDAR
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  .F.  }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "MultiSelect",        ::aMultiSelect[j],                                                             .F.  }, ;
                       { "NoTabStop",          ::aNoTabStop[j],                                                               1000 }, ;
                       { "NoToday",            ::aNoTodayCircle[j],                                                           .F.  }, ;
                       { "NoTodayCircle",      ::aNoToday[j],                                                                 .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "RTL",                ::aRTL[j],                                                                     1000 }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 .F.  }, ;
                       { "Value",              ::aValue[j],                                                                   1000 }, ;
                       { "WeekNumbers",        ::aWeekNumbers[j],                                                             .F.  } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aMultiSelect[j]      := aResults[ ++k ]
      ::aNoTabStop[j]        := aResults[ ++k ]
      ::aNoTodayCircle[j]    := aResults[ ++k ]
      ::aNoToday[j]          := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aValue[j]            := aResults[ ++k ]
      ::aWeekNumbers[j]      := aResults[ ++k ]
      EXIT

   CASE TYPE_PICBUTT
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Buffer",             ::aBuffer[j],                                                                  1000 }, ;
                       { "Cancel",             ::aCancel[j],                                                                  .F.  }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "Default",            ::aDefault[j],                                                                 .F.  }, ;
                       { "DIBSection",         ::aDIBSection[j],                                                              .F.  }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "DrawBy",             AScan( { "OOHGDRAW", "WINDRAW" }, ::aDrawBy[j] ) + 1,                          { "NIL", "OOHGDRAW", "WINDRAW" } }, ;
                       { "FitImg",             ::aFitImg[j],                                                                  .F.  }, ;
                       { "Flat",               ::aFlat[j],                                                                    .F.  }, ;
                       { "ForceScale",         ::aForceScale[j],                                                              .F.  }, ;
                       { "HandCursor",         ::aHandCursor[j],                                                              .F.  }, ;
                       { "HBitmap",            ::aHBitmap[j],                                                                 1000 }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "ImageAlign",         AScan( { "BOTTOM", "CENTER", "LEFT", "RIGHT", "TOP" }, ::aImageAlign[j] ) + 1, { "NIL", "BOTTOM",  "CENTER",  "LEFT",  "RIGHT",  "TOP" } }, ;
                       { "ImageMargin",        ::aImageMargin[j],                                                             1000 }, ;
                       { "ImageSize",          ::aImageSize[j],                                                               .F.  }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "No3DColors",         ::aNo3DColors[j],                                                              .F.  }, ;
                       { "NoDestroy",          ::aNoDestroy[j],                                                               .F.  }, ;
                       { "NoFocusRect",        ::aNoFocusRect[j],                                                             .F.  }, ;
                       { "NoHotLight",         ::aNoHotLight[j],                                                              .F.  }, ;
                       { "NoImageList",        ::aNoImgList[j],                                                               .F.  }, ;
                       { "NoLoadTransparent",  ::aNoLoadTrans[j],                                                             .F.  }, ;
                       { "NoTabStop",          ::aNoTabStop[j],                                                               .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "Picture",            ::aPicture[j],                                                                 1000 }, ;
                       { "Solid",              ::aSolid[j],                                                                   .F.  }, ;
                       { "Stretch",            ::aStretch[j],                                                                 .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "Transparent",        ::aTransparent[j],                                                             .F.  } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aBuffer[j]           := aResults[ ++k ]
      ::aCancel[j]           := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aDefault[j]          := aResults[ ++k ]
      ::aDIBSection[j]       := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aDrawBy[j]           := { "NIL", "OOHGDRAW", "WINDRAW" } [ aResults[ ++k ] ]
      ::aFitImg[j]           := aResults[ ++k ]
      ::aFlat[j]             := aResults[ ++k ]
      ::aForceScale[j]       := aResults[ ++k ]
      ::aHandCursor[j]       := aResults[ ++k ]
      ::aHBitmap[j]          := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aImageAlign[j]       := { "NIL", "BOTTOM", "CENTER", "LEFT", "RIGHT", "TOP" } [ aResults[ ++k ] ]
      ::aImageMargin[j]      := aResults[ ++k ]
      ::aImageSize[j]        := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aNo3DColors[j]       := aResults[ ++k ]
      ::aNoDestroy[j]        := aResults[ ++k ]
      ::aNoFocusRect[j]      := aResults[ ++k ]
      ::aNoHotLight[j]       := aResults[ ++k ]
      ::aNoImgList[j]        := aResults[ ++k ]
      ::aNoLoadTrans[j]      := aResults[ ++k ]
      ::aNoTabStop[j]        := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aPicture[j]          := aResults[ ++k ]
      ::aSolid[j]            := aResults[ ++k ]
      ::aStretch[j]          := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aTransparent[j]      := aResults[ ++k ]
      EXIT

   CASE TYPE_PICCHECKBUTT
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Buffer",             ::aBuffer[j],                                                                  1000 }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "DIBSection",         ::aDIBSection[j],                                                              .F.  }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "DrawBy",             AScan( { "OOHGDRAW", "WINDRAW" }, ::aDrawBy[j] ) + 1,                          { "NIL", "OOHGDRAW", "WINDRAW" } }, ;
                       { "Field",              ::aField[j],                                                                   1000 }, ;
                       { "FitImg",             ::aFitImg[j],                                                                  .F.  }, ;
                       { "Flat",               ::aFlat[j],                                                                    .F.  }, ;
                       { "ForceScale",         ::aForceScale[j],                                                              .F.  }, ;
                       { "HandCursor",         ::aHandCursor[j],                                                              .F.  }, ;
                       { "HBitmap",            ::aHBitmap[j],                                                                 1000 }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "ImageAlign",         AScan( { "BOTTOM", "CENTER", "LEFT", "RIGHT", "TOP" }, ::aImageAlign[j] ) + 1, { "NIL", "BOTTOM",  "CENTER",  "LEFT",  "RIGHT",  "TOP" } }, ;
                       { "ImageMargin",        ::aImageMargin[j],                                                             1000 }, ;
                       { "ImageSize",          ::aImageSize[j],                                                               .F.  }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "No3DColors",         ::aNo3DColors[j],                                                              .F.  }, ;
                       { "NoDestroy",          ::aNoDestroy[j],                                                               .F.  }, ;
                       { "NoFocusRect",        ::aNoFocusRect[j],                                                             .F. }, ;
                       { "NoHotLight",         ::aNoHotLight[j],                                                              .F.  }, ;
                       { "NoImageList",        ::aNoImgList[j],                                                               .F.  }, ;
                       { "NoLoadTransparent",  ::aNoLoadTrans[j],                                                             .F.  }, ;
                       { "NoTabStop",          ::aNoTabStop[j],                                                               .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "Picture",            ::aPicture[j],                                                                 1000 }, ;
                       { "Solid",              ::aSolid[j],                                                                   .F.  }, ;
                       { "Stretch",            ::aStretch[j],                                                                 .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "Transparent",        ::aTransparent[j],                                                             .F.  }, ;
                       { "Value",              ::aValue[j],                                                                   1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aBuffer[j]           := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aDIBSection[j]       := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aDrawBy[j]           := { "NIL", "OOHGDRAW", "WINDRAW" } [ aResults[ ++k ] ]
      ::aField[j]            := aResults[ ++k ]
      ::aFitImg[j]           := aResults[ ++k ]
      ::aFlat[j]             := aResults[ ++k ]
      ::aForceScale[j]       := aResults[ ++k ]
      ::aHandCursor[j]       := aResults[ ++k ]
      ::aHBitmap[j]          := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aImageAlign[j]       := { "NIL", "BOTTOM", "CENTER", "LEFT", "RIGHT", "TOP" } [ aResults[ ++k ] ]
      ::aImageMargin[j]      := aResults[ ++k ]
      ::aImageSize[j]        := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aNo3DColors[j]       := aResults[ ++k ]
      ::aNoDestroy[j]        := aResults[ ++k ]
      ::aNoFocusRect[j]      := aResults[ ++k ]
      ::aNoHotLight[j]       := aResults[ ++k ]
      ::aNoImgList[j]        := aResults[ ++k ]
      ::aNoLoadTrans[j]      := aResults[ ++k ]
      ::aNoTabStop[j]        := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aPicture[j]          := aResults[ ++k ]
      ::aSolid[j]            := aResults[ ++k ]
      ::aStretch[j]          := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aTransparent[j]      := aResults[ ++k ]
      ::aValue[j]            := aResults[ ++k ]
      EXIT

   CASE TYPE_PICTURE
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Border",             ::aBorder[j],                                                                  .F.  }, ;
                       { "Buffer",             ::aBuffer[j],                                                                  1000 }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "ClientEdge",         ::aClientEdge[j],                                                              .F.  }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "ExcludeArea",        ::aExclude[j],                                                                 1000 }, ;
                       { "ForceScale",         ::aForceScale[j],                                                              .F.  }, ;
                       { "HBitmap",            ::aHBitmap[j],                                                                 1000 }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "ImageSize",          ::aImageSize[j],                                                               .F.  }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "No3DColors",         ::aNo3DColors[j],                                                              .F.  }, ;
                       { "NoDIBSection",       ::aDIBSection[j],                                                              .F.  }, ;
                       { "NoLoadTransparent",  ::aNoLoadTrans[j],                                                             .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "Picture",            ::aPicture[j],                                                                 1000 }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "Stretch",            ::aStretch[j],                                                                 .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "Transparent",        ::aTransparent[j],                                                             .F.  } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aBorder[j]           := aResults[ ++k ]
      ::aBuffer[j]           := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aClientEdge[j]       := aResults[ ++k ]
      ::aDIBSection[j]       := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aExclude[j]          := aResults[ ++k ]
      ::aForceScale[j]       := aResults[ ++k ]
      ::aHBitmap[j]          := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aImageSize[j]        := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aNo3DColors[j]       := aResults[ ++k ]
      ::aNoLoadTrans[j]      := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aPicture[j]          := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aStretch[j]          := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aTransparent[j]      := aResults[ ++k ]
      EXIT

   CASE TYPE_PLAYER
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "File",               ::aFile[j],                                                                    1000 }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "NoAutoSizeMovie",    ::aNoAutoSizeMov[j],                                                           .F.  }, ;
                       { "NoAutoSizeWindow",   ::aNoAutoSizeWin[j],                                                           .F.  }, ;
                       { "NoErrorDlg",         ::aNoErrorDlg[j],                                                              .F.  }, ;
                       { "NoMenu",             ::aNoMenu[j],                                                                  .F.  }, ;
                       { "NoOpen",             ::aNoOpen[j],                                                                  .F.  }, ;
                       { "NoPlayBar",          ::aNoPlayBar[j],                                                               .F.  }, ;
                       { "NoTabStop",          ::aNoTabStop[j],                                                               .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "ShowAll",            ::aShowAll[j],                                                                 .F.  }, ;
                       { "ShowMode",           ::aShowMode[j],                                                                .F.  }, ;
                       { "ShowName",           ::aShowName[j],                                                                .F.  }, ;
                       { "ShowPosition",       ::aShowPosition[j],                                                            .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aFile[j]             := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aNoAutoSizeMov[j]    := aResults[ ++k ]
      ::aNoAutoSizeWin[j]    := aResults[ ++k ]
      ::aNoErrorDlg[j]       := aResults[ ++k ]
      ::aNoMenu[j]           := aResults[ ++k ]
      ::aNoOpen[j]           := aResults[ ++k ]
      ::aNoPlayBar[j]        := aResults[ ++k ]
      ::aNoTabStop[j]        := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aShowAll[j]          := aResults[ ++k ]
      ::aShowMode[j]         := aResults[ ++k ]
      ::aShowName[j]         := aResults[ ++k ]
      ::aShowPosition[j]     := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      EXIT

   CASE TYPE_PROGRESSBAR
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "Marquee",            ::aMarquee[j],                                                                 1000 }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "Range",              ::aRange[j],                                                                   1000 }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "Smooth",             ::aSmooth[j],                                                                  .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "Value",              ::aValue[j],                                                                   1000 }, ;
                       { "Vertical",           ::aVertical[j],                                                                .F.  } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aMarquee[j]          := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aRange[j]            := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aSmooth[j]           := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aValue[j]            := aResults[ ++k ]
      ::aVertical[j]         := aResults[ ++k ]
      EXIT

   CASE TYPE_PROGRESSMETER
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "ClientEdge",         ::aHelpID[j],                                                                  1000 }, ;
                       { "Disabled",           ::aInvisible[j],                                                               .F.  }, ;
                       { "HelpID",             ::aRange[j],                                                                   1000 }, ;
                       { "Invisible",          ::aRTL[j],                                                                     .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "Range",              ::aSmooth[j],                                                                  .F.  }, ;
                       { "RTL",                ::aSubClass[j],                                                                1000 }, ;
                       { "SubClass",           ::aToolTip[j],                                                                 1000 }, ;
                       { "ToolTip",            ::aValue[j],                                                                   1000 }, ;
                       { "Value",              ::aVertical[j],                                                                .F.  } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aClientEdge[j]       := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aRange[j]            := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aValue[j]            := aResults[ ++k ]
      EXIT

   CASE TYPE_RADIOGROUP
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "AutoSize",           ::aAutoSize[j],                                                                .F.  }, ;
                       { "Background",         ::aBackground[j],                                                              1000 }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "DrawBy",             AScan( { "OOHGDRAW", "WINDRAW" }, ::aDrawBy[j] ) + 1,                          { "NIL", "OOHGDRAW", "WINDRAW" } }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "Height",             ::aHeight[j],                                                                  1000 }, ;
                       { "Horizontal",         ::aHorizontal[j],                                                              .F.  }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "LeftJustify",        ::aLeftJust[j],                                                                .F.  }, ;
                       { "Limit",              ::aLimit[j],                                                                   1000 }, ;
                       { "NoFocusRect",        ::aNoFocusRect[j],                                                             .F.  }, ;
                       { "NoTabStop",          ::aNoTabStop[j],                                                               .F.  }, ;
                       { "Options",            ::aOptions[j],                                                                 1000 }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "ReadOnly",           ::aReadOnlyArray[j],                                                           1000 }, ;
                       { "RTL",                ::aRTL[j],                                                                     1000 }, ;
                       { "Shift",              ::aShift[j],                                                                   1000 }, ;
                       { "Spacing",            ::aSpacing[j],                                                                 1000 }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "Transparent",        ::aTransparent[j],                                                             .F.  }, ;
                       { "Value",              ::aValue[j],                                                                   1000 }, ;
                       { "Width",              ::aWidth[j],                                                                   1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aAutoSize[j]         := aResults[ ++k ]
      ::aBackground[j]       := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aDrawBy[j]           := { "NIL", "OOHGDRAW", "WINDRAW" } [ aResults[ ++k ] ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aHeight[j]           := aResults[ ++k ]
      ::aHorizontal[j]       := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aLeftJust[j]         := aResults[ ++k ]
      ::aLimit[j]            := aResults[ ++k ]
      ::aNoFocusRect[j]      := aResults[ ++k ]
      ::aNoTabStop[j]        := aResults[ ++k ]
      ::aOptions[j]          := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aReadOnlyArray[j]    := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aShift[j]            := aResults[ ++k ]
      ::aSpacing[j]          := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aTransparent[j]      := aResults[ ++k ]
      ::aValue[j]            := aResults[ ++k ]
      ::aWidth[j]            := aResults[ ++k ]
      EXIT

   CASE TYPE_RICHEDITBOX
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Break",              ::aBreak[j],                                                                   .F.  }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "Field",              ::aField[j],                                                                   1000 }, ;
                       { "File",               ::aFile[j],                                                                    1000 }, ;
                       { "FileType",           ::aFileType[j],                                                                1000 }, ;
                       { "FocusedPos",         ::aFocusedPos[j],                                                              1000 }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "InsertType",         ::aInsertType[j],                                                              1000 }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "MaxLength",          ::aMaxLength[j],                                                               1000 }, ;
                       { "NoHideSel",          ::aNoHideSel[j],                                                               .F.  }, ;
                       { "NoHScroll",          ::aNoHScroll[j],                                                               .F.  }, ;
                       { "NoTabStop",          ::aNoTabStop[j],                                                               .F.  }, ;
                       { "NoVScroll",          ::aNoVScroll[j],                                                               .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "PlainText",          ::aPlainText[j],                                                               .F.  }, ;
                       { "ReadOnly",           ::aReadOnly[j],                                                                .F.  }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "Value",              ::aValue[j],                                                                   1000 }, ;
                       { "Version",            ::aVersion[j],                                                                 1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aBreak[j]            := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aField[j]            := aResults[ ++k ]
      ::aFile[j]             := aResults[ ++k ]
      ::aFileType[j]         := aResults[ ++k ]
      ::aFocusedPos[j]       := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aInsertType[j]       := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aMaxLength[j]        := aResults[ ++k ]
      ::aNoHideSel[j]        := aResults[ ++k ]
      ::aNoHScroll[j]        := aResults[ ++k ]
      ::aNoTabStop[j]        := aResults[ ++k ]
      ::aNoVScroll[j]        := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aPlainText[j]        := aResults[ ++k ]
      ::aReadOnly[j]         := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aValue[j]            := aResults[ ++k ]
      ::aVersion[j]          := aResults[ ++k ]
      EXIT

   CASE TYPE_SCROLLBAR
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Attached",           ::aAttached[j],                                                                .F.  }, ;
                       { "AutoMove",           ::aAutoMove[j],                                                                .F.  }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "Horizontal",         ::aHorizontal[j],                                                              .F.  }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "LineSkip",           ::aLineSkip[j],                                                                1000 }, ;
                       { "PageSkip",           ::aPageSkip[j],                                                                1000 }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "Range",              ::aRange[j],                                                                   1000 }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "Value",              ::aValue[j],                                                                   1000 }, ;
                       { "Vertical",           ::aVertical[j],                                                                .F.  } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aAttached[j]         := aResults[ ++k ]
      ::aAutoMove[j]         := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aHorizontal[j]       := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aLineSkip[j]         := aResults[ ++k ]
      ::aPageSkip[j]         := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aRange[j]            := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aValue[j]            := aResults[ ++k ]
      ::aVertical[j]         := aResults[ ++k ]
      EXIT

   CASE TYPE_SLIDER
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Both",               ::aBoth[j],                                                                    .F.  }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "Left",               ::aLeft[j],                                                                    .F.  }, ;
                       { "NoTabStop",          ::aNoTabStop[j],                                                               .F.  }, ;
                       { "NoTicks",            ::aNoTicks[j],                                                                 .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "Range",              ::aRange[j],                                                                   1000 }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "Top",                ::aTop[j],                                                                     .F.  }, ;
                       { "Value ",             ::aValue[j],                                                                   1000 }, ;
                       { "Vertical",           ::aVertical[j],                                                                .F.  } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aBoth[j]             := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aLeft[j]             := aResults[ ++k ]
      ::aNoTabStop[j]        := aResults[ ++k ]
      ::aNoTicks[j]          := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aRange[j]            := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aTop[j]              := aResults[ ++k ]
      ::aValue[j]            := aResults[ ++k ]
      ::aVertical[j]         := aResults[ ++k ]
      EXIT

   CASE TYPE_SPINNER
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "BoundText",          ::aBoundText[j],                                                               .F.  }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "CueBanner",          ::aCue[j],                                                                     1000 }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "Increment",          ::aIncrement[j],                                                               1000 }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "NoBorder",           ::aNoBorder[j],,                                                               .F.  }, ;
                       { "NoTabStop",          ::aNoTabStop[j],                                                               .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "Range",              ::aRange[j],                                                                   1000 }, ;
                       { "ReadOnly",           ::aReadOnly[j],                                                                .F.  }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "Value ",             ::aValue[j],                                                                   1000 }, ;
                       { "Wrap",               ::aWrap[j],                                                                    .F.  } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aBoundText[j]        := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aCue[j]              := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aIncrement[j]        := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aNoBorder[j]         := aResults[ ++k ]
      ::aNoTabStop[j]        := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aRange[j]            := aResults[ ++k ]
      ::aReadOnly[j]         := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aValue[j]            := aResults[ ++k ]
      ::aWrap[j]             := aResults[ ++k ]
      EXIT

   CASE TYPE_TAB
      cName := _OOHG_GetNullName( "0" )
      SET INTERACTIVECLOSE ON
      LOAD WINDOW tabprop AS ( cName )
    // #define EDITBOX_HEIGHT Int( 40 * ::myIde:nDPIh )
      CENTER WINDOW ( cName )
      ACTIVATE WINDOW ( cName )
      SET INTERACTIVECLOSE OFF
      EXIT

   CASE TYPE_TEXTARRAY
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Border",             ::aBorder[j],                                                                  .F.  }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "ClientEdge",         ::aClientEdge[j],                                                              .F.  }, ;
                       { "ColCount",           ::aColCount[j],                                                                1000 }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "NoTabStop",          ::aNoTabStop[j],                                                               .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "RowCount",           ::aRowCount[j],                                                                 1000 }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "Value",              ::aValue[j],                                                                   1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aBorder[j]           := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aClientEdge[j]       := aResults[ ++k ]
      ::aColCount[j]         := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aNoTabStop[j]        := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aRowCount[j]         := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aValue[j]            := aResults[ ++k ]
      EXIT

   CASE TYPE_TEXTBOX
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "AutoSkip",           ::aAutoSkip[j],                                                                .F.  }, ;
                       { "ButtonWidth",        ::aButtonWidth[j],                                                             1000 }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "CenterAlign",        ::aCenterAlign[j],                                                             .F.  }, ;
                       { "CtrlsAtLeft",        ::aCtrlsLeft[j],                                                               .F.  }, ;
                       { "CueBanner",          ::aCue[j],                                                                     1000 }, ;
                       { "Date",               ::aDate[j],                                                                    .F.  }, ;
                       { "DefaultYear",        ::aDefaultYear[j],                                                             1000 }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "Field",              ::aField[j],                                                                   1000 }, ;
                       { "FocusedPos",         ::aFocusedPos[j],                                                              1000 }, ;
                       { "Format",             ::aFormat[j],                                                                  1000 }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "Image",              ::aImage[j],                                                                   1000 }, ;
                       { "InputMask",          ::aInputMask[j],                                                               1000 }, ;
                       { "InsertType",         ::aInsertType[j],                                                              1000 }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "LowerCase",          ::aLowerCase[j],                                                               .F.  }, ;
                       { "MaxLength",          ::aMaxLength[j],                                                               1000 }, ;
                       { "NoBorder",           ::aNoBorder[j],                                                                .F.  }, ;
                       { "NoContextMenu",      ::aNoContext[j],                                                               .F.  }, ;
                       { "NoTabStop",          ::aNoTabStop[j],                                                               .F.  }, ;
                       { "Numeric",            ::aNumeric[j],                                                                 .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "Password",           ::aPassword[j],                                                                .F.  }, ;
                       { "ReadOnly",           ::aReadOnly[j],                                                                .F.  }, ;
                       { "RightAlign",         ::aRightAlign[j],                                                              .F.  }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "UpperCase",          ::aUpperCase[j],                                                               .F.  }, ;
                       { "Valid",              ::aValid[j],                                                                   1000 }, ;
                       { "Value",              ::aValue[j],                                                                   1000 }, ;
                       { "When",               ::aWhen[j],                                                                    1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aAutoSkip[j]         := aResults[ ++k ]
      ::aButtonWidth[j]      := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aCenterAlign[j]      := aResults[ ++k ]
      ::aCtrlsLeft[j]        := aResults[ ++k ]
      ::aCue[j]              := aResults[ ++k ]
      ::aDate[j]             := aResults[ ++k ]
      ::aDefaultYear[j]      := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aField[j]            := aResults[ ++k ]
      ::aFocusedPos[j]       := aResults[ ++k ]
      ::aFormat[j]           := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aImage[j]            := aResults[ ++k ]
      ::aInputMask[j]        := aResults[ ++k ]
      ::aInsertType[j]       := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aLowerCase[j]        := aResults[ ++k ]
      ::aMaxLength[j]        := aResults[ ++k ]
      ::aNoBorder[j]         := aResults[ ++k ]
      ::aNoContext[j]        := aResults[ ++k ]
      ::aNoTabStop[j]        := aResults[ ++k ]
      ::aNumeric[j]          := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aPassword[j]         := aResults[ ++k ]
      ::aReadOnly[j]         := aResults[ ++k ]
      ::aRightAlign[j]       := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aUpperCase[j]        := aResults[ ++k ]
      ::aValid[j]            := aResults[ ++k ]
      ::aValue[j]            := aResults[ ++k ]
      ::aWhen[j]             := aResults[ ++k ]

      IF ! IsFormatValid( ::StrToValueCtrl( ::aFormat[j], "C", NIL ) )
         MsgInfo( i18n( "Format is not valid !!!" ) + CRLF + i18n( "Beware that OOHG will abort with a RTE !!!" ), "OOHG IDE+" )
      ENDIF
      EXIT

   CASE TYPE_TIMEPICKER
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "Disabled",           ::aDisabled[j],                                                                1000 }, ;
                       { "Field",              ::aField[j],                                                                   .F.  }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "Invisible",          ::aInvisible[j],                                                               1000 }, ;
                       { "NoBorder",           ::aNoBorder[j],                                                                .F.  }, ;
                       { "NoTabStop",          ::aNoTabStop[j],                                                               .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "ShowNone",           ::aShowNone[j],                                                                .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                .F.  }, ;
                       { "TimeFormat",         ::aFormat[j],                                                                  1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "Valid",              ::aValid[j],                                                                   1000 }, ;
                       { "Value",              ::aValue[j],                                                                   1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aField[j]            := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aNoBorder[j]         := aResults[ ++k ]
      ::aNoTabStop[j]        := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aShowNone[j]         := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aFormat[j]           := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aValid[j]            := aResults[ ++k ]
      ::aValue[j]            := aResults[ ++k ]
      EXIT

   CASE TYPE_TIMER
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "Interval",           ::aValue[j],                                                                   1000 }, ;
                       { "Once",               ::aOnce[j],                                                                    .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aValue[j]            := aResults[ ++k ]
      ::aOnce[j]             := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      EXIT

   CASE TYPE_TREE
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Break",              ::aBreak[j],                                                                   .F.  }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "CheckBoxes",         ::aCheckBoxes[j],                                                              .F.  }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "EditLabels",         ::aEditLabels[j],                                                              .F.  }, ;
                       { "EnableDrag",         ::aDrag[j],                                                                    .F.  }, ;
                       { "EnableDrop",         ::aDrop[j],                                                                    .F.  }, ;
                       { "FullRowSelect",      ::aFullRowSelect[j],                                                           .F.  }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "HotTracking",        ::aHotTrack[j],                                                                .F.  }, ;
                       { "Indent",             ::aIndent[j],                                                                  1000 }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "ItemIDs",            ::aItemIDs[j],                                                                 .F.  }, ;
                       { "ItemImages",         ::aItemImages[j],                                                              1000 }, ;
                       { "NoBorder",           ::aNoBorder[j],                                                                .F.  }, ;
                       { "NoButtons",          ::aNoButtons[j],                                                               .F.  }, ;
                       { "NodeImages",         ::aNodeImages[j],                                                              1000 }, ;
                       { "NoHScroll",          ::aNoHScroll[j],                                                               .F.  }, ;
                       { "NoLines",            ::aNoLines[j],                                                                 .F.  }, ;
                       { "NoRootButton",       ::aNoRootButton[j],                                                            .F.  }, ;
                       { "NoScroll",           ::aNoVScroll[j],                                                               .F.  }, ;
                       { "NoTabStop",          ::aNoTabStop[j],                                                               .F.  }, ;
                       { "OwnToolTip",         ::aOwnTT[j],                                                                   .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "RedrawOnAdd",        ::aRedrawOnAdd[j],                                                             .F.  }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "SelBold",            ::aSelBold[j],                                                                 .F.  }, ;
                       { "SelColor",           ::aSelColor[j],                                                                1000 }, ;
                       { "SingleExpand",       ::aSingleExpand[j],                                                            .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "Target",             ::aTarget[j],                                                                  1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "Valid",              ::aValid[j],                                                                   1000 }, ;
                       { "Value",              ::aValue[j],                                                                   1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aBreak[j]            := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aCheckBoxes[j]       := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aEditLabels[j]       := aResults[ ++k ]
      ::aDrag[j]             := aResults[ ++k ]
      ::aDrop[j]             := aResults[ ++k ]
      ::aFullRowSelect[j]    := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aHotTrack[j]         := aResults[ ++k ]
      ::aIndent[j]           := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aItemIDs[j]          := aResults[ ++k ]
      ::aItemImages[j]       := aResults[ ++k ]
      ::aNoBorder[j]         := aResults[ ++k ]
      ::aNoButtons[j]        := aResults[ ++k ]
      ::aNodeImages[j]       := aResults[ ++k ]
      ::aNoHScroll[j]        := aResults[ ++k ]
      ::aNoLines[j]          := aResults[ ++k ]
      ::aNoRootButton[j]     := aResults[ ++k ]
      ::aNoVScroll[j]        := aResults[ ++k ]
      ::aNoTabStop[j]        := aResults[ ++k ]
      ::aOwnTT[j]            := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aRedrawOnAdd[j]      := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aSelBold[j]          := aResults[ ++k ]
      ::aSelColor[j]         := aResults[ ++k ]
      ::aSingleExpand[j]     := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aTarget[j]           := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aValid[j]            := aResults[ ++k ]
      ::aValue[j]            := aResults[ ++k ]
      EXIT

   CASE TYPE_XBROWSE
      aData       := { { "Name",               ::aName[j],                                                                    1000 }, ;
                       { "Obj",                ::aCObj[j],                                                                    1000 }, ;
                       { "Append",             ::aAppend[j],                                                                  .F.  }, ;
                       { "Break",              ::aBreak[j],                                                                   .F.  }, ;
                       { "Cargo",              ::aCargo[j],                                                                   1000 }, ;
                       { "CellToolTip",        ::aCellToolTip[j],                                                             .F.  }, ;
                       { "CheckBoxes",         ::aCheckBoxes[j],                                                              .F.  }, ;
                       { "ColumnControls",     ::aColumnCtrls[j],                                                             1000 }, ;
                       { "ColumnInfo",         ::aColumnInfo[j],                                                              1000 }, ;
                       { "DefaultValues",      ::aDefaultValues[j],                                                           1000 }, ;
                       { "Delete",             ::aDelete[j],                                                                  .F.  }, ;
                       { "DeleteMsg",          ::aDeleteMsg[j],                                                               1000 }, ;
                       { "DeleteWhen",         ::aDeleteWhen[j],                                                              1000 }, ;
                       { "Descending",         ::aDescend[j],                                                                 .F.  }, ;
                       { "DisableAltA",        ::aDisableAltA[j],                                                             .F.  }, ;
                       { "Disabled",           ::aDisabled[j],                                                                .F.  }, ;
                       { "DynamicBackColor",   ::aDynBackColor[j],                                                            1000 }, ;
                       { "DynamicForeColor",   ::aDynForeColor[j],                                                            1000 }, ;
                       { "Edit",               ::aEdit[j],                                                                    .F.  }, ;
                       { "EditCellValue",      ::aEditCellValue[j],                                                           1000 }, ;
                       { "EditFirstVisible",   ::aEditFirstVis[j],                                                            .F.  }, ;
                       { "EditKeys",           ::aEditKeys[j],                                                                1000 }, ;
                       { "EditKeysFun",        ::aEditKeysFun[j],                                                             1000 }, ;
                       { "EditLikeExcel",      ::aEditLikeExcel[j],                                                           .F.  }, ;
                       { "ExtDblClick",        ::aExtDblClick[j],                                                             .F.  }, ;
                       { "Fields",             ::aFields[j],                                                                  1000 }, ;
                       { "FixedBlocks",        AScan( { ".T.", ".F." }, ::aFixBlocks[j] ) + 1,                                { "NIL", ".T.", ".F." } }, ;
                       { "FixedCols",          ::aFixedCols[j],                                                               .F.  }, ;
                       { "FixedControls",      AScan( { ".T.", ".F." }, ::aFixedCtrls[j] ) + 1,                               { "NIL", ".T.", ".F." } }, ;
                       { "FixedWidths",        ::aFixedWidths[j],                                                             .F.  }, ;
                       { "FocusRect",          AScan( { ".T.", ".F." }, ::aFocusRect[j] ) + 1,                                { "NIL", ".T.", ".F." } }, ;
                       { "FullMove",           ::aFullMove[j],                                                                .F.  }, ;
                       { "HeaderBackColors",   ::aHdrBackClrs[j],                                                             1000 }, ;
                       { "HeaderColors",       ::aHdrFontClrs[j],                                                             1000 }, ;
                       { "HeaderImages",       ::aHdrImages[j],                                                               1000 }, ;
                       { "HeaderImagesAlign",  ::aHdrImgAlign[j],                                                             1000 }, ;
                       { "Headers",            ::aHeaders[j],                                                                 1000 }, ;
                       { "HelpID",             ::aHelpID[j],                                                                  1000 }, ;
                       { "Image",              ::aImage[j],                                                                   1000 }, ;
                       { "InPlace",            ::aInPlace[j],                                                                 .F.  }, ;
                       { "InputMask",          ::aInputMask[j],                                                               1000 }, ;
                       { "Invisible",          ::aInvisible[j],                                                               .F.  }, ;
                       { "Justify",            ::aJustify[j],                                                                 1000 }, ;
                       { "KeysLikeClipper",    ::aKeysLkClp[j],                                                               .F.  }, ;
                       { "Lock",               ::aLock[j],                                                                    .F.  }, ;
                       { "NavigateBycell",     ::aNavByCell[j],                                                               .F.  }, ;
                       { "NoDefaultMsg",       ::aNoDefMsg[j],                                                                .F.  }, ;
                       { "NoDeleteMsg",        ::aNoDelMsg[j],                                                                .F.  }, ;
                       { "NoHeaders",          ::aNoHeaders[j],                                                               .F.  }, ;
                       { "NoHScroll",          ::aNoHScroll[j],                                                               .F.  }, ;
                       { "NoLines",            ::aNoLines[j],                                                                 .F.  }, ;
                       { "NoModalEdit",        ::aNoModalEdit[j],                                                             .F.  }, ;
                       { "NoShowAlways",       ::aNoShowAlways[j],                                                            .F.  }, ;
                       { "NoShowEmptyRow",     ::aShowNone[j],                                                                .F.  }, ;
                       { "NoTabStop",          ::aNoTabStop[j],                                                               .F.  }, ;
                       { "NoVScroll",          ::aNoVScroll[j],                                                               .F.  }, ;
                       { "PaintLeftMargin",    ::aPLM[j],                                                                     .F.  }, ;
                       { "Parent",             ::aParent[j],                                                                  1000 }, ;
                       { "ReadOnly",           ::aReadOnlyArray[j],                                                           1000 }, ;
                       { "RecCount",           ::aRecCount[j],                                                                .F.  }, ;
                       { "ReplaceField",       ::aReplaceField[j],                                                            1000 }, ;
                       { "RTL",                ::aRTL[j],                                                                     .F.  }, ;
                       { "SelectedColors",     ::aSelColor[j],                                                                1000 }, ;
                       { "Silent",             ::aSilent[j],                                                                  .F.  }, ;
                       { "SingleBuffer",       ::aSingleBuffer[j],                                                            .F.  }, ;
                       { "SubClass",           ::aSubClass[j],                                                                1000 }, ;
                       { "TimeOut",            ::aTimeOut[j],                                                                 1000 }, ;
                       { "ToolTip",            ::aToolTip[j],                                                                 1000 }, ;
                       { "UpdateColors",       ::aUpdateColors[j],                                                            .F.  }, ;
                       { "UseButtons",         ::aUseButtons[j],                                                              .F.  }, ;
                       { "Valid",              ::aValid[j],                                                                   1000 }, ;
                       { "ValidMessages",      ::aValidMess[j],                                                               1000 }, ;
                       { "Value ",             ::aValue[j],                                                                   1000 }, ;
                       { "When",               ::aWhen[j],                                                                    1000 }, ;
                       { "Widths",             ::aWidths[j],                                                                  1000 }, ;
                       { "WorkArea",           ::aWorkArea[j],                                                                1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      ::aName[j]             := iif( ! ::IsUnique( aResults[k], j ), ::aName[j], AllTrim( aResults[k] ) )
      ::aCObj[j]             := aResults[ ++k ]
      ::aAppend[j]           := aResults[ ++k ]
      ::aBreak[j]            := aResults[ ++k ]
      ::aCargo[j]            := aResults[ ++k ]
      ::aCellToolTip[j]      := aResults[ ++k ]
      ::aCheckBoxes[j]       := aResults[ ++k ]
      ::aColumnCtrls[j]      := aResults[ ++k ]
      ::aColumnInfo[j]       := aResults[ ++k ]
      ::aDefaultValues[j]    := aResults[ ++k ]
      ::aDelete[j]           := aResults[ ++k ]
      ::aDeleteMsg[j]        := aResults[ ++k ]
      ::aDeleteWhen[j]       := aResults[ ++k ]
      ::aDescend[j]          := aResults[ ++k ]
      ::aDisableAltA[j]      := aResults[ ++k ]
      ::aDisabled[j]         := aResults[ ++k ]
      ::aDynBackColor[j]     := aResults[ ++k ]
      ::aDynForeColor[j]     := aResults[ ++k ]
      ::aEdit[j]             := aResults[ ++k ]
      ::aEditCellValue[j]    := aResults[ ++k ]
      ::aEditFirstVis[j]     := aResults[ ++k ]
      ::aEditKeys[j]         := aResults[ ++k ]
      ::aEditKeysFun[j]      := aResults[ ++k ]
      ::aEditLikeExcel[j]    := aResults[ ++k ]
      ::aExtDblClick[j]      := aResults[ ++k ]
      ::aFields[j]           := aResults[ ++k ]
      ::aFixBlocks[j]        := { "NIL", ".T.", ".F." } [ aResults[ ++k ] ]
      ::aFixedCols[j]        := aResults[ ++k ]
      ::aFixedCtrls[j]       := { "NIL", ".T.", ".F." } [ aResults[ ++k ] ]
      ::aFixedWidths[j]      := aResults[ ++k ]
      ::aFocusRect[j]        := { "NIL", ".T.", ".F." } [ aResults[ ++k ] ]
      ::aFullMove[j]         := aResults[ ++k ]
      ::aHdrBackClrs[j]      := aResults[ ++k ]
      ::aHdrFontClrs[j]      := aResults[ ++k ]
      ::aHdrImages[j]        := aResults[ ++k ]
      ::aHdrImgAlign[j]      := aResults[ ++k ]
      ::aHeaders[j]          := aResults[ ++k ]
      ::aHelpID[j]           := aResults[ ++k ]
      ::aImage[j]            := aResults[ ++k ]
      ::aInPlace[j]          := aResults[ ++k ]
      ::aInputMask[j]        := aResults[ ++k ]
      ::aInvisible[j]        := aResults[ ++k ]
      ::aJustify[j]          := aResults[ ++k ]
      ::aKeysLkClp[j]        := aResults[ ++k ]
      ::aLock[j]             := aResults[ ++k ]
      ::aNavByCell[j]        := aResults[ ++k ]
      ::aNoDefMsg[j]         := aResults[ ++k ]
      ::aNoDelMsg[j]         := aResults[ ++k ]
      ::aNoHeaders[j]        := aResults[ ++k ]
      ::aNoHScroll[j]        := aResults[ ++k ]
      ::aNoLines[j]          := aResults[ ++k ]
      ::aNoModalEdit[j]      := aResults[ ++k ]
      ::aNoShowAlways[j]     := aResults[ ++k ]
      ::aShowNone[j]         := aResults[ ++k ]
      ::aNoTabStop[j]        := aResults[ ++k ]
      ::aNoVScroll[j]        := aResults[ ++k ]
      ::aPLM[j]              := aResults[ ++k ]
      ::aParent[j]           := aResults[ ++k ]
      ::aReadOnlyArray[j]    := aResults[ ++k ]
      ::aRecCount[j]         := aResults[ ++k ]
      ::aReplaceField[j]     := aResults[ ++k ]
      ::aRTL[j]              := aResults[ ++k ]
      ::aSelColor[j]         := aResults[ ++k ]
      ::aSilent[j]           := aResults[ ++k ]
      ::aSingleBuffer[j]     := aResults[ ++k ]
      ::aSubClass[j]         := aResults[ ++k ]
      ::aTimeOut[j]          := aResults[ ++k ]
      ::aToolTip[j]          := aResults[ ++k ]
      ::aUpdateColors[j]     := aResults[ ++k ]
      ::aUseButtons[j]       := aResults[ ++k ]
      ::aValid[j]            := aResults[ ++k ]
      ::aValidMess[j]        := aResults[ ++k ]
      ::aValue[j]            := aResults[ ++k ]
      ::aWhen[j]             := aResults[ ++k ]
      ::aWidths[j]           := aResults[ ++k ]
      ::aWorkArea[j]         := aResults[ ++k ]
      EXIT

   ENDSWITCH

   ::lIsFormModified := .T.
   oControl := ::RecreateControl( oControl, j )
   ::DrawOutline( oControl )
   oControl:SetFocus()

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD RecreateControl( oControl, j ) CLASS TFormEditor

   LOCAL nRow, nCol, nStyle, nWidth, nHeight, i, aCtrls, cTab, oTab, nInd

   nRow := oControl:Row
   nCol := oControl:Col
   nInd := oControl:TabIndex

   IF ::aCtrlType[j] == ::ControlType[ TYPE_PROGRESSBAR ]
      nStyle := WindowStyleFlag( oControl:hWnd,  PBS_VERTICAL )
      IF ( nStyle # PBS_VERTICAL .AND. ::aVertical[j] ) .OR. ( nStyle == PBS_VERTICAL .AND. ! ::aVertical[j] )
         nWidth  := oControl:Height
         nHeight := oControl:Width
      ELSE
         nWidth  := oControl:Width
         nHeight := oControl:Height
      ENDIF
   ELSEIF ::aCtrlType[j] == ::ControlType[ TYPE_SLIDER ]
      nStyle := WindowStyleFlag( oControl:hWnd,  TBS_VERT )
      IF ( nStyle == TBS_HORZ .AND. ::aVertical[j] ) .OR. ( nStyle == TBS_VERT .AND. ! ::aVertical[j] )
         nWidth  := oControl:Height
         nHeight := oControl:Width
      ELSE
         nWidth  := oControl:Width
         nHeight := oControl:Height
      ENDIF
   ELSEIF ::aCtrlType[j] == ::ControlType[ TYPE_TAB ]
      aCtrls := Array( oControl:ItemCount )
      FOR i := 1 TO Len( aCtrls )
         aCtrls[i] := aClone( oControl:aPages[i]:aControls )
         aEval( aCtrls[i], { |c| oControl:aPages[i]:DeleteControl( c ) } )
      NEXT i
      nWidth  := oControl:Width
      nHeight := oControl:Height
   ELSE
      nWidth  := oControl:Width
      nHeight := oControl:Height
   ENDIF

   oControl:Release()

   oControl          := ::CreateControl( AScan( ::ControlType, ::aCtrlType[j] ), j, nWidth, nHeight, aCtrls )
   oControl:Row      := nRow
   oControl:Col      := nCol
   oControl:TabIndex := nInd

   IF ! Empty( ::aTabPage[j, 1] ) .AND. ::aTabPage[j, 2] > 0
      IF ( i := AScan( ::aName, { |c| Lower( c ) == ::aTabPage[j, 1] } ) ) > 0
         cTab := ::aControlW[i]
         IF ( i := AScan( ::oDesignForm:aControls, { |c| Lower( c:Name ) == cTab } ) ) > 0
            oTab := ::oDesignForm:aControls[i]
            oTab:AddControl( oControl:Name, ::aTabPage[j, 2], oControl:Row, oControl:Col )
         ELSE
            ::aTabPage[j, 1] := ""
            ::aTabPage[j, 2] := 0
         ENDIF
      ELSE
         ::aTabPage[j, 1] := ""
         ::aTabPage[j, 2] := 0
      ENDIF
   ENDIF

   RETURN oControl

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD TabUpdate( j ) CLASS TFormEditor

   LOCAL aData, aLabels, aInitValues, aFormats, aResults, cTitle, k := 0

   aData       := { { "Name",        ::aName[j],        1000 }, ;
                    { "Obj",         ::aCObj[j],        1000 }, ;
                    { "Bottom",      ::aBottomAlign[j], .F.  }, ;
                    { "Buttons",     ::aButtons[j],     .F.  }, ;
                    { "Cargo",       ::aCargo[j],       1000 }, ;
                    { "DelayMsgs",   ::aDelayedLoad[j], .F.  }, ;
                    { "Disabled",    ::aDisabled[j],    .F.  }, ;
                    { "FixedWidth",  ::aFixedWidths[j], .F.  }, ;
                    { "Flat",        ::aFlat[j],        .F.  }, ;
                    { "HotTrack",    ::aHotTrack[j],    .F.  }, ;
                    { "IconLeft",    ::aIconLeft[j],    .F.  }, ;
                    { "Internals",   ::aInternals[j],   .F.  }, ;
                    { "Invisible",   ::aInvisible[j],   .F.  }, ;
                    { "ItemSize",    ::aItemSize[j],    1000 }, ;
                    { "LabelLeft",   ::aLabelLeft[j],   .F.  }, ;
                    { "MinWidth",    ::aMinWidth[j],    1000 }, ;
                    { "Multiline",   ::aMultiLine[j],   .F.  }, ;
                    { "NoTabStop",   ::aNoTabStop[j],   .F.  }, ;
                    { "Padding",     ::aPadding[j],     1000 }, ;
                    { "Parent",      ::aParent[j],      1000 }, ;
                    { "RaggedRight", ::aRaggedRight[j], .F.  }, ;
                    { "Right",       ::aRightAlign[j],  .F.  }, ;
                    { "RightJust",   ::aRightJust[j],   .F.  }, ;
                    { "RTL",         ::aRTL[j],         .F.  }, ;
                    { "ScrollOp",    ::aScrollOp[j],    .F.  }, ;
                    { "SubClass",    ::aSubClass[j],    1000 }, ;
                    { "ToolTip",     ::aToolTip[j],     1000 }, ;
                    { "Value",       ::aValue[j],       1000 }, ;
                    { "Vertical",    ::aVertical[j],    .F.  } }
   cTitle      := DQM( ::cFName + ".fmg" ) + i18n( " - Properties of Control " ) + ::aName[j]
   aLabels     := Array( Len( aData ) )
   aInitValues := Array( Len( aData ) )
   aFormats    := Array( Len( aData ) )
   AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
   /* get data */
   aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
   IF aResults[1] == NIL
      RETURN NIL
   ENDIF

   ::aName[j]        := aResults[ ++k ]
   ::aCObj[j]        := aResults[ ++k ]
   ::aBottomAlign[j] := aResults[ ++k ]
   ::aButtons[j]     := aResults[ ++k ]
   ::aCargo[j]       := aResults[ ++k ]
   ::aDelayedLoad[j] := aResults[ ++k ]
   ::aDisabled[j]    := aResults[ ++k ]
   ::aFixedWidths[j] := aResults[ ++k ]
   ::aFlat[j]        := aResults[ ++k ]
   ::aHotTrack[j]    := aResults[ ++k ]
   ::aIconLeft[j]    := aResults[ ++k ]
   ::aInternals[j]   := aResults[ ++k ]
   ::aInvisible[j]   := aResults[ ++k ]
   ::aItemSize[j]    := aResults[ ++k ]
   ::aLabelLeft[j]   := aResults[ ++k ]
   ::aMinWidth[j]    := aResults[ ++k ]
   ::aMultiLine[j]   := aResults[ ++k ]
   ::aNoTabStop[j]   := aResults[ ++k ]
   ::aPadding[j]     := aResults[ ++k ]
   ::aParent[j]      := aResults[ ++k ]
   ::aRaggedRight[j] := aResults[ ++k ]
   ::aRightAlign[j]  := aResults[ ++k ]
   ::aRightJust[j]   := aResults[ ++k ]
   ::aRTL[j]         := aResults[ ++k ]
   ::aScrollOp[j]    := aResults[ ++k ]
   ::aSubClass[j]    := aResults[ ++k ]
   ::aToolTip[j]     := aResults[ ++k ]
   ::aValue[j]       := aResults[ ++k ]
   ::aVertical[j]    := aResults[ ++k ]

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD AddTabPage( i, oTab, oTabProp ) CLASS TFormEditor

   LOCAL nPages

   nPages := oTab:ItemCount

   AAdd( ::aCaption[i], StrToStr( "Page " + LTrim( Str( nPages + 1 ) ) ) )
   AAdd( ::aImage[i], "" )
   AAdd( ::aPageNames[i], "" )
   AAdd( ::aPageObjs[i], "" )
   AAdd( ::aPageSubClass[i], "" )
   AAdd( ::aPageToolTips[i], "" )
   AAdd( ::aPageCargos[i], "" )

   oTab:Addpage( nPages + 1, "Page " + LTrim( Str( nPages + 1 ) ) )

   oTabProp:lbl_PageCount:Value := ( 'Page count: ' + LTrim( Str( nPages + 1 ) ) )

   oTabProp:Spinner_1:RangeMax := nPages + 1
   oTabProp:Spinner_1:Value := nPages + 1

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD DeleteTabPage( i, oTab, oTabProp ) CLASS TFormEditor

   LOCAL nPages, cName, j

   nPages := oTab:ItemCount
   IF nPages <= 1
      RETURN NIL
   ENDIF

   ASize( ::aCaption[i], nPages - 1 )
   ASize( ::aImage[i], nPages - 1 )
   ASize( ::aPageNames[i], nPages - 1 )
   ASize( ::aPageObjs[i], nPages - 1 )
   ASize( ::aPageSubClass[i], nPages - 1 )
   ASize( ::aPageToolTips[i], nPages - 1 )
   ASize( ::aPageCargos[i], nPages - 1 )

   cName := ::aControlW[i]
   FOR j := ::nControlW TO 1 STEP -1
      IF ::aTabPage[j, 1] == cName .and. ::aTabPage[j, 2] == nPages
         ::DelCtrlAndChildsArrays( j )
       ENDIF
   NEXT j

   oTab:DeletePage( nPages )
   oTab:Visible := .F.
   oTab:Visible := .T.

   oTabProp:lbl_PageCount:Value := ( 'Page count: ' + LTrim( Str( nPages - 1 ) ) )

   oTabProp:Spinner_1:RangeMax := nPages - 1
   oTabProp:Spinner_1:Value := nPages - 1

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD LoadTabpageProperties( j, oTabProp ) CLASS TFormEditor

   oTabProp:Edit_1:Value := ::aCaption[j, oTabProp:Spinner_1:Value]
   oTabProp:Edit_2:Value := ::aImage[j, oTabProp:Spinner_1:Value]
   oTabProp:Edit_3:Value := ::aPageNames[j, oTabProp:Spinner_1:Value]
   oTabProp:Edit_4:Value := ::aPageObjs[j, oTabProp:Spinner_1:Value]
   oTabProp:Edit_5:Value := ::aPageSubClass[j, oTabProp:Spinner_1:Value]
   oTabProp:Edit_6:Value := ::aPageToolTips[j, oTabProp:Spinner_1:Value]
   oTabProp:Edit_7:Value := ::aPageCargos[j, oTabProp:Spinner_1:Value]

   RETURN NIL
 
/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD SaveTabpageProperties( j, oTabProp ) CLASS TFormEditor

   ::aCaption[j, oTabProp:Spinner_1:Value]      := oTabProp:Edit_1:Value
   ::aImage[j, oTabProp:Spinner_1:Value]        := oTabProp:Edit_2:Value
   ::aPageNames[j, oTabProp:Spinner_1:Value]    := oTabProp:Edit_3:Value
   ::aPageObjs[j, oTabProp:Spinner_1:Value]     := oTabProp:Edit_4:Value
   ::aPageSubClass[j, oTabProp:Spinner_1:Value] := oTabProp:Edit_5:Value
   ::aPageToolTips[j, oTabProp:Spinner_1:Value] := oTabProp:Edit_6:Value
   ::aPageCargos[j, oTabProp:Spinner_1:Value]   := oTabProp:Edit_7:Value

   oTabProp:Button_5:Enabled := .F.
   ::lIsFormModified := .T.

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD EventsClick() CLASS TFormEditor

   LOCAL aData, aFormats, aInitValues, aLabels, aResults, cTitle, ia, j, k, oControl, nControlType

   ia := ::FirstCtrl()
   IF ia <= 0
      RETURN NIL
   ENDIF

   oControl := ::oDesignForm:aControls[ia]
   j := AScan( ::aControlW, Lower( oControl:Name ) )
   IF j <= 0
      RETURN NIL
   ENDIF

   nControlType := AScan( ::ControlType, ::aCtrlType[j] )
   cTitle := DQM( ::cFName + ".fmg" ) + i18n( " - Events of Control " ) + ::aName[j]

   SWITCH nControlType

   CASE TYPE_ACTIVEX
      /* Control has no events */
      EXIT

   CASE TYPE_ANIGIF
      aData       := { { "Action",                ::aAction[j],                                                                  1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aAction[j]          := aResults[ ++k ]
      EXIT

   CASE TYPE_ANIMATEBOX
      /* Control has no events */
      EXIT

   CASE TYPE_BROWSE
      aData       := { { "Action",                ::aAction[j],                                                                  1000 }, ;
                       { "AfterColMove",          ::aAfterColMove[j],                                                            1000 }, ;
                       { "AfterColSize",          ::aAfterColSize[j],                                                            1000 }, ;
                       { "BeforeAutoFit",         ::aBeforeAutoFit[j],                                                           1000 }, ;
                       { "BeforeColMove",         ::aBeforeColMove[j],                                                           1000 }, ;
                       { "BeforeColSize",         ::aBeforeColSize[j],                                                           1000 }, ;
                       { "On AbortEdit",          ::aOnAbortEdit[j],                                                             1000 }, ;
                       { "On Append",             ::aOnAppend[j],                                                                1000 }, ;
                       { "On BeforeEditCell",     ::aOnBfrEdtCell[j],                                                            1000 }, ;
                       { "On Change",             ::aOnChange[j],                                                                1000 }, ;
                       { "On CheckChange",        ::aOnCheckChg[j],                                                              1000 }, ;
                       { "On DblClick",           ::aOnDblClick[j],                                                              1000 }, ;
                       { "On Delete",             ::aOnDelete[j],                                                                1000 }, ;
                       { "On EditCell",           ::aOnEditCell[j],                                                              1000 }, ;
                       { "On EditCellEnd",        ::aOnEditCellEnd[j],                                                           1000 }, ;
                       { "On Enter",              ::aOnEnter[j],                                                                 1000 }, ;
                       { "On GotFocus",           ::aOnGotFocus[j],                                                              1000 }, ;
                       { "On HeadClick",          ::aOnHeadClick[j],                                                             1000 }, ;
                       { "On HeadDblClick",       ::aOnHeadDClick[j],                                                            1000 }, ;
                       { "On HeadRClick",         ::aOnHeadRClick[j],                                                            1000 }, ;
                       { "On LostFocus",          ::aOnLostFocus[j],                                                             1000 }, ;
                       { "On RClick",             ::aOnRClick[j],                                                                1000 }, ;
                       { "On RowRefresh",         ::aOnRowRefresh[j],                                                            1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aAction[j]          := aResults[ ++k ]
      ::aAfterColMove[j]    := aResults[ ++k ]
      ::aAfterColSize[j]    := aResults[ ++k ]
      ::aBeforeAutoFit[j]   := aResults[ ++k ]
      ::aBeforeColMove[j]   := aResults[ ++k ]
      ::aBeforeColSize[j]   := aResults[ ++k ]
      ::aOnAbortEdit[j]     := aResults[ ++k ]
      ::aOnAppend[j]        := aResults[ ++k ]
      ::aOnBfrEdtCell[j]    := aResults[ ++k ]
      ::aOnChange[j]        := aResults[ ++k ]
      ::aOnCheckChg[j]      := aResults[ ++k ]
      ::aOnDblClick[j]      := aResults[ ++k ]
      ::aOnDelete[j]        := aResults[ ++k ]
      ::aOnEditCell[j]      := aResults[ ++k ]
      ::aOnEditCellEnd[j]   := aResults[ ++k ]
      ::aOnEnter[j]         := aResults[ ++k ]
      ::aOnGotFocus[j]      := aResults[ ++k ]
      ::aOnHeadClick[j]     := aResults[ ++k ]
      ::aOnHeadDClick[j]    := aResults[ ++k ]
      ::aOnHeadRClick[j]    := aResults[ ++k ]
      ::aOnLostFocus[j]     := aResults[ ++k ]
      ::aOnRClick[j]        := aResults[ ++k ]
      ::aOnRowRefresh[j]    := aResults[ ++k ]
      EXIT

   CASE TYPE_BUTTON
      aData       := { { "Action",                ::aAction[j],                                                                  1000 }, ;
                       { "On GotFocus",           ::aOnGotFocus[j],                                                              1000 }, ;
                       { "On LostFocus",          ::aOnLostFocus[j],                                                             1000 }, ;
                       { "On MouseMove",          ::aOnMouseMove[j],                                                             1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aAction[j]          := aResults[ ++k ]
      ::aOnGotFocus[j]      := aResults[ ++k ]
      ::aOnLostFocus[j]     := aResults[ ++k ]
      ::aOnMouseMove[j]     := aResults[ ++k ]
      EXIT

   CASE TYPE_CHECKBOX
      aData       := { { "On Change",             ::aOnChange[j],                                                                1000 }, ;
                       { "On GotFocus",           ::aOnGotFocus[j],                                                              1000 }, ;
                       { "On LostFocus",          ::aOnLostFocus[j],                                                             1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aOnChange[j]        := aResults[ ++k ]
      ::aOnGotFocus[j]      := aResults[ ++k ]
      ::aOnLostFocus[j]     := aResults[ ++k ]
      EXIT

   CASE TYPE_CHECKBUTTON
      aData       := { { "On Change",             ::aOnChange[j],                                                                1000 }, ;
                       { "On GotFocus",           ::aOnGotFocus[j],                                                              1000 }, ;
                       { "On LostFocus",          ::aOnLostFocus[j],                                                             1000 }, ;
                       { "On MouseMove",          ::aOnMouseMove[j],                                                             1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aOnChange[j]        := aResults[ ++k ]
      ::aOnGotFocus[j]      := aResults[ ++k ]
      ::aOnLostFocus[j]     := aResults[ ++k ]
      ::aOnMouseMove[j]     := aResults[ ++k ]
      EXIT

   CASE TYPE_CHECKLIST
      aData       := { { "Action",                ::aAction[j],                                                                  1000 }, ;
                       { "On Change",             ::aOnChange[j],                                                                1000 }, ;
                       { "On GotFocus",           ::aOnGotFocus[j],                                                              1000 }, ;
                       { "On LostFocus",          ::aOnLostFocus[j],                                                             1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aAction[j]          := aResults[ ++k ]
      ::aOnChange[j]        := aResults[ ++k ]
      ::aOnGotFocus[j]      := aResults[ ++k ]
      ::aOnLostFocus[j]     := aResults[ ++k ]
      EXIT

   CASE TYPE_COMBOBOX
      aData       := { { "On Cancel",             ::aOnCancel[j],                                                                1000 }, ;
                       { "On Change",             ::aOnChange[j],                                                                1000 }, ;
                       { "On DisplayChange",      ::aOnDispChange[j],                                                            1000 }, ;
                       { "On Enter",              ::aOnEnter[j],                                                                 1000 }, ;
                       { "On GotFocus",           ::aOnGotFocus[j],                                                              1000 }, ;
                       { "On ListClose",          ::aOnListClose[j],                                                             1000 }, ;
                       { "On ListDisplay",        ::aOnListDisplay[j],                                                           1000 }, ;
                       { "On LostFocus",          ::aOnLostFocus[j],                                                             1000 }, ;
                       { "On Refresh",            ::aOnRefresh[j],                                                               1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aOnCancel[j]        := aResults[ ++k ]
      ::aOnChange[j]        := aResults[ ++k ]
      ::aOnDispChange[j]    := aResults[ ++k ]
      ::aOnEnter[j]         := aResults[ ++k ]
      ::aOnGotFocus[j]      := aResults[ ++k ]
      ::aOnListClose[j]     := aResults[ ++k ]
      ::aOnListDisplay[j]   := aResults[ ++k ]
      ::aOnLostFocus[j]     := aResults[ ++k ]
      ::aOnRefresh[j]       := aResults[ ++k ]
      EXIT

   CASE TYPE_DATEPICKER
      aData       := { { "On Change",             ::aOnChange[j],                                                                1000 }, ;
                       { "On Enter",              ::aOnEnter[j],                                                                 1000 }, ;
                       { "On GotFocus",           ::aOnGotFocus[j],                                                              1000 }, ;
                       { "On LostFocus",          ::aOnLostFocus[j],                                                             1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aOnChange[j]        := aResults[ ++k ]
      ::aOnEnter[j]         := aResults[ ++k ]
      ::aOnGotFocus[j]      := aResults[ ++k ]
      ::aOnLostFocus[j]     := aResults[ ++k ]
      EXIT

   CASE TYPE_EDITBOX
      aData       := { { "On Change",             ::aOnChange[j],                                                                1000 }, ;
                       { "On GotFocus",           ::aOnGotFocus[j],                                                              1000 }, ;
                       { "On HScroll",            ::aOnHScroll[j],                                                               1000 }, ;
                       { "On LostFocus",          ::aOnLostFocus[j],                                                             1000 }, ;
                       { "On VScroll",            ::aOnVScroll[j],                                                               1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aOnChange[j]        := aResults[ ++k ]
      ::aOnGotFocus[j]      := aResults[ ++k ]
      ::aOnHScroll[j]       := aResults[ ++k ]
      ::aOnLostFocus[j]     := aResults[ ++k ]
      ::aOnVScroll[j]       := aResults[ ++k ]
      EXIT

   CASE TYPE_FRAME
      /* Control has no events */
      EXIT

   CASE TYPE_GRID
      aData       := { { "Action",                ::aAction[j],                                                                  1000 }, ;
                       { "AfterColMove",          ::aAfterColMove[j],                                                            1000 }, ;
                       { "AfterColSize",          ::aAfterColSize[j],                                                            1000 }, ;
                       { "BeforeAutoFit",         ::aBeforeAutoFit[j],                                                           1000 }, ;
                       { "BeforeColMove",         ::aBeforeColMove[j],                                                           1000 }, ;
                       { "BeforeColSize",         ::aBeforeColSize[j],                                                           1000 }, ;
                       { "On AbortEdit",          ::aOnAbortEdit[j],                                                             1000 }, ;
                       { "On Append",             ::aOnAppend[j],                                                                1000 }, ;
                       { "On BeforeEditCell",     ::aOnBfrEdtCell[j],                                                            1000 }, ;
                       { "On BeforeInsert",       ::aOnBfrInsert[j],                                                             1000 }, ;
                       { "On Change",             ::aOnChange[j],                                                                1000 }, ;
                       { "On CheckChange",        ::aOnCheckChg[j],                                                              1000 }, ;
                       { "On DblClick",           ::aOnDblClick[j],                                                              1000 }, ;
                       { "On Delete",             ::aOnDelete[j],                                                                1000 }, ;
                       { "On EditCell",           ::aOnEditCell[j],                                                              1000 }, ;
                       { "On EditCellEnd",        ::aOnEditCellEnd[j],                                                           1000 }, ;
                       { "On Enter",              ::aOnEnter[j],                                                                 1000 }, ;
                       { "On GotFocus",           ::aOnGotFocus[j],                                                              1000 }, ;
                       { "On HeadClick",          ::aOnHeadClick[j],                                                             1000 }, ;
                       { "On HeadDblClick",       ::aOnHeadDClick[j],                                                            1000 }, ;
                       { "On HeadRClick",         ::aOnHeadRClick[j],                                                            1000 }, ;
                       { "On Insert",             ::aOnInsert[j],                                                                1000 }, ;
                       { "On LostFocus",          ::aOnLostFocus[j],                                                             1000 }, ;
                       { "On QueryData",          ::aOnQueryData[j],                                                             1000 }, ;
                       { "On RClick",             ::aOnRClick[j],                                                                1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aAction[j]          := aResults[ ++k ]
      ::aAfterColMove[j]    := aResults[ ++k ]
      ::aAfterColSize[j]    := aResults[ ++k ]
      ::aBeforeAutoFit[j]   := aResults[ ++k ]
      ::aBeforeColMove[j]   := aResults[ ++k ]
      ::aBeforeColSize[j]   := aResults[ ++k ]
      ::aOnAbortEdit[j]     := aResults[ ++k ]
      ::aOnAppend[j]        := aResults[ ++k ]
      ::aOnBfrEdtCell[j]    := aResults[ ++k ]
      ::aOnBfrInsert[j]     := aResults[ ++k ]
      ::aOnChange[j]        := aResults[ ++k ]
      ::aOnCheckChg[j]      := aResults[ ++k ]
      ::aOnDblClick[j]      := aResults[ ++k ]
      ::aOnDelete[j]        := aResults[ ++k ]
      ::aOnEditCell[j]      := aResults[ ++k ]
      ::aOnEditCellEnd[j]   := aResults[ ++k ]
      ::aOnEnter[j]         := aResults[ ++k ]
      ::aOnGotFocus[j]      := aResults[ ++k ]
      ::aOnHeadClick[j]     := aResults[ ++k ]
      ::aOnHeadDClick[j]    := aResults[ ++k ]
      ::aOnHeadRClick[j]    := aResults[ ++k ]
      ::aOnInsert[j]        := aResults[ ++k ]
      ::aOnLostFocus[j]     := aResults[ ++k ]
      ::aOnQueryData[j]     := aResults[ ++k ]
      ::aOnRClick[j]        := aResults[ ++k ]
      EXIT

   CASE TYPE_HOTKEYBOX
      aData       := { { "On Change",             ::aOnChange[j],                                                                1000 }, ;
                       { "On Enter",              ::aOnEnter[j],                                                                 1000 }, ;
                       { "On GotFocus",           ::aOnGotFocus[j],                                                              1000 }, ;
                       { "On LostFocus",          ::aOnLostFocus[j],                                                             1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aOnChange[j]        := aResults[ ++k ]
      ::aOnEnter[j]         := aResults[ ++k ]
      ::aOnGotFocus[j]      := aResults[ ++k ]
      ::aOnLostFocus[j]     := aResults[ ++k ]
      EXIT

   CASE TYPE_HYPERLINK
      /* Control has no events */
      EXIT

   CASE TYPE_IMAGE
      aData       := { { "Action",                ::aAction[j],                                                                  1000 }, ;
                       { "On Change",             ::aOnChange[j],                                                                1000 }, ;
                       { "On DblClick",           ::aOnDblClick[j],                                                              1000 }, ;
                       { "On MClick",             ::aOnMClick[j],                                                                1000 }, ;
                       { "On MDblClick",          ::aOnMDClick[j],                                                               1000 }, ;
                       { "On MouseLeave",         ::aOnMouseLeave[j],                                                            1000 }, ;
                       { "On MouseMove",          ::aOnMouseMove[j],                                                             1000 }, ;
                       { "On RClick",             ::aOnRClick[j],                                                                1000 }, ;
                       { "On RDblClick",          ::aOnRDClick[j],                                                               1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aAction[j]          := aResults[ ++k ]
      ::aOnChange[j]        := aResults[ ++k ]
      ::aOnDblClick[j]      := aResults[ ++k ]
      ::aOnMClick[j]        := aResults[ ++k ]
      ::aOnMDClick[j]       := aResults[ ++k ]
      ::aOnMouseLeave[j]    := aResults[ ++k ]
      ::aOnMouseMove[j]     := aResults[ ++k ]
      ::aOnRClick[j]        := aResults[ ++k ]
      ::aOnRDClick[j]       := aResults[ ++k ]
      EXIT

   CASE TYPE_IPADDRESS
      aData       := { { "On Change",             ::aOnChange[j],                                                                1000 }, ;
                       { "On GotFocus",           ::aOnGotFocus[j],                                                              1000 }, ;
                       { "On LostFocus",          ::aOnLostFocus[j],                                                             1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aOnChange[j]        := aResults[ ++k ]
      ::aOnGotFocus[j]      := aResults[ ++k ]
      ::aOnLostFocus[j]     := aResults[ ++k ]
      EXIT

   CASE TYPE_LABEL
      aData       := { { "Action",                ::aAction[j],                                                                  1000 }, ;
                       { "On DblClick",           ::aOnDblClick[j],                                                              1000 }, ;
                       { "On MouseLeave",         ::aOnMouseLeave[j],                                                            1000 }, ;
                       { "On MouseMove",          ::aOnMouseMove[j],                                                             1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aAction[j]          := aResults[ ++k ]
      ::aOnDblClick[j]      := aResults[ ++k ]
      ::aOnMouseLeave[j]    := aResults[ ++k ]
      ::aOnMouseMove[j]     := aResults[ ++k ]
      EXIT

   CASE TYPE_LISTBOX
      aData       := { { "On Change",             ::aOnChange[j],                                                                1000 }, ;
                       { "On DblClick",           ::aOnDblClick[j],                                                              1000 }, ;
                       { "On Enter",              ::aOnEnter[j],                                                                 1000 }, ;
                       { "On GotFocus",           ::aOnGotFocus[j],                                                              1000 }, ;
                       { "On LostFocus",          ::aOnLostFocus[j],                                                             1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aOnChange[j]        := aResults[ ++k ]
      ::aOnDblClick[j]      := aResults[ ++k ]
      ::aOnEnter[j]         := aResults[ ++k ]
      ::aOnGotFocus[j]      := aResults[ ++k ]
      ::aOnLostFocus[j]     := aResults[ ++k ]
      EXIT

   CASE TYPE_MONTHCALENDAR
      aData       := { { "On Change",             ::aOnChange[j],                                                                1000 }, ;
                       { "On GotFocus",           ::aOnGotFocus[j],                                                              1000 }, ;
                       { "On LostFocus",          ::aOnLostFocus[j],                                                             1000 }, ;
                       { "On ViewChange",         ::aOnViewChange[j],                                                            1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aOnChange[j]        := aResults[ ++k ]
      ::aOnGotFocus[j]      := aResults[ ++k ]
      ::aOnLostFocus[j]     := aResults[ ++k ]
      ::aOnViewChange[j]    := aResults[ ++k ]
      EXIT

   CASE TYPE_PICBUTT
      aData       := { { "Action",                ::aAction[j],                                                                  1000 }, ;
                       { "On GotFocus",           ::aOnGotFocus[j],                                                              1000 }, ;
                       { "On LostFocus",          ::aOnLostFocus[j],                                                             1000 }, ;
                       { "On MouseMove",          ::aOnMouseMove[j],                                                             1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aAction[j]          := aResults[ ++k ]
      ::aOnGotFocus[j]      := aResults[ ++k ]
      ::aOnLostFocus[j]     := aResults[ ++k ]
      ::aOnMouseMove[j]     := aResults[ ++k ]
      EXIT

   CASE TYPE_PICCHECKBUTT
      aData       := { { "On Change",             ::aOnChange[j],                                                                1000 }, ;
                       { "On GotFocus",           ::aOnGotFocus[j],                                                              1000 }, ;
                       { "On LostFocus",          ::aOnLostFocus[j],                                                             1000 }, ;
                       { "On MouseMove",          ::aOnMouseMove[j],                                                             1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aOnChange[j]        := aResults[ ++k ]
      ::aOnGotFocus[j]      := aResults[ ++k ]
      ::aOnLostFocus[j]     := aResults[ ++k ]
      ::aOnMouseMove[j]     := aResults[ ++k ]
      EXIT

   CASE TYPE_PICTURE
      aData       := { { "Action",                ::aAction[j],                                                                  1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aAction[j]          := aResults[ ++k ]
      EXIT

   CASE TYPE_PLAYER
      /* Control has no events */
      EXIT

   CASE TYPE_PROGRESSBAR
      /* Control has no events */
      EXIT

   CASE TYPE_PROGRESSMETER
      aData       := { { "Action",                ::aAction[j],                                                                  1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aAction[j]          := aResults[ ++k ]
      EXIT

   CASE TYPE_RADIOGROUP
      aData       := { { "On Change",             ::aOnChange[j],                                                                1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aOnChange[j]        := aResults[ ++k ]
      EXIT

   CASE TYPE_RICHEDITBOX
      aData       := { { "On Change",             ::aOnChange[j],                                                                1000 }, ;
                       { "On GotFocus",           ::aOnGotFocus[j],                                                              1000 }, ;
                       { "On HScroll",            ::aOnHScroll[j],                                                               1000 }, ;
                       { "On LostFocus",          ::aOnLostFocus[j],                                                             1000 }, ;
                       { "On SelChange",          ::aOnSelChange[j],                                                             1000 }, ;
                       { "On VScroll",            ::aOnVScroll[j],                                                               1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
       aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aOnChange[j]        := aResults[ ++k ]
      ::aOnGotFocus[j]      := aResults[ ++k ]
      ::aOnHScroll[j]       := aResults[ ++k ]
      ::aOnLostFocus[j]     := aResults[ ++k ]
      ::aOnSelChange[j]     := aResults[ ++k ]
      ::aOnVScroll[j]       := aResults[ ++k ]
      EXIT

   CASE TYPE_SCROLLBAR
      aData       := { { "On Change",             ::aOnChange[j],                                                                1000 }, ;
                       { "On EndTrack",           ::aOnScrEndTrack[j],                                                           1000 }, ;
                       { "On Left/Top",           ::aOnScrLT[j],                                                                 1000 }, ;
                       { "On LineLeft/LineUp",    ::aOnScrLineLU[j],                                                             1000 }, ;
                       { "On LineRight/LineDown", ::aOnScrLineRD[j],                                                             1000 }, ;
                       { "On PageLeft/PageUp",    ::aOnScrPageLU[j],                                                             1000 }, ;
                       { "On PageRight/PageDown", ::aOnScrPageRD[j],                                                             1000 }, ;
                       { "On Right/Bottom",       ::aOnScrRB[j],                                                                 1000 }, ;
                       { "On Thumb",              ::aOnScrThumb[j],                                                              1000 }, ;
                       { "On Track",              ::aOnScrTrack[j],                                                              1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aOnChange[j]        := aResults[ ++k ]
      ::aOnScrEndTrack[j]   := aResults[ ++k ]
      ::aOnScrLT[j]         := aResults[ ++k ]
      ::aOnScrLineLU[j]     := aResults[ ++k ]
      ::aOnScrLineRD[j]     := aResults[ ++k ]
      ::aOnScrPageLU[j]     := aResults[ ++k ]
      ::aOnScrPageRD[j]     := aResults[ ++k ]
      ::aOnScrRB[j]         := aResults[ ++k ]
      ::aOnScrThumb[j]      := aResults[ ++k ]
      ::aOnScrTrack[j]      := aResults[ ++k ]
      EXIT

   CASE TYPE_SLIDER
      aData       := { { "On Change",             ::aOnChange[j],                                                                1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aOnChange[j]        := aResults[ ++k ]
      EXIT

   CASE TYPE_SPINNER
      aData       := { { "On Change",             ::aOnChange[j],                                                                1000 }, ;
                       { "On GotFocus",           ::aOnGotFocus[j],                                                              1000 }, ;
                       { "On LostFocus",          ::aOnLostFocus[j],                                                             1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aOnChange[j]        := aResults[ ++k ]
      ::aOnGotFocus[j]      := aResults[ ++k ]
      ::aOnLostFocus[j]     := aResults[ ++k ]
      EXIT

   CASE TYPE_TAB
      aData       := { { "Action",                ::aOnChange[j],                                                                1000 }, ;
                       { "On Change",             ::aOnGotFocus[j],                                                              1000 }, ;
                       { "On RClick",             ::aOnLostFocus[j],                                                             1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aAction[j]        := aResults[ ++k ]
      ::aOnChange[j]      := aResults[ ++k ]
      ::aOnRClick[j]      := aResults[ ++k ]
      EXIT

   CASE TYPE_TEXTARRAY
      aData       := { { "Action",                ::aOnChange[j],                                                                1000 }, ;
                       { "On GotFocus",           ::aOnGotFocus[j],                                                              1000 }, ;
                       { "On LostFocus",          ::aOnLostFocus[j],                                                             1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aAction[j]          := aResults[ ++k ]
      ::aOnGotFocus[j]      := aResults[ ++k ]
      ::aOnLostFocus[j]     := aResults[ ++k ]
      EXIT

   CASE TYPE_TEXTBOX
      aData       := { { "Action",                ::aAction[j],                                                                  1000 }, ;
                       { "ToolTip",               ::aToolTipAct1[j],                                                             1000 }, ;
                       { "Action2",               ::aAction2[j],                                                                 1000 }, ;
                       { "ToolTip",               ::aToolTipAct2[j],                                                             1000 }, ;
                       { "On Change",             ::aOnChange[j],                                                                1000 }, ;
                       { "On Enter",              ::aOnEnter[j],                                                                 1000 }, ;
                       { "On GotFocus",           ::aOnGotFocus[j],                                                              1000 }, ;
                       { "On LostFocus",          ::aOnLostFocus[j],                                                             1000 }, ;
                       { "On TextFilled",         ::aOnTextFilled[j],                                                            1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aAction[j]          := aResults[ ++k ]
      ::aToolTipAct1[j]     := aResults[ ++k ]
      ::aAction2[j]         := aResults[ ++k ]
      ::aToolTipAct2[j]     := aResults[ ++k ]
      ::aOnChange[j]        := aResults[ ++k ]
      ::aOnEnter[j]         := aResults[ ++k ]
      ::aOnGotFocus[j]      := aResults[ ++k ]
      ::aOnLostFocus[j]     := aResults[ ++k ]
      ::aOnTextFilled[j]    := aResults[ ++k ]
      EXIT

   CASE TYPE_TIMEPICKER
      aData       := { { "On Change",             ::aOnChange[j],                                                                1000 }, ;
                       { "On Enter",              ::aOnEnter[j],                                                                 1000 }, ;
                       { "On GotFocus",           ::aOnGotFocus[j],                                                              1000 }, ;
                       { "On LostFocus",          ::aOnLostFocus[j],                                                             1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aOnChange[j]        := aResults[ ++k ]
      ::aOnEnter[j]         := aResults[ ++k ]
      ::aOnGotFocus[j]      := aResults[ ++k ]
      ::aOnLostFocus[j]     := aResults[ ++k ]
      EXIT

   CASE TYPE_TIMER
      aData       := { { "Action",                ::aAction[j],                                                                  1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aAction[j]          := aResults[ ++k ]
      EXIT

   CASE TYPE_TREE
      aData       := { { "On Change",             ::aOnChange[j],                                                                1000 }, ;
                       { "On CheckChange",        ::aOnCheckChg[j],                                                              1000 }, ;
                       { "On Collapse",           ::aOnCollapse[j],                                                              1000 }, ;
                       { "On DblClick",           ::aOnDblClick[j],                                                              1000 }, ;
                       { "On Drop",               ::aOnDrop[j],                                                                  1000 }, ;
                       { "On Enter",              ::aOnEnter[j],                                                                 1000 }, ;
                       { "On Expand",             ::aOnExpand[j],                                                                1000 }, ;
                       { "On GotFocus",           ::aOnGotFocus[j],                                                              1000 }, ;
                       { "On LabelEdit",          ::aOnLabelEdit[j],                                                             1000 }, ;
                       { "On LostFocus",          ::aOnLostFocus[j],                                                             1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aOnChange[j]        := aResults[ ++k ]
      ::aOnCheckChg[j]      := aResults[ ++k ]
      ::aOnCollapse[j]      := aResults[ ++k ]
      ::aOnDblClick[j]      := aResults[ ++k ]
      ::aOnDrop[j]          := aResults[ ++k ]
      ::aOnEnter[j]         := aResults[ ++k ]
      ::aOnExpand[j]        := aResults[ ++k ]
      ::aOnGotFocus[j]      := aResults[ ++k ]
      ::aOnLabelEdit[j]     := aResults[ ++k ]
      ::aOnLostFocus[j]     := aResults[ ++k ]
      EXIT

   CASE TYPE_XBROWSE
      aData       := { { "Action",                ::aAction[j],                                                                  1000 }, ;
                       { "AfterColMove",          ::aAfterColMove[j],                                                            1000 }, ;
                       { "AfterColSize",          ::aAfterColSize[j],                                                            1000 }, ;
                       { "BeforeAutoFit",         ::aBeforeAutoFit[j],                                                           1000 }, ;
                       { "BeforeColMove",         ::aBeforeColMove[j],                                                           1000 }, ;
                       { "BeforeColSize",         ::aBeforeColSize[j],                                                           1000 }, ;
                       { "On AbortEdit",          ::aOnAbortEdit[j],                                                             1000 }, ;
                       { "On Append",             ::aOnAppend[j],                                                                1000 }, ;
                       { "On BeforeEditCell",     ::aOnBfrEdtCell[j],                                                            1000 }, ;
                       { "On Change",             ::aOnChange[j],                                                                1000 }, ;
                       { "On CheckChange",        ::aOnCheckChg[j],                                                              1000 }, ;
                       { "On DblClick",           ::aOnDblClick[j],                                                              1000 }, ;
                       { "On Delete",             ::aOnDelete[j],                                                                1000 }, ;
                       { "On EditCell",           ::aOnEditCell[j],                                                              1000 }, ;
                       { "On EditCellEnd",        ::aOnEditCellEnd[j],                                                           1000 }, ;
                       { "On Enter",              ::aOnEnter[j],                                                                 1000 }, ;
                       { "On GotFocus",           ::aOnGotFocus[j],                                                              1000 }, ;
                       { "On HeadClick",          ::aOnHeadClick[j],                                                             1000 }, ;
                       { "On HeadDblClick",       ::aOnHeadDClick[j],                                                            1000 }, ;
                       { "On HeadRClick",         ::aOnHeadRClick[j],                                                            1000 }, ;
                       { "On LostFocus",          ::aOnLostFocus[j],                                                             1000 }, ;
                       { "On RClick",             ::aOnRClick[j],                                                                1000 }, ;
                       { "On RowRefresh",         ::aOnRowRefresh[j],                                                            1000 } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         oControl:SetFocus()
         RETURN NIL
      ENDIF
      k := 0
      ::aAction[j]          := aResults[ ++k ]
      ::aAfterColMove[j]    := aResults[ ++k ]
      ::aAfterColSize[j]    := aResults[ ++k ]
      ::aBeforeAutoFit[j]   := aResults[ ++k ]
      ::aBeforeColMove[j]   := aResults[ ++k ]
      ::aBeforeColSize[j]   := aResults[ ++k ]
      ::aOnAbortEdit[j]     := aResults[ ++k ]
      ::aOnAppend[j]        := aResults[ ++k ]
      ::aOnBfrEdtCell[j]    := aResults[ ++k ]
      ::aOnChange[j]        := aResults[ ++k ]
      ::aOnCheckChg[j]      := aResults[ ++k ]
      ::aOnDblClick[j]      := aResults[ ++k ]
      ::aOnDelete[j]        := aResults[ ++k ]
      ::aOnEditCell[j]      := aResults[ ++k ]
      ::aOnEditCellEnd[j]   := aResults[ ++k ]
      ::aOnEnter[j]         := aResults[ ++k ]
      ::aOnGotFocus[j]      := aResults[ ++k ]
      ::aOnHeadClick[j]     := aResults[ ++k ]
      ::aOnHeadDClick[j]    := aResults[ ++k ]
      ::aOnHeadRClick[j]    := aResults[ ++k ]
      ::aOnLostFocus[j]     := aResults[ ++k ]
      ::aOnRClick[j]        := aResults[ ++k ]
      ::aOnRowRefresh[j]    := aResults[ ++k ]
      EXIT

   ENDSWITCH

   ::lIsFormModified := .T.
   oControl:SetFocus()

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD FrmProperties() CLASS TFormEditor

   LOCAL aData, aFormats, aInitValues, aLabels, aNewDefines, aNewUndefs, aResults, cConstant, cDefines, cFBkClrForShow
   LOCAL cFColorForShow, cFFontForShow, cFTitleForShow, cLine, cTitle, cUndefs, cValue, i, j, k, lAgain, nFColForShow, nFHeight
   LOCAL nFMaxHeight, nFMaxWidth, nFMinHeight, nFMinWidth, nFRowForShow, nFSizeForShow, nFVirtualH, nFVirtualW, nFWidth, nLineCount
   LOCAL nPos

   cTitle := DQM( ::cFName + ".fmg" ) + i18n( " - Properties of Form" )

   cDefines := ""
   FOR i := 1 TO Len( ::aFDefines )
      cDefines += "#define " + ::aFDefines[i, 1] + " " + ::aFDefines[i, 2] + CRLF
   NEXT i

   cUndefs := ""
   FOR i := 1 TO Len( ::aFUndefs )
      cUndefs += "#undef " + ::aFUndefs[i] + CRLF
   NEXT i

   IF ! NOTEMPTY( ::cFPosition[1] )
      ::cFPosition[1] := LTrim( Str( ::oDesignForm:Row ) )
   ENDIF
   IF ! NOTEMPTY( ::cFPosition[2] )
      ::cFPosition[2] := LTrim( Str( ::oDesignForm:Col ) )
   ENDIF

   DO WHILE .T.
      aData       := { { "Name",             "TEMPLATE",                                               NIL  }, ;
                       { "Obj",              ::cFObj,                                                  1000 }, ;
                       { "BackColor",        ::cFBackColor,                                            1000 }, ;
                       { "BackImage",        ::cFBackImage,                                            1000 }, ;
                       { "Border",           ::lFBorder,                                               .F.  }, ;
                       { "Break",            ::lFBreak,                                                .F.  }, ;
                       { "Cargo",            ::cFCargo,                                                1000 }, ;
                       { "Child",            ::lFChild,                                                .F.  }, ;
                       { "ClientArea",       ::lFClientArea,                                           .F.  }, ;
                       { "Col",              ::cFPosition[2],                                          1000 }, ;
                       { "Cursor",           ::cFCursor,                                               1000 }, ;
                       { "Focused",          ::lFFocused,                                              .F.  }, ;
                       { "Font",             ::cFFontName,                                             1000 }, ;
                       { "FontColor",        ::cFFontColor,                                            1000 }, ;
                       { "FontSize",         ::cFFontSize,                                             1000 }, ;
                       { "GripperText",      ::cFGripperText,                                          1000 }, ;
                       { "Height",           ::cFHeight,                                               1000 }, ;
                       { "HelpButton",       ::lFHelpButton,                                           .F.  }, ;
                       { "Icon",             ::cFIcon,                                                 1000 }, ;
                       { "InteractiveClose", AScan( { "ON", "OFF", "QUERY" }, ::cFInterActClose ) + 1, { "NIL", "ON", "OFF", "QUERY" } }, ;
                       { "Internal",         ::lFInternal,                                             .F.  }, ;
                       { "Main",             ::lFMain,                                                 .F.  }, ;
                       { "MaxHeight",        ::cFMaxHeight,                                            1000 }, ;
                       { "MaxWidth",         ::cFMaxWidth,                                             1000 }, ;
                       { "MDI",              ::lFMDI,                                                  .F.  }, ;
                       { "MDIChild",         ::lFMDIChild,                                             .F.  }, ;
                       { "MDIClient",        ::lFMDIClient,                                            .F.  }, ;
                       { "MinHeight",        ::cFMinHeight,                                            1000 }, ;
                       { "MinWidth",         ::cFMinWidth,                                             1000 }, ;
                       { "Modal",            ::lFModal,                                                .F.  }, ;
                       { "ModalSize",        ::lFModalSize,                                            .F.  }, ;
                       { "NoAutoRelease",    ::lFNoAutoRelease,                                        .F.  }, ;
                       { "NoCaption",        ::lFNoCaption,                                            .F.  }, ;
                       { "NODWP",            ::lFNoDefWinProc,                                         .F.  }, ;
                       { "NoMaximize",       ::lFNoMaximize,                                           .F.  }, ;
                       { "NoMinimize",       ::lFNoMinimize,                                           .F.  }, ;
                       { "NoShow",           ::lFNoShow,                                               .F.  }, ;
                       { "NoSize",           ::lFNoSize,                                               .F.  }, ;
                       { "NoSysMenu",        ::lFNoSysMenu,                                            .F.  }, ;
                       { "NotifyIcon",       ::cFNotifyIcon,                                           1000 }, ;
                       { "NotifyToolTip",    ::cFNotifyTooltip,                                        1000 }, ;
                       { "Parent",           ::cFParent,                                               1000 }, ;
                       { "Row",              ::cFPosition[1],                                          1000 }, ;
                       { "RTL",              ::lFRTL,                                                  .F.  }, ;
                       { "SplitChild",       ::lFSplitchild,                                           .F.  }, ;
                       { "Stretch",          ::lFStretch,                                              .F.  }, ;
                       { "SubClass",         ::cFSubClass,                                             1000 }, ;
                       { "Title",            ::cFTitle,                                                1000 }, ;
                       { "Topmost",          ::lFTopmost,                                              .F.  }, ;
                       { "VirtualHeight",    ::cFVirtualH,                                             1000 }, ;
                       { "VirtualWidth",     ::cFVirtualW,                                             1000 }, ;
                       { "Width",            ::cFWidth,                                                1000 }, ;
                       { "#define",          cDefines,                                                 "M"  }, ;
                       { "#undef",           cUndefs,                                                  "M"  } }
      aLabels     := Array( Len( aData ) )
      aInitValues := Array( Len( aData ) )
      aFormats    := Array( Len( aData ) )
      AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
      /* get data */
      aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
      IF aResults[1] == NIL
         ::oDesignForm:SetFocus()
         RETURN NIL
      ENDIF
      k := 1
      // Item 01, "Name", is readonly
      ::cFObj           := aResults[ ++k ]
      ::cFBackColor     := aResults[ ++k ]
      ::cFBackImage     := aResults[ ++k ]
      ::lFBorder        := aResults[ ++k ]
      ::lFBreak         := aResults[ ++k ]
      ::cFCargo         := aResults[ ++k ]
      ::lFChild         := aResults[ ++k ]
      ::lFClientArea    := aResults[ ++k ]
      ::cFPosition[2]   := iif( NOTEMPTY( aResults[ ++k ] ), aResults[ k ], LTrim( Str( ::oDesignForm:Col ) ) )
      ::cFCursor        := aResults[ ++k ]
      ::lFFocused       := aResults[ ++k ]
      ::cFFontName      := aResults[ ++k ]
      ::cFFontColor     := aResults[ ++k ]
      ::cFFontSize      := aResults[ ++k ]
      ::cFGripperText   := aResults[ ++k ]
      ::cFHeight        := aResults[ ++k ]
      ::lFHelpButton    := aResults[ ++k ]
      ::cFIcon          := aResults[ ++k ]
      ::cFInterActClose := { "NIL", "ON", "OFF", "QUERY" } [ aResults[ ++k ] ]
      ::lFInternal      := aResults[ ++k ]
      ::lFMain          := aResults[ ++k ]
      ::cFMaxHeight     := aResults[ ++k ]
      ::cFMaxWidth      := aResults[ ++k ]
      ::lFMDI           := aResults[ ++k ]
      ::lFMDIChild      := aResults[ ++k ]
      ::lFMDIClient     := aResults[ ++k ]
      ::cFMinHeight     := aResults[ ++k ]
      ::cFMinWidth      := aResults[ ++k ]
      ::lFModal         := aResults[ ++k ]
      ::lFModalSize     := aResults[ ++k ]
      ::lFNoAutoRelease := aResults[ ++k ]
      ::lFNoCaption     := aResults[ ++k ]
      ::lFNoDefWinProc  := aResults[ ++k ]
      ::lFNoMaximize    := aResults[ ++k ]
      ::lFNoMinimize    := aResults[ ++k ]
      ::lFNoShow        := aResults[ ++k ]
      ::lFNoSize        := aResults[ ++k ]
      ::lFNoSysMenu     := aResults[ ++k ]
      ::cFNotifyIcon    := aResults[ ++k ]
      ::cFNotifyTooltip := aResults[ ++k ]
      ::cFParent        := aResults[ ++k ]
      ::cFPosition[1]   := iif( NOTEMPTY( aResults[ ++k ] ), aResults[ k ], LTrim( Str( ::oDesignForm:Row ) ) )
      ::lFRTL           := aResults[ ++k ]
      ::lFSplitchild    := aResults[ ++k ]
      ::lFStretch       := aResults[ ++k ]
      ::cFSubClass      := aResults[ ++k ]
      ::cFTitle         := aResults[ ++k ]
      ::lFTopmost       := aResults[ ++k ]
      ::cFVirtualH      := aResults[ ++k ]
      ::cFVirtualW      := aResults[ ++k ]
      ::cFWidth         := aResults[ ++k ]
      ::lIsFormModified := .T.

      // Process #defines
      IF ! HB_ISSTRING( aResults[ ++k ] )
         aResults[ k ] := ""
      ELSE
         aResults[ k ] := StrTran( aResults[ k ], HTAB, " " )
      ENDIF
      nLineCount  := MLCount( aResults[ k ] )
      aNewDefines := {}
      lAgain := .F.
      FOR i := 1 TO nLineCount
         cLine := AllTrim( MemoLine( aResults[ k ], 1200, i ) )
         IF Upper( Left( cLine, 8 ) ) == "#DEFINE "
            cLine     := LTrim( SubStr( cLine, 9 ) )
            nPos      := At( " ", cLine + " " )
            cConstant := Left( cLine, nPos - 1 )
            IF IsAlpha( cConstant ) .OR. Left( cConstant, 1 ) == "_"
               cValue    := LTrim( SubStr( cLine, nPos + 1 ) )
               j         := i
               DO WHILE i < nLineCount .AND. Right( cValue, 1 ) == ";"
                  i ++
                  cValue += ( CRLF + RTrim( MemoLine( aResults[ k ], 1200, i ) ) )
               ENDDO
               IF Right( cValue, 3 ) == ";" + CRLF
                  cValue := RTrim( Left( cValue, Len( cValue ) - 3 ) )
               ELSEIF Right( cValue, 1 ) == ";"
                  cValue := RTrim( Left( cValue, Len( cValue ) - 1 ) )
               ENDIF
               IF Empty( cValue )
                  IF MsgYesNo( i18n( "Malformed #define detected at line " ) + LTrim( Str( j ) ) + i18n( ". Edit?" ), "OOHG IDE+" )
                     lAgain := .T.
                     EXIT
                  ENDIF
               ELSE
                  AAdd( aNewDefines, { cConstant, cValue } )
               ENDIF
            ELSE
               IF MsgYesNo( i18n( "Invalid #define detected at line " ) + LTrim( Str( j ) ) + i18n( ". Edit?" ), "OOHG IDE+" )
                  lAgain := .T.
                  EXIT
               ENDIF
            ENDIF
         ELSE
            j := i
            DO WHILE Right( cLine, 1 ) == ";"
               i ++
               cLine := RTrim( MemoLine( aResults[ k ], 1200, i ) )
            ENDDO
            IF MsgYesNo( i18n( "Invalid #define detected at line " ) + LTrim( Str( j ) ) + i18n( ". Edit?" ), "OOHG IDE+" )
               lAgain := .T.
               EXIT
            ENDIF
         ENDIF
      NEXT i

      IF ! lAgain
         // Process #undefs
         IF ! HB_ISSTRING( aResults[ ++k ] )
            aResults[ k ] := ""
         ELSE
            aResults[ k ] := StrTran( aResults[ k ], HTAB, " " )
         ENDIF
         nLineCount := MLCount( aResults[ k ] )
         aNewUndefs := {}
         FOR i := 1 TO nLineCount
            cLine := AllTrim( MemoLine( aResults[ k ], 1200, i ) )
            IF Upper( Left( cLine, 7 ) ) == "#UNDEF "
               cLine     := LTrim( SubStr( cLine, 8 ) )
               nPos      := At( " ", cLine + " " )
               cConstant := Left( cLine, nPos - 1 )
               IF IsAlpha( cConstant ) .OR. Left( cConstant, 1 ) == "_"
                  cValue    := LTrim( SubStr( cLine, nPos + 1 ) )
                  j         := i
                  DO WHILE i < nLineCount .AND. Right( cValue, 1 ) == ";"
                     i ++
                     cValue += ( CRLF + RTrim( MemoLine( aResults[ k ], 1200, i ) ) )
                  ENDDO
                  IF Right( cValue, 3 ) == ";" + CRLF
                     cValue := RTrim( Left( cValue, Len( cValue ) - 3 ) )
                  ELSEIF Right( cValue, 1 ) == ";"
                     cValue := RTrim( Left( cValue, Len( cValue ) - 1 ) )
                  ENDIF
                  IF Empty( cValue )
                     AAdd( aNewUndefs, cConstant )
                  ELSEIF Upper( cValue ) == "NIL"
                     IF MsgYesNo( i18n( "Invalid #undef detected at line " ) + LTrim( Str( j ) ) + i18n( ". Edit?" ), "OOHG IDE+" )
                        lAgain := .T.
                        EXIT
                     ENDIF
                  ELSE
                     IF MsgYesNo( i18n( "Invalid #undef detected at line " ) + LTrim( Str( j ) ) + i18n( ". Edit?" ), "OOHG IDE+" )
                        lAgain := .T.
                        EXIT
                     ENDIF
                  ENDIF
               ELSE
                  IF MsgYesNo( i18n( "Invalid #undef detected at line " ) + LTrim( Str( j ) ) + i18n( ". Edit?" ), "OOHG IDE+" )
                     lAgain := .T.
                     EXIT
                  ENDIF
               ENDIF
            ELSE
               j := i
               DO WHILE i < nLineCount .AND. Right( cLine, 1 ) == ";"
                  i ++
                  cLine := RTrim( MemoLine( aResults[ k ], 1200, i ) )
               ENDDO
               IF MsgYesNo( i18n( "Invalid #undef detected at line " ) + LTrim( Str( j ) ) + i18n( ". Edit?" ), "OOHG IDE+" )
                  lAgain := .T.
                  EXIT
               ENDIF
            ENDIF
         NEXT i

         IF ! lAgain
            ::aFDefines := aNewDefines
            ::aFUndefs  := aNewUndefs
            EXIT
         ENDIF
      ENDIF

      cDefines := aResults[ k - 1 ]
      cUndefs  := aResults[ k ]
   ENDDO

   /* Derive values that can be used in the design form */
   nFRowForShow   := ::StrToValueForm( "ROW", ::cFPosition[1], "N", 120, 0, GetDesktopRealHeight() - 50 )      // TODO: add a parameter
   nFColForShow   := ::StrToValueForm( "COL", ::cFPosition[2], "N", 120, 0, GetDesktopRealWidth() - 50 )       // TODO: add a parameter
   cFTitleForShow := ::StrToValueForm( "TITLE", ::cFTitle, "C", "Form's title" )
   cFFontForShow  := iif( ! NOTEMPTY( ::cFFontName ), _OOHG_DefaultFontName, ::StrToValueForm( "FONT", ::cFFontName, "C", ::myIde:cFormDefFontName ) )
   cFColorForShow := iif( ! NOTEMPTY( ::cFFontColor ), _OOHG_DefaultFontColor, ::StrToValueForm( "FONTCOLOR", ::cFFontColor, "X", ::myIde:cFormDefFontColor ) )
   cFBkClrForShow := iif( ! NOTEMPTY( ::cFBackColor ), NIL, ::StrToValueForm( "BACKCOLOR", ::cFBackColor, "X", ::myIde:aSystemColor ) )
   nFSizeForShow  := iif( ! NOTEMPTY( ::cFFontSize ), _OOHG_DefaultFontSize, ::StrToValueForm( "SIZE", ::cFFontSize, "N", ::myIde:nFormDefFontSize, 0, 0 ) )
   nFWidth        := ::StrToValueForm( "WIDTH", ::cFWidth, "N", 640, GetSystemMetrics( SM_CXMIN ), 0 )
   nFHeight       := ::StrToValueForm( "HEIGHT", ::cFHeight, "N", 480, GetSystemMetrics( SM_CYMIN ), 0 )
   nFVirtualW     := ::StrToValueForm( "VIRTUAL WIDTH", ::cFVirtualW, "N", 0, 0, 0 )
   nFVirtualH     := ::StrToValueForm( "VIRTUAL HEIGHT", ::cFVirtualH, "N", 0, 0, 0 )
   nFMaxWidth     := ::StrToValueForm( "MAXWIDTH", ::cFMaxWidth, "N", 0, 0, 0 )
   nFMaxHeight    := ::StrToValueForm( "MAXHEIGHT", ::cFMaxHeight, "N", 0, 0, 0 )
   nFMinWidth     := ::StrToValueForm( "MINWIDTH", ::cFMinWidth, "N", 0, GetSystemMetrics( SM_CXMIN ), 0 )
   nFMinHeight    := ::StrToValueForm( "MINHEIGHT", ::cFMinHeight, "N", 0, GetSystemMetrics( SM_CYMIN ), 0 )

   /* Apply derived values to design form */
   ::oDesignForm:Hide()
   ::oDesignForm:Row           := nFRowForShow
   ::oDesignForm:Col           := nFColForShow
   ::oDesignForm:Title         := cFTitleForShow
   ::oDesignForm:cFontName     := cFFontForShow
   ::oDesignForm:nFontSize     := nFSizeForShow
   ::oDesignForm:FontColor     := cFColorForShow
   ::oDesignForm:BackColor     := cFBkClrForShow
   ::oDesignForm:Width         := nFWidth
   ::oDesignForm:nWidth        := nFWidth
   ::oDesignForm:Height        := nFHeight
   ::oDesignForm:nHeight       := nFHeight
   ::oDesignForm:VirtualWidth  := nFVirtualW
   ::oDesignForm:VirtualHeight := nFVirtualH
   ::oDesignForm:MaxWidth      := nFMaxWidth
   ::oDesignForm:MaxHeight     := nFMaxHeight
   ::oDesignForm:MinWidth      := nFMinWidth
   ::oDesignForm:MinHeight     := nFMinHeight
   IF ::lFClientArea
      ClientAreaResize( ::oDesignForm )
   ENDIF

   ::oDesignForm:Show()
   ::oDesignForm:SetFocus()

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD FrmEvents() CLASS TFormEditor

   LOCAL aData, aLabels, aInitValues, aFormats, aResults, cTitle

   aData       := { { "On DblClick",         ::cFDblClickProcedure,  1000 }, ;
                    { "On GotFocus",         ::cFOnGotFocus,         1000 }, ;
                    { "On HScrollBox",       ::cFOnHScrollbox,       1000 }, ;
                    { "On Init",             ::cFOnInit,             1000 }, ;
                    { "On InteractiveClose", ::cFOnInteractiveClose, 1000 }, ;
                    { "On Key - keys",       ::cFOnKeyKeys,          1000 }, ;
                    { "On Key - actions",    ::cFOnKeyActions,       1000 }, ;
                    { "On LostFocus",        ::cFOnLostFocus,        1000 }, ;
                    { "On Maximize",         ::cFOnMaximize,         1000 }, ;
                    { "On MClick",           ::cFMClickProcedure,    1000 }, ;
                    { "On MDblClick",        ::cFMDblClickProcedure, 1000 }, ;
                    { "On Minimize",         ::cFOnMinimize,         1000 }, ;
                    { "On MouseClick",       ::cFOnMouseClick,       1000 }, ;
                    { "On MouseDrag",        ::cFOnMouseDrag,        1000 }, ;
                    { "On MouseMove",        ::cFOnMouseMove,        1000 }, ;
                    { "On Move",             ::cFMoveProcedure,      1000 }, ;
                    { "On NotifyClick",      ::cFOnNotifyClick,      1000 }, ;
                    { "On Paint",            ::cFOnPaint,            1000 }, ;
                    { "On RClick",           ::cFRClickProcedure,    1000 }, ;
                    { "On RDblClick",        ::cFRDblClickProcedure, 1000 }, ;
                    { "On Release",          ::cFOnRelease,          1000 }, ;
                    { "On Restore",          ::cFRestoreProcedure,   1000 }, ;
                    { "On ScrollDown",       ::cFOnScrollDown,       1000 }, ;
                    { "On ScrollLeft",       ::cFOnScrollLeft,       1000 }, ;
                    { "On ScrollRight",      ::cFOnScrollRight,      1000 }, ;
                    { "On ScrollUp",         ::cFOnScrollUp,         1000 }, ;
                    { "On Size",             ::cFOnSize,             1000 }, ;
                    { "On VScrollBox",       ::cFOnVScrollbox,       1000 } }
   cTitle := DQM( ::cFName + ".fmg" ) + i18n( " - Events of Form" )
   aLabels     := Array( Len( aData ) )
   aInitValues := Array( Len( aData ) )
   aFormats    := Array( Len( aData ) )
   AEval( aData, { |a, i| aLabels[i] := a[1], aInitValues[i] := a[2], aFormats[i] := a[3] } )
   /* get data */
   aResults    := ::myIde:myInputWindow( cTitle, aLabels, aInitValues, aFormats )
   IF aResults[1] == NIL
      ::oDesignForm:SetFocus()
      RETURN NIL
   ENDIF
   ::cFDblClickProcedure  := aResults[01]
   ::cFOnGotFocus         := aResults[02]
   ::cFOnHScrollbox       := aResults[03]
   ::cFOnInit             := aResults[04]
   ::cFOnInteractiveClose := aResults[05]
   ::cFOnKeyKeys          := aResults[06]
   ::cFOnKeyActions       := aResults[07]
   ::cFOnLostFocus        := aResults[08]
   ::cFOnMaximize         := aResults[09]
   ::cFMClickProcedure    := aResults[10]
   ::cFMDblClickProcedure := aResults[11]
   ::cFOnMinimize         := aResults[12]
   ::cFOnMouseClick       := aResults[13]
   ::cFOnMouseDrag        := aResults[14]
   ::cFOnMouseMove        := aResults[15]
   ::cFMoveProcedure      := aResults[16]
   ::cFOnNotifyClick      := aResults[17]
   ::cFOnPaint            := aResults[18]
   ::cFRClickProcedure    := aResults[19]
   ::cFRDblClickProcedure := aResults[20]
   ::cFOnRelease          := aResults[21]
   ::cFRestoreProcedure   := aResults[22]
   ::cFOnScrollDown       := aResults[23]
   ::cFOnScrollLeft       := aResults[24]
   ::cFOnScrollRight      := aResults[25]
   ::cFOnScrollUp         := aResults[26]
   ::cFOnSize             := aResults[27]
   ::cFOnVScrollbox       := aResults[28]

   ::lIsFormModified := .T.
   ::oDesignForm:SetFocus()

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD Snap( oControl ) CLASS TFormEditor

   LOCAL nRow, nCol
   IF ::myIde:lSnap
      nRow := oControl:Row
      nCol := oControl:Col
      DO WHILE Mod( nRow, 10 ) # 0
         nRow --
      ENDDO
      DO WHILE Mod( nCol, 10 ) # 0
         nCol --
      ENDDO
      oControl:Row := nRow
      oControl:Col := nCol
   ENDIF

   RETURN NIL

/*--------------------------------------------------------------------------------------------------------------------------------*/
METHOD CtrlIsOfType( ia, cType ) CLASS TFormEditor

   LOCAL i

   IF ( i := AScan( ::aControlW, Lower( ::oDesignForm:aControls[ia]:Name ) ) ) > 0
      /* cType must be uppercase */
      IF ( " " + ::aCtrlType[i] + " " ) $ cType
         RETURN .T.
      ENDIF
   ENDIF

   RETURN .F.

/*--------------------------------------------------------------------------------------------------------------------------------*/
#pragma BEGINDUMP

#include "oohg.h"
#include "hbapi.h"
#include "hbapiitm.h"
#include <windows.h>
#include <commctrl.h>

/*--------------------------------------------------------------------------------------------------------------------------------*/
HB_FUNC( SETPIXEL )
{
  hb_retnl( (ULONG) SetPixel( HDCparam( 1 ), hb_parni( 2 ), hb_parni( 3 ), (COLORREF) hb_parnl( 4 ) ) ) ;
}

/*
#define WMSZ_LEFT 1
#define WMSZ_RIGHT 2
#define WMSZ_TOP 3
#define WMSZ_TOPLEFT 4
#define WMSZ_TOPRIGHT 5
#define WMSZ_BOTTOM 6
#define WMSZ_BOTTOMLEFT 7
#define WMSZ_BOTTOMRIGHT 8
*/

/*--------------------------------------------------------------------------------------------------------------------------------*/
HB_FUNC( INTERACTIVESIZEHANDLE )
{
   SendMessage( HWNDparam( 1 ), WM_SYSCOMMAND, SC_SIZE + 8, 0 );
}

/*--------------------------------------------------------------------------------------------------------------------------------*/
HB_FUNC( INTERACTIVEMOVEHANDLE )
{
   keybd_event( VK_RIGHT, 0, 0, 0 );
   keybd_event( VK_LEFT, 0, 0, 0 );
   SendMessage( HWNDparam( 1 ), WM_SYSCOMMAND, SC_MOVE, 0 );
}

#pragma ENDDUMP

/*
 * EOF
 */
